(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const C of document.querySelectorAll('link[rel="modulepreload"]'))x(C);new MutationObserver(C=>{for(const k of C)if(k.type==="childList")for(const E of k.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&x(E)}).observe(document,{childList:!0,subtree:!0});function m(C){const k={};return C.integrity&&(k.integrity=C.integrity),C.referrerPolicy&&(k.referrerPolicy=C.referrerPolicy),C.crossOrigin==="use-credentials"?k.credentials="include":C.crossOrigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function x(C){if(C.ep)return;C.ep=!0;const k=m(C);fetch(C.href,k)}})();var w2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lf(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var P_={exports:{}},Bm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dx;function S2(){if(Dx)return Bm;Dx=1;var o=Symbol.for("react.transitional.element"),d=Symbol.for("react.fragment");function m(x,C,k){var E=null;if(k!==void 0&&(E=""+k),C.key!==void 0&&(E=""+C.key),"key"in C){k={};for(var l in C)l!=="key"&&(k[l]=C[l])}else k=C;return C=k.ref,{$$typeof:o,type:x,key:E,ref:C!==void 0?C:null,props:k}}return Bm.Fragment=d,Bm.jsx=m,Bm.jsxs=m,Bm}var Nx;function T2(){return Nx||(Nx=1,P_.exports=S2()),P_.exports}var w=T2(),j_={exports:{}},br={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lx;function M2(){if(Lx)return br;Lx=1;var o=Symbol.for("react.transitional.element"),d=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),E=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),V=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),ne=Symbol.iterator;function re(Se){return Se===null||typeof Se!="object"?null:(Se=ne&&Se[ne]||Se["@@iterator"],typeof Se=="function"?Se:null)}var ee={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},te=Object.assign,be={};function Ee(Se,_t,Ot){this.props=Se,this.context=_t,this.refs=be,this.updater=Ot||ee}Ee.prototype.isReactComponent={},Ee.prototype.setState=function(Se,_t){if(typeof Se!="object"&&typeof Se!="function"&&Se!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Se,_t,"setState")},Ee.prototype.forceUpdate=function(Se){this.updater.enqueueForceUpdate(this,Se,"forceUpdate")};function Ae(){}Ae.prototype=Ee.prototype;function Ie(Se,_t,Ot){this.props=Se,this.context=_t,this.refs=be,this.updater=Ot||ee}var tt=Ie.prototype=new Ae;tt.constructor=Ie,te(tt,Ee.prototype),tt.isPureReactComponent=!0;var vt=Array.isArray,nt={H:null,A:null,T:null,S:null},Ye=Object.prototype.hasOwnProperty;function st(Se,_t,Ot,It,Et,Kt){return Ot=Kt.ref,{$$typeof:o,type:Se,key:_t,ref:Ot!==void 0?Ot:null,props:Kt}}function ot(Se,_t){return st(Se.type,_t,void 0,void 0,void 0,Se.props)}function at(Se){return typeof Se=="object"&&Se!==null&&Se.$$typeof===o}function xt(Se){var _t={"=":"=0",":":"=2"};return"$"+Se.replace(/[=:]/g,function(Ot){return _t[Ot]})}var zt=/\/+/g;function Ht(Se,_t){return typeof Se=="object"&&Se!==null&&Se.key!=null?xt(""+Se.key):_t.toString(36)}function Yt(){}function er(Se){switch(Se.status){case"fulfilled":return Se.value;case"rejected":throw Se.reason;default:switch(typeof Se.status=="string"?Se.then(Yt,Yt):(Se.status="pending",Se.then(function(_t){Se.status==="pending"&&(Se.status="fulfilled",Se.value=_t)},function(_t){Se.status==="pending"&&(Se.status="rejected",Se.reason=_t)})),Se.status){case"fulfilled":return Se.value;case"rejected":throw Se.reason}}throw Se}function Rr(Se,_t,Ot,It,Et){var Kt=typeof Se;(Kt==="undefined"||Kt==="boolean")&&(Se=null);var rr=!1;if(Se===null)rr=!0;else switch(Kt){case"bigint":case"string":case"number":rr=!0;break;case"object":switch(Se.$$typeof){case o:case d:rr=!0;break;case X:return rr=Se._init,Rr(rr(Se._payload),_t,Ot,It,Et)}}if(rr)return Et=Et(Se),rr=It===""?"."+Ht(Se,0):It,vt(Et)?(Ot="",rr!=null&&(Ot=rr.replace(zt,"$&/")+"/"),Rr(Et,_t,Ot,"",function($r){return $r})):Et!=null&&(at(Et)&&(Et=ot(Et,Ot+(Et.key==null||Se&&Se.key===Et.key?"":(""+Et.key).replace(zt,"$&/")+"/")+rr)),_t.push(Et)),1;rr=0;var qr=It===""?".":It+":";if(vt(Se))for(var wr=0;wr<Se.length;wr++)It=Se[wr],Kt=qr+Ht(It,wr),rr+=Rr(It,_t,Ot,Kt,Et);else if(wr=re(Se),typeof wr=="function")for(Se=wr.call(Se),wr=0;!(It=Se.next()).done;)It=It.value,Kt=qr+Ht(It,wr++),rr+=Rr(It,_t,Ot,Kt,Et);else if(Kt==="object"){if(typeof Se.then=="function")return Rr(er(Se),_t,Ot,It,Et);throw _t=String(Se),Error("Objects are not valid as a React child (found: "+(_t==="[object Object]"?"object with keys {"+Object.keys(Se).join(", ")+"}":_t)+"). If you meant to render a collection of children, use an array instead.")}return rr}function Mt(Se,_t,Ot){if(Se==null)return Se;var It=[],Et=0;return Rr(Se,It,"","",function(Kt){return _t.call(Ot,Kt,Et++)}),It}function yt(Se){if(Se._status===-1){var _t=Se._result;_t=_t(),_t.then(function(Ot){(Se._status===0||Se._status===-1)&&(Se._status=1,Se._result=Ot)},function(Ot){(Se._status===0||Se._status===-1)&&(Se._status=2,Se._result=Ot)}),Se._status===-1&&(Se._status=0,Se._result=_t)}if(Se._status===1)return Se._result.default;throw Se._result}var Je=typeof reportError=="function"?reportError:function(Se){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Se=="object"&&Se!==null&&typeof Se.message=="string"?String(Se.message):String(Se),error:Se});if(!window.dispatchEvent(_t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Se);return}console.error(Se)};function Pt(){}return br.Children={map:Mt,forEach:function(Se,_t,Ot){Mt(Se,function(){_t.apply(this,arguments)},Ot)},count:function(Se){var _t=0;return Mt(Se,function(){_t++}),_t},toArray:function(Se){return Mt(Se,function(_t){return _t})||[]},only:function(Se){if(!at(Se))throw Error("React.Children.only expected to receive a single React element child.");return Se}},br.Component=Ee,br.Fragment=m,br.Profiler=C,br.PureComponent=Ie,br.StrictMode=x,br.Suspense=B,br.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=nt,br.act=function(){throw Error("act(...) is not supported in production builds of React.")},br.cache=function(Se){return function(){return Se.apply(null,arguments)}},br.cloneElement=function(Se,_t,Ot){if(Se==null)throw Error("The argument must be a React element, but you passed "+Se+".");var It=te({},Se.props),Et=Se.key,Kt=void 0;if(_t!=null)for(rr in _t.ref!==void 0&&(Kt=void 0),_t.key!==void 0&&(Et=""+_t.key),_t)!Ye.call(_t,rr)||rr==="key"||rr==="__self"||rr==="__source"||rr==="ref"&&_t.ref===void 0||(It[rr]=_t[rr]);var rr=arguments.length-2;if(rr===1)It.children=Ot;else if(1<rr){for(var qr=Array(rr),wr=0;wr<rr;wr++)qr[wr]=arguments[wr+2];It.children=qr}return st(Se.type,Et,void 0,void 0,Kt,It)},br.createContext=function(Se){return Se={$$typeof:E,_currentValue:Se,_currentValue2:Se,_threadCount:0,Provider:null,Consumer:null},Se.Provider=Se,Se.Consumer={$$typeof:k,_context:Se},Se},br.createElement=function(Se,_t,Ot){var It,Et={},Kt=null;if(_t!=null)for(It in _t.key!==void 0&&(Kt=""+_t.key),_t)Ye.call(_t,It)&&It!=="key"&&It!=="__self"&&It!=="__source"&&(Et[It]=_t[It]);var rr=arguments.length-2;if(rr===1)Et.children=Ot;else if(1<rr){for(var qr=Array(rr),wr=0;wr<rr;wr++)qr[wr]=arguments[wr+2];Et.children=qr}if(Se&&Se.defaultProps)for(It in rr=Se.defaultProps,rr)Et[It]===void 0&&(Et[It]=rr[It]);return st(Se,Kt,void 0,void 0,null,Et)},br.createRef=function(){return{current:null}},br.forwardRef=function(Se){return{$$typeof:l,render:Se}},br.isValidElement=at,br.lazy=function(Se){return{$$typeof:X,_payload:{_status:-1,_result:Se},_init:yt}},br.memo=function(Se,_t){return{$$typeof:V,type:Se,compare:_t===void 0?null:_t}},br.startTransition=function(Se){var _t=nt.T,Ot={};nt.T=Ot;try{var It=Se(),Et=nt.S;Et!==null&&Et(Ot,It),typeof It=="object"&&It!==null&&typeof It.then=="function"&&It.then(Pt,Je)}catch(Kt){Je(Kt)}finally{nt.T=_t}},br.unstable_useCacheRefresh=function(){return nt.H.useCacheRefresh()},br.use=function(Se){return nt.H.use(Se)},br.useActionState=function(Se,_t,Ot){return nt.H.useActionState(Se,_t,Ot)},br.useCallback=function(Se,_t){return nt.H.useCallback(Se,_t)},br.useContext=function(Se){return nt.H.useContext(Se)},br.useDebugValue=function(){},br.useDeferredValue=function(Se,_t){return nt.H.useDeferredValue(Se,_t)},br.useEffect=function(Se,_t){return nt.H.useEffect(Se,_t)},br.useId=function(){return nt.H.useId()},br.useImperativeHandle=function(Se,_t,Ot){return nt.H.useImperativeHandle(Se,_t,Ot)},br.useInsertionEffect=function(Se,_t){return nt.H.useInsertionEffect(Se,_t)},br.useLayoutEffect=function(Se,_t){return nt.H.useLayoutEffect(Se,_t)},br.useMemo=function(Se,_t){return nt.H.useMemo(Se,_t)},br.useOptimistic=function(Se,_t){return nt.H.useOptimistic(Se,_t)},br.useReducer=function(Se,_t,Ot){return nt.H.useReducer(Se,_t,Ot)},br.useRef=function(Se){return nt.H.useRef(Se)},br.useState=function(Se){return nt.H.useState(Se)},br.useSyncExternalStore=function(Se,_t,Ot){return nt.H.useSyncExternalStore(Se,_t,Ot)},br.useTransition=function(){return nt.H.useTransition()},br.version="19.0.0",br}var Ox;function tx(){return Ox||(Ox=1,j_.exports=M2()),j_.exports}var he=tx();const So=lf(he);var z_={exports:{}},Fm={},I_={exports:{}},R_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bx;function E2(){return Bx||(Bx=1,function(o){function d(Mt,yt){var Je=Mt.length;Mt.push(yt);e:for(;0<Je;){var Pt=Je-1>>>1,Se=Mt[Pt];if(0<C(Se,yt))Mt[Pt]=yt,Mt[Je]=Se,Je=Pt;else break e}}function m(Mt){return Mt.length===0?null:Mt[0]}function x(Mt){if(Mt.length===0)return null;var yt=Mt[0],Je=Mt.pop();if(Je!==yt){Mt[0]=Je;e:for(var Pt=0,Se=Mt.length,_t=Se>>>1;Pt<_t;){var Ot=2*(Pt+1)-1,It=Mt[Ot],Et=Ot+1,Kt=Mt[Et];if(0>C(It,Je))Et<Se&&0>C(Kt,It)?(Mt[Pt]=Kt,Mt[Et]=Je,Pt=Et):(Mt[Pt]=It,Mt[Ot]=Je,Pt=Ot);else if(Et<Se&&0>C(Kt,Je))Mt[Pt]=Kt,Mt[Et]=Je,Pt=Et;else break e}}return yt}function C(Mt,yt){var Je=Mt.sortIndex-yt.sortIndex;return Je!==0?Je:Mt.id-yt.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var k=performance;o.unstable_now=function(){return k.now()}}else{var E=Date,l=E.now();o.unstable_now=function(){return E.now()-l}}var B=[],V=[],X=1,ne=null,re=3,ee=!1,te=!1,be=!1,Ee=typeof setTimeout=="function"?setTimeout:null,Ae=typeof clearTimeout=="function"?clearTimeout:null,Ie=typeof setImmediate<"u"?setImmediate:null;function tt(Mt){for(var yt=m(V);yt!==null;){if(yt.callback===null)x(V);else if(yt.startTime<=Mt)x(V),yt.sortIndex=yt.expirationTime,d(B,yt);else break;yt=m(V)}}function vt(Mt){if(be=!1,tt(Mt),!te)if(m(B)!==null)te=!0,er();else{var yt=m(V);yt!==null&&Rr(vt,yt.startTime-Mt)}}var nt=!1,Ye=-1,st=5,ot=-1;function at(){return!(o.unstable_now()-ot<st)}function xt(){if(nt){var Mt=o.unstable_now();ot=Mt;var yt=!0;try{e:{te=!1,be&&(be=!1,Ae(Ye),Ye=-1),ee=!0;var Je=re;try{t:{for(tt(Mt),ne=m(B);ne!==null&&!(ne.expirationTime>Mt&&at());){var Pt=ne.callback;if(typeof Pt=="function"){ne.callback=null,re=ne.priorityLevel;var Se=Pt(ne.expirationTime<=Mt);if(Mt=o.unstable_now(),typeof Se=="function"){ne.callback=Se,tt(Mt),yt=!0;break t}ne===m(B)&&x(B),tt(Mt)}else x(B);ne=m(B)}if(ne!==null)yt=!0;else{var _t=m(V);_t!==null&&Rr(vt,_t.startTime-Mt),yt=!1}}break e}finally{ne=null,re=Je,ee=!1}yt=void 0}}finally{yt?zt():nt=!1}}}var zt;if(typeof Ie=="function")zt=function(){Ie(xt)};else if(typeof MessageChannel<"u"){var Ht=new MessageChannel,Yt=Ht.port2;Ht.port1.onmessage=xt,zt=function(){Yt.postMessage(null)}}else zt=function(){Ee(xt,0)};function er(){nt||(nt=!0,zt())}function Rr(Mt,yt){Ye=Ee(function(){Mt(o.unstable_now())},yt)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(Mt){Mt.callback=null},o.unstable_continueExecution=function(){te||ee||(te=!0,er())},o.unstable_forceFrameRate=function(Mt){0>Mt||125<Mt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):st=0<Mt?Math.floor(1e3/Mt):5},o.unstable_getCurrentPriorityLevel=function(){return re},o.unstable_getFirstCallbackNode=function(){return m(B)},o.unstable_next=function(Mt){switch(re){case 1:case 2:case 3:var yt=3;break;default:yt=re}var Je=re;re=yt;try{return Mt()}finally{re=Je}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(Mt,yt){switch(Mt){case 1:case 2:case 3:case 4:case 5:break;default:Mt=3}var Je=re;re=Mt;try{return yt()}finally{re=Je}},o.unstable_scheduleCallback=function(Mt,yt,Je){var Pt=o.unstable_now();switch(typeof Je=="object"&&Je!==null?(Je=Je.delay,Je=typeof Je=="number"&&0<Je?Pt+Je:Pt):Je=Pt,Mt){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=Je+Se,Mt={id:X++,callback:yt,priorityLevel:Mt,startTime:Je,expirationTime:Se,sortIndex:-1},Je>Pt?(Mt.sortIndex=Je,d(V,Mt),m(B)===null&&Mt===m(V)&&(be?(Ae(Ye),Ye=-1):be=!0,Rr(vt,Je-Pt))):(Mt.sortIndex=Se,d(B,Mt),te||ee||(te=!0,er())),Mt},o.unstable_shouldYield=at,o.unstable_wrapCallback=function(Mt){var yt=re;return function(){var Je=re;re=yt;try{return Mt.apply(this,arguments)}finally{re=Je}}}}(R_)),R_}var Fx;function C2(){return Fx||(Fx=1,I_.exports=E2()),I_.exports}var D_={exports:{}},En={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ux;function A2(){if(Ux)return En;Ux=1;var o=tx();function d(B){var V="https://react.dev/errors/"+B;if(1<arguments.length){V+="?args[]="+encodeURIComponent(arguments[1]);for(var X=2;X<arguments.length;X++)V+="&args[]="+encodeURIComponent(arguments[X])}return"Minified React error #"+B+"; visit "+V+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function m(){}var x={d:{f:m,r:function(){throw Error(d(522))},D:m,C:m,L:m,m,X:m,S:m,M:m},p:0,findDOMNode:null},C=Symbol.for("react.portal");function k(B,V,X){var ne=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:C,key:ne==null?null:""+ne,children:B,containerInfo:V,implementation:X}}var E=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(B,V){if(B==="font")return"";if(typeof V=="string")return V==="use-credentials"?V:""}return En.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=x,En.createPortal=function(B,V){var X=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!V||V.nodeType!==1&&V.nodeType!==9&&V.nodeType!==11)throw Error(d(299));return k(B,V,null,X)},En.flushSync=function(B){var V=E.T,X=x.p;try{if(E.T=null,x.p=2,B)return B()}finally{E.T=V,x.p=X,x.d.f()}},En.preconnect=function(B,V){typeof B=="string"&&(V?(V=V.crossOrigin,V=typeof V=="string"?V==="use-credentials"?V:"":void 0):V=null,x.d.C(B,V))},En.prefetchDNS=function(B){typeof B=="string"&&x.d.D(B)},En.preinit=function(B,V){if(typeof B=="string"&&V&&typeof V.as=="string"){var X=V.as,ne=l(X,V.crossOrigin),re=typeof V.integrity=="string"?V.integrity:void 0,ee=typeof V.fetchPriority=="string"?V.fetchPriority:void 0;X==="style"?x.d.S(B,typeof V.precedence=="string"?V.precedence:void 0,{crossOrigin:ne,integrity:re,fetchPriority:ee}):X==="script"&&x.d.X(B,{crossOrigin:ne,integrity:re,fetchPriority:ee,nonce:typeof V.nonce=="string"?V.nonce:void 0})}},En.preinitModule=function(B,V){if(typeof B=="string")if(typeof V=="object"&&V!==null){if(V.as==null||V.as==="script"){var X=l(V.as,V.crossOrigin);x.d.M(B,{crossOrigin:X,integrity:typeof V.integrity=="string"?V.integrity:void 0,nonce:typeof V.nonce=="string"?V.nonce:void 0})}}else V==null&&x.d.M(B)},En.preload=function(B,V){if(typeof B=="string"&&typeof V=="object"&&V!==null&&typeof V.as=="string"){var X=V.as,ne=l(X,V.crossOrigin);x.d.L(B,X,{crossOrigin:ne,integrity:typeof V.integrity=="string"?V.integrity:void 0,nonce:typeof V.nonce=="string"?V.nonce:void 0,type:typeof V.type=="string"?V.type:void 0,fetchPriority:typeof V.fetchPriority=="string"?V.fetchPriority:void 0,referrerPolicy:typeof V.referrerPolicy=="string"?V.referrerPolicy:void 0,imageSrcSet:typeof V.imageSrcSet=="string"?V.imageSrcSet:void 0,imageSizes:typeof V.imageSizes=="string"?V.imageSizes:void 0,media:typeof V.media=="string"?V.media:void 0})}},En.preloadModule=function(B,V){if(typeof B=="string")if(V){var X=l(V.as,V.crossOrigin);x.d.m(B,{as:typeof V.as=="string"&&V.as!=="script"?V.as:void 0,crossOrigin:X,integrity:typeof V.integrity=="string"?V.integrity:void 0})}else x.d.m(B)},En.requestFormReset=function(B){x.d.r(B)},En.unstable_batchedUpdates=function(B,V){return B(V)},En.useFormState=function(B,V,X){return E.H.useFormState(B,V,X)},En.useFormStatus=function(){return E.H.useHostTransitionStatus()},En.version="19.0.0",En}var Vx;function k2(){if(Vx)return D_.exports;Vx=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(d){console.error(d)}}return o(),D_.exports=A2(),D_.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qx;function P2(){if(qx)return Fm;qx=1;var o=C2(),d=tx(),m=k2();function x(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)s+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function C(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}var k=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),X=Symbol.for("react.profiler"),ne=Symbol.for("react.provider"),re=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),te=Symbol.for("react.forward_ref"),be=Symbol.for("react.suspense"),Ee=Symbol.for("react.suspense_list"),Ae=Symbol.for("react.memo"),Ie=Symbol.for("react.lazy"),tt=Symbol.for("react.offscreen"),vt=Symbol.for("react.memo_cache_sentinel"),nt=Symbol.iterator;function Ye(r){return r===null||typeof r!="object"?null:(r=nt&&r[nt]||r["@@iterator"],typeof r=="function"?r:null)}var st=Symbol.for("react.client.reference");function ot(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===st?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case B:return"Fragment";case l:return"Portal";case X:return"Profiler";case V:return"StrictMode";case be:return"Suspense";case Ee:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case ee:return(r.displayName||"Context")+".Provider";case re:return(r._context.displayName||"Context")+".Consumer";case te:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Ae:return s=r.displayName||null,s!==null?s:ot(r.type)||"Memo";case Ie:s=r._payload,r=r._init;try{return ot(r(s))}catch{}}return null}var at=d.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xt=Object.assign,zt,Ht;function Yt(r){if(zt===void 0)try{throw Error()}catch(h){var s=h.stack.trim().match(/\n( *(at )?)/);zt=s&&s[1]||"",Ht=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zt+r+Ht}var er=!1;function Rr(r,s){if(!r||er)return"";er=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(s){var bt=function(){throw Error()};if(Object.defineProperty(bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(bt,[])}catch(ct){var We=ct}Reflect.construct(r,[],bt)}else{try{bt.call()}catch(ct){We=ct}r.call(bt.prototype)}}else{try{throw Error()}catch(ct){We=ct}(bt=r())&&typeof bt.catch=="function"&&bt.catch(function(){})}}catch(ct){if(ct&&We&&typeof ct.stack=="string")return[ct.stack,We.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=y.DetermineComponentFrameRoot(),Z=z[0],ie=z[1];if(Z&&ie){var ge=Z.split(`
`),ze=ie.split(`
`);for(M=y=0;y<ge.length&&!ge[y].includes("DetermineComponentFrameRoot");)y++;for(;M<ze.length&&!ze[M].includes("DetermineComponentFrameRoot");)M++;if(y===ge.length||M===ze.length)for(y=ge.length-1,M=ze.length-1;1<=y&&0<=M&&ge[y]!==ze[M];)M--;for(;1<=y&&0<=M;y--,M--)if(ge[y]!==ze[M]){if(y!==1||M!==1)do if(y--,M--,0>M||ge[y]!==ze[M]){var lt=`
`+ge[y].replace(" at new "," at ");return r.displayName&&lt.includes("<anonymous>")&&(lt=lt.replace("<anonymous>",r.displayName)),lt}while(1<=y&&0<=M);break}}}finally{er=!1,Error.prepareStackTrace=h}return(h=r?r.displayName||r.name:"")?Yt(h):""}function Mt(r){switch(r.tag){case 26:case 27:case 5:return Yt(r.type);case 16:return Yt("Lazy");case 13:return Yt("Suspense");case 19:return Yt("SuspenseList");case 0:case 15:return r=Rr(r.type,!1),r;case 11:return r=Rr(r.type.render,!1),r;case 1:return r=Rr(r.type,!0),r;default:return""}}function yt(r){try{var s="";do s+=Mt(r),r=r.return;while(r);return s}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function Je(r){var s=r,h=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,s.flags&4098&&(h=s.return),r=s.return;while(r)}return s.tag===3?h:null}function Pt(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function Se(r){if(Je(r)!==r)throw Error(x(188))}function _t(r){var s=r.alternate;if(!s){if(s=Je(r),s===null)throw Error(x(188));return s!==r?null:r}for(var h=r,y=s;;){var M=h.return;if(M===null)break;var z=M.alternate;if(z===null){if(y=M.return,y!==null){h=y;continue}break}if(M.child===z.child){for(z=M.child;z;){if(z===h)return Se(M),r;if(z===y)return Se(M),s;z=z.sibling}throw Error(x(188))}if(h.return!==y.return)h=M,y=z;else{for(var Z=!1,ie=M.child;ie;){if(ie===h){Z=!0,h=M,y=z;break}if(ie===y){Z=!0,y=M,h=z;break}ie=ie.sibling}if(!Z){for(ie=z.child;ie;){if(ie===h){Z=!0,h=z,y=M;break}if(ie===y){Z=!0,y=z,h=M;break}ie=ie.sibling}if(!Z)throw Error(x(189))}}if(h.alternate!==y)throw Error(x(190))}if(h.tag!==3)throw Error(x(188));return h.stateNode.current===h?r:s}function Ot(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=Ot(r),s!==null)return s;r=r.sibling}return null}var It=Array.isArray,Et=m.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Kt={pending:!1,data:null,method:null,action:null},rr=[],qr=-1;function wr(r){return{current:r}}function $r(r){0>qr||(r.current=rr[qr],rr[qr]=null,qr--)}function Br(r,s){qr++,rr[qr]=r.current,r.current=s}var vi=wr(null),Hi=wr(null),hi=wr(null),Fr=wr(null);function $a(r,s){switch(Br(hi,s),Br(Hi,r),Br(vi,null),r=s.nodeType,r){case 9:case 11:s=(s=s.documentElement)&&(s=s.namespaceURI)?Cm(s):0;break;default:if(r=r===8?s.parentNode:s,s=r.tagName,r=r.namespaceURI)r=Cm(r),s=Am(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}$r(vi),Br(vi,s)}function Ga(){$r(vi),$r(Hi),$r(hi)}function za(r){r.memoizedState!==null&&Br(Fr,r);var s=vi.current,h=Am(s,r.type);s!==h&&(Br(Hi,r),Br(vi,h))}function Gs(r){Hi.current===r&&($r(vi),$r(Hi)),Fr.current===r&&($r(Fr),T._currentValue=Kt)}var Eo=Object.prototype.hasOwnProperty,Sa=o.unstable_scheduleCallback,ln=o.unstable_cancelCallback,Co=o.unstable_shouldYield,Ao=o.unstable_requestPaint,Ji=o.unstable_now,Dl=o.unstable_getCurrentPriorityLevel,ko=o.unstable_ImmediatePriority,Po=o.unstable_UserBlockingPriority,cn=o.unstable_NormalPriority,ws=o.unstable_LowPriority,Ss=o.unstable_IdlePriority,Nl=o.log,un=o.unstable_setDisableYieldValue,ea=null,Mi=null;function Re(r){if(Mi&&typeof Mi.onCommitFiberRoot=="function")try{Mi.onCommitFiberRoot(ea,r,void 0,(r.current.flags&128)===128)}catch{}}function Q(r){if(typeof Nl=="function"&&un(r),Mi&&typeof Mi.setStrictMode=="function")try{Mi.setStrictMode(ea,r)}catch{}}var J=Math.clz32?Math.clz32:Ce,le=Math.log,ye=Math.LN2;function Ce(r){return r>>>=0,r===0?32:31-(le(r)/ye|0)|0}var oe=128,Ue=4194304;function Pe(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Le(r,s){var h=r.pendingLanes;if(h===0)return 0;var y=0,M=r.suspendedLanes,z=r.pingedLanes,Z=r.warmLanes;r=r.finishedLanes!==0;var ie=h&134217727;return ie!==0?(h=ie&~M,h!==0?y=Pe(h):(z&=ie,z!==0?y=Pe(z):r||(Z=ie&~Z,Z!==0&&(y=Pe(Z))))):(ie=h&~M,ie!==0?y=Pe(ie):z!==0?y=Pe(z):r||(Z=h&~Z,Z!==0&&(y=Pe(Z)))),y===0?0:s!==0&&s!==y&&!(s&M)&&(M=y&-y,Z=s&-s,M>=Z||M===32&&(Z&4194176)!==0)?s:y}function Ze(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function Ne(r,s){switch(r){case 1:case 2:case 4:case 8:return s+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ht(){var r=oe;return oe<<=1,!(oe&4194176)&&(oe=128),r}function Tt(){var r=Ue;return Ue<<=1,!(Ue&62914560)&&(Ue=4194304),r}function Ct(r){for(var s=[],h=0;31>h;h++)s.push(r);return s}function Bt(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function ar(r,s,h,y,M,z){var Z=r.pendingLanes;r.pendingLanes=h,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=h,r.entangledLanes&=h,r.errorRecoveryDisabledLanes&=h,r.shellSuspendCounter=0;var ie=r.entanglements,ge=r.expirationTimes,ze=r.hiddenUpdates;for(h=Z&~h;0<h;){var lt=31-J(h),bt=1<<lt;ie[lt]=0,ge[lt]=-1;var We=ze[lt];if(We!==null)for(ze[lt]=null,lt=0;lt<We.length;lt++){var ct=We[lt];ct!==null&&(ct.lane&=-536870913)}h&=~bt}y!==0&&Xt(r,y,0),z!==0&&M===0&&r.tag!==0&&(r.suspendedLanes|=z&~(Z&~s))}function Xt(r,s,h){r.pendingLanes|=s,r.suspendedLanes&=~s;var y=31-J(s);r.entangledLanes|=s,r.entanglements[y]=r.entanglements[y]|1073741824|h&4194218}function Qe(r,s){var h=r.entangledLanes|=s;for(r=r.entanglements;h;){var y=31-J(h),M=1<<y;M&s|r[y]&s&&(r[y]|=s),h&=~M}}function jr(r){return r&=-r,2<r?8<r?r&134217727?32:268435456:8:2}function fr(){var r=Et.p;return r!==0?r:(r=window.event,r===void 0?32:_e(r.type))}function Ar(r,s){var h=Et.p;try{return Et.p=r,s()}finally{Et.p=h}}var Zt=Math.random().toString(36).slice(2),rt="__reactFiber$"+Zt,Rt="__reactProps$"+Zt,Qt="__reactContainer$"+Zt,ii="__reactEvents$"+Zt,xi="__reactListeners$"+Zt,Ia="__reactHandles$"+Zt,nr="__reactResources$"+Zt,Xn="__reactMarker$"+Zt;function jo(r){delete r[rt],delete r[Rt],delete r[ii],delete r[xi],delete r[Ia]}function Ha(r){var s=r[rt];if(s)return s;for(var h=r.parentNode;h;){if(s=h[Qt]||h[rt]){if(h=s.alternate,s.child!==null||h!==null&&h.child!==null)for(r=zm(r);r!==null;){if(h=r[rt])return h;r=zm(r)}return s}r=h,h=r.parentNode}return null}function Yn(r){if(r=r[rt]||r[Qt]){var s=r.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return r}return null}function Wa(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(x(33))}function hn(r){var s=r[nr];return s||(s=r[nr]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function _r(r){r[Xn]=!0}var Ra=new Set,Kr={};function An(r,s){kn(r,s),kn(r+"Capture",s)}function kn(r,s){for(Kr[r]=s,r=0;r<s.length;r++)Ra.add(s[r])}var Pn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Kn={},qh={};function Zh(r){return Eo.call(qh,r)?!0:Eo.call(Kn,r)?!1:zo.test(r)?qh[r]=!0:(Kn[r]=!0,!1)}function Rc(r,s,h){if(Zh(s))if(h===null)r.removeAttribute(s);else{switch(typeof h){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var y=s.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+h)}}function Ts(r,s,h){if(h===null)r.removeAttribute(s);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+h)}}function Qn(r,s,h,y){if(y===null)r.removeAttribute(h);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(h);return}r.setAttributeNS(s,h,""+y)}}function dn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function hf(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Vp(r){var s=hf(r)?"checked":"value",h=Object.getOwnPropertyDescriptor(r.constructor.prototype,s),y=""+r[s];if(!r.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var M=h.get,z=h.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return M.call(this)},set:function(Z){y=""+Z,z.call(this,Z)}}),Object.defineProperty(r,s,{enumerable:h.enumerable}),{getValue:function(){return y},setValue:function(Z){y=""+Z},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function Dc(r){r._valueTracker||(r._valueTracker=Vp(r))}function Du(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var h=s.getValue(),y="";return r&&(y=hf(r)?r.checked?"true":"false":r.value),r=y,r!==h?(s.setValue(r),!0):!1}function Jn(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var $h=/[\n"\\]/g;function Xa(r){return r.replace($h,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ms(r,s,h,y,M,z,Z,ie){r.name="",Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?r.type=Z:r.removeAttribute("type"),s!=null?Z==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+dn(s)):r.value!==""+dn(s)&&(r.value=""+dn(s)):Z!=="submit"&&Z!=="reset"||r.removeAttribute("value"),s!=null?Gh(r,Z,dn(s)):h!=null?Gh(r,Z,dn(h)):y!=null&&r.removeAttribute("value"),M==null&&z!=null&&(r.defaultChecked=!!z),M!=null&&(r.checked=M&&typeof M!="function"&&typeof M!="symbol"),ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"?r.name=""+dn(ie):r.removeAttribute("name")}function Nu(r,s,h,y,M,z,Z,ie){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(r.type=z),s!=null||h!=null){if(!(z!=="submit"&&z!=="reset"||s!=null))return;h=h!=null?""+dn(h):"",s=s!=null?""+dn(s):h,ie||s===r.value||(r.value=s),r.defaultValue=s}y=y??M,y=typeof y!="function"&&typeof y!="symbol"&&!!y,r.checked=ie?r.checked:!!y,r.defaultChecked=!!y,Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"&&(r.name=Z)}function Gh(r,s,h){s==="number"&&Jn(r.ownerDocument)===r||r.defaultValue===""+h||(r.defaultValue=""+h)}function es(r,s,h,y){if(r=r.options,s){s={};for(var M=0;M<h.length;M++)s["$"+h[M]]=!0;for(h=0;h<r.length;h++)M=s.hasOwnProperty("$"+r[h].value),r[h].selected!==M&&(r[h].selected=M),M&&y&&(r[h].defaultSelected=!0)}else{for(h=""+dn(h),s=null,M=0;M<r.length;M++){if(r[M].value===h){r[M].selected=!0,y&&(r[M].defaultSelected=!0);return}s!==null||r[M].disabled||(s=r[M])}s!==null&&(s.selected=!0)}}function Ll(r,s,h){if(s!=null&&(s=""+dn(s),s!==r.value&&(r.value=s),h==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=h!=null?""+dn(h):""}function Lu(r,s,h,y){if(s==null){if(y!=null){if(h!=null)throw Error(x(92));if(It(y)){if(1<y.length)throw Error(x(93));y=y[0]}h=y}h==null&&(h=""),s=h}h=dn(s),r.defaultValue=h,y=r.textContent,y===h&&y!==""&&y!==null&&(r.value=y)}function Ui(r,s){if(s){var h=r.firstChild;if(h&&h===r.lastChild&&h.nodeType===3){h.nodeValue=s;return}}r.textContent=s}var Sr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Io(r,s,h){var y=s.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?y?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":y?r.setProperty(s,h):typeof h!="number"||h===0||Sr.has(s)?s==="float"?r.cssFloat=h:r[s]=(""+h).trim():r[s]=h+"px"}function fa(r,s,h){if(s!=null&&typeof s!="object")throw Error(x(62));if(r=r.style,h!=null){for(var y in h)!h.hasOwnProperty(y)||s!=null&&s.hasOwnProperty(y)||(y.indexOf("--")===0?r.setProperty(y,""):y==="float"?r.cssFloat="":r[y]="");for(var M in s)y=s[M],s.hasOwnProperty(M)&&h[M]!==y&&Io(r,M,y)}else for(var z in s)s.hasOwnProperty(z)&&Io(r,z,s[z])}function Es(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Nc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Hs(r){return Nc.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var Ws=null;function pa(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Ei=null,Qr=null;function ta(r){var s=Yn(r);if(s&&(r=s.stateNode)){var h=r[Rt]||null;e:switch(r=s.stateNode,s.type){case"input":if(Ms(r,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),s=h.name,h.type==="radio"&&s!=null){for(h=r;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Xa(""+s)+'"][type="radio"]'),s=0;s<h.length;s++){var y=h[s];if(y!==r&&y.form===r.form){var M=y[Rt]||null;if(!M)throw Error(x(90));Ms(y,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(s=0;s<h.length;s++)y=h[s],y.form===r.form&&Du(y)}break e;case"textarea":Ll(r,h.value,h.defaultValue);break e;case"select":s=h.value,s!=null&&es(r,!!h.multiple,s,!1)}}}var Gr=!1;function Ro(r,s,h){if(Gr)return r(s,h);Gr=!0;try{var y=r(s);return y}finally{if(Gr=!1,(Ei!==null||Qr!==null)&&(Xf(),Ei&&(s=Ei,r=Qr,Qr=Ei=null,ta(s),r)))for(s=0;s<r.length;s++)ta(r[s])}}function Wi(r,s){var h=r.stateNode;if(h===null)return null;var y=h[Rt]||null;if(y===null)return null;h=y[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(r=r.type,y=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!y;break e;default:r=!1}if(r)return null;if(h&&typeof h!="function")throw Error(x(231,s,typeof h));return h}var Ta=!1;if(Pn)try{var ra={};Object.defineProperty(ra,"passive",{get:function(){Ta=!0}}),window.addEventListener("test",ra,ra),window.removeEventListener("test",ra,ra)}catch{Ta=!1}var fn=null,Dr=null,Jr=null;function pr(){if(Jr)return Jr;var r,s=Dr,h=s.length,y,M="value"in fn?fn.value:fn.textContent,z=M.length;for(r=0;r<h&&s[r]===M[r];r++);var Z=h-r;for(y=1;y<=Z&&s[h-y]===M[z-y];y++);return Jr=M.slice(r,1<y?1-y:void 0)}function Jt(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function Cs(){return!0}function sr(){return!1}function oa(r){function s(h,y,M,z,Z){this._reactName=h,this._targetInst=M,this.type=y,this.nativeEvent=z,this.target=Z,this.currentTarget=null;for(var ie in r)r.hasOwnProperty(ie)&&(h=r[ie],this[ie]=h?h(z):z[ie]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?Cs:sr,this.isPropagationStopped=sr,this}return xt(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Cs)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Cs)},persist:function(){},isPersistent:Cs}),s}var Ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ol=oa(Ci),Do=xt({},Ci,{view:0,detail:0}),Lc=oa(Do),Xs,No,Lo,Oo=xt({},Do,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qo,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Lo&&(Lo&&r.type==="mousemove"?(Xs=r.screenX-Lo.screenX,No=r.screenY-Lo.screenY):No=Xs=0,Lo=r),Xs)},movementY:function(r){return"movementY"in r?r.movementY:No}}),Bl=oa(Oo),Bo=xt({},Oo,{dataTransfer:0}),ia=oa(Bo),Fo=xt({},Do,{relatedTarget:0}),Uo=oa(Fo),Ys=xt({},Ci,{animationName:0,elapsedTime:0,pseudoElement:0}),aa=oa(Ys),Ou=xt({},Ci,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Bu=oa(Ou),df=xt({},Ci,{data:0}),ff=oa(df),ma={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Oc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ts={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vo(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=ts[r])?!!s[r]:!1}function qo(){return Vo}var pn=xt({},Do,{key:function(r){if(r.key){var s=ma[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=Jt(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Oc[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qo,charCode:function(r){return r.type==="keypress"?Jt(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Jt(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Zo=oa(pn),Fu=xt({},Oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pf=oa(Fu),Hh=xt({},Do,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qo}),qp=oa(Hh),Zp=xt({},Ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),$p=oa(Zp),Uu=xt({},Oo,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Fl=oa(Uu),Vu=xt({},Ci,{newState:0,oldState:0}),qu=oa(Vu),Zu=[9,13,27,32],mn=Pn&&"CompositionEvent"in window,Ul=null;Pn&&"documentMode"in document&&(Ul=document.documentMode);var Wh=Pn&&"TextEvent"in window&&!Ul,Vl=Pn&&(!mn||Ul&&8<Ul&&11>=Ul),ql=" ",mf=!1;function Bc(r,s){switch(r){case"keyup":return Zu.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xh(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var gn=!1;function gf(r,s){switch(r){case"compositionend":return Xh(s);case"keypress":return s.which!==32?null:(mf=!0,ql);case"textInput":return r=s.data,r===ql&&mf?null:r;default:return null}}function yf(r,s){if(gn)return r==="compositionend"||!mn&&Bc(r,s)?(r=pr(),Jr=Dr=fn=null,gn=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Vl&&s.locale!=="ko"?null:s.data;default:return null}}var Gp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yh(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!Gp[r.type]:s==="textarea"}function Zl(r,s,h,y){Ei?Qr?Qr.push(y):Qr=[y]:Ei=y,s=Bd(s,"onChange"),0<s.length&&(h=new Ol("onChange","change",null,h,y),r.push({event:h,listeners:s}))}var $l=null,Gl=null;function _f(r){wm(r,0)}function Hl(r){var s=Wa(r);if(Du(s))return r}function As(r,s){if(r==="change")return s}var Kh=!1;if(Pn){var $u;if(Pn){var Ks="oninput"in document;if(!Ks){var Qh=document.createElement("div");Qh.setAttribute("oninput","return;"),Ks=typeof Qh.oninput=="function"}$u=Ks}else $u=!1;Kh=$u&&(!document.documentMode||9<document.documentMode)}function Fc(){$l&&($l.detachEvent("onpropertychange",vf),Gl=$l=null)}function vf(r){if(r.propertyName==="value"&&Hl(Gl)){var s=[];Zl(s,Gl,r,pa(r)),Ro(_f,s)}}function Hp(r,s,h){r==="focusin"?(Fc(),$l=s,Gl=h,$l.attachEvent("onpropertychange",vf)):r==="focusout"&&Fc()}function Jh(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Hl(Gl)}function xf(r,s){if(r==="click")return Hl(s)}function bf(r,s){if(r==="input"||r==="change")return Hl(s)}function ed(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Da=typeof Object.is=="function"?Object.is:ed;function mr(r,s){if(Da(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var h=Object.keys(r),y=Object.keys(s);if(h.length!==y.length)return!1;for(y=0;y<h.length;y++){var M=h[y];if(!Eo.call(s,M)||!Da(r[M],s[M]))return!1}return!0}function rs(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Gu(r,s){var h=rs(r);r=0;for(var y;h;){if(h.nodeType===3){if(y=r+h.textContent.length,r<=s&&y>=s)return{node:h,offset:s-r};r=y}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=rs(h)}}function Hu(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?Hu(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function Wu(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=Jn(r.document);s instanceof r.HTMLIFrameElement;){try{var h=typeof s.contentWindow.location.href=="string"}catch{h=!1}if(h)r=s.contentWindow;else break;s=Jn(r.document)}return s}function Xu(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}function td(r,s){var h=Wu(s);s=r.focusedElem;var y=r.selectionRange;if(h!==s&&s&&s.ownerDocument&&Hu(s.ownerDocument.documentElement,s)){if(y!==null&&Xu(s)){if(r=y.start,h=y.end,h===void 0&&(h=r),"selectionStart"in s)s.selectionStart=r,s.selectionEnd=Math.min(h,s.value.length);else if(h=(r=s.ownerDocument||document)&&r.defaultView||window,h.getSelection){h=h.getSelection();var M=s.textContent.length,z=Math.min(y.start,M);y=y.end===void 0?z:Math.min(y.end,M),!h.extend&&z>y&&(M=y,y=z,z=M),M=Gu(s,z);var Z=Gu(s,y);M&&Z&&(h.rangeCount!==1||h.anchorNode!==M.node||h.anchorOffset!==M.offset||h.focusNode!==Z.node||h.focusOffset!==Z.offset)&&(r=r.createRange(),r.setStart(M.node,M.offset),h.removeAllRanges(),z>y?(h.addRange(r),h.extend(Z.node,Z.offset)):(r.setEnd(Z.node,Z.offset),h.addRange(r)))}}for(r=[],h=s;h=h.parentNode;)h.nodeType===1&&r.push({element:h,left:h.scrollLeft,top:h.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<r.length;s++)h=r[s],h.element.scrollLeft=h.left,h.element.scrollTop=h.top}}var $o=Pn&&"documentMode"in document&&11>=document.documentMode,Qs=null,rd=null,Uc=null,id=!1;function wf(r,s,h){var y=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;id||Qs==null||Qs!==Jn(y)||(y=Qs,"selectionStart"in y&&Xu(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Uc&&mr(Uc,y)||(Uc=y,y=Bd(rd,"onSelect"),0<y.length&&(s=new Ol("onSelect","select",null,s,h),r.push({event:s,listeners:y}),s.target=Qs)))}function Js(r,s){var h={};return h[r.toLowerCase()]=s.toLowerCase(),h["Webkit"+r]="webkit"+s,h["Moz"+r]="moz"+s,h}var Wl={animationend:Js("Animation","AnimationEnd"),animationiteration:Js("Animation","AnimationIteration"),animationstart:Js("Animation","AnimationStart"),transitionrun:Js("Transition","TransitionRun"),transitionstart:Js("Transition","TransitionStart"),transitioncancel:Js("Transition","TransitionCancel"),transitionend:Js("Transition","TransitionEnd")},Yu={},Vc={};Pn&&(Vc=document.createElement("div").style,"AnimationEvent"in window||(delete Wl.animationend.animation,delete Wl.animationiteration.animation,delete Wl.animationstart.animation),"TransitionEvent"in window||delete Wl.transitionend.transition);function is(r){if(Yu[r])return Yu[r];if(!Wl[r])return r;var s=Wl[r],h;for(h in s)if(s.hasOwnProperty(h)&&h in Vc)return Yu[r]=s[h];return r}var qc=is("animationend"),Ku=is("animationiteration"),eo=is("animationstart"),Qu=is("transitionrun"),Xl=is("transitionstart"),yn=is("transitioncancel"),ad=is("transitionend"),nd=new Map,Ju="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function la(r,s){nd.set(r,s),An(s,[r])}var Ma=[],ks=0,Go=0;function Ho(){for(var r=ks,s=Go=ks=0;s<r;){var h=Ma[s];Ma[s++]=null;var y=Ma[s];Ma[s++]=null;var M=Ma[s];Ma[s++]=null;var z=Ma[s];if(Ma[s++]=null,y!==null&&M!==null){var Z=y.pending;Z===null?M.next=M:(M.next=Z.next,Z.next=M),y.pending=M}z!==0&&sd(h,M,z)}}function Wo(r,s,h,y){Ma[ks++]=r,Ma[ks++]=s,Ma[ks++]=h,Ma[ks++]=y,Go|=y,r.lanes|=y,r=r.alternate,r!==null&&(r.lanes|=y)}function to(r,s,h,y){return Wo(r,s,h,y),Xo(r)}function Ya(r,s){return Wo(r,null,null,s),Xo(r)}function sd(r,s,h){r.lanes|=h;var y=r.alternate;y!==null&&(y.lanes|=h);for(var M=!1,z=r.return;z!==null;)z.childLanes|=h,y=z.alternate,y!==null&&(y.childLanes|=h),z.tag===22&&(r=z.stateNode,r===null||r._visibility&1||(M=!0)),r=z,z=z.return;M&&s!==null&&r.tag===3&&(z=r.stateNode,M=31-J(h),z=z.hiddenUpdates,r=z[M],r===null?z[M]=[s]:r.push(s),s.lane=h|536870912)}function Xo(r){if(50<du)throw du=0,Gf=null,Error(x(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var or={},Zc=new WeakMap;function Ea(r,s){if(typeof r=="object"&&r!==null){var h=Zc.get(r);return h!==void 0?h:(s={value:r,source:s,stack:yt(s)},Zc.set(r,s),s)}return{value:r,source:s,stack:yt(s)}}var ro=[],as=0,eh=null,th=0,Ka=[],_n=0,ns=null,Qa=1,vn="";function Ps(r,s){ro[as++]=th,ro[as++]=eh,eh=r,th=s}function $c(r,s,h){Ka[_n++]=Qa,Ka[_n++]=vn,Ka[_n++]=ns,ns=r;var y=Qa;r=vn;var M=32-J(y)-1;y&=~(1<<M),h+=1;var z=32-J(s)+M;if(30<z){var Z=M-M%5;z=(y&(1<<Z)-1).toString(32),y>>=Z,M-=Z,Qa=1<<32-J(s)+M|h<<M|y,vn=z+r}else Qa=1<<z|h<<M|y,vn=r}function Gc(r){r.return!==null&&(Ps(r,1),$c(r,1,0))}function Yo(r){for(;r===eh;)eh=ro[--as],ro[as]=null,th=ro[--as],ro[as]=null;for(;r===ns;)ns=Ka[--_n],Ka[_n]=null,vn=Ka[--_n],Ka[_n]=null,Qa=Ka[--_n],Ka[_n]=null}var Xi=null,Di=null,kr=!1,Ca=null,Ja=!1,rh=Error(x(519));function ss(r){var s=Error(x(418,""));throw ao(Ea(s,r)),rh}function ih(r){var s=r.stateNode,h=r.type,y=r.memoizedProps;switch(s[rt]=r,s[Rt]=y,h){case"dialog":zr("cancel",s),zr("close",s);break;case"iframe":case"object":case"embed":zr("load",s);break;case"video":case"audio":for(h=0;h<Ld.length;h++)zr(Ld[h],s);break;case"source":zr("error",s);break;case"img":case"image":case"link":zr("error",s),zr("load",s);break;case"details":zr("toggle",s);break;case"input":zr("invalid",s),Nu(s,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0),Dc(s);break;case"select":zr("invalid",s);break;case"textarea":zr("invalid",s),Lu(s,y.value,y.defaultValue,y.children),Dc(s)}h=y.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||s.textContent===""+h||y.suppressHydrationWarning===!0||Em(s.textContent,h)?(y.popover!=null&&(zr("beforetoggle",s),zr("toggle",s)),y.onScroll!=null&&zr("scroll",s),y.onScrollEnd!=null&&zr("scrollend",s),y.onClick!=null&&(s.onclick=mc),s=!0):s=!1,s||ss(r)}function od(r){for(Xi=r.return;Xi;)switch(Xi.tag){case 3:case 27:Ja=!0;return;case 5:case 13:Ja=!1;return;default:Xi=Xi.return}}function Yl(r){if(r!==Xi)return!1;if(!kr)return od(r),kr=!0,!1;var s=!1,h;if((h=r.tag!==3&&r.tag!==27)&&((h=r.tag===5)&&(h=r.type,h=!(h!=="form"&&h!=="button")||sp(r.type,r.memoizedProps)),h=!h),h&&(s=!0),s&&Di&&ss(r),od(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(x(317));e:{for(r=r.nextSibling,s=0;r;){if(r.nodeType===8)if(h=r.data,h==="/$"){if(s===0){Di=an(r.nextSibling);break e}s--}else h!=="$"&&h!=="$!"&&h!=="$?"||s++;r=r.nextSibling}Di=null}}else Di=Xi?an(r.stateNode.nextSibling):null;return!0}function io(){Di=Xi=null,kr=!1}function ao(r){Ca===null?Ca=[r]:Ca.push(r)}var Kl=Error(x(460)),Ql=Error(x(474)),di={then:function(){}};function js(r){return r=r.status,r==="fulfilled"||r==="rejected"}function ga(){}function ah(r,s,h){switch(h=r[h],h===void 0?r.push(s):h!==s&&(s.then(ga,ga),s=h),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,r===Kl?Error(x(483)):r;default:if(typeof s.status=="string")s.then(ga,ga);else{if(r=gi,r!==null&&100<r.shellSuspendCounter)throw Error(x(482));r=s,r.status="pending",r.then(function(y){if(s.status==="pending"){var M=s;M.status="fulfilled",M.value=y}},function(y){if(s.status==="pending"){var M=s;M.status="rejected",M.reason=y}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,r===Kl?Error(x(483)):r}throw zs=s,Kl}}var zs=null;function nh(){if(zs===null)throw Error(x(459));var r=zs;return zs=null,r}var Aa=null,Ko=0;function no(r){var s=Ko;return Ko+=1,Aa===null&&(Aa=[]),ah(Aa,r,s)}function Qo(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function Hc(r,s){throw s.$$typeof===k?Error(x(525)):(r=Object.prototype.toString.call(s),Error(x(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function ld(r){var s=r._init;return s(r._payload)}function cd(r){function s(Oe,je){if(r){var $e=Oe.deletions;$e===null?(Oe.deletions=[je],Oe.flags|=16):$e.push(je)}}function h(Oe,je){if(!r)return null;for(;je!==null;)s(Oe,je),je=je.sibling;return null}function y(Oe){for(var je=new Map;Oe!==null;)Oe.key!==null?je.set(Oe.key,Oe):je.set(Oe.index,Oe),Oe=Oe.sibling;return je}function M(Oe,je){return Oe=yo(Oe,je),Oe.index=0,Oe.sibling=null,Oe}function z(Oe,je,$e){return Oe.index=$e,r?($e=Oe.alternate,$e!==null?($e=$e.index,$e<je?(Oe.flags|=33554434,je):$e):(Oe.flags|=33554434,je)):(Oe.flags|=1048576,je)}function Z(Oe){return r&&Oe.alternate===null&&(Oe.flags|=33554434),Oe}function ie(Oe,je,$e,pt){return je===null||je.tag!==6?(je=xh($e,Oe.mode,pt),je.return=Oe,je):(je=M(je,$e),je.return=Oe,je)}function ge(Oe,je,$e,pt){var Ft=$e.type;return Ft===B?lt(Oe,je,$e.props.children,pt,$e.key):je!==null&&(je.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===Ie&&ld(Ft)===je.type)?(je=M(je,$e.props),Qo(je,$e),je.return=Oe,je):(je=vh($e.type,$e.key,$e.props,null,Oe.mode,pt),Qo(je,$e),je.return=Oe,je)}function ze(Oe,je,$e,pt){return je===null||je.tag!==4||je.stateNode.containerInfo!==$e.containerInfo||je.stateNode.implementation!==$e.implementation?(je=Ff($e,Oe.mode,pt),je.return=Oe,je):(je=M(je,$e.children||[]),je.return=Oe,je)}function lt(Oe,je,$e,pt,Ft){return je===null||je.tag!==7?(je=uc($e,Oe.mode,pt,Ft),je.return=Oe,je):(je=M(je,$e),je.return=Oe,je)}function bt(Oe,je,$e){if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return je=xh(""+je,Oe.mode,$e),je.return=Oe,je;if(typeof je=="object"&&je!==null){switch(je.$$typeof){case E:return $e=vh(je.type,je.key,je.props,null,Oe.mode,$e),Qo($e,je),$e.return=Oe,$e;case l:return je=Ff(je,Oe.mode,$e),je.return=Oe,je;case Ie:var pt=je._init;return je=pt(je._payload),bt(Oe,je,$e)}if(It(je)||Ye(je))return je=uc(je,Oe.mode,$e,null),je.return=Oe,je;if(typeof je.then=="function")return bt(Oe,no(je),$e);if(je.$$typeof===ee)return bt(Oe,vd(Oe,je),$e);Hc(Oe,je)}return null}function We(Oe,je,$e,pt){var Ft=je!==null?je.key:null;if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return Ft!==null?null:ie(Oe,je,""+$e,pt);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case E:return $e.key===Ft?ge(Oe,je,$e,pt):null;case l:return $e.key===Ft?ze(Oe,je,$e,pt):null;case Ie:return Ft=$e._init,$e=Ft($e._payload),We(Oe,je,$e,pt)}if(It($e)||Ye($e))return Ft!==null?null:lt(Oe,je,$e,pt,null);if(typeof $e.then=="function")return We(Oe,je,no($e),pt);if($e.$$typeof===ee)return We(Oe,je,vd(Oe,$e),pt);Hc(Oe,$e)}return null}function ct(Oe,je,$e,pt,Ft){if(typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint")return Oe=Oe.get($e)||null,ie(je,Oe,""+pt,Ft);if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case E:return Oe=Oe.get(pt.key===null?$e:pt.key)||null,ge(je,Oe,pt,Ft);case l:return Oe=Oe.get(pt.key===null?$e:pt.key)||null,ze(je,Oe,pt,Ft);case Ie:var xr=pt._init;return pt=xr(pt._payload),ct(Oe,je,$e,pt,Ft)}if(It(pt)||Ye(pt))return Oe=Oe.get($e)||null,lt(je,Oe,pt,Ft,null);if(typeof pt.then=="function")return ct(Oe,je,$e,no(pt),Ft);if(pt.$$typeof===ee)return ct(Oe,je,$e,vd(je,pt),Ft);Hc(je,pt)}return null}function Vt(Oe,je,$e,pt){for(var Ft=null,xr=null,qt=je,tr=je=0,da=null;qt!==null&&tr<$e.length;tr++){qt.index>tr?(da=qt,qt=null):da=qt.sibling;var Vr=We(Oe,qt,$e[tr],pt);if(Vr===null){qt===null&&(qt=da);break}r&&qt&&Vr.alternate===null&&s(Oe,qt),je=z(Vr,je,tr),xr===null?Ft=Vr:xr.sibling=Vr,xr=Vr,qt=da}if(tr===$e.length)return h(Oe,qt),kr&&Ps(Oe,tr),Ft;if(qt===null){for(;tr<$e.length;tr++)qt=bt(Oe,$e[tr],pt),qt!==null&&(je=z(qt,je,tr),xr===null?Ft=qt:xr.sibling=qt,xr=qt);return kr&&Ps(Oe,tr),Ft}for(qt=y(qt);tr<$e.length;tr++)da=ct(qt,Oe,tr,$e[tr],pt),da!==null&&(r&&da.alternate!==null&&qt.delete(da.key===null?tr:da.key),je=z(da,je,tr),xr===null?Ft=da:xr.sibling=da,xr=da);return r&&qt.forEach(function(xc){return s(Oe,xc)}),kr&&Ps(Oe,tr),Ft}function ir(Oe,je,$e,pt){if($e==null)throw Error(x(151));for(var Ft=null,xr=null,qt=je,tr=je=0,da=null,Vr=$e.next();qt!==null&&!Vr.done;tr++,Vr=$e.next()){qt.index>tr?(da=qt,qt=null):da=qt.sibling;var xc=We(Oe,qt,Vr.value,pt);if(xc===null){qt===null&&(qt=da);break}r&&qt&&xc.alternate===null&&s(Oe,qt),je=z(xc,je,tr),xr===null?Ft=xc:xr.sibling=xc,xr=xc,qt=da}if(Vr.done)return h(Oe,qt),kr&&Ps(Oe,tr),Ft;if(qt===null){for(;!Vr.done;tr++,Vr=$e.next())Vr=bt(Oe,Vr.value,pt),Vr!==null&&(je=z(Vr,je,tr),xr===null?Ft=Vr:xr.sibling=Vr,xr=Vr);return kr&&Ps(Oe,tr),Ft}for(qt=y(qt);!Vr.done;tr++,Vr=$e.next())Vr=ct(qt,Oe,tr,Vr.value,pt),Vr!==null&&(r&&Vr.alternate!==null&&qt.delete(Vr.key===null?tr:Vr.key),je=z(Vr,je,tr),xr===null?Ft=Vr:xr.sibling=Vr,xr=Vr);return r&&qt.forEach(function(k_){return s(Oe,k_)}),kr&&Ps(Oe,tr),Ft}function ci(Oe,je,$e,pt){if(typeof $e=="object"&&$e!==null&&$e.type===B&&$e.key===null&&($e=$e.props.children),typeof $e=="object"&&$e!==null){switch($e.$$typeof){case E:e:{for(var Ft=$e.key;je!==null;){if(je.key===Ft){if(Ft=$e.type,Ft===B){if(je.tag===7){h(Oe,je.sibling),pt=M(je,$e.props.children),pt.return=Oe,Oe=pt;break e}}else if(je.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===Ie&&ld(Ft)===je.type){h(Oe,je.sibling),pt=M(je,$e.props),Qo(pt,$e),pt.return=Oe,Oe=pt;break e}h(Oe,je);break}else s(Oe,je);je=je.sibling}$e.type===B?(pt=uc($e.props.children,Oe.mode,pt,$e.key),pt.return=Oe,Oe=pt):(pt=vh($e.type,$e.key,$e.props,null,Oe.mode,pt),Qo(pt,$e),pt.return=Oe,Oe=pt)}return Z(Oe);case l:e:{for(Ft=$e.key;je!==null;){if(je.key===Ft)if(je.tag===4&&je.stateNode.containerInfo===$e.containerInfo&&je.stateNode.implementation===$e.implementation){h(Oe,je.sibling),pt=M(je,$e.children||[]),pt.return=Oe,Oe=pt;break e}else{h(Oe,je);break}else s(Oe,je);je=je.sibling}pt=Ff($e,Oe.mode,pt),pt.return=Oe,Oe=pt}return Z(Oe);case Ie:return Ft=$e._init,$e=Ft($e._payload),ci(Oe,je,$e,pt)}if(It($e))return Vt(Oe,je,$e,pt);if(Ye($e)){if(Ft=Ye($e),typeof Ft!="function")throw Error(x(150));return $e=Ft.call($e),ir(Oe,je,$e,pt)}if(typeof $e.then=="function")return ci(Oe,je,no($e),pt);if($e.$$typeof===ee)return ci(Oe,je,vd(Oe,$e),pt);Hc(Oe,$e)}return typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint"?($e=""+$e,je!==null&&je.tag===6?(h(Oe,je.sibling),pt=M(je,$e),pt.return=Oe,Oe=pt):(h(Oe,je),pt=xh($e,Oe.mode,pt),pt.return=Oe,Oe=pt),Z(Oe)):h(Oe,je)}return function(Oe,je,$e,pt){try{Ko=0;var Ft=ci(Oe,je,$e,pt);return Aa=null,Ft}catch(qt){if(qt===Kl)throw qt;var xr=Mn(29,qt,null,Oe.mode);return xr.lanes=pt,xr.return=Oe,xr}finally{}}}var xn=cd(!0),Jo=cd(!1),fi=wr(null),Is=wr(0);function sh(r,s){r=vl,Br(Is,r),Br(fi,s),vl=r|s.baseLanes}function oh(){Br(Is,vl),Br(fi,fi.current)}function lh(){vl=Is.current,$r(fi),$r(Is)}var ca=wr(null),bn=null;function jn(r){var s=r.alternate;Br(Pr,Pr.current&1),Br(ca,r),bn===null&&(s===null||fi.current!==null||s.memoizedState!==null)&&(bn=r)}function ud(r){if(r.tag===22){if(Br(Pr,Pr.current),Br(ca,r),bn===null){var s=r.alternate;s!==null&&s.memoizedState!==null&&(bn=r)}}else en()}function en(){Br(Pr,Pr.current),Br(ca,ca.current)}function os(r){$r(ca),bn===r&&(bn=null),$r(Pr)}var Pr=wr(0);function Na(r){for(var s=r;s!==null;){if(s.tag===13){var h=s.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Jl=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(h,y){r.push(y)}};this.abort=function(){s.aborted=!0,r.forEach(function(h){return h()})}},zn=o.unstable_scheduleCallback,ec=o.unstable_NormalPriority,Ai={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function hd(){return{controller:new Jl,data:new Map,refCount:0}}function el(r){r.refCount--,r.refCount===0&&zn(ec,function(){r.controller.abort()})}var so=null,Wc=0,In=0,ka=null;function kt(r,s){if(so===null){var h=so=[];Wc=0,In=Dd(),ka={status:"pending",value:void 0,then:function(y){h.push(y)}}}return Wc++,s.then(Xc,Xc),s}function Xc(){if(--Wc===0&&so!==null){ka!==null&&(ka.status="fulfilled");var r=so;so=null,In=0,ka=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function ch(r,s){var h=[],y={status:"pending",value:null,reason:null,then:function(M){h.push(M)}};return r.then(function(){y.status="fulfilled",y.value=s;for(var M=0;M<h.length;M++)(0,h[M])(s)},function(M){for(y.status="rejected",y.reason=M,M=0;M<h.length;M++)(0,h[M])(void 0)}),y}var dd=at.S;at.S=function(r,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&kt(r,s),dd!==null&&dd(r,s)};var wn=wr(null);function tl(){var r=wn.current;return r!==null?r:gi.pooledCache}function tc(r,s){s===null?Br(wn,wn.current):Br(wn,s.pool)}function dr(){var r=tl();return r===null?null:{parent:Ai._currentValue,pool:r}}var Rn=0,gr=null,Ur=null,Ni=null,Yc=!1,oo=!1,ls=!1,lo=0,Kc=0,Rs=null,Wp=0;function Li(){throw Error(x(321))}function Dn(r,s){if(s===null)return!1;for(var h=0;h<s.length&&h<r.length;h++)if(!Da(r[h],s[h]))return!1;return!0}function Hr(r,s,h,y,M,z){return Rn=z,gr=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,at.H=r===null||r.memoizedState===null?yr:ti,ls=!1,z=h(y,M),ls=!1,oo&&(z=uh(s,h,y,M)),rc(r),z}function rc(r){at.H=Tr;var s=Ur!==null&&Ur.next!==null;if(Rn=0,Ni=Ur=gr=null,Yc=!1,Kc=0,Rs=null,s)throw Error(x(300));r===null||cr||(r=r.dependencies,r!==null&&iu(r)&&(cr=!0))}function uh(r,s,h,y){gr=r;var M=0;do{if(oo&&(Rs=null),Kc=0,oo=!1,25<=M)throw Error(x(301));if(M+=1,Ni=Ur=null,r.updateQueue!=null){var z=r.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}at.H=mi,z=s(h,y)}while(oo);return z}function Sf(){var r=at.H,s=r.useState()[0];return s=typeof s.then=="function"?$t(s):s,r=r.useState()[0],(Ur!==null?Ur.memoizedState:null)!==r&&(gr.flags|=1024),s}function hh(){var r=lo!==0;return lo=0,r}function dh(r,s,h){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~h}function fd(r){if(Yc){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Yc=!1}Rn=0,Ni=Ur=gr=null,oo=!1,Kc=lo=0,Rs=null}function Wr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ni===null?gr.memoizedState=Ni=r:Ni=Ni.next=r,Ni}function bi(){if(Ur===null){var r=gr.alternate;r=r!==null?r.memoizedState:null}else r=Ur.next;var s=Ni===null?gr.memoizedState:Ni.next;if(s!==null)Ni=s,Ur=r;else{if(r===null)throw gr.alternate===null?Error(x(467)):Error(x(310));Ur=r,r={memoizedState:Ur.memoizedState,baseState:Ur.baseState,baseQueue:Ur.baseQueue,queue:Ur.queue,next:null},Ni===null?gr.memoizedState=Ni=r:Ni=Ni.next=r}return Ni}var Dt;Dt=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function $t(r){var s=Kc;return Kc+=1,Rs===null&&(Rs=[]),r=ah(Rs,r,s),s=gr,(Ni===null?s.memoizedState:Ni.next)===null&&(s=s.alternate,at.H=s===null||s.memoizedState===null?yr:ti),r}function co(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return $t(r);if(r.$$typeof===ee)return Pa(r)}throw Error(x(438,String(r)))}function Qc(r){var s=null,h=gr.updateQueue;if(h!==null&&(s=h.memoCache),s==null){var y=gr.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(s={data:y.data.map(function(M){return M.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),h===null&&(h=Dt(),gr.updateQueue=h),h.memoCache=s,h=s.data[s.index],h===void 0)for(h=s.data[s.index]=Array(r),y=0;y<r;y++)h[y]=vt;return s.index++,h}function Nn(r,s){return typeof s=="function"?s(r):s}function wi(r){var s=bi();return Jc(s,Ur,r)}function Jc(r,s,h){var y=r.queue;if(y===null)throw Error(x(311));y.lastRenderedReducer=h;var M=r.baseQueue,z=y.pending;if(z!==null){if(M!==null){var Z=M.next;M.next=z.next,z.next=Z}s.baseQueue=M=z,y.pending=null}if(z=r.baseState,M===null)r.memoizedState=z;else{s=M.next;var ie=Z=null,ge=null,ze=s,lt=!1;do{var bt=ze.lane&-536870913;if(bt!==ze.lane?(Mr&bt)===bt:(Rn&bt)===bt){var We=ze.revertLane;if(We===0)ge!==null&&(ge=ge.next={lane:0,revertLane:0,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null}),bt===In&&(lt=!0);else if((Rn&We)===We){ze=ze.next,We===In&&(lt=!0);continue}else bt={lane:0,revertLane:ze.revertLane,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},ge===null?(ie=ge=bt,Z=z):ge=ge.next=bt,gr.lanes|=We,xl|=We;bt=ze.action,ls&&h(z,bt),z=ze.hasEagerState?ze.eagerState:h(z,bt)}else We={lane:bt,revertLane:ze.revertLane,action:ze.action,hasEagerState:ze.hasEagerState,eagerState:ze.eagerState,next:null},ge===null?(ie=ge=We,Z=z):ge=ge.next=We,gr.lanes|=bt,xl|=bt;ze=ze.next}while(ze!==null&&ze!==s);if(ge===null?Z=z:ge.next=ie,!Da(z,r.memoizedState)&&(cr=!0,lt&&(h=ka,h!==null)))throw h;r.memoizedState=z,r.baseState=Z,r.baseQueue=ge,y.lastRenderedState=z}return M===null&&(y.lanes=0),[r.memoizedState,y.dispatch]}function La(r){var s=bi(),h=s.queue;if(h===null)throw Error(x(311));h.lastRenderedReducer=r;var y=h.dispatch,M=h.pending,z=s.memoizedState;if(M!==null){h.pending=null;var Z=M=M.next;do z=r(z,Z.action),Z=Z.next;while(Z!==M);Da(z,s.memoizedState)||(cr=!0),s.memoizedState=z,s.baseQueue===null&&(s.baseState=z),h.lastRenderedState=z}return[z,y]}function pd(r,s,h){var y=gr,M=bi(),z=kr;if(z){if(h===void 0)throw Error(x(407));h=h()}else h=s();var Z=!Da((Ur||M).memoizedState,h);if(Z&&(M.memoizedState=h,cr=!0),M=M.queue,W(ai.bind(null,y,M,r),[r]),M.getSnapshot!==s||Z||Ni!==null&&Ni.memoizedState.tag&1){if(y.flags|=2048,j(9,pi.bind(null,y,M,h,s),{destroy:void 0},null),gi===null)throw Error(x(349));z||Rn&60||uo(y,s,h)}return h}function uo(r,s,h){r.flags|=16384,r={getSnapshot:s,value:h},s=gr.updateQueue,s===null?(s=Dt(),gr.updateQueue=s,s.stores=[r]):(h=s.stores,h===null?s.stores=[r]:h.push(r))}function pi(r,s,h,y){s.value=h,s.getSnapshot=y,rl(s)&&ic(r)}function ai(r,s,h){return h(function(){rl(s)&&ic(r)})}function rl(r){var s=r.getSnapshot;r=r.value;try{var h=s();return!Da(r,h)}catch{return!0}}function ic(r){var s=Ya(r,2);s!==null&&rn(s,r,2)}function il(r){var s=Wr();if(typeof r=="function"){var h=r;if(r=h(),ls){Q(!0);try{h()}finally{Q(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nn,lastRenderedState:r},s}function ho(r,s,h,y){return r.baseState=h,Jc(r,Ur,typeof y=="function"?y:Nn)}function md(r,s,h,y,M){if(Nr(r))throw Error(x(485));if(r=s.action,r!==null){var z={payload:M,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Z){z.listeners.push(Z)}};at.T!==null?h(!0):z.isTransition=!1,y(z),h=s.pending,h===null?(z.next=s.pending=z,fh(s,z)):(z.next=h.next,s.pending=h.next=z)}}function fh(r,s){var h=s.action,y=s.payload,M=r.state;if(s.isTransition){var z=at.T,Z={};at.T=Z;try{var ie=h(M,y),ge=at.S;ge!==null&&ge(Z,ie),al(r,s,ie)}catch(ze){g(r,s,ze)}finally{at.T=z}}else try{z=h(M,y),al(r,s,z)}catch(ze){g(r,s,ze)}}function al(r,s,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(y){ph(r,s,y)},function(y){return g(r,s,y)}):ph(r,s,h)}function ph(r,s,h){s.status="fulfilled",s.value=h,e(s),r.state=h,s=r.pending,s!==null&&(h=s.next,h===s?r.pending=null:(h=h.next,s.next=h,fh(r,h)))}function g(r,s,h){var y=r.pending;if(r.pending=null,y!==null){y=y.next;do s.status="rejected",s.reason=h,e(s),s=s.next;while(s!==y)}r.action=null}function e(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function i(r,s){return s}function u(r,s){if(kr){var h=gi.formState;if(h!==null){e:{var y=gr;if(kr){if(Di){t:{for(var M=Di,z=Ja;M.nodeType!==8;){if(!z){M=null;break t}if(M=an(M.nextSibling),M===null){M=null;break t}}z=M.data,M=z==="F!"||z==="F"?M:null}if(M){Di=an(M.nextSibling),y=M.data==="F!";break e}}ss(y)}y=!1}y&&(s=h[0])}}return h=Wr(),h.memoizedState=h.baseState=s,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:s},h.queue=y,h=lr.bind(null,gr,y),y.dispatch=h,y=il(!1),z=ei.bind(null,gr,!1,y.queue),y=Wr(),M={state:s,dispatch:null,action:r,pending:null},y.queue=M,h=md.bind(null,gr,M,z,h),M.dispatch=h,y.memoizedState=r,[s,h,!1]}function f(r){var s=bi();return _(s,Ur,r)}function _(r,s,h){s=Jc(r,s,i)[0],r=wi(Nn)[0],s=typeof s=="object"&&s!==null&&typeof s.then=="function"?$t(s):s;var y=bi(),M=y.queue,z=M.dispatch;return h!==y.memoizedState&&(gr.flags|=2048,j(9,S.bind(null,M,h),{destroy:void 0},null)),[s,z,r]}function S(r,s){r.action=s}function A(r){var s=bi(),h=Ur;if(h!==null)return _(s,h,r);bi(),s=s.memoizedState,h=bi();var y=h.queue.dispatch;return h.memoizedState=r,[s,y,!1]}function j(r,s,h,y){return r={tag:r,create:s,inst:h,deps:y,next:null},s=gr.updateQueue,s===null&&(s=Dt(),gr.updateQueue=s),h=s.lastEffect,h===null?s.lastEffect=r.next=r:(y=h.next,h.next=r,r.next=y,s.lastEffect=r),r}function R(){return bi().memoizedState}function N(r,s,h,y){var M=Wr();gr.flags|=r,M.memoizedState=j(1|s,h,{destroy:void 0},y===void 0?null:y)}function F(r,s,h,y){var M=bi();y=y===void 0?null:y;var z=M.memoizedState.inst;Ur!==null&&y!==null&&Dn(y,Ur.memoizedState.deps)?M.memoizedState=j(s,h,z,y):(gr.flags|=r,M.memoizedState=j(1|s,h,z,y))}function U(r,s){N(8390656,8,r,s)}function W(r,s){F(2048,8,r,s)}function Y(r,s){return F(4,2,r,s)}function ue(r,s){return F(4,4,r,s)}function ce(r,s){if(typeof s=="function"){r=r();var h=s(r);return function(){typeof h=="function"?h():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function de(r,s,h){h=h!=null?h.concat([r]):null,F(4,4,ce.bind(null,s,r),h)}function pe(){}function xe(r,s){var h=bi();s=s===void 0?null:s;var y=h.memoizedState;return s!==null&&Dn(s,y[1])?y[0]:(h.memoizedState=[r,s],r)}function ve(r,s){var h=bi();s=s===void 0?null:s;var y=h.memoizedState;if(s!==null&&Dn(s,y[1]))return y[0];if(y=r(),ls){Q(!0);try{r()}finally{Q(!1)}}return h.memoizedState=[y,s],y}function we(r,s,h){return h===void 0||Rn&1073741824?r.memoizedState=s:(r.memoizedState=h,r=Hf(),gr.lanes|=r,xl|=r,h)}function ke(r,s,h,y){return Da(h,s)?h:fi.current!==null?(r=we(r,h,y),Da(r,s)||(cr=!0),r):Rn&42?(r=Hf(),gr.lanes|=r,xl|=r,s):(cr=!0,r.memoizedState=h)}function Te(r,s,h,y,M){var z=Et.p;Et.p=z!==0&&8>z?z:8;var Z=at.T,ie={};at.T=ie,ei(r,!1,s,h);try{var ge=M(),ze=at.S;if(ze!==null&&ze(ie,ge),ge!==null&&typeof ge=="object"&&typeof ge.then=="function"){var lt=ch(ge,y);ur(r,s,lt,Lr(r))}else ur(r,s,y,Lr(r))}catch(bt){ur(r,s,{then:function(){},status:"rejected",reason:bt},Lr())}finally{Et.p=z,at.T=Z}}function Ve(){}function et(r,s,h,y){if(r.tag!==5)throw Error(x(476));var M=Ge(r).queue;Te(r,M,s,Kt,h===null?Ve:function(){return He(r),h(y)})}function Ge(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:Kt,baseState:Kt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nn,lastRenderedState:Kt},next:null};var h={};return s.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nn,lastRenderedState:h},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function He(r){var s=Ge(r).next.queue;ur(r,s,{},Lr())}function Ke(){return Pa(T)}function St(){return bi().memoizedState}function wt(){return bi().memoizedState}function ft(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var h=Lr();r=ul(h);var y=oc(s,r,h);y!==null&&(rn(y,s,h),au(y,s,h)),s={cache:hd()},r.payload=s;return}s=s.return}}function Lt(r,s,h){var y=Lr();h={lane:y,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},Nr(r)?ni(s,h):(h=to(r,s,h,y),h!==null&&(rn(h,r,y),si(h,s,y)))}function lr(r,s,h){var y=Lr();ur(r,s,h,y)}function ur(r,s,h,y){var M={lane:y,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(Nr(r))ni(s,M);else{var z=r.alternate;if(r.lanes===0&&(z===null||z.lanes===0)&&(z=s.lastRenderedReducer,z!==null))try{var Z=s.lastRenderedState,ie=z(Z,h);if(M.hasEagerState=!0,M.eagerState=ie,Da(ie,Z))return Wo(r,s,M,0),gi===null&&Ho(),!1}catch{}finally{}if(h=to(r,s,M,y),h!==null)return rn(h,r,y),si(h,s,y),!0}return!1}function ei(r,s,h,y){if(y={lane:2,revertLane:Dd(),action:y,hasEagerState:!1,eagerState:null,next:null},Nr(r)){if(s)throw Error(x(479))}else s=to(r,h,y,2),s!==null&&rn(s,r,2)}function Nr(r){var s=r.alternate;return r===gr||s!==null&&s===gr}function ni(r,s){oo=Yc=!0;var h=r.pending;h===null?s.next=s:(s.next=h.next,h.next=s),r.pending=s}function si(r,s,h){if(h&4194176){var y=s.lanes;y&=r.pendingLanes,h|=y,s.lanes=h,Qe(r,h)}}var Tr={readContext:Pa,use:co,useCallback:Li,useContext:Li,useEffect:Li,useImperativeHandle:Li,useLayoutEffect:Li,useInsertionEffect:Li,useMemo:Li,useReducer:Li,useRef:Li,useState:Li,useDebugValue:Li,useDeferredValue:Li,useTransition:Li,useSyncExternalStore:Li,useId:Li};Tr.useCacheRefresh=Li,Tr.useMemoCache=Li,Tr.useHostTransitionStatus=Li,Tr.useFormState=Li,Tr.useActionState=Li,Tr.useOptimistic=Li;var yr={readContext:Pa,use:co,useCallback:function(r,s){return Wr().memoizedState=[r,s===void 0?null:s],r},useContext:Pa,useEffect:U,useImperativeHandle:function(r,s,h){h=h!=null?h.concat([r]):null,N(4194308,4,ce.bind(null,s,r),h)},useLayoutEffect:function(r,s){return N(4194308,4,r,s)},useInsertionEffect:function(r,s){N(4,2,r,s)},useMemo:function(r,s){var h=Wr();s=s===void 0?null:s;var y=r();if(ls){Q(!0);try{r()}finally{Q(!1)}}return h.memoizedState=[y,s],y},useReducer:function(r,s,h){var y=Wr();if(h!==void 0){var M=h(s);if(ls){Q(!0);try{h(s)}finally{Q(!1)}}}else M=s;return y.memoizedState=y.baseState=M,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:M},y.queue=r,r=r.dispatch=Lt.bind(null,gr,r),[y.memoizedState,r]},useRef:function(r){var s=Wr();return r={current:r},s.memoizedState=r},useState:function(r){r=il(r);var s=r.queue,h=lr.bind(null,gr,s);return s.dispatch=h,[r.memoizedState,h]},useDebugValue:pe,useDeferredValue:function(r,s){var h=Wr();return we(h,r,s)},useTransition:function(){var r=il(!1);return r=Te.bind(null,gr,r.queue,!0,!1),Wr().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,h){var y=gr,M=Wr();if(kr){if(h===void 0)throw Error(x(407));h=h()}else{if(h=s(),gi===null)throw Error(x(349));Mr&60||uo(y,s,h)}M.memoizedState=h;var z={value:h,getSnapshot:s};return M.queue=z,U(ai.bind(null,y,z,r),[r]),y.flags|=2048,j(9,pi.bind(null,y,z,h,s),{destroy:void 0},null),h},useId:function(){var r=Wr(),s=gi.identifierPrefix;if(kr){var h=vn,y=Qa;h=(y&~(1<<32-J(y)-1)).toString(32)+h,s=":"+s+"R"+h,h=lo++,0<h&&(s+="H"+h.toString(32)),s+=":"}else h=Wp++,s=":"+s+"r"+h.toString(32)+":";return r.memoizedState=s},useCacheRefresh:function(){return Wr().memoizedState=ft.bind(null,gr)}};yr.useMemoCache=Qc,yr.useHostTransitionStatus=Ke,yr.useFormState=u,yr.useActionState=u,yr.useOptimistic=function(r){var s=Wr();s.memoizedState=s.baseState=r;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=h,s=ei.bind(null,gr,!0,h),h.dispatch=s,[r,s]};var ti={readContext:Pa,use:co,useCallback:xe,useContext:Pa,useEffect:W,useImperativeHandle:de,useInsertionEffect:Y,useLayoutEffect:ue,useMemo:ve,useReducer:wi,useRef:R,useState:function(){return wi(Nn)},useDebugValue:pe,useDeferredValue:function(r,s){var h=bi();return ke(h,Ur.memoizedState,r,s)},useTransition:function(){var r=wi(Nn)[0],s=bi().memoizedState;return[typeof r=="boolean"?r:$t(r),s]},useSyncExternalStore:pd,useId:St};ti.useCacheRefresh=wt,ti.useMemoCache=Qc,ti.useHostTransitionStatus=Ke,ti.useFormState=f,ti.useActionState=f,ti.useOptimistic=function(r,s){var h=bi();return ho(h,Ur,r,s)};var mi={readContext:Pa,use:co,useCallback:xe,useContext:Pa,useEffect:W,useImperativeHandle:de,useInsertionEffect:Y,useLayoutEffect:ue,useMemo:ve,useReducer:La,useRef:R,useState:function(){return La(Nn)},useDebugValue:pe,useDeferredValue:function(r,s){var h=bi();return Ur===null?we(h,r,s):ke(h,Ur.memoizedState,r,s)},useTransition:function(){var r=La(Nn)[0],s=bi().memoizedState;return[typeof r=="boolean"?r:$t(r),s]},useSyncExternalStore:pd,useId:St};mi.useCacheRefresh=wt,mi.useMemoCache=Qc,mi.useHostTransitionStatus=Ke,mi.useFormState=A,mi.useActionState=A,mi.useOptimistic=function(r,s){var h=bi();return Ur!==null?ho(h,Ur,r,s):(h.baseState=r,[r,h.queue.dispatch])};function Yi(r,s,h,y){s=r.memoizedState,h=h(y,s),h=h==null?s:xt({},s,h),r.memoizedState=h,r.lanes===0&&(r.updateQueue.baseState=h)}var Er={isMounted:function(r){return(r=r._reactInternals)?Je(r)===r:!1},enqueueSetState:function(r,s,h){r=r._reactInternals;var y=Lr(),M=ul(y);M.payload=s,h!=null&&(M.callback=h),s=oc(r,M,y),s!==null&&(rn(s,r,y),au(s,r,y))},enqueueReplaceState:function(r,s,h){r=r._reactInternals;var y=Lr(),M=ul(y);M.tag=1,M.payload=s,h!=null&&(M.callback=h),s=oc(r,M,y),s!==null&&(rn(s,r,y),au(s,r,y))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var h=Lr(),y=ul(h);y.tag=2,s!=null&&(y.callback=s),s=oc(r,y,h),s!==null&&(rn(s,r,h),au(s,r,h))}};function Ds(r,s,h,y,M,z,Z){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(y,z,Z):s.prototype&&s.prototype.isPureReactComponent?!mr(h,y)||!mr(M,z):!0}function Ln(r,s,h,y){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(h,y),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(h,y),s.state!==r&&Er.enqueueReplaceState(s,s.state,null)}function Oa(r,s){var h=s;if("ref"in s){h={};for(var y in s)y!=="ref"&&(h[y]=s[y])}if(r=r.defaultProps){h===s&&(h=xt({},h));for(var M in r)h[M]===void 0&&(h[M]=r[M])}return h}var cs=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function ac(r){cs(r)}function Ns(r){console.error(r)}function fo(r){cs(r)}function ya(r,s){try{var h=r.onUncaughtError;h(s.value,{componentStack:s.stack})}catch(y){setTimeout(function(){throw y})}}function Ls(r,s,h){try{var y=r.onCaughtError;y(h.value,{componentStack:h.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function On(r,s,h){return h=ul(h),h.tag=3,h.payload={element:null},h.callback=function(){ya(r,s)},h}function Os(r){return r=ul(r),r.tag=3,r}function Oi(r,s,h,y){var M=h.type.getDerivedStateFromError;if(typeof M=="function"){var z=y.value;r.payload=function(){return M(z)},r.callback=function(){Ls(s,h,y)}}var Z=h.stateNode;Z!==null&&typeof Z.componentDidCatch=="function"&&(r.callback=function(){Ls(s,h,y),typeof M!="function"&&(dc===null?dc=new Set([this]):dc.add(this));var ie=y.stack;this.componentDidCatch(y.value,{componentStack:ie!==null?ie:""})})}function Vi(r,s,h,y,M){if(h.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(s=h.alternate,s!==null&&cl(s,h,M,!0),h=ca.current,h!==null){switch(h.tag){case 13:return bn===null?vo():h.alternate===null&&$i===0&&($i=3),h.flags&=-257,h.flags|=65536,h.lanes=M,y===di?h.flags|=16384:(s=h.updateQueue,s===null?h.updateQueue=new Set([y]):s.add(y),Jf(r,y,M)),!1;case 22:return h.flags|=65536,y===di?h.flags|=16384:(s=h.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([y])},h.updateQueue=s):(h=s.retryQueue,h===null?s.retryQueue=new Set([y]):h.add(y)),Jf(r,y,M)),!1}throw Error(x(435,h.tag))}return Jf(r,y,M),vo(),!1}if(kr)return s=ca.current,s!==null?(!(s.flags&65536)&&(s.flags|=256),s.flags|=65536,s.lanes=M,y!==rh&&(r=Error(x(422),{cause:y}),ao(Ea(r,h)))):(y!==rh&&(s=Error(x(423),{cause:y}),ao(Ea(s,h))),r=r.current.alternate,r.flags|=65536,M&=-M,r.lanes|=M,y=Ea(y,h),M=On(r.stateNode,y,M),jf(r,M),$i!==4&&($i=2)),!1;var z=Error(x(520),{cause:y});if(z=Ea(z,h),Md===null?Md=[z]:Md.push(z),$i!==4&&($i=2),s===null)return!0;y=Ea(y,h),h=s;do{switch(h.tag){case 3:return h.flags|=65536,r=M&-M,h.lanes|=r,r=On(h.stateNode,y,r),jf(h,r),!1;case 1:if(s=h.type,z=h.stateNode,(h.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(dc===null||!dc.has(z))))return h.flags|=65536,M&=-M,h.lanes|=M,M=Os(M),Oi(M,r,h,y),jf(h,M),!1}h=h.return}while(h!==null);return!1}var _a=Error(x(461)),cr=!1;function qi(r,s,h,y){s.child=r===null?Jo(s,null,h,y):xn(s,r.child,h,y)}function gd(r,s,h,y,M){h=h.render;var z=s.ref;if("ref"in y){var Z={};for(var ie in y)ie!=="ref"&&(Z[ie]=y[ie])}else Z=y;return go(s),y=Hr(r,s,h,Z,z,M),ie=hh(),r!==null&&!cr?(dh(r,s,M),po(r,s,M)):(kr&&ie&&Gc(s),s.flags|=1,qi(r,s,y,M),s.child)}function yd(r,s,h,y,M){if(r===null){var z=h.type;return typeof z=="function"&&!Bf(z)&&z.defaultProps===void 0&&h.compare===null?(s.tag=15,s.type=z,Tf(r,s,z,y,M)):(r=vh(h.type,null,y,s,s.mode,M),r.ref=s.ref,r.return=s,s.child=r)}if(z=r.child,!Kp(r,M)){var Z=z.memoizedProps;if(h=h.compare,h=h!==null?h:mr,h(Z,y)&&r.ref===s.ref)return po(r,s,M)}return s.flags|=1,r=yo(z,y),r.ref=s.ref,r.return=s,s.child=r}function Tf(r,s,h,y,M){if(r!==null){var z=r.memoizedProps;if(mr(z,y)&&r.ref===s.ref)if(cr=!1,s.pendingProps=y=z,Kp(r,M))r.flags&131072&&(cr=!0);else return s.lanes=r.lanes,po(r,s,M)}return Sn(r,s,h,y,M)}function mh(r,s,h){var y=s.pendingProps,M=y.children,z=(s.stateNode._pendingVisibility&2)!==0,Z=r!==null?r.memoizedState:null;if(va(r,s),y.mode==="hidden"||z){if(s.flags&128){if(y=Z!==null?Z.baseLanes|h:h,r!==null){for(M=s.child=r.child,z=0;M!==null;)z=z|M.lanes|M.childLanes,M=M.sibling;s.childLanes=z&~y}else s.childLanes=0,s.child=null;return nc(r,s,y,h)}if(h&536870912)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&tc(s,Z!==null?Z.cachePool:null),Z!==null?sh(s,Z):oh(),ud(s);else return s.lanes=s.childLanes=536870912,nc(r,s,Z!==null?Z.baseLanes|h:h,h)}else Z!==null?(tc(s,Z.cachePool),sh(s,Z),en(),s.memoizedState=null):(r!==null&&tc(s,null),oh(),en());return qi(r,s,M,h),s.child}function nc(r,s,h,y){var M=tl();return M=M===null?null:{parent:Ai._currentValue,pool:M},s.memoizedState={baseLanes:h,cachePool:M},r!==null&&tc(s,null),oh(),ud(s),r!==null&&cl(r,s,y,!0),null}function va(r,s){var h=s.ref;if(h===null)r!==null&&r.ref!==null&&(s.flags|=2097664);else{if(typeof h!="function"&&typeof h!="object")throw Error(x(284));(r===null||r.ref!==h)&&(s.flags|=2097664)}}function Sn(r,s,h,y,M){return go(s),h=Hr(r,s,h,y,void 0,M),y=hh(),r!==null&&!cr?(dh(r,s,M),po(r,s,M)):(kr&&y&&Gc(s),s.flags|=1,qi(r,s,h,M),s.child)}function tn(r,s,h,y,M,z){return go(s),s.updateQueue=null,h=uh(s,y,h,M),rc(r),y=hh(),r!==null&&!cr?(dh(r,s,z),po(r,s,z)):(kr&&y&&Gc(s),s.flags|=1,qi(r,s,h,z),s.child)}function us(r,s,h,y,M){if(go(s),s.stateNode===null){var z=or,Z=h.contextType;typeof Z=="object"&&Z!==null&&(z=Pa(Z)),z=new h(y,z),s.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=Er,s.stateNode=z,z._reactInternals=s,z=s.stateNode,z.props=y,z.state=s.memoizedState,z.refs={},kf(s),Z=h.contextType,z.context=typeof Z=="object"&&Z!==null?Pa(Z):or,z.state=s.memoizedState,Z=h.getDerivedStateFromProps,typeof Z=="function"&&(Yi(s,h,Z,y),z.state=s.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(Z=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),Z!==z.state&&Er.enqueueReplaceState(z,z.state,null),ja(s,y,z,M),hl(),z.state=s.memoizedState),typeof z.componentDidMount=="function"&&(s.flags|=4194308),y=!0}else if(r===null){z=s.stateNode;var ie=s.memoizedProps,ge=Oa(h,ie);z.props=ge;var ze=z.context,lt=h.contextType;Z=or,typeof lt=="object"&&lt!==null&&(Z=Pa(lt));var bt=h.getDerivedStateFromProps;lt=typeof bt=="function"||typeof z.getSnapshotBeforeUpdate=="function",ie=s.pendingProps!==ie,lt||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ie||ze!==Z)&&Ln(s,z,y,Z),sc=!1;var We=s.memoizedState;z.state=We,ja(s,y,z,M),hl(),ze=s.memoizedState,ie||We!==ze||sc?(typeof bt=="function"&&(Yi(s,h,bt,y),ze=s.memoizedState),(ge=sc||Ds(s,h,ge,y,We,ze,Z))?(lt||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(s.flags|=4194308)):(typeof z.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=y,s.memoizedState=ze),z.props=y,z.state=ze,z.context=Z,y=ge):(typeof z.componentDidMount=="function"&&(s.flags|=4194308),y=!1)}else{z=s.stateNode,Pf(r,s),Z=s.memoizedProps,lt=Oa(h,Z),z.props=lt,bt=s.pendingProps,We=z.context,ze=h.contextType,ge=or,typeof ze=="object"&&ze!==null&&(ge=Pa(ze)),ie=h.getDerivedStateFromProps,(ze=typeof ie=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(Z!==bt||We!==ge)&&Ln(s,z,y,ge),sc=!1,We=s.memoizedState,z.state=We,ja(s,y,z,M),hl();var ct=s.memoizedState;Z!==bt||We!==ct||sc||r!==null&&r.dependencies!==null&&iu(r.dependencies)?(typeof ie=="function"&&(Yi(s,h,ie,y),ct=s.memoizedState),(lt=sc||Ds(s,h,lt,y,We,ct,ge)||r!==null&&r.dependencies!==null&&iu(r.dependencies))?(ze||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(y,ct,ge),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(y,ct,ge)),typeof z.componentDidUpdate=="function"&&(s.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof z.componentDidUpdate!="function"||Z===r.memoizedProps&&We===r.memoizedState||(s.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||Z===r.memoizedProps&&We===r.memoizedState||(s.flags|=1024),s.memoizedProps=y,s.memoizedState=ct),z.props=y,z.state=ct,z.context=ge,y=lt):(typeof z.componentDidUpdate!="function"||Z===r.memoizedProps&&We===r.memoizedState||(s.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||Z===r.memoizedProps&&We===r.memoizedState||(s.flags|=1024),y=!1)}return z=y,va(r,s),y=(s.flags&128)!==0,z||y?(z=s.stateNode,h=y&&typeof h.getDerivedStateFromError!="function"?null:z.render(),s.flags|=1,r!==null&&y?(s.child=xn(s,r.child,null,M),s.child=xn(s,null,h,M)):qi(r,s,h,M),s.memoizedState=z.state,r=s.child):r=po(r,s,M),r}function eu(r,s,h,y){return io(),s.flags|=256,qi(r,s,h,y),s.child}var hs={dehydrated:null,treeContext:null,retryLane:0};function tu(r){return{baseLanes:r,cachePool:dr()}}function Mf(r,s,h){return r=r!==null?r.childLanes&~h:0,s&&(r|=qn),r}function Ef(r,s,h){var y=s.pendingProps,M=!1,z=(s.flags&128)!==0,Z;if((Z=z)||(Z=r!==null&&r.memoizedState===null?!1:(Pr.current&2)!==0),Z&&(M=!0,s.flags&=-129),Z=(s.flags&32)!==0,s.flags&=-33,r===null){if(kr){if(M?jn(s):en(),kr){var ie=Di,ge;if(ge=ie){e:{for(ge=ie,ie=Ja;ge.nodeType!==8;){if(!ie){ie=null;break e}if(ge=an(ge.nextSibling),ge===null){ie=null;break e}}ie=ge}ie!==null?(s.memoizedState={dehydrated:ie,treeContext:ns!==null?{id:Qa,overflow:vn}:null,retryLane:536870912},ge=Mn(18,null,null,0),ge.stateNode=ie,ge.return=s,s.child=ge,Xi=s,Di=null,ge=!0):ge=!1}ge||ss(s)}if(ie=s.memoizedState,ie!==null&&(ie=ie.dehydrated,ie!==null))return ie.data==="$!"?s.lanes=16:s.lanes=536870912,null;os(s)}return ie=y.children,y=y.fallback,M?(en(),M=s.mode,ie=nl({mode:"hidden",children:ie},M),y=uc(y,M,h,null),ie.return=s,y.return=s,ie.sibling=y,s.child=ie,M=s.child,M.memoizedState=tu(h),M.childLanes=Mf(r,Z,h),s.memoizedState=hs,y):(jn(s),Cf(s,ie))}if(ge=r.memoizedState,ge!==null&&(ie=ge.dehydrated,ie!==null)){if(z)s.flags&256?(jn(s),s.flags&=-257,s=sl(r,s,h)):s.memoizedState!==null?(en(),s.child=r.child,s.flags|=128,s=null):(en(),M=y.fallback,ie=s.mode,y=nl({mode:"visible",children:y.children},ie),M=uc(M,ie,h,null),M.flags|=2,y.return=s,M.return=s,y.sibling=M,s.child=y,xn(s,r.child,null,h),y=s.child,y.memoizedState=tu(h),y.childLanes=Mf(r,Z,h),s.memoizedState=hs,s=M);else if(jn(s),ie.data==="$!"){if(Z=ie.nextSibling&&ie.nextSibling.dataset,Z)var ze=Z.dgst;Z=ze,y=Error(x(419)),y.stack="",y.digest=Z,ao({value:y,source:null,stack:null}),s=sl(r,s,h)}else if(cr||cl(r,s,h,!1),Z=(h&r.childLanes)!==0,cr||Z){if(Z=gi,Z!==null){if(y=h&-h,y&42)y=1;else switch(y){case 2:y=1;break;case 8:y=4;break;case 32:y=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:y=64;break;case 268435456:y=134217728;break;default:y=0}if(y=y&(Z.suspendedLanes|h)?0:y,y!==0&&y!==ge.retryLane)throw ge.retryLane=y,Ya(r,y),rn(Z,r,y),_a}ie.data==="$?"||vo(),s=sl(r,s,h)}else ie.data==="$?"?(s.flags|=128,s.child=r.child,s=v_.bind(null,r),ie._reactRetry=s,s=null):(r=ge.treeContext,Di=an(ie.nextSibling),Xi=s,kr=!0,Ca=null,Ja=!1,r!==null&&(Ka[_n++]=Qa,Ka[_n++]=vn,Ka[_n++]=ns,Qa=r.id,vn=r.overflow,ns=s),s=Cf(s,y.children),s.flags|=4096);return s}return M?(en(),M=y.fallback,ie=s.mode,ge=r.child,ze=ge.sibling,y=yo(ge,{mode:"hidden",children:y.children}),y.subtreeFlags=ge.subtreeFlags&31457280,ze!==null?M=yo(ze,M):(M=uc(M,ie,h,null),M.flags|=2),M.return=s,y.return=s,y.sibling=M,s.child=y,y=M,M=s.child,ie=r.child.memoizedState,ie===null?ie=tu(h):(ge=ie.cachePool,ge!==null?(ze=Ai._currentValue,ge=ge.parent!==ze?{parent:ze,pool:ze}:ge):ge=dr(),ie={baseLanes:ie.baseLanes|h,cachePool:ge}),M.memoizedState=ie,M.childLanes=Mf(r,Z,h),s.memoizedState=hs,y):(jn(s),h=r.child,r=h.sibling,h=yo(h,{mode:"visible",children:y.children}),h.return=s,h.sibling=null,r!==null&&(Z=s.deletions,Z===null?(s.deletions=[r],s.flags|=16):Z.push(r)),s.child=h,s.memoizedState=null,h)}function Cf(r,s){return s=nl({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function nl(r,s){return um(r,s,0,null)}function sl(r,s,h){return xn(s,r.child,null,h),r=Cf(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function Xp(r,s,h){r.lanes|=s;var y=r.alternate;y!==null&&(y.lanes|=s),ll(r.return,s,h)}function Yp(r,s,h,y,M){var z=r.memoizedState;z===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:y,tail:h,tailMode:M}:(z.isBackwards=s,z.rendering=null,z.renderingStartTime=0,z.last=y,z.tail=h,z.tailMode=M)}function Af(r,s,h){var y=s.pendingProps,M=y.revealOrder,z=y.tail;if(qi(r,s,y.children,h),y=Pr.current,y&2)y=y&1|2,s.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Xp(r,h,s);else if(r.tag===19)Xp(r,h,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}y&=1}switch(Br(Pr,y),M){case"forwards":for(h=s.child,M=null;h!==null;)r=h.alternate,r!==null&&Na(r)===null&&(M=h),h=h.sibling;h=M,h===null?(M=s.child,s.child=null):(M=h.sibling,h.sibling=null),Yp(s,!1,M,h,z);break;case"backwards":for(h=null,M=s.child,s.child=null;M!==null;){if(r=M.alternate,r!==null&&Na(r)===null){s.child=M;break}r=M.sibling,M.sibling=h,h=M,M=r}Yp(s,!0,h,null,z);break;case"together":Yp(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function po(r,s,h){if(r!==null&&(s.dependencies=r.dependencies),xl|=s.lanes,!(h&s.childLanes))if(r!==null){if(cl(r,s,h,!1),(h&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(x(153));if(s.child!==null){for(r=s.child,h=yo(r,r.pendingProps),s.child=h,h.return=s;r.sibling!==null;)r=r.sibling,h=h.sibling=yo(r,r.pendingProps),h.return=s;h.sibling=null}return s.child}function Kp(r,s){return r.lanes&s?!0:(r=r.dependencies,!!(r!==null&&iu(r)))}function Ag(r,s,h){switch(s.tag){case 3:$a(s,s.stateNode.containerInfo),ol(s,Ai,r.memoizedState.cache),io();break;case 27:case 5:za(s);break;case 4:$a(s,s.stateNode.containerInfo);break;case 10:ol(s,s.type,s.memoizedProps.value);break;case 13:var y=s.memoizedState;if(y!==null)return y.dehydrated!==null?(jn(s),s.flags|=128,null):h&s.child.childLanes?Ef(r,s,h):(jn(s),r=po(r,s,h),r!==null?r.sibling:null);jn(s);break;case 19:var M=(r.flags&128)!==0;if(y=(h&s.childLanes)!==0,y||(cl(r,s,h,!1),y=(h&s.childLanes)!==0),M){if(y)return Af(r,s,h);s.flags|=128}if(M=s.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),Br(Pr,Pr.current),y)break;return null;case 22:case 23:return s.lanes=0,mh(r,s,h);case 24:ol(s,Ai,r.memoizedState.cache)}return po(r,s,h)}function kg(r,s,h){if(r!==null)if(r.memoizedProps!==s.pendingProps)cr=!0;else{if(!Kp(r,h)&&!(s.flags&128))return cr=!1,Ag(r,s,h);cr=!!(r.flags&131072)}else cr=!1,kr&&s.flags&1048576&&$c(s,th,s.index);switch(s.lanes=0,s.tag){case 16:e:{r=s.pendingProps;var y=s.elementType,M=y._init;if(y=M(y._payload),s.type=y,typeof y=="function")Bf(y)?(r=Oa(y,r),s.tag=1,s=us(null,s,y,r,h)):(s.tag=0,s=Sn(null,s,y,r,h));else{if(y!=null){if(M=y.$$typeof,M===te){s.tag=11,s=gd(null,s,y,r,h);break e}else if(M===Ae){s.tag=14,s=yd(null,s,y,r,h);break e}}throw s=ot(y)||y,Error(x(306,s,""))}}return s;case 0:return Sn(r,s,s.type,s.pendingProps,h);case 1:return y=s.type,M=Oa(y,s.pendingProps),us(r,s,y,M,h);case 3:e:{if($a(s,s.stateNode.containerInfo),r===null)throw Error(x(387));var z=s.pendingProps;M=s.memoizedState,y=M.element,Pf(r,s),ja(s,z,null,h);var Z=s.memoizedState;if(z=Z.cache,ol(s,Ai,z),z!==M.cache&&Qp(s,[Ai],h,!0),hl(),z=Z.element,M.isDehydrated)if(M={element:z,isDehydrated:!1,cache:Z.cache},s.updateQueue.baseState=M,s.memoizedState=M,s.flags&256){s=eu(r,s,z,h);break e}else if(z!==y){y=Ea(Error(x(424)),s),ao(y),s=eu(r,s,z,h);break e}else for(Di=an(s.stateNode.containerInfo.firstChild),Xi=s,kr=!0,Ca=null,Ja=!0,h=Jo(s,null,z,h),s.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(io(),z===y){s=po(r,s,h);break e}qi(r,s,z,h)}s=s.child}return s;case 26:return va(r,s),r===null?(h=Dm(s.type,null,s.pendingProps,null))?s.memoizedState=h:kr||(h=s.type,r=s.pendingProps,y=Ud(hi.current).createElement(h),y[rt]=s,y[Rt]=r,ba(y,h,r),_r(y),s.stateNode=y):s.memoizedState=Dm(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return za(s),r===null&&kr&&(y=s.stateNode=Vd(s.type,s.pendingProps,hi.current),Xi=s,Ja=!0,Di=an(y.firstChild)),y=s.pendingProps.children,r!==null||kr?qi(r,s,y,h):s.child=xn(s,null,y,h),va(r,s),s.child;case 5:return r===null&&kr&&((M=y=Di)&&(y=M_(y,s.type,s.pendingProps,Ja),y!==null?(s.stateNode=y,Xi=s,Di=an(y.firstChild),Ja=!1,M=!0):M=!1),M||ss(s)),za(s),M=s.type,z=s.pendingProps,Z=r!==null?r.memoizedProps:null,y=z.children,sp(M,z)?y=null:Z!==null&&sp(M,Z)&&(s.flags|=32),s.memoizedState!==null&&(M=Hr(r,s,Sf,null,null,h),T._currentValue=M),va(r,s),qi(r,s,y,h),s.child;case 6:return r===null&&kr&&((r=h=Di)&&(h=Qg(h,s.pendingProps,Ja),h!==null?(s.stateNode=h,Xi=s,Di=null,r=!0):r=!1),r||ss(s)),null;case 13:return Ef(r,s,h);case 4:return $a(s,s.stateNode.containerInfo),y=s.pendingProps,r===null?s.child=xn(s,null,y,h):qi(r,s,y,h),s.child;case 11:return gd(r,s,s.type,s.pendingProps,h);case 7:return qi(r,s,s.pendingProps,h),s.child;case 8:return qi(r,s,s.pendingProps.children,h),s.child;case 12:return qi(r,s,s.pendingProps.children,h),s.child;case 10:return y=s.pendingProps,ol(s,s.type,y.value),qi(r,s,y.children,h),s.child;case 9:return M=s.type._context,y=s.pendingProps.children,go(s),M=Pa(M),y=y(M),s.flags|=1,qi(r,s,y,h),s.child;case 14:return yd(r,s,s.type,s.pendingProps,h);case 15:return Tf(r,s,s.type,s.pendingProps,h);case 19:return Af(r,s,h);case 22:return mh(r,s,h);case 24:return go(s),y=Pa(Ai),r===null?(M=tl(),M===null&&(M=gi,z=hd(),M.pooledCache=z,z.refCount++,z!==null&&(M.pooledCacheLanes|=h),M=z),s.memoizedState={parent:y,cache:M},kf(s),ol(s,Ai,M)):(r.lanes&h&&(Pf(r,s),ja(s,null,null,h),hl()),M=r.memoizedState,z=s.memoizedState,M.parent!==y?(M={parent:y,cache:y},s.memoizedState=M,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=M),ol(s,Ai,y)):(y=z.cache,ol(s,Ai,y),y!==M.cache&&Qp(s,[Ai],h,!0))),qi(r,s,s.pendingProps.children,h),s.child;case 29:throw s.pendingProps}throw Error(x(156,s.tag))}var _d=wr(null),ru=null,Bs=null;function ol(r,s,h){Br(_d,s._currentValue),s._currentValue=h}function mo(r){r._currentValue=_d.current,$r(_d)}function ll(r,s,h){for(;r!==null;){var y=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,y!==null&&(y.childLanes|=s)):y!==null&&(y.childLanes&s)!==s&&(y.childLanes|=s),r===h)break;r=r.return}}function Qp(r,s,h,y){var M=r.child;for(M!==null&&(M.return=r);M!==null;){var z=M.dependencies;if(z!==null){var Z=M.child;z=z.firstContext;e:for(;z!==null;){var ie=z;z=M;for(var ge=0;ge<s.length;ge++)if(ie.context===s[ge]){z.lanes|=h,ie=z.alternate,ie!==null&&(ie.lanes|=h),ll(z.return,h,r),y||(Z=null);break e}z=ie.next}}else if(M.tag===18){if(Z=M.return,Z===null)throw Error(x(341));Z.lanes|=h,z=Z.alternate,z!==null&&(z.lanes|=h),ll(Z,h,r),Z=null}else Z=M.child;if(Z!==null)Z.return=M;else for(Z=M;Z!==null;){if(Z===r){Z=null;break}if(M=Z.sibling,M!==null){M.return=Z.return,Z=M;break}Z=Z.return}M=Z}}function cl(r,s,h,y){r=null;for(var M=s,z=!1;M!==null;){if(!z){if(M.flags&524288)z=!0;else if(M.flags&262144)break}if(M.tag===10){var Z=M.alternate;if(Z===null)throw Error(x(387));if(Z=Z.memoizedProps,Z!==null){var ie=M.type;Da(M.pendingProps.value,Z.value)||(r!==null?r.push(ie):r=[ie])}}else if(M===Fr.current){if(Z=M.alternate,Z===null)throw Error(x(387));Z.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(r!==null?r.push(T):r=[T])}M=M.return}r!==null&&Qp(s,r,h,y),s.flags|=262144}function iu(r){for(r=r.firstContext;r!==null;){if(!Da(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function go(r){ru=r,Bs=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Pa(r){return Pg(ru,r)}function vd(r,s){return ru===null&&go(r),Pg(r,s)}function Pg(r,s){var h=s._currentValue;if(s={context:s,memoizedValue:h,next:null},Bs===null){if(r===null)throw Error(x(308));Bs=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else Bs=Bs.next=s;return h}var sc=!1;function kf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pf(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ul(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function oc(r,s,h){var y=r.updateQueue;if(y===null)return null;if(y=y.shared,Pi&2){var M=y.pending;return M===null?s.next=s:(s.next=M.next,M.next=s),y.pending=s,s=Xo(r),sd(r,null,h),s}return Wo(r,y,s,h),Xo(r)}function au(r,s,h){if(s=s.updateQueue,s!==null&&(s=s.shared,(h&4194176)!==0)){var y=s.lanes;y&=r.pendingLanes,h|=y,s.lanes=h,Qe(r,h)}}function jf(r,s){var h=r.updateQueue,y=r.alternate;if(y!==null&&(y=y.updateQueue,h===y)){var M=null,z=null;if(h=h.firstBaseUpdate,h!==null){do{var Z={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};z===null?M=z=Z:z=z.next=Z,h=h.next}while(h!==null);z===null?M=z=s:z=z.next=s}else M=z=s;h={baseState:y.baseState,firstBaseUpdate:M,lastBaseUpdate:z,shared:y.shared,callbacks:y.callbacks},r.updateQueue=h;return}r=h.lastBaseUpdate,r===null?h.firstBaseUpdate=s:r.next=s,h.lastBaseUpdate=s}var xd=!1;function hl(){if(xd){var r=ka;if(r!==null)throw r}}function ja(r,s,h,y){xd=!1;var M=r.updateQueue;sc=!1;var z=M.firstBaseUpdate,Z=M.lastBaseUpdate,ie=M.shared.pending;if(ie!==null){M.shared.pending=null;var ge=ie,ze=ge.next;ge.next=null,Z===null?z=ze:Z.next=ze,Z=ge;var lt=r.alternate;lt!==null&&(lt=lt.updateQueue,ie=lt.lastBaseUpdate,ie!==Z&&(ie===null?lt.firstBaseUpdate=ze:ie.next=ze,lt.lastBaseUpdate=ge))}if(z!==null){var bt=M.baseState;Z=0,lt=ze=ge=null,ie=z;do{var We=ie.lane&-536870913,ct=We!==ie.lane;if(ct?(Mr&We)===We:(y&We)===We){We!==0&&We===In&&(xd=!0),lt!==null&&(lt=lt.next={lane:0,tag:ie.tag,payload:ie.payload,callback:null,next:null});e:{var Vt=r,ir=ie;We=s;var ci=h;switch(ir.tag){case 1:if(Vt=ir.payload,typeof Vt=="function"){bt=Vt.call(ci,bt,We);break e}bt=Vt;break e;case 3:Vt.flags=Vt.flags&-65537|128;case 0:if(Vt=ir.payload,We=typeof Vt=="function"?Vt.call(ci,bt,We):Vt,We==null)break e;bt=xt({},bt,We);break e;case 2:sc=!0}}We=ie.callback,We!==null&&(r.flags|=64,ct&&(r.flags|=8192),ct=M.callbacks,ct===null?M.callbacks=[We]:ct.push(We))}else ct={lane:We,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},lt===null?(ze=lt=ct,ge=bt):lt=lt.next=ct,Z|=We;if(ie=ie.next,ie===null){if(ie=M.shared.pending,ie===null)break;ct=ie,ie=ct.next,ct.next=null,M.lastBaseUpdate=ct,M.shared.pending=null}}while(!0);lt===null&&(ge=bt),M.baseState=ge,M.firstBaseUpdate=ze,M.lastBaseUpdate=lt,z===null&&(M.shared.lanes=0),xl|=Z,r.lanes=Z,r.memoizedState=bt}}function Jp(r,s){if(typeof r!="function")throw Error(x(191,r));r.call(s)}function zf(r,s){var h=r.callbacks;if(h!==null)for(r.callbacks=null,r=0;r<h.length;r++)Jp(h[r],s)}function bd(r,s){try{var h=s.updateQueue,y=h!==null?h.lastEffect:null;if(y!==null){var M=y.next;h=M;do{if((h.tag&r)===r){y=void 0;var z=h.create,Z=h.inst;y=z(),Z.destroy=y}h=h.next}while(h!==M)}}catch(ie){li(s,s.return,ie)}}function dl(r,s,h){try{var y=s.updateQueue,M=y!==null?y.lastEffect:null;if(M!==null){var z=M.next;y=z;do{if((y.tag&r)===r){var Z=y.inst,ie=Z.destroy;if(ie!==void 0){Z.destroy=void 0,M=s;var ge=h;try{ie()}catch(ze){li(M,ge,ze)}}}y=y.next}while(y!==z)}}catch(ze){li(s,s.return,ze)}}function jg(r){var s=r.updateQueue;if(s!==null){var h=r.stateNode;try{zf(s,h)}catch(y){li(r,r.return,y)}}}function zg(r,s,h){h.props=Oa(r.type,r.memoizedProps),h.state=r.memoizedState;try{h.componentWillUnmount()}catch(y){li(r,s,y)}}function nu(r,s){try{var h=r.ref;if(h!==null){var y=r.stateNode;switch(r.tag){case 26:case 27:case 5:var M=y;break;default:M=y}typeof h=="function"?r.refCleanup=h(M):h.current=M}}catch(z){li(r,s,z)}}function Bn(r,s){var h=r.ref,y=r.refCleanup;if(h!==null)if(typeof y=="function")try{y()}catch(M){li(r,s,M)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(M){li(r,s,M)}else h.current=null}function If(r){var s=r.type,h=r.memoizedProps,y=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":h.autoFocus&&y.focus();break e;case"img":h.src?y.src=h.src:h.srcSet&&(y.srcset=h.srcSet)}}catch(M){li(r,r.return,M)}}function Rf(r,s,h){try{var y=r.stateNode;Gn(y,r.type,h,s),y[Rt]=s}catch(M){li(r,r.return,M)}}function em(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27||r.tag===4}function fl(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||em(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==27&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function su(r,s,h){var y=r.tag;if(y===5||y===6)r=r.stateNode,s?h.nodeType===8?h.parentNode.insertBefore(r,s):h.insertBefore(r,s):(h.nodeType===8?(s=h.parentNode,s.insertBefore(r,h)):(s=h,s.appendChild(r)),h=h._reactRootContainer,h!=null||s.onclick!==null||(s.onclick=mc));else if(y!==4&&y!==27&&(r=r.child,r!==null))for(su(r,s,h),r=r.sibling;r!==null;)su(r,s,h),r=r.sibling}function Df(r,s,h){var y=r.tag;if(y===5||y===6)r=r.stateNode,s?h.insertBefore(r,s):h.appendChild(r);else if(y!==4&&y!==27&&(r=r.child,r!==null))for(Df(r,s,h),r=r.sibling;r!==null;)Df(r,s,h),r=r.sibling}var pl=!1,Zi=!1,tm=!1,Ig=typeof WeakSet=="function"?WeakSet:Set,xa=null,Rg=!1;function rm(r,s){if(r=r.containerInfo,gc=K,r=Wu(r),Xu(r)){if("selectionStart"in r)var h={start:r.selectionStart,end:r.selectionEnd};else e:{h=(h=r.ownerDocument)&&h.defaultView||window;var y=h.getSelection&&h.getSelection();if(y&&y.rangeCount!==0){h=y.anchorNode;var M=y.anchorOffset,z=y.focusNode;y=y.focusOffset;try{h.nodeType,z.nodeType}catch{h=null;break e}var Z=0,ie=-1,ge=-1,ze=0,lt=0,bt=r,We=null;t:for(;;){for(var ct;bt!==h||M!==0&&bt.nodeType!==3||(ie=Z+M),bt!==z||y!==0&&bt.nodeType!==3||(ge=Z+y),bt.nodeType===3&&(Z+=bt.nodeValue.length),(ct=bt.firstChild)!==null;)We=bt,bt=ct;for(;;){if(bt===r)break t;if(We===h&&++ze===M&&(ie=Z),We===z&&++lt===y&&(ge=Z),(ct=bt.nextSibling)!==null)break;bt=We,We=bt.parentNode}bt=ct}h=ie===-1||ge===-1?null:{start:ie,end:ge}}else h=null}h=h||{start:0,end:0}}else h=null;for(np={focusedElem:r,selectionRange:h},K=!1,xa=s;xa!==null;)if(s=xa,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,xa=r;else for(;xa!==null;){switch(s=xa,z=s.alternate,r=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if(r&1024&&z!==null){r=void 0,h=s,M=z.memoizedProps,z=z.memoizedState,y=h.stateNode;try{var Vt=Oa(h.type,M,h.elementType===h.type);r=y.getSnapshotBeforeUpdate(Vt,z),y.__reactInternalSnapshotBeforeUpdate=r}catch(ir){li(h,h.return,ir)}}break;case 3:if(r&1024){if(r=s.stateNode.containerInfo,h=r.nodeType,h===9)jm(r);else if(h===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":jm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(r&1024)throw Error(x(163))}if(r=s.sibling,r!==null){r.return=s.return,xa=r;break}xa=s.return}return Vt=Rg,Rg=!1,Vt}function Dg(r,s,h){var y=h.flags;switch(h.tag){case 0:case 11:case 15:Tn(r,h),y&4&&bd(5,h);break;case 1:if(Tn(r,h),y&4)if(r=h.stateNode,s===null)try{r.componentDidMount()}catch(ie){li(h,h.return,ie)}else{var M=Oa(h.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(M,s,r.__reactInternalSnapshotBeforeUpdate)}catch(ie){li(h,h.return,ie)}}y&64&&jg(h),y&512&&nu(h,h.return);break;case 3:if(Tn(r,h),y&64&&(y=h.updateQueue,y!==null)){if(r=null,h.child!==null)switch(h.child.tag){case 27:case 5:r=h.child.stateNode;break;case 1:r=h.child.stateNode}try{zf(y,r)}catch(ie){li(h,h.return,ie)}}break;case 26:Tn(r,h),y&512&&nu(h,h.return);break;case 27:case 5:Tn(r,h),s===null&&y&4&&If(h),y&512&&nu(h,h.return);break;case 12:Tn(r,h);break;case 13:Tn(r,h),y&4&&am(r,h);break;case 22:if(M=h.memoizedState!==null||pl,!M){s=s!==null&&s.memoizedState!==null||Zi;var z=pl,Z=Zi;pl=M,(Zi=s)&&!Z?Un(r,h,(h.subtreeFlags&8772)!==0):Tn(r,h),pl=z,Zi=Z}y&512&&(h.memoizedProps.mode==="manual"?nu(h,h.return):Bn(h,h.return));break;default:Tn(r,h)}}function im(r){var s=r.alternate;s!==null&&(r.alternate=null,im(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&jo(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var ki=null,Fn=!1;function Zr(r,s,h){for(h=h.child;h!==null;)ou(r,s,h),h=h.sibling}function ou(r,s,h){if(Mi&&typeof Mi.onCommitFiberUnmount=="function")try{Mi.onCommitFiberUnmount(ea,h)}catch{}switch(h.tag){case 26:Zi||Bn(h,s),Zr(r,s,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Zi||Bn(h,s);var y=ki,M=Fn;for(ki=h.stateNode,Zr(r,s,h),h=h.stateNode,s=h.attributes;s.length;)h.removeAttributeNode(s[0]);jo(h),ki=y,Fn=M;break;case 5:Zi||Bn(h,s);case 6:M=ki;var z=Fn;if(ki=null,Zr(r,s,h),ki=M,Fn=z,ki!==null)if(Fn)try{r=ki,y=h.stateNode,r.nodeType===8?r.parentNode.removeChild(y):r.removeChild(y)}catch(Z){li(h,s,Z)}else try{ki.removeChild(h.stateNode)}catch(Z){li(h,s,Z)}break;case 18:ki!==null&&(Fn?(s=ki,h=h.stateNode,s.nodeType===8?lp(s.parentNode,h):s.nodeType===1&&lp(s,h),Bi(s)):lp(ki,h.stateNode));break;case 4:y=ki,M=Fn,ki=h.stateNode.containerInfo,Fn=!0,Zr(r,s,h),ki=y,Fn=M;break;case 0:case 11:case 14:case 15:Zi||dl(2,h,s),Zi||dl(4,h,s),Zr(r,s,h);break;case 1:Zi||(Bn(h,s),y=h.stateNode,typeof y.componentWillUnmount=="function"&&zg(h,s,y)),Zr(r,s,h);break;case 21:Zr(r,s,h);break;case 22:Zi||Bn(h,s),Zi=(y=Zi)||h.memoizedState!==null,Zr(r,s,h),Zi=y;break;default:Zr(r,s,h)}}function am(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Bi(r)}catch(h){li(s,s.return,h)}}function Nf(r){switch(r.tag){case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new Ig),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new Ig),s;default:throw Error(x(435,r.tag))}}function gh(r,s){var h=Nf(r);s.forEach(function(y){var M=x_.bind(null,r,y);h.has(y)||(h.add(y),y.then(M,M))})}function Ba(r,s){var h=s.deletions;if(h!==null)for(var y=0;y<h.length;y++){var M=h[y],z=r,Z=s,ie=Z;e:for(;ie!==null;){switch(ie.tag){case 27:case 5:ki=ie.stateNode,Fn=!1;break e;case 3:ki=ie.stateNode.containerInfo,Fn=!0;break e;case 4:ki=ie.stateNode.containerInfo,Fn=!0;break e}ie=ie.return}if(ki===null)throw Error(x(160));ou(z,Z,M),ki=null,Fn=!1,z=M.alternate,z!==null&&(z.return=null),M.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)nm(s,r),s=s.sibling}var ds=null;function nm(r,s){var h=r.alternate,y=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Ba(s,r),Fa(r),y&4&&(dl(3,r,r.return),bd(3,r),dl(5,r,r.return));break;case 1:Ba(s,r),Fa(r),y&512&&(Zi||h===null||Bn(h,h.return)),y&64&&pl&&(r=r.updateQueue,r!==null&&(y=r.callbacks,y!==null&&(h=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=h===null?y:h.concat(y))));break;case 26:var M=ds;if(Ba(s,r),Fa(r),y&512&&(Zi||h===null||Bn(h,h.return)),y&4){var z=h!==null?h.memoizedState:null;if(y=r.memoizedState,h===null)if(y===null)if(r.stateNode===null){e:{y=r.type,h=r.memoizedProps,M=M.ownerDocument||M;t:switch(y){case"title":z=M.getElementsByTagName("title")[0],(!z||z[Xn]||z[rt]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=M.createElement(y),M.head.insertBefore(z,M.querySelector("head > title"))),ba(z,y,h),z[rt]=r,_r(z),y=z;break e;case"link":var Z=kh("link","href",M).get(y+(h.href||""));if(Z){for(var ie=0;ie<Z.length;ie++)if(z=Z[ie],z.getAttribute("href")===(h.href==null?null:h.href)&&z.getAttribute("rel")===(h.rel==null?null:h.rel)&&z.getAttribute("title")===(h.title==null?null:h.title)&&z.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){Z.splice(ie,1);break t}}z=M.createElement(y),ba(z,y,h),M.head.appendChild(z);break;case"meta":if(Z=kh("meta","content",M).get(y+(h.content||""))){for(ie=0;ie<Z.length;ie++)if(z=Z[ie],z.getAttribute("content")===(h.content==null?null:""+h.content)&&z.getAttribute("name")===(h.name==null?null:h.name)&&z.getAttribute("property")===(h.property==null?null:h.property)&&z.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&z.getAttribute("charset")===(h.charSet==null?null:h.charSet)){Z.splice(ie,1);break t}}z=M.createElement(y),ba(z,y,h),M.head.appendChild(z);break;default:throw Error(x(468,y))}z[rt]=r,_r(z),y=z}r.stateNode=y}else up(M,r.type,r.stateNode);else r.stateNode=Ch(M,y,r.memoizedProps);else z!==y?(z===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):z.count--,y===null?up(M,r.type,r.stateNode):Ch(M,y,r.memoizedProps)):y===null&&r.stateNode!==null&&Rf(r,r.memoizedProps,h.memoizedProps)}break;case 27:if(y&4&&r.alternate===null){M=r.stateNode,z=r.memoizedProps;try{for(var ge=M.firstChild;ge;){var ze=ge.nextSibling,lt=ge.nodeName;ge[Xn]||lt==="HEAD"||lt==="BODY"||lt==="SCRIPT"||lt==="STYLE"||lt==="LINK"&&ge.rel.toLowerCase()==="stylesheet"||M.removeChild(ge),ge=ze}for(var bt=r.type,We=M.attributes;We.length;)M.removeAttributeNode(We[0]);ba(M,bt,z),M[rt]=r,M[Rt]=z}catch(Vt){li(r,r.return,Vt)}}case 5:if(Ba(s,r),Fa(r),y&512&&(Zi||h===null||Bn(h,h.return)),r.flags&32){M=r.stateNode;try{Ui(M,"")}catch(Vt){li(r,r.return,Vt)}}y&4&&r.stateNode!=null&&(M=r.memoizedProps,Rf(r,M,h!==null?h.memoizedProps:M)),y&1024&&(tm=!0);break;case 6:if(Ba(s,r),Fa(r),y&4){if(r.stateNode===null)throw Error(x(162));y=r.memoizedProps,h=r.stateNode;try{h.nodeValue=y}catch(Vt){li(r,r.return,Vt)}}break;case 3:if(bu=null,M=ds,ds=_u(s.containerInfo),Ba(s,r),ds=M,Fa(r),y&4&&h!==null&&h.memoizedState.isDehydrated)try{Bi(s.containerInfo)}catch(Vt){li(r,r.return,Vt)}tm&&(tm=!1,Lf(r));break;case 4:y=ds,ds=_u(r.stateNode.containerInfo),Ba(s,r),Fa(r),ds=y;break;case 12:Ba(s,r),Fa(r);break;case 13:Ba(s,r),Fa(r),r.child.flags&8192&&r.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Vf=Ji()),y&4&&(y=r.updateQueue,y!==null&&(r.updateQueue=null,gh(r,y)));break;case 22:if(y&512&&(Zi||h===null||Bn(h,h.return)),ge=r.memoizedState!==null,ze=h!==null&&h.memoizedState!==null,lt=pl,bt=Zi,pl=lt||ge,Zi=bt||ze,Ba(s,r),Zi=bt,pl=lt,Fa(r),s=r.stateNode,s._current=r,s._visibility&=-3,s._visibility|=s._pendingVisibility&2,y&8192&&(s._visibility=ge?s._visibility&-2:s._visibility|1,ge&&(s=pl||Zi,h===null||ze||s||ml(r)),r.memoizedProps===null||r.memoizedProps.mode!=="manual"))e:for(h=null,s=r;;){if(s.tag===5||s.tag===26||s.tag===27){if(h===null){ze=h=s;try{if(M=ze.stateNode,ge)z=M.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none";else{Z=ze.stateNode,ie=ze.memoizedProps.style;var ct=ie!=null&&ie.hasOwnProperty("display")?ie.display:null;Z.style.display=ct==null||typeof ct=="boolean"?"":(""+ct).trim()}}catch(Vt){li(ze,ze.return,Vt)}}}else if(s.tag===6){if(h===null){ze=s;try{ze.stateNode.nodeValue=ge?"":ze.memoizedProps}catch(Vt){li(ze,ze.return,Vt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;h===s&&(h=null),s=s.return}h===s&&(h=null),s.sibling.return=s.return,s=s.sibling}y&4&&(y=r.updateQueue,y!==null&&(h=y.retryQueue,h!==null&&(y.retryQueue=null,gh(r,h))));break;case 19:Ba(s,r),Fa(r),y&4&&(y=r.updateQueue,y!==null&&(r.updateQueue=null,gh(r,y)));break;case 21:break;default:Ba(s,r),Fa(r)}}function Fa(r){var s=r.flags;if(s&2){try{if(r.tag!==27){e:{for(var h=r.return;h!==null;){if(em(h)){var y=h;break e}h=h.return}throw Error(x(160))}switch(y.tag){case 27:var M=y.stateNode,z=fl(r);Df(r,z,M);break;case 5:var Z=y.stateNode;y.flags&32&&(Ui(Z,""),y.flags&=-33);var ie=fl(r);Df(r,ie,Z);break;case 3:case 4:var ge=y.stateNode.containerInfo,ze=fl(r);su(r,ze,ge);break;default:throw Error(x(161))}}}catch(lt){li(r,r.return,lt)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function Lf(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;Lf(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function Tn(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Dg(r,s.alternate,s),s=s.sibling}function ml(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:dl(4,s,s.return),ml(s);break;case 1:Bn(s,s.return);var h=s.stateNode;typeof h.componentWillUnmount=="function"&&zg(s,s.return,h),ml(s);break;case 26:case 27:case 5:Bn(s,s.return),ml(s);break;case 22:Bn(s,s.return),s.memoizedState===null&&ml(s);break;default:ml(s)}r=r.sibling}}function Un(r,s,h){for(h=h&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var y=s.alternate,M=r,z=s,Z=z.flags;switch(z.tag){case 0:case 11:case 15:Un(M,z,h),bd(4,z);break;case 1:if(Un(M,z,h),y=z,M=y.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(ze){li(y,y.return,ze)}if(y=z,M=y.updateQueue,M!==null){var ie=y.stateNode;try{var ge=M.shared.hiddenCallbacks;if(ge!==null)for(M.shared.hiddenCallbacks=null,M=0;M<ge.length;M++)Jp(ge[M],ie)}catch(ze){li(y,y.return,ze)}}h&&Z&64&&jg(z),nu(z,z.return);break;case 26:case 27:case 5:Un(M,z,h),h&&y===null&&Z&4&&If(z),nu(z,z.return);break;case 12:Un(M,z,h);break;case 13:Un(M,z,h),h&&Z&4&&am(M,z);break;case 22:z.memoizedState===null&&Un(M,z,h),nu(z,z.return);break;default:Un(M,z,h)}s=s.sibling}}function lu(r,s){var h=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==h&&(r!=null&&r.refCount++,h!=null&&el(h))}function sm(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&el(r))}function gl(r,s,h,y){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)lc(r,s,h,y),s=s.sibling}function lc(r,s,h,y){var M=s.flags;switch(s.tag){case 0:case 11:case 15:gl(r,s,h,y),M&2048&&bd(9,s);break;case 3:gl(r,s,h,y),M&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&el(r)));break;case 12:if(M&2048){gl(r,s,h,y),r=s.stateNode;try{var z=s.memoizedProps,Z=z.id,ie=z.onPostCommit;typeof ie=="function"&&ie(Z,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(ge){li(s,s.return,ge)}}else gl(r,s,h,y);break;case 23:break;case 22:z=s.stateNode,s.memoizedState!==null?z._visibility&4?gl(r,s,h,y):_h(r,s):z._visibility&4?gl(r,s,h,y):(z._visibility|=4,yh(r,s,h,y,(s.subtreeFlags&10256)!==0)),M&2048&&lu(s.alternate,s);break;case 24:gl(r,s,h,y),M&2048&&sm(s.alternate,s);break;default:gl(r,s,h,y)}}function yh(r,s,h,y,M){for(M=M&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var z=r,Z=s,ie=h,ge=y,ze=Z.flags;switch(Z.tag){case 0:case 11:case 15:yh(z,Z,ie,ge,M),bd(8,Z);break;case 23:break;case 22:var lt=Z.stateNode;Z.memoizedState!==null?lt._visibility&4?yh(z,Z,ie,ge,M):_h(z,Z):(lt._visibility|=4,yh(z,Z,ie,ge,M)),M&&ze&2048&&lu(Z.alternate,Z);break;case 24:yh(z,Z,ie,ge,M),M&&ze&2048&&sm(Z.alternate,Z);break;default:yh(z,Z,ie,ge,M)}s=s.sibling}}function _h(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var h=r,y=s,M=y.flags;switch(y.tag){case 22:_h(h,y),M&2048&&lu(y.alternate,y);break;case 24:_h(h,y),M&2048&&sm(y.alternate,y);break;default:_h(h,y)}s=s.sibling}}var yl=8192;function cc(r){if(r.subtreeFlags&yl)for(r=r.child;r!==null;)om(r),r=r.sibling}function om(r){switch(r.tag){case 26:cc(r),r.flags&yl&&r.memoizedState!==null&&t(ds,r.memoizedState,r.memoizedProps);break;case 5:cc(r);break;case 3:case 4:var s=ds;ds=_u(r.stateNode.containerInfo),cc(r),ds=s;break;case 22:r.memoizedState===null&&(s=r.alternate,s!==null&&s.memoizedState!==null?(s=yl,yl=16777216,cc(r),yl=s):cc(r));break;default:cc(r)}}function lm(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function wd(r){var s=r.deletions;if(r.flags&16){if(s!==null)for(var h=0;h<s.length;h++){var y=s[h];xa=y,Lg(y,r)}lm(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Ng(r),r=r.sibling}function Ng(r){switch(r.tag){case 0:case 11:case 15:wd(r),r.flags&2048&&dl(9,r,r.return);break;case 3:wd(r);break;case 12:wd(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&4&&(r.return===null||r.return.tag!==13)?(s._visibility&=-5,Of(r)):wd(r);break;default:wd(r)}}function Of(r){var s=r.deletions;if(r.flags&16){if(s!==null)for(var h=0;h<s.length;h++){var y=s[h];xa=y,Lg(y,r)}lm(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:dl(8,s,s.return),Of(s);break;case 22:h=s.stateNode,h._visibility&4&&(h._visibility&=-5,Of(s));break;default:Of(s)}r=r.sibling}}function Lg(r,s){for(;xa!==null;){var h=xa;switch(h.tag){case 0:case 11:case 15:dl(8,h,s);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var y=h.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:el(h.memoizedState.cache)}if(y=h.child,y!==null)y.return=h,xa=y;else e:for(h=r;xa!==null;){y=xa;var M=y.sibling,z=y.return;if(im(y),y===h){xa=null;break e}if(M!==null){M.return=z,xa=M;break e}xa=z}}}function m_(r,s,h,y){this.tag=r,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mn(r,s,h,y){return new m_(r,s,h,y)}function Bf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function yo(r,s){var h=r.alternate;return h===null?(h=Mn(r.tag,s,r.key,r.mode),h.elementType=r.elementType,h.type=r.type,h.stateNode=r.stateNode,h.alternate=r,r.alternate=h):(h.pendingProps=s,h.type=r.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=r.flags&31457280,h.childLanes=r.childLanes,h.lanes=r.lanes,h.child=r.child,h.memoizedProps=r.memoizedProps,h.memoizedState=r.memoizedState,h.updateQueue=r.updateQueue,s=r.dependencies,h.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},h.sibling=r.sibling,h.index=r.index,h.ref=r.ref,h.refCleanup=r.refCleanup,h}function cm(r,s){r.flags&=31457282;var h=r.alternate;return h===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=h.childLanes,r.lanes=h.lanes,r.child=h.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=h.memoizedProps,r.memoizedState=h.memoizedState,r.updateQueue=h.updateQueue,r.type=h.type,s=h.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function vh(r,s,h,y,M,z){var Z=0;if(y=r,typeof r=="function")Bf(r)&&(Z=1);else if(typeof r=="string")Z=Om(r,h,vi.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case B:return uc(h.children,M,z,s);case V:Z=8,M|=24;break;case X:return r=Mn(12,h,s,M|2),r.elementType=X,r.lanes=z,r;case be:return r=Mn(13,h,s,M),r.elementType=be,r.lanes=z,r;case Ee:return r=Mn(19,h,s,M),r.elementType=Ee,r.lanes=z,r;case tt:return um(h,M,z,s);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case ne:case ee:Z=10;break e;case re:Z=9;break e;case te:Z=11;break e;case Ae:Z=14;break e;case Ie:Z=16,y=null;break e}Z=29,h=Error(x(130,r===null?"null":typeof r,"")),y=null}return s=Mn(Z,h,s,M),s.elementType=r,s.type=y,s.lanes=z,s}function uc(r,s,h,y){return r=Mn(7,r,y,s),r.lanes=h,r}function um(r,s,h,y){r=Mn(22,r,y,s),r.elementType=tt,r.lanes=h;var M={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var z=M._current;if(z===null)throw Error(x(456));if(!(M._pendingVisibility&2)){var Z=Ya(z,2);Z!==null&&(M._pendingVisibility|=2,rn(Z,z,2))}},attach:function(){var z=M._current;if(z===null)throw Error(x(456));if(M._pendingVisibility&2){var Z=Ya(z,2);Z!==null&&(M._pendingVisibility&=-3,rn(Z,z,2))}}};return r.stateNode=M,r}function xh(r,s,h){return r=Mn(6,r,null,s),r.lanes=h,r}function Ff(r,s,h){return s=Mn(4,r.children!==null?r.children:[],r.key,s),s.lanes=h,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}function _o(r){r.flags|=4}function hm(r,s){if(s.type!=="stylesheet"||s.state.loading&4)r.flags&=-16777217;else if(r.flags|=16777216,!hp(s)){if(s=ca.current,s!==null&&((Mr&4194176)===Mr?bn!==null:(Mr&62914560)!==Mr&&!(Mr&536870912)||s!==bn))throw zs=di,Ql;r.flags|=8192}}function hc(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?Tt():536870912,r.lanes|=s,cu|=s)}function Sd(r,s){if(!kr)switch(r.tailMode){case"hidden":s=r.tail;for(var h=null;s!==null;)s.alternate!==null&&(h=s),s=s.sibling;h===null?r.tail=null:h.sibling=null;break;case"collapsed":h=r.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:y.sibling=null}}function Si(r){var s=r.alternate!==null&&r.alternate.child===r.child,h=0,y=0;if(s)for(var M=r.child;M!==null;)h|=M.lanes|M.childLanes,y|=M.subtreeFlags&31457280,y|=M.flags&31457280,M.return=r,M=M.sibling;else for(M=r.child;M!==null;)h|=M.lanes|M.childLanes,y|=M.subtreeFlags,y|=M.flags,M.return=r,M=M.sibling;return r.subtreeFlags|=y,r.childLanes=h,s}function Td(r,s,h){var y=s.pendingProps;switch(Yo(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Si(s),null;case 1:return Si(s),null;case 3:return h=s.stateNode,y=null,r!==null&&(y=r.memoizedState.cache),s.memoizedState.cache!==y&&(s.flags|=2048),mo(Ai),Ga(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Yl(s)?_o(s):r===null||r.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Ca!==null&&(Ad(Ca),Ca=null))),Si(s),null;case 26:return h=s.memoizedState,r===null?(_o(s),h!==null?(Si(s),hm(s,h)):(Si(s),s.flags&=-16777217)):h?h!==r.memoizedState?(_o(s),Si(s),hm(s,h)):(Si(s),s.flags&=-16777217):(r.memoizedProps!==y&&_o(s),Si(s),s.flags&=-16777217),null;case 27:Gs(s),h=hi.current;var M=s.type;if(r!==null&&s.stateNode!=null)r.memoizedProps!==y&&_o(s);else{if(!y){if(s.stateNode===null)throw Error(x(166));return Si(s),null}r=vi.current,Yl(s)?ih(s):(r=Vd(M,y,h),s.stateNode=r,_o(s))}return Si(s),null;case 5:if(Gs(s),h=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==y&&_o(s);else{if(!y){if(s.stateNode===null)throw Error(x(166));return Si(s),null}if(r=vi.current,Yl(s))ih(s);else{switch(M=Ud(hi.current),r){case 1:r=M.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:r=M.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":r=M.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":r=M.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":r=M.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof y.is=="string"?M.createElement("select",{is:y.is}):M.createElement("select"),y.multiple?r.multiple=!0:y.size&&(r.size=y.size);break;default:r=typeof y.is=="string"?M.createElement(h,{is:y.is}):M.createElement(h)}}r[rt]=s,r[Rt]=y;e:for(M=s.child;M!==null;){if(M.tag===5||M.tag===6)r.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===s)break e;for(;M.sibling===null;){if(M.return===null||M.return===s)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}s.stateNode=r;e:switch(ba(r,h,y),h){case"button":case"input":case"select":case"textarea":r=!!y.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&_o(s)}}return Si(s),s.flags&=-16777217,null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==y&&_o(s);else{if(typeof y!="string"&&s.stateNode===null)throw Error(x(166));if(r=hi.current,Yl(s)){if(r=s.stateNode,h=s.memoizedProps,y=null,M=Xi,M!==null)switch(M.tag){case 27:case 5:y=M.memoizedProps}r[rt]=s,r=!!(r.nodeValue===h||y!==null&&y.suppressHydrationWarning===!0||Em(r.nodeValue,h)),r||ss(s)}else r=Ud(r).createTextNode(y),r[rt]=s,s.stateNode=r}return Si(s),null;case 13:if(y=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(M=Yl(s),y!==null&&y.dehydrated!==null){if(r===null){if(!M)throw Error(x(318));if(M=s.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(x(317));M[rt]=s}else io(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Si(s),M=!1}else Ca!==null&&(Ad(Ca),Ca=null),M=!0;if(!M)return s.flags&256?(os(s),s):(os(s),null)}if(os(s),s.flags&128)return s.lanes=h,s;if(h=y!==null,r=r!==null&&r.memoizedState!==null,h){y=s.child,M=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(M=y.alternate.memoizedState.cachePool.pool);var z=null;y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(z=y.memoizedState.cachePool.pool),z!==M&&(y.flags|=2048)}return h!==r&&h&&(s.child.flags|=8192),hc(s,s.updateQueue),Si(s),null;case 4:return Ga(),r===null&&Tm(s.stateNode.containerInfo),Si(s),null;case 10:return mo(s.type),Si(s),null;case 19:if($r(Pr),M=s.memoizedState,M===null)return Si(s),null;if(y=(s.flags&128)!==0,z=M.rendering,z===null)if(y)Sd(M,!1);else{if($i!==0||r!==null&&r.flags&128)for(r=s.child;r!==null;){if(z=Na(r),z!==null){for(s.flags|=128,Sd(M,!1),r=z.updateQueue,s.updateQueue=r,hc(s,r),s.subtreeFlags=0,r=h,h=s.child;h!==null;)cm(h,r),h=h.sibling;return Br(Pr,Pr.current&1|2),s.child}r=r.sibling}M.tail!==null&&Ji()>qf&&(s.flags|=128,y=!0,Sd(M,!1),s.lanes=4194304)}else{if(!y)if(r=Na(z),r!==null){if(s.flags|=128,y=!0,r=r.updateQueue,s.updateQueue=r,hc(s,r),Sd(M,!0),M.tail===null&&M.tailMode==="hidden"&&!z.alternate&&!kr)return Si(s),null}else 2*Ji()-M.renderingStartTime>qf&&h!==536870912&&(s.flags|=128,y=!0,Sd(M,!1),s.lanes=4194304);M.isBackwards?(z.sibling=s.child,s.child=z):(r=M.last,r!==null?r.sibling=z:s.child=z,M.last=z)}return M.tail!==null?(s=M.tail,M.rendering=s,M.tail=s.sibling,M.renderingStartTime=Ji(),s.sibling=null,r=Pr.current,Br(Pr,y?r&1|2:r&1),s):(Si(s),null);case 22:case 23:return os(s),lh(),y=s.memoizedState!==null,r!==null?r.memoizedState!==null!==y&&(s.flags|=8192):y&&(s.flags|=8192),y?h&536870912&&!(s.flags&128)&&(Si(s),s.subtreeFlags&6&&(s.flags|=8192)):Si(s),h=s.updateQueue,h!==null&&hc(s,h.retryQueue),h=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),y=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(y=s.memoizedState.cachePool.pool),y!==h&&(s.flags|=2048),r!==null&&$r(wn),null;case 24:return h=null,r!==null&&(h=r.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),mo(Ai),Si(s),null;case 25:return null}throw Error(x(156,s.tag))}function dm(r,s){switch(Yo(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return mo(Ai),Ga(),r=s.flags,r&65536&&!(r&128)?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return Gs(s),null;case 13:if(os(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(x(340));io()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return $r(Pr),null;case 4:return Ga(),null;case 10:return mo(s.type),null;case 22:case 23:return os(s),lh(),r!==null&&$r(wn),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return mo(Ai),null;case 25:return null;default:return null}}function Og(r,s){switch(Yo(s),s.tag){case 3:mo(Ai),Ga();break;case 26:case 27:case 5:Gs(s);break;case 4:Ga();break;case 13:os(s);break;case 19:$r(Pr);break;case 10:mo(s.type);break;case 22:case 23:os(s),lh(),r!==null&&$r(wn);break;case 24:mo(Ai)}}var g_={getCacheForType:function(r){var s=Pa(Ai),h=s.data.get(r);return h===void 0&&(h=r(),s.data.set(r,h)),h}},Bg=typeof WeakMap=="function"?WeakMap:Map,Pi=0,gi=null,Cr=null,Mr=0,oi=0,Vn=null,_l=!1,bh=!1,fm=!1,vl=0,$i=0,xl=0,bl=0,Uf=0,qn=0,cu=0,Md=null,Zn=null,pm=!1,Vf=0,qf=1/0,Zf=null,dc=null,Ed=!1,uu=null,Cd=0,hu=0,$f=null,du=0,Gf=null;function Lr(){if(Pi&2&&Mr!==0)return Mr&-Mr;if(at.T!==null){var r=In;return r!==0?r:Dd()}return fr()}function Hf(){qn===0&&(qn=!(Mr&536870912)||kr?ht():536870912);var r=ca.current;return r!==null&&(r.flags|=32),qn}function rn(r,s,h){(r===gi&&oi===2||r.cancelPendingCommit!==null)&&(fu(r,0),wl(r,Mr,qn,!1)),Bt(r,h),(!(Pi&2)||r!==gi)&&(r===gi&&(!(Pi&2)&&(bl|=h),$i===4&&wl(r,Mr,qn,!1)),fs(r))}function mm(r,s,h){if(Pi&6)throw Error(x(327));var y=!h&&(s&60)===0&&(s&r.expiredLanes)===0||Ze(r,s),M=y?Sh(r,s):wh(r,s,!0),z=y;do{if(M===0){bh&&!y&&wl(r,s,0,!1);break}else if(M===6)wl(r,s,0,!_l);else{if(h=r.current.alternate,z&&!y_(h)){M=wh(r,s,!1),z=!1;continue}if(M===2){if(z=s,r.errorRecoveryDisabledLanes&z)var Z=0;else Z=r.pendingLanes&-536870913,Z=Z!==0?Z:Z&536870912?536870912:0;if(Z!==0){s=Z;e:{var ie=r;M=Md;var ge=ie.current.memoizedState.isDehydrated;if(ge&&(fu(ie,Z).flags|=256),Z=wh(ie,Z,!1),Z!==2){if(fm&&!ge){ie.errorRecoveryDisabledLanes|=z,bl|=z,M=4;break e}z=Zn,Zn=M,z!==null&&Ad(z)}M=Z}if(z=!1,M!==2)continue}}if(M===1){fu(r,0),wl(r,s,0,!0);break}e:{switch(y=r,M){case 0:case 1:throw Error(x(345));case 4:if((s&4194176)===s){wl(y,s,qn,!_l);break e}break;case 2:Zn=null;break;case 3:case 5:break;default:throw Error(x(329))}if(y.finishedWork=h,y.finishedLanes=s,(s&62914560)===s&&(z=Vf+300-Ji(),10<z)){if(wl(y,s,qn,!_l),Le(y,0)!==0)break e;y.timeoutHandle=km(Wf.bind(null,y,h,Zn,Zf,pm,s,qn,bl,cu,_l,2,-0,0),z);break e}Wf(y,h,Zn,Zf,pm,s,qn,bl,cu,_l,0,-0,0)}}break}while(!0);fs(r)}function Ad(r){Zn===null?Zn=r:Zn.push.apply(Zn,r)}function Wf(r,s,h,y,M,z,Z,ie,ge,ze,lt,bt,We){var ct=s.subtreeFlags;if((ct&8192||(ct&16785408)===16785408)&&(Gd={stylesheets:null,count:0,unsuspend:n},om(s),s=a(),s!==null)){r.cancelPendingCommit=s(Ug.bind(null,r,h,y,M,Z,ie,ge,1,bt,We)),wl(r,z,Z,!ze);return}Ug(r,h,y,M,Z,ie,ge,lt,bt,We)}function y_(r){for(var s=r;;){var h=s.tag;if((h===0||h===11||h===15)&&s.flags&16384&&(h=s.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var y=0;y<h.length;y++){var M=h[y],z=M.getSnapshot;M=M.value;try{if(!Da(z(),M))return!1}catch{return!1}}if(h=s.child,s.subtreeFlags&16384&&h!==null)h.return=s,s=h;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function wl(r,s,h,y){s&=~Uf,s&=~bl,r.suspendedLanes|=s,r.pingedLanes&=~s,y&&(r.warmLanes|=s),y=r.expirationTimes;for(var M=s;0<M;){var z=31-J(M),Z=1<<z;y[z]=-1,M&=~Z}h!==0&&Xt(r,h,s)}function Xf(){return Pi&6?!0:(Id(0),!1)}function gm(){if(Cr!==null){if(oi===0)var r=Cr.return;else r=Cr,Bs=ru=null,fd(r),Aa=null,Ko=0,r=Cr;for(;r!==null;)Og(r.alternate,r),r=r.return;Cr=null}}function fu(r,s){r.finishedWork=null,r.finishedLanes=0;var h=r.timeoutHandle;h!==-1&&(r.timeoutHandle=-1,yc(h)),h=r.cancelPendingCommit,h!==null&&(r.cancelPendingCommit=null,h()),gm(),gi=r,Cr=h=yo(r.current,null),Mr=s,oi=0,Vn=null,_l=!1,bh=Ze(r,s),fm=!1,cu=qn=Uf=bl=xl=$i=0,Zn=Md=null,pm=!1,s&8&&(s|=s&32);var y=r.entangledLanes;if(y!==0)for(r=r.entanglements,y&=s;0<y;){var M=31-J(y),z=1<<M;s|=r[M],y&=~z}return vl=s,Ho(),h}function Ua(r,s){gr=null,at.H=Tr,s===Kl?(s=nh(),oi=3):s===Ql?(s=nh(),oi=4):oi=s===_a?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Vn=s,Cr===null&&($i=1,ya(r,Ea(s,r.current)))}function Yf(){var r=at.H;return at.H=Tr,r===null?Tr:r}function ym(){var r=at.A;return at.A=g_,r}function vo(){$i=4,_l||(Mr&4194176)!==Mr&&ca.current!==null||(bh=!0),!(xl&134217727)&&!(bl&134217727)||gi===null||wl(gi,Mr,qn,!1)}function wh(r,s,h){var y=Pi;Pi|=2;var M=Yf(),z=ym();(gi!==r||Mr!==s)&&(Zf=null,fu(r,s)),s=!1;var Z=$i;e:do try{if(oi!==0&&Cr!==null){var ie=Cr,ge=Vn;switch(oi){case 8:gm(),Z=6;break e;case 3:case 2:case 6:ca.current===null&&(s=!0);var ze=oi;if(oi=0,Vn=null,Th(r,ie,ge,ze),h&&bh){Z=0;break e}break;default:ze=oi,oi=0,Vn=null,Th(r,ie,ge,ze)}}kd(),Z=$i;break}catch(lt){Ua(r,lt)}while(!0);return s&&r.shellSuspendCounter++,Bs=ru=null,Pi=y,at.H=M,at.A=z,Cr===null&&(gi=null,Mr=0,Ho()),Z}function kd(){for(;Cr!==null;)Pd(Cr)}function Sh(r,s){var h=Pi;Pi|=2;var y=Yf(),M=ym();gi!==r||Mr!==s?(Zf=null,qf=Ji()+500,fu(r,s)):bh=Ze(r,s);e:do try{if(oi!==0&&Cr!==null){s=Cr;var z=Vn;t:switch(oi){case 1:oi=0,Vn=null,Th(r,s,z,1);break;case 2:if(js(z)){oi=0,Vn=null,Fg(s);break}s=function(){oi===2&&gi===r&&(oi=7),fs(r)},z.then(s,s);break e;case 3:oi=7;break e;case 4:oi=5;break e;case 7:js(z)?(oi=0,Vn=null,Fg(s)):(oi=0,Vn=null,Th(r,s,z,7));break;case 5:var Z=null;switch(Cr.tag){case 26:Z=Cr.memoizedState;case 5:case 27:var ie=Cr;if(!Z||hp(Z)){oi=0,Vn=null;var ge=ie.sibling;if(ge!==null)Cr=ge;else{var ze=ie.return;ze!==null?(Cr=ze,jd(ze)):Cr=null}break t}}oi=0,Vn=null,Th(r,s,z,5);break;case 6:oi=0,Vn=null,Th(r,s,z,6);break;case 8:gm(),$i=6;break e;default:throw Error(x(462))}}Kf();break}catch(lt){Ua(r,lt)}while(!0);return Bs=ru=null,at.H=y,at.A=M,Pi=h,Cr!==null?0:(gi=null,Mr=0,Ho(),$i)}function Kf(){for(;Cr!==null&&!Co();)Pd(Cr)}function Pd(r){var s=kg(r.alternate,r,vl);r.memoizedProps=r.pendingProps,s===null?jd(r):Cr=s}function Fg(r){var s=r,h=s.alternate;switch(s.tag){case 15:case 0:s=tn(h,s,s.pendingProps,s.type,void 0,Mr);break;case 11:s=tn(h,s,s.pendingProps,s.type.render,s.ref,Mr);break;case 5:fd(s);default:Og(h,s),s=Cr=cm(s,vl),s=kg(h,s,vl)}r.memoizedProps=r.pendingProps,s===null?jd(r):Cr=s}function Th(r,s,h,y){Bs=ru=null,fd(s),Aa=null,Ko=0;var M=s.return;try{if(Vi(r,M,s,h,Mr)){$i=1,ya(r,Ea(h,r.current)),Cr=null;return}}catch(z){if(M!==null)throw Cr=M,z;$i=1,ya(r,Ea(h,r.current)),Cr=null;return}s.flags&32768?(kr||y===1?r=!0:bh||Mr&536870912?r=!1:(_l=r=!0,(y===2||y===3||y===6)&&(y=ca.current,y!==null&&y.tag===13&&(y.flags|=16384))),_m(s,r)):jd(s)}function jd(r){var s=r;do{if(s.flags&32768){_m(s,_l);return}r=s.return;var h=Td(s.alternate,s,vl);if(h!==null){Cr=h;return}if(s=s.sibling,s!==null){Cr=s;return}Cr=s=r}while(s!==null);$i===0&&($i=5)}function _m(r,s){do{var h=dm(r.alternate,r);if(h!==null){h.flags&=32767,Cr=h;return}if(h=r.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!s&&(r=r.sibling,r!==null)){Cr=r;return}Cr=r=h}while(r!==null);$i=6,Cr=null}function Ug(r,s,h,y,M,z,Z,ie,ge,ze){var lt=at.T,bt=Et.p;try{Et.p=2,at.T=null,Vg(r,s,h,y,bt,M,z,Z,ie,ge,ze)}finally{at.T=lt,Et.p=bt}}function Vg(r,s,h,y,M,z,Z,ie){do fc();while(uu!==null);if(Pi&6)throw Error(x(327));var ge=r.finishedWork;if(y=r.finishedLanes,ge===null)return null;if(r.finishedWork=null,r.finishedLanes=0,ge===r.current)throw Error(x(177));r.callbackNode=null,r.callbackPriority=0,r.cancelPendingCommit=null;var ze=ge.lanes|ge.childLanes;if(ze|=Go,ar(r,y,ze,z,Z,ie),r===gi&&(Cr=gi=null,Mr=0),!(ge.subtreeFlags&10256)&&!(ge.flags&10256)||Ed||(Ed=!0,hu=ze,$f=h,b_(cn,function(){return fc(),null})),h=(ge.flags&15990)!==0,ge.subtreeFlags&15990||h?(h=at.T,at.T=null,z=Et.p,Et.p=2,Z=Pi,Pi|=4,rm(r,ge),nm(ge,r),td(np,r.containerInfo),K=!!gc,np=gc=null,r.current=ge,Dg(r,ge.alternate,ge),Ao(),Pi=Z,Et.p=z,at.T=h):r.current=ge,Ed?(Ed=!1,uu=r,Cd=y):vm(r,ze),ze=r.pendingLanes,ze===0&&(dc=null),Re(ge.stateNode),fs(r),s!==null)for(M=r.onRecoverableError,ge=0;ge<s.length;ge++)ze=s[ge],M(ze.value,{componentStack:ze.stack});return Cd&3&&fc(),ze=r.pendingLanes,y&4194218&&ze&42?r===Gf?du++:(du=0,Gf=r):du=0,Id(0),null}function vm(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,el(s)))}function fc(){if(uu!==null){var r=uu,s=hu;hu=0;var h=jr(Cd),y=at.T,M=Et.p;try{if(Et.p=32>h?32:h,at.T=null,uu===null)var z=!1;else{h=$f,$f=null;var Z=uu,ie=Cd;if(uu=null,Cd=0,Pi&6)throw Error(x(331));var ge=Pi;if(Pi|=4,Ng(Z.current),lc(Z,Z.current,ie,h),Pi=ge,Id(0,!1),Mi&&typeof Mi.onPostCommitFiberRoot=="function")try{Mi.onPostCommitFiberRoot(ea,Z)}catch{}z=!0}return z}finally{Et.p=M,at.T=y,vm(r,s)}}return!1}function Qf(r,s,h){s=Ea(h,s),s=On(r.stateNode,s,2),r=oc(r,s,2),r!==null&&(Bt(r,2),fs(r))}function li(r,s,h){if(r.tag===3)Qf(r,r,h);else for(;s!==null;){if(s.tag===3){Qf(s,r,h);break}else if(s.tag===1){var y=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(dc===null||!dc.has(y))){r=Ea(h,r),h=Os(2),y=oc(s,h,2),y!==null&&(Oi(h,y,s,r),Bt(y,2),fs(y));break}}s=s.return}}function Jf(r,s,h){var y=r.pingCache;if(y===null){y=r.pingCache=new Bg;var M=new Set;y.set(s,M)}else M=y.get(s),M===void 0&&(M=new Set,y.set(s,M));M.has(h)||(fm=!0,M.add(h),r=__.bind(null,r,s,h),s.then(r,r))}function __(r,s,h){var y=r.pingCache;y!==null&&y.delete(s),r.pingedLanes|=r.suspendedLanes&h,r.warmLanes&=~h,gi===r&&(Mr&h)===h&&($i===4||$i===3&&(Mr&62914560)===Mr&&300>Ji()-Vf?!(Pi&2)&&fu(r,0):Uf|=h,cu===Mr&&(cu=0)),fs(r)}function qg(r,s){s===0&&(s=Tt()),r=Ya(r,s),r!==null&&(Bt(r,s),fs(r))}function v_(r){var s=r.memoizedState,h=0;s!==null&&(h=s.retryLane),qg(r,h)}function x_(r,s){var h=0;switch(r.tag){case 13:var y=r.stateNode,M=r.memoizedState;M!==null&&(h=M.retryLane);break;case 19:y=r.stateNode;break;case 22:y=r.stateNode._retryCache;break;default:throw Error(x(314))}y!==null&&y.delete(s),qg(r,h)}function b_(r,s){return Sa(r,s)}var zd=null,pu=null,mu=!1,$n=!1,xo=!1,pc=0;function fs(r){r!==pu&&r.next===null&&(pu===null?zd=pu=r:pu=pu.next=r),$n=!0,mu||(mu=!0,xm(w_))}function Id(r,s){if(!xo&&$n){xo=!0;do for(var h=!1,y=zd;y!==null;){if(r!==0){var M=y.pendingLanes;if(M===0)var z=0;else{var Z=y.suspendedLanes,ie=y.pingedLanes;z=(1<<31-J(42|r)+1)-1,z&=M&~(Z&~ie),z=z&201326677?z&201326677|1:z?z|2:0}z!==0&&(h=!0,Zg(y,z))}else z=Mr,z=Le(y,y===gi?z:0),!(z&3)||Ze(y,z)||(h=!0,Zg(y,z));y=y.next}while(h);xo=!1}}function w_(){$n=mu=!1;var r=0;pc!==0&&(T_()&&(r=pc),pc=0);for(var s=Ji(),h=null,y=zd;y!==null;){var M=y.next,z=Rd(y,s);z===0?(y.next=null,h===null?zd=M:h.next=M,M===null&&(pu=h)):(h=y,(r!==0||z&3)&&($n=!0)),y=M}Id(r)}function Rd(r,s){for(var h=r.suspendedLanes,y=r.pingedLanes,M=r.expirationTimes,z=r.pendingLanes&-62914561;0<z;){var Z=31-J(z),ie=1<<Z,ge=M[Z];ge===-1?(!(ie&h)||ie&y)&&(M[Z]=Ne(ie,s)):ge<=s&&(r.expiredLanes|=ie),z&=~ie}if(s=gi,h=Mr,h=Le(r,r===s?h:0),y=r.callbackNode,h===0||r===s&&oi===2||r.cancelPendingCommit!==null)return y!==null&&y!==null&&ln(y),r.callbackNode=null,r.callbackPriority=0;if(!(h&3)||Ze(r,h)){if(s=h&-h,s===r.callbackPriority)return s;switch(y!==null&&ln(y),jr(h)){case 2:case 8:h=Po;break;case 32:h=cn;break;case 268435456:h=Ss;break;default:h=cn}return y=ep.bind(null,r),h=Sa(h,y),r.callbackPriority=s,r.callbackNode=h,s}return y!==null&&y!==null&&ln(y),r.callbackPriority=2,r.callbackNode=null,2}function ep(r,s){var h=r.callbackNode;if(fc()&&r.callbackNode!==h)return null;var y=Mr;return y=Le(r,r===gi?y:0),y===0?null:(mm(r,y,s),Rd(r,Ji()),r.callbackNode!=null&&r.callbackNode===h?ep.bind(null,r):null)}function Zg(r,s){if(fc())return null;mm(r,s,!0)}function xm(r){Yg(function(){Pi&6?Sa(ko,r):r()})}function Dd(){return pc===0&&(pc=ht()),pc}function gu(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Hs(""+r)}function bm(r,s){var h=s.ownerDocument.createElement("input");return h.name=s.name,h.value=s.value,r.id&&h.setAttribute("form",r.id),s.parentNode.insertBefore(h,s),r=new FormData(r),h.parentNode.removeChild(h),r}function $g(r,s,h,y,M){if(s==="submit"&&h&&h.stateNode===M){var z=gu((M[Rt]||null).action),Z=y.submitter;Z&&(s=(s=Z[Rt]||null)?gu(s.formAction):Z.getAttribute("formAction"),s!==null&&(z=s,Z=null));var ie=new Ol("action","action",null,y,M);r.push({event:ie,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(pc!==0){var ge=Z?bm(M,Z):new FormData(M);et(h,{pending:!0,data:ge,method:M.method,action:z},null,ge)}}else typeof z=="function"&&(ie.preventDefault(),ge=Z?bm(M,Z):new FormData(M),et(h,{pending:!0,data:ge,method:M.method,action:z},z,ge))},currentTarget:M}]})}}for(var Nd=0;Nd<Ju.length;Nd++){var tp=Ju[Nd],rp=tp.toLowerCase(),Gg=tp[0].toUpperCase()+tp.slice(1);la(rp,"on"+Gg)}la(qc,"onAnimationEnd"),la(Ku,"onAnimationIteration"),la(eo,"onAnimationStart"),la("dblclick","onDoubleClick"),la("focusin","onFocus"),la("focusout","onBlur"),la(Qu,"onTransitionRun"),la(Xl,"onTransitionStart"),la(yn,"onTransitionCancel"),la(ad,"onTransitionEnd"),kn("onMouseEnter",["mouseout","mouseover"]),kn("onMouseLeave",["mouseout","mouseover"]),kn("onPointerEnter",["pointerout","pointerover"]),kn("onPointerLeave",["pointerout","pointerover"]),An("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),An("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),An("onBeforeInput",["compositionend","keypress","textInput","paste"]),An("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),An("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),An("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ld="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),S_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ld));function wm(r,s){s=(s&4)!==0;for(var h=0;h<r.length;h++){var y=r[h],M=y.event;y=y.listeners;e:{var z=void 0;if(s)for(var Z=y.length-1;0<=Z;Z--){var ie=y[Z],ge=ie.instance,ze=ie.currentTarget;if(ie=ie.listener,ge!==z&&M.isPropagationStopped())break e;z=ie,M.currentTarget=ze;try{z(M)}catch(lt){cs(lt)}M.currentTarget=null,z=ge}else for(Z=0;Z<y.length;Z++){if(ie=y[Z],ge=ie.instance,ze=ie.currentTarget,ie=ie.listener,ge!==z&&M.isPropagationStopped())break e;z=ie,M.currentTarget=ze;try{z(M)}catch(lt){cs(lt)}M.currentTarget=null,z=ge}}}}function zr(r,s){var h=s[ii];h===void 0&&(h=s[ii]=new Set);var y=r+"__bubble";h.has(y)||(Hg(s,r,2,!1),h.add(y))}function Sm(r,s,h){var y=0;s&&(y|=4),Hg(h,r,y,s)}var ip="_reactListening"+Math.random().toString(36).slice(2);function Tm(r){if(!r[ip]){r[ip]=!0,Ra.forEach(function(h){h!=="selectionchange"&&(S_.has(h)||Sm(h,!1,r),Sm(h,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[ip]||(s[ip]=!0,Sm("selectionchange",!1,s))}}function Hg(r,s,h,y){switch(_e(s)){case 2:var M=se;break;case 8:M=fe;break;default:M=Me}h=M.bind(null,s,h,r),M=void 0,!Ta||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(M=!0),y?M!==void 0?r.addEventListener(s,h,{capture:!0,passive:M}):r.addEventListener(s,h,!0):M!==void 0?r.addEventListener(s,h,{passive:M}):r.addEventListener(s,h,!1)}function Od(r,s,h,y,M){var z=y;if(!(s&1)&&!(s&2)&&y!==null)e:for(;;){if(y===null)return;var Z=y.tag;if(Z===3||Z===4){var ie=y.stateNode.containerInfo;if(ie===M||ie.nodeType===8&&ie.parentNode===M)break;if(Z===4)for(Z=y.return;Z!==null;){var ge=Z.tag;if((ge===3||ge===4)&&(ge=Z.stateNode.containerInfo,ge===M||ge.nodeType===8&&ge.parentNode===M))return;Z=Z.return}for(;ie!==null;){if(Z=Ha(ie),Z===null)return;if(ge=Z.tag,ge===5||ge===6||ge===26||ge===27){y=z=Z;continue e}ie=ie.parentNode}}y=y.return}Ro(function(){var ze=z,lt=pa(h),bt=[];e:{var We=nd.get(r);if(We!==void 0){var ct=Ol,Vt=r;switch(r){case"keypress":if(Jt(h)===0)break e;case"keydown":case"keyup":ct=Zo;break;case"focusin":Vt="focus",ct=Uo;break;case"focusout":Vt="blur",ct=Uo;break;case"beforeblur":case"afterblur":ct=Uo;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ct=Bl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ct=ia;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ct=qp;break;case qc:case Ku:case eo:ct=aa;break;case ad:ct=$p;break;case"scroll":case"scrollend":ct=Lc;break;case"wheel":ct=Fl;break;case"copy":case"cut":case"paste":ct=Bu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ct=pf;break;case"toggle":case"beforetoggle":ct=qu}var ir=(s&4)!==0,ci=!ir&&(r==="scroll"||r==="scrollend"),Oe=ir?We!==null?We+"Capture":null:We;ir=[];for(var je=ze,$e;je!==null;){var pt=je;if($e=pt.stateNode,pt=pt.tag,pt!==5&&pt!==26&&pt!==27||$e===null||Oe===null||(pt=Wi(je,Oe),pt!=null&&ir.push(ps(je,pt,$e))),ci)break;je=je.return}0<ir.length&&(We=new ct(We,Vt,null,h,lt),bt.push({event:We,listeners:ir}))}}if(!(s&7)){e:{if(We=r==="mouseover"||r==="pointerover",ct=r==="mouseout"||r==="pointerout",We&&h!==Ws&&(Vt=h.relatedTarget||h.fromElement)&&(Ha(Vt)||Vt[Qt]))break e;if((ct||We)&&(We=lt.window===lt?lt:(We=lt.ownerDocument)?We.defaultView||We.parentWindow:window,ct?(Vt=h.relatedTarget||h.toElement,ct=ze,Vt=Vt?Ha(Vt):null,Vt!==null&&(ci=Je(Vt),ir=Vt.tag,Vt!==ci||ir!==5&&ir!==27&&ir!==6)&&(Vt=null)):(ct=null,Vt=ze),ct!==Vt)){if(ir=Bl,pt="onMouseLeave",Oe="onMouseEnter",je="mouse",(r==="pointerout"||r==="pointerover")&&(ir=pf,pt="onPointerLeave",Oe="onPointerEnter",je="pointer"),ci=ct==null?We:Wa(ct),$e=Vt==null?We:Wa(Vt),We=new ir(pt,je+"leave",ct,h,lt),We.target=ci,We.relatedTarget=$e,pt=null,Ha(lt)===ze&&(ir=new ir(Oe,je+"enter",Vt,h,lt),ir.target=$e,ir.relatedTarget=ci,pt=ir),ci=pt,ct&&Vt)t:{for(ir=ct,Oe=Vt,je=0,$e=ir;$e;$e=yu($e))je++;for($e=0,pt=Oe;pt;pt=yu(pt))$e++;for(;0<je-$e;)ir=yu(ir),je--;for(;0<$e-je;)Oe=yu(Oe),$e--;for(;je--;){if(ir===Oe||Oe!==null&&ir===Oe.alternate)break t;ir=yu(ir),Oe=yu(Oe)}ir=null}else ir=null;ct!==null&&Mm(bt,We,ct,ir,!1),Vt!==null&&ci!==null&&Mm(bt,ci,Vt,ir,!0)}}e:{if(We=ze?Wa(ze):window,ct=We.nodeName&&We.nodeName.toLowerCase(),ct==="select"||ct==="input"&&We.type==="file")var Ft=As;else if(Yh(We))if(Kh)Ft=bf;else{Ft=Jh;var xr=Hp}else ct=We.nodeName,!ct||ct.toLowerCase()!=="input"||We.type!=="checkbox"&&We.type!=="radio"?ze&&Es(ze.elementType)&&(Ft=As):Ft=xf;if(Ft&&(Ft=Ft(r,ze))){Zl(bt,Ft,h,lt);break e}xr&&xr(r,We,ze),r==="focusout"&&ze&&We.type==="number"&&ze.memoizedProps.value!=null&&Gh(We,"number",We.value)}switch(xr=ze?Wa(ze):window,r){case"focusin":(Yh(xr)||xr.contentEditable==="true")&&(Qs=xr,rd=ze,Uc=null);break;case"focusout":Uc=rd=Qs=null;break;case"mousedown":id=!0;break;case"contextmenu":case"mouseup":case"dragend":id=!1,wf(bt,h,lt);break;case"selectionchange":if($o)break;case"keydown":case"keyup":wf(bt,h,lt)}var qt;if(mn)e:{switch(r){case"compositionstart":var tr="onCompositionStart";break e;case"compositionend":tr="onCompositionEnd";break e;case"compositionupdate":tr="onCompositionUpdate";break e}tr=void 0}else gn?Bc(r,h)&&(tr="onCompositionEnd"):r==="keydown"&&h.keyCode===229&&(tr="onCompositionStart");tr&&(Vl&&h.locale!=="ko"&&(gn||tr!=="onCompositionStart"?tr==="onCompositionEnd"&&gn&&(qt=pr()):(fn=lt,Dr="value"in fn?fn.value:fn.textContent,gn=!0)),xr=Bd(ze,tr),0<xr.length&&(tr=new ff(tr,r,null,h,lt),bt.push({event:tr,listeners:xr}),qt?tr.data=qt:(qt=Xh(h),qt!==null&&(tr.data=qt)))),(qt=Wh?gf(r,h):yf(r,h))&&(tr=Bd(ze,"onBeforeInput"),0<tr.length&&(xr=new ff("onBeforeInput","beforeinput",null,h,lt),bt.push({event:xr,listeners:tr}),xr.data=qt)),$g(bt,r,ze,h,lt)}wm(bt,s)})}function ps(r,s,h){return{instance:r,listener:s,currentTarget:h}}function Bd(r,s){for(var h=s+"Capture",y=[];r!==null;){var M=r,z=M.stateNode;M=M.tag,M!==5&&M!==26&&M!==27||z===null||(M=Wi(r,h),M!=null&&y.unshift(ps(r,M,z)),M=Wi(r,s),M!=null&&y.push(ps(r,M,z))),r=r.return}return y}function yu(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Mm(r,s,h,y,M){for(var z=s._reactName,Z=[];h!==null&&h!==y;){var ie=h,ge=ie.alternate,ze=ie.stateNode;if(ie=ie.tag,ge!==null&&ge===y)break;ie!==5&&ie!==26&&ie!==27||ze===null||(ge=ze,M?(ze=Wi(h,z),ze!=null&&Z.unshift(ps(h,ze,ge))):M||(ze=Wi(h,z),ze!=null&&Z.push(ps(h,ze,ge)))),h=h.return}Z.length!==0&&r.push({event:s,listeners:Z})}var Wg=/\r\n?/g,Xg=/\u0000|\uFFFD/g;function ap(r){return(typeof r=="string"?r:""+r).replace(Wg,`
`).replace(Xg,"")}function Em(r,s){return s=ap(s),ap(r)===s}function mc(){}function Xr(r,s,h,y,M,z){switch(h){case"children":typeof y=="string"?s==="body"||s==="textarea"&&y===""||Ui(r,y):(typeof y=="number"||typeof y=="bigint")&&s!=="body"&&Ui(r,""+y);break;case"className":Ts(r,"class",y);break;case"tabIndex":Ts(r,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":Ts(r,h,y);break;case"style":fa(r,y,z);break;case"data":if(s!=="object"){Ts(r,"data",y);break}case"src":case"href":if(y===""&&(s!=="a"||h!=="href")){r.removeAttribute(h);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){r.removeAttribute(h);break}y=Hs(""+y),r.setAttribute(h,y);break;case"action":case"formAction":if(typeof y=="function"){r.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(h==="formAction"?(s!=="input"&&Xr(r,s,"name",M.name,M,null),Xr(r,s,"formEncType",M.formEncType,M,null),Xr(r,s,"formMethod",M.formMethod,M,null),Xr(r,s,"formTarget",M.formTarget,M,null)):(Xr(r,s,"encType",M.encType,M,null),Xr(r,s,"method",M.method,M,null),Xr(r,s,"target",M.target,M,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){r.removeAttribute(h);break}y=Hs(""+y),r.setAttribute(h,y);break;case"onClick":y!=null&&(r.onclick=mc);break;case"onScroll":y!=null&&zr("scroll",r);break;case"onScrollEnd":y!=null&&zr("scrollend",r);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(x(61));if(h=y.__html,h!=null){if(M.children!=null)throw Error(x(60));r.innerHTML=h}}break;case"multiple":r.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":r.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){r.removeAttribute("xlink:href");break}h=Hs(""+y),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?r.setAttribute(h,""+y):r.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?r.setAttribute(h,""):r.removeAttribute(h);break;case"capture":case"download":y===!0?r.setAttribute(h,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?r.setAttribute(h,y):r.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?r.setAttribute(h,y):r.removeAttribute(h);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?r.removeAttribute(h):r.setAttribute(h,y);break;case"popover":zr("beforetoggle",r),zr("toggle",r),Rc(r,"popover",y);break;case"xlinkActuate":Qn(r,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":Qn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":Qn(r,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":Qn(r,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":Qn(r,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":Qn(r,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":Qn(r,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":Qn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":Qn(r,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":Rc(r,"is",y);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=vr.get(h)||h,Rc(r,h,y))}}function Fd(r,s,h,y,M,z){switch(h){case"style":fa(r,y,z);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(x(61));if(h=y.__html,h!=null){if(M.children!=null)throw Error(x(60));r.innerHTML=h}}break;case"children":typeof y=="string"?Ui(r,y):(typeof y=="number"||typeof y=="bigint")&&Ui(r,""+y);break;case"onScroll":y!=null&&zr("scroll",r);break;case"onScrollEnd":y!=null&&zr("scrollend",r);break;case"onClick":y!=null&&(r.onclick=mc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Kr.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(M=h.endsWith("Capture"),s=h.slice(2,M?h.length-7:void 0),z=r[Rt]||null,z=z!=null?z[h]:null,typeof z=="function"&&r.removeEventListener(s,z,M),typeof y=="function")){typeof z!="function"&&z!==null&&(h in r?r[h]=null:r.hasAttribute(h)&&r.removeAttribute(h)),r.addEventListener(s,y,M);break e}h in r?r[h]=y:y===!0?r.setAttribute(h,""):Rc(r,h,y)}}}function ba(r,s,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zr("error",r),zr("load",r);var y=!1,M=!1,z;for(z in h)if(h.hasOwnProperty(z)){var Z=h[z];if(Z!=null)switch(z){case"src":y=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(x(137,s));default:Xr(r,s,z,Z,h,null)}}M&&Xr(r,s,"srcSet",h.srcSet,h,null),y&&Xr(r,s,"src",h.src,h,null);return;case"input":zr("invalid",r);var ie=z=Z=M=null,ge=null,ze=null;for(y in h)if(h.hasOwnProperty(y)){var lt=h[y];if(lt!=null)switch(y){case"name":M=lt;break;case"type":Z=lt;break;case"checked":ge=lt;break;case"defaultChecked":ze=lt;break;case"value":z=lt;break;case"defaultValue":ie=lt;break;case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(x(137,s));break;default:Xr(r,s,y,lt,h,null)}}Nu(r,z,ie,ge,ze,Z,M,!1),Dc(r);return;case"select":zr("invalid",r),y=Z=z=null;for(M in h)if(h.hasOwnProperty(M)&&(ie=h[M],ie!=null))switch(M){case"value":z=ie;break;case"defaultValue":Z=ie;break;case"multiple":y=ie;default:Xr(r,s,M,ie,h,null)}s=z,h=Z,r.multiple=!!y,s!=null?es(r,!!y,s,!1):h!=null&&es(r,!!y,h,!0);return;case"textarea":zr("invalid",r),z=M=y=null;for(Z in h)if(h.hasOwnProperty(Z)&&(ie=h[Z],ie!=null))switch(Z){case"value":y=ie;break;case"defaultValue":M=ie;break;case"children":z=ie;break;case"dangerouslySetInnerHTML":if(ie!=null)throw Error(x(91));break;default:Xr(r,s,Z,ie,h,null)}Lu(r,y,M,z),Dc(r);return;case"option":for(ge in h)if(h.hasOwnProperty(ge)&&(y=h[ge],y!=null))switch(ge){case"selected":r.selected=y&&typeof y!="function"&&typeof y!="symbol";break;default:Xr(r,s,ge,y,h,null)}return;case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":zr("load",r);break;case"video":case"audio":for(y=0;y<Ld.length;y++)zr(Ld[y],r);break;case"image":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"embed":case"source":case"link":zr("error",r),zr("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ze in h)if(h.hasOwnProperty(ze)&&(y=h[ze],y!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":throw Error(x(137,s));default:Xr(r,s,ze,y,h,null)}return;default:if(Es(s)){for(lt in h)h.hasOwnProperty(lt)&&(y=h[lt],y!==void 0&&Fd(r,s,lt,y,h,void 0));return}}for(ie in h)h.hasOwnProperty(ie)&&(y=h[ie],y!=null&&Xr(r,s,ie,y,h,null))}function Gn(r,s,h,y){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,z=null,Z=null,ie=null,ge=null,ze=null,lt=null;for(ct in h){var bt=h[ct];if(h.hasOwnProperty(ct)&&bt!=null)switch(ct){case"checked":break;case"value":break;case"defaultValue":ge=bt;default:y.hasOwnProperty(ct)||Xr(r,s,ct,null,y,bt)}}for(var We in y){var ct=y[We];if(bt=h[We],y.hasOwnProperty(We)&&(ct!=null||bt!=null))switch(We){case"type":z=ct;break;case"name":M=ct;break;case"checked":ze=ct;break;case"defaultChecked":lt=ct;break;case"value":Z=ct;break;case"defaultValue":ie=ct;break;case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(x(137,s));break;default:ct!==bt&&Xr(r,s,We,ct,y,bt)}}Ms(r,Z,ie,ge,ze,lt,z,M);return;case"select":ct=Z=ie=We=null;for(z in h)if(ge=h[z],h.hasOwnProperty(z)&&ge!=null)switch(z){case"value":break;case"multiple":ct=ge;default:y.hasOwnProperty(z)||Xr(r,s,z,null,y,ge)}for(M in y)if(z=y[M],ge=h[M],y.hasOwnProperty(M)&&(z!=null||ge!=null))switch(M){case"value":We=z;break;case"defaultValue":ie=z;break;case"multiple":Z=z;default:z!==ge&&Xr(r,s,M,z,y,ge)}s=ie,h=Z,y=ct,We!=null?es(r,!!h,We,!1):!!y!=!!h&&(s!=null?es(r,!!h,s,!0):es(r,!!h,h?[]:"",!1));return;case"textarea":ct=We=null;for(ie in h)if(M=h[ie],h.hasOwnProperty(ie)&&M!=null&&!y.hasOwnProperty(ie))switch(ie){case"value":break;case"children":break;default:Xr(r,s,ie,null,y,M)}for(Z in y)if(M=y[Z],z=h[Z],y.hasOwnProperty(Z)&&(M!=null||z!=null))switch(Z){case"value":We=M;break;case"defaultValue":ct=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(x(91));break;default:M!==z&&Xr(r,s,Z,M,y,z)}Ll(r,We,ct);return;case"option":for(var Vt in h)if(We=h[Vt],h.hasOwnProperty(Vt)&&We!=null&&!y.hasOwnProperty(Vt))switch(Vt){case"selected":r.selected=!1;break;default:Xr(r,s,Vt,null,y,We)}for(ge in y)if(We=y[ge],ct=h[ge],y.hasOwnProperty(ge)&&We!==ct&&(We!=null||ct!=null))switch(ge){case"selected":r.selected=We&&typeof We!="function"&&typeof We!="symbol";break;default:Xr(r,s,ge,We,y,ct)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ir in h)We=h[ir],h.hasOwnProperty(ir)&&We!=null&&!y.hasOwnProperty(ir)&&Xr(r,s,ir,null,y,We);for(ze in y)if(We=y[ze],ct=h[ze],y.hasOwnProperty(ze)&&We!==ct&&(We!=null||ct!=null))switch(ze){case"children":case"dangerouslySetInnerHTML":if(We!=null)throw Error(x(137,s));break;default:Xr(r,s,ze,We,y,ct)}return;default:if(Es(s)){for(var ci in h)We=h[ci],h.hasOwnProperty(ci)&&We!==void 0&&!y.hasOwnProperty(ci)&&Fd(r,s,ci,void 0,y,We);for(lt in y)We=y[lt],ct=h[lt],!y.hasOwnProperty(lt)||We===ct||We===void 0&&ct===void 0||Fd(r,s,lt,We,y,ct);return}}for(var Oe in h)We=h[Oe],h.hasOwnProperty(Oe)&&We!=null&&!y.hasOwnProperty(Oe)&&Xr(r,s,Oe,null,y,We);for(bt in y)We=y[bt],ct=h[bt],!y.hasOwnProperty(bt)||We===ct||We==null&&ct==null||Xr(r,s,bt,We,y,ct)}var gc=null,np=null;function Ud(r){return r.nodeType===9?r:r.ownerDocument}function Cm(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Am(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function sp(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var op=null;function T_(){var r=window.event;return r&&r.type==="popstate"?r===op?!1:(op=r,!0):(op=null,!1)}var km=typeof setTimeout=="function"?setTimeout:void 0,yc=typeof clearTimeout=="function"?clearTimeout:void 0,Pm=typeof Promise=="function"?Promise:void 0,Yg=typeof queueMicrotask=="function"?queueMicrotask:typeof Pm<"u"?function(r){return Pm.resolve(null).then(r).catch(Kg)}:km;function Kg(r){setTimeout(function(){throw r})}function lp(r,s){var h=s,y=0;do{var M=h.nextSibling;if(r.removeChild(h),M&&M.nodeType===8)if(h=M.data,h==="/$"){if(y===0){r.removeChild(M),Bi(s);return}y--}else h!=="$"&&h!=="$?"&&h!=="$!"||y++;h=M}while(h);Bi(s)}function jm(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var h=s;switch(s=s.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":jm(h),jo(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}r.removeChild(h)}}function M_(r,s,h,y){for(;r.nodeType===1;){var M=h;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!y&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(y){if(!r[Xn])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(z=r.getAttribute("rel"),z==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(z!==M.rel||r.getAttribute("href")!==(M.href==null?null:M.href)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||r.getAttribute("title")!==(M.title==null?null:M.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(z=r.getAttribute("src"),(z!==(M.src==null?null:M.src)||r.getAttribute("type")!==(M.type==null?null:M.type)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&z&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var z=M.name==null?null:""+M.name;if(M.type==="hidden"&&r.getAttribute("name")===z)return r}else return r;if(r=an(r.nextSibling),r===null)break}return null}function Qg(r,s,h){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!h||(r=an(r.nextSibling),r===null))return null;return r}function an(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return r}function zm(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var h=r.data;if(h==="$"||h==="$!"||h==="$?"){if(s===0)return r;s--}else h==="/$"&&s++}r=r.previousSibling}return null}function Vd(r,s,h){switch(s=Ud(h),r){case"html":if(r=s.documentElement,!r)throw Error(x(452));return r;case"head":if(r=s.head,!r)throw Error(x(453));return r;case"body":if(r=s.body,!r)throw Error(x(454));return r;default:throw Error(x(451))}}var Hn=new Map,qd=new Set;function _u(r){return typeof r.getRootNode=="function"?r.getRootNode():r.ownerDocument}var ms=Et.d;Et.d={f:E_,r:C_,D:wa,C:_c,L:Im,m:Jg,X:Rm,S:e0,M:A_};function E_(){var r=ms.f(),s=Xf();return r||s}function C_(r){var s=Yn(r);s!==null&&s.tag===5&&s.type==="form"?He(s):ms.r(r)}var Mh=typeof document>"u"?null:document;function vu(r,s,h){var y=Mh;if(y&&typeof s=="string"&&s){var M=Xa(s);M='link[rel="'+r+'"][href="'+M+'"]',typeof h=="string"&&(M+='[crossorigin="'+h+'"]'),qd.has(M)||(qd.add(M),r={rel:r,crossOrigin:h,href:s},y.querySelector(M)===null&&(s=y.createElement("link"),ba(s,"link",r),_r(s),y.head.appendChild(s)))}}function wa(r){ms.D(r),vu("dns-prefetch",r,null)}function _c(r,s){ms.C(r,s),vu("preconnect",r,s)}function Im(r,s,h){ms.L(r,s,h);var y=Mh;if(y&&r&&s){var M='link[rel="preload"][as="'+Xa(s)+'"]';s==="image"&&h&&h.imageSrcSet?(M+='[imagesrcset="'+Xa(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(M+='[imagesizes="'+Xa(h.imageSizes)+'"]')):M+='[href="'+Xa(r)+'"]';var z=M;switch(s){case"style":z=xu(r);break;case"script":z=vc(r)}Hn.has(z)||(r=xt({rel:"preload",href:s==="image"&&h&&h.imageSrcSet?void 0:r,as:s},h),Hn.set(z,r),y.querySelector(M)!==null||s==="style"&&y.querySelector(Zd(z))||s==="script"&&y.querySelector(Eh(z))||(s=y.createElement("link"),ba(s,"link",r),_r(s),y.head.appendChild(s)))}}function Jg(r,s){ms.m(r,s);var h=Mh;if(h&&r){var y=s&&typeof s.as=="string"?s.as:"script",M='link[rel="modulepreload"][as="'+Xa(y)+'"][href="'+Xa(r)+'"]',z=M;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=vc(r)}if(!Hn.has(z)&&(r=xt({rel:"modulepreload",href:r},s),Hn.set(z,r),h.querySelector(M)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Eh(z)))return}y=h.createElement("link"),ba(y,"link",r),_r(y),h.head.appendChild(y)}}}function e0(r,s,h){ms.S(r,s,h);var y=Mh;if(y&&r){var M=hn(y).hoistableStyles,z=xu(r);s=s||"default";var Z=M.get(z);if(!Z){var ie={loading:0,preload:null};if(Z=y.querySelector(Zd(z)))ie.loading=5;else{r=xt({rel:"stylesheet",href:r,"data-precedence":s},h),(h=Hn.get(z))&&cp(r,h);var ge=Z=y.createElement("link");_r(ge),ba(ge,"link",r),ge._p=new Promise(function(ze,lt){ge.onload=ze,ge.onerror=lt}),ge.addEventListener("load",function(){ie.loading|=1}),ge.addEventListener("error",function(){ie.loading|=2}),ie.loading|=4,Ah(Z,s,y)}Z={type:"stylesheet",instance:Z,count:1,state:ie},M.set(z,Z)}}}function Rm(r,s){ms.X(r,s);var h=Mh;if(h&&r){var y=hn(h).hoistableScripts,M=vc(r),z=y.get(M);z||(z=h.querySelector(Eh(M)),z||(r=xt({src:r,async:!0},s),(s=Hn.get(M))&&$d(r,s),z=h.createElement("script"),_r(z),ba(z,"link",r),h.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},y.set(M,z))}}function A_(r,s){ms.M(r,s);var h=Mh;if(h&&r){var y=hn(h).hoistableScripts,M=vc(r),z=y.get(M);z||(z=h.querySelector(Eh(M)),z||(r=xt({src:r,async:!0,type:"module"},s),(s=Hn.get(M))&&$d(r,s),z=h.createElement("script"),_r(z),ba(z,"link",r),h.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},y.set(M,z))}}function Dm(r,s,h,y){var M=(M=hi.current)?_u(M):null;if(!M)throw Error(x(446));switch(r){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(s=xu(h.href),h=hn(M).hoistableStyles,y=h.get(s),y||(y={type:"style",instance:null,count:0,state:null},h.set(s,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){r=xu(h.href);var z=hn(M).hoistableStyles,Z=z.get(r);if(Z||(M=M.ownerDocument||M,Z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(r,Z),(z=M.querySelector(Zd(r)))&&!z._p&&(Z.instance=z,Z.state.loading=5),Hn.has(r)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Hn.set(r,h),z||Lm(M,r,h,Z.state))),s&&y===null)throw Error(x(528,""));return Z}if(s&&y!==null)throw Error(x(529,""));return null;case"script":return s=h.async,h=h.src,typeof h=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=vc(h),h=hn(M).hoistableScripts,y=h.get(s),y||(y={type:"script",instance:null,count:0,state:null},h.set(s,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(x(444,r))}}function xu(r){return'href="'+Xa(r)+'"'}function Zd(r){return'link[rel="stylesheet"]['+r+"]"}function Nm(r){return xt({},r,{"data-precedence":r.precedence,precedence:null})}function Lm(r,s,h,y){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?y.loading=1:(s=r.createElement("link"),y.preload=s,s.addEventListener("load",function(){return y.loading|=1}),s.addEventListener("error",function(){return y.loading|=2}),ba(s,"link",h),_r(s),r.head.appendChild(s))}function vc(r){return'[src="'+Xa(r)+'"]'}function Eh(r){return"script[async]"+r}function Ch(r,s,h){if(s.count++,s.instance===null)switch(s.type){case"style":var y=r.querySelector('style[data-href~="'+Xa(h.href)+'"]');if(y)return s.instance=y,_r(y),y;var M=xt({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return y=(r.ownerDocument||r).createElement("style"),_r(y),ba(y,"style",M),Ah(y,h.precedence,r),s.instance=y;case"stylesheet":M=xu(h.href);var z=r.querySelector(Zd(M));if(z)return s.state.loading|=4,s.instance=z,_r(z),z;y=Nm(h),(M=Hn.get(M))&&cp(y,M),z=(r.ownerDocument||r).createElement("link"),_r(z);var Z=z;return Z._p=new Promise(function(ie,ge){Z.onload=ie,Z.onerror=ge}),ba(z,"link",y),s.state.loading|=4,Ah(z,h.precedence,r),s.instance=z;case"script":return z=vc(h.src),(M=r.querySelector(Eh(z)))?(s.instance=M,_r(M),M):(y=h,(M=Hn.get(z))&&(y=xt({},h),$d(y,M)),r=r.ownerDocument||r,M=r.createElement("script"),_r(M),ba(M,"link",y),r.head.appendChild(M),s.instance=M);case"void":return null;default:throw Error(x(443,s.type))}else s.type==="stylesheet"&&!(s.state.loading&4)&&(y=s.instance,s.state.loading|=4,Ah(y,h.precedence,r));return s.instance}function Ah(r,s,h){for(var y=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=y.length?y[y.length-1]:null,z=M,Z=0;Z<y.length;Z++){var ie=y[Z];if(ie.dataset.precedence===s)z=ie;else if(z!==M)break}z?z.parentNode.insertBefore(r,z.nextSibling):(s=h.nodeType===9?h.head:h,s.insertBefore(r,s.firstChild))}function cp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function $d(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var bu=null;function kh(r,s,h){if(bu===null){var y=new Map,M=bu=new Map;M.set(h,y)}else M=bu,y=M.get(h),y||(y=new Map,M.set(h,y));if(y.has(r))return y;for(y.set(r,null),h=h.getElementsByTagName(r),M=0;M<h.length;M++){var z=h[M];if(!(z[Xn]||z[rt]||r==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var Z=z.getAttribute(s)||"";Z=r+Z;var ie=y.get(Z);ie?ie.push(z):y.set(Z,[z])}}return y}function up(r,s,h){r=r.ownerDocument||r,r.head.insertBefore(h,s==="title"?r.querySelector("head > title"):null)}function Om(r,s,h){if(h===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return r=s.disabled,typeof s.precedence=="string"&&r==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function hp(r){return!(r.type==="stylesheet"&&!(r.state.loading&3))}var Gd=null;function n(){}function t(r,s,h){if(Gd===null)throw Error(x(475));var y=Gd;if(s.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&!(s.state.loading&4)){if(s.instance===null){var M=xu(h.href),z=r.querySelector(Zd(M));if(z){r=z._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(y.count++,y=c.bind(y),r.then(y,y)),s.state.loading|=4,s.instance=z,_r(z);return}z=r.ownerDocument||r,h=Nm(h),(M=Hn.get(M))&&cp(h,M),z=z.createElement("link"),_r(z);var Z=z;Z._p=new Promise(function(ie,ge){Z.onload=ie,Z.onerror=ge}),ba(z,"link",h),s.instance=z}y.stylesheets===null&&(y.stylesheets=new Map),y.stylesheets.set(s,r),(r=s.state.preload)&&!(s.state.loading&3)&&(y.count++,s=c.bind(y),r.addEventListener("load",s),r.addEventListener("error",s))}}function a(){if(Gd===null)throw Error(x(475));var r=Gd;return r.stylesheets&&r.count===0&&v(r,r.stylesheets),0<r.count?function(s){var h=setTimeout(function(){if(r.stylesheets&&v(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4);return r.unsuspend=s,function(){r.unsuspend=null,clearTimeout(h)}}:null}function c(){if(this.count--,this.count===0){if(this.stylesheets)v(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var p=null;function v(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,p=new Map,s.forEach(b,r),p=null,c.call(r))}function b(r,s){if(!(s.state.loading&4)){var h=p.get(r);if(h)var y=h.get(null);else{h=new Map,p.set(r,h);for(var M=r.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<M.length;z++){var Z=M[z];(Z.nodeName==="LINK"||Z.getAttribute("media")!=="not all")&&(h.set(Z.dataset.precedence,Z),y=Z)}y&&h.set(null,y)}M=s.instance,Z=M.getAttribute("data-precedence"),z=h.get(Z)||y,z===y&&h.set(null,M),h.set(Z,M),this.count++,y=c.bind(this),M.addEventListener("load",y),M.addEventListener("error",y),z?z.parentNode.insertBefore(M,z.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(M,r.firstChild)),s.state.loading|=4}}var T={$$typeof:ee,Provider:null,Consumer:null,_currentValue:Kt,_currentValue2:Kt,_threadCount:0};function P(r,s,h,y,M,z,Z,ie){this.tag=1,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ct(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ct(0),this.hiddenUpdates=Ct(null),this.identifierPrefix=y,this.onUncaughtError=M,this.onCaughtError=z,this.onRecoverableError=Z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ie,this.incompleteTransitions=new Map}function I(r,s,h,y,M,z,Z,ie,ge,ze,lt,bt){return r=new P(r,s,h,Z,ie,ge,ze,bt),s=1,z===!0&&(s|=24),z=Mn(3,null,null,s),r.current=z,z.stateNode=r,s=hd(),s.refCount++,r.pooledCache=s,s.refCount++,z.memoizedState={element:y,isDehydrated:h,cache:s},kf(z),r}function D(r){return r?(r=or,r):or}function L(r,s,h,y,M,z){M=D(M),y.context===null?y.context=M:y.pendingContext=M,y=ul(s),y.payload={element:h},z=z===void 0?null:z,z!==null&&(y.callback=z),h=oc(r,y,s),h!==null&&(rn(h,r,s),au(h,r,s))}function q(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var h=r.retryLane;r.retryLane=h!==0&&h<s?h:s}}function G(r,s){q(r,s),(r=r.alternate)&&q(r,s)}function H(r){if(r.tag===13){var s=Ya(r,67108864);s!==null&&rn(s,r,67108864),G(r,67108864)}}var K=!0;function se(r,s,h,y){var M=at.T;at.T=null;var z=Et.p;try{Et.p=2,Me(r,s,h,y)}finally{Et.p=z,at.T=M}}function fe(r,s,h,y){var M=at.T;at.T=null;var z=Et.p;try{Et.p=8,Me(r,s,h,y)}finally{Et.p=z,at.T=M}}function Me(r,s,h,y){if(K){var M=me(y);if(M===null)Od(r,s,y,$,h),jt(r,y);else if(Gt(M,r,s,h,y))y.stopPropagation();else if(jt(r,y),s&4&&-1<it.indexOf(r)){for(;M!==null;){var z=Yn(M);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var Z=Pe(z.pendingLanes);if(Z!==0){var ie=z;for(ie.pendingLanes|=2,ie.entangledLanes|=2;Z;){var ge=1<<31-J(Z);ie.entanglements[1]|=ge,Z&=~ge}fs(z),!(Pi&6)&&(qf=Ji()+500,Id(0))}}break;case 13:ie=Ya(z,2),ie!==null&&rn(ie,z,2),Xf(),G(z,2)}if(z=me(y),z===null&&Od(r,s,y,$,h),z===M)break;M=z}M!==null&&y.stopPropagation()}else Od(r,s,y,null,h)}}function me(r){return r=pa(r),ae(r)}var $=null;function ae(r){if($=null,r=Ha(r),r!==null){var s=Je(r);if(s===null)r=null;else{var h=s.tag;if(h===13){if(r=Pt(s),r!==null)return r;r=null}else if(h===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return $=r,null}function _e(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Dl()){case ko:return 2;case Po:return 8;case cn:case ws:return 32;case Ss:return 268435456;default:return 32}default:return 32}}var Fe=!1,ut=null,qe=null,Xe=null,mt=new Map,dt=new Map,gt=[],it="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function jt(r,s){switch(r){case"focusin":case"focusout":ut=null;break;case"dragenter":case"dragleave":qe=null;break;case"mouseover":case"mouseout":Xe=null;break;case"pointerover":case"pointerout":mt.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":dt.delete(s.pointerId)}}function Ut(r,s,h,y,M,z){return r===null||r.nativeEvent!==z?(r={blockedOn:s,domEventName:h,eventSystemFlags:y,nativeEvent:z,targetContainers:[M]},s!==null&&(s=Yn(s),s!==null&&H(s)),r):(r.eventSystemFlags|=y,s=r.targetContainers,M!==null&&s.indexOf(M)===-1&&s.push(M),r)}function Gt(r,s,h,y,M){switch(s){case"focusin":return ut=Ut(ut,r,s,h,y,M),!0;case"dragenter":return qe=Ut(qe,r,s,h,y,M),!0;case"mouseover":return Xe=Ut(Xe,r,s,h,y,M),!0;case"pointerover":var z=M.pointerId;return mt.set(z,Ut(mt.get(z)||null,r,s,h,y,M)),!0;case"gotpointercapture":return z=M.pointerId,dt.set(z,Ut(dt.get(z)||null,r,s,h,y,M)),!0}return!1}function Nt(r){var s=Ha(r.target);if(s!==null){var h=Je(s);if(h!==null){if(s=h.tag,s===13){if(s=Pt(h),s!==null){r.blockedOn=s,Ar(r.priority,function(){if(h.tag===13){var y=Lr(),M=Ya(h,y);M!==null&&rn(M,h,y),G(h,y)}});return}}else if(s===3&&h.stateNode.current.memoizedState.isDehydrated){r.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}r.blockedOn=null}function hr(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var h=me(r.nativeEvent);if(h===null){h=r.nativeEvent;var y=new h.constructor(h.type,h);Ws=y,h.target.dispatchEvent(y),Ws=null}else return s=Yn(h),s!==null&&H(s),r.blockedOn=h,!1;s.shift()}return!0}function yi(r,s,h){hr(r)&&h.delete(s)}function Ki(){Fe=!1,ut!==null&&hr(ut)&&(ut=null),qe!==null&&hr(qe)&&(qe=null),Xe!==null&&hr(Xe)&&(Xe=null),mt.forEach(yi),dt.forEach(yi)}function Qi(r,s){r.blockedOn===s&&(r.blockedOn=null,Fe||(Fe=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Ki)))}var Va=null;function qa(r){Va!==r&&(Va=r,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){Va===r&&(Va=null);for(var s=0;s<r.length;s+=3){var h=r[s],y=r[s+1],M=r[s+2];if(typeof y!="function"){if(ae(y||h)===null)continue;break}var z=Yn(h);z!==null&&(r.splice(s,3),s-=3,et(z,{pending:!0,data:M,method:h.method,action:y},y,M))}}))}function Bi(r){function s(ge){return Qi(ge,r)}ut!==null&&Qi(ut,r),qe!==null&&Qi(qe,r),Xe!==null&&Qi(Xe,r),mt.forEach(s),dt.forEach(s);for(var h=0;h<gt.length;h++){var y=gt[h];y.blockedOn===r&&(y.blockedOn=null)}for(;0<gt.length&&(h=gt[0],h.blockedOn===null);)Nt(h),h.blockedOn===null&&gt.shift();if(h=(r.ownerDocument||r).$$reactFormReplay,h!=null)for(y=0;y<h.length;y+=3){var M=h[y],z=h[y+1],Z=M[Rt]||null;if(typeof z=="function")Z||qa(h);else if(Z){var ie=null;if(z&&z.hasAttribute("formAction")){if(M=z,Z=z[Rt]||null)ie=Z.formAction;else if(ae(M)!==null)continue}else ie=Z.action;typeof ie=="function"?h[y+1]=ie:(h.splice(y,3),y-=3),qa(h)}}}function ri(r){this._internalRoot=r}Fi.prototype.render=ri.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(x(409));var h=s.current,y=Lr();L(h,y,r,s,null,null)},Fi.prototype.unmount=ri.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;r.tag===0&&fc(),L(r.current,2,null,r,null,null),Xf(),s[Qt]=null}};function Fi(r){this._internalRoot=r}Fi.prototype.unstable_scheduleHydration=function(r){if(r){var s=fr();r={blockedOn:null,target:r,priority:s};for(var h=0;h<gt.length&&s!==0&&s<gt[h].priority;h++);gt.splice(h,0,r),h===0&&Nt(r)}};var na=d.version;if(na!=="19.0.0")throw Error(x(527,na,"19.0.0"));Et.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(x(188)):(r=Object.keys(r).join(","),Error(x(268,r)));return r=_t(s),r=r!==null?Ot(r):null,r=r===null?null:r.stateNode,r};var ua={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:at,findFiberByHostInstance:Ha,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ha=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ha.isDisabled&&ha.supportsFiber)try{ea=ha.inject(ua),Mi=ha}catch{}}return Fm.createRoot=function(r,s){if(!C(r))throw Error(x(299));var h=!1,y="",M=ac,z=Ns,Z=fo,ie=null;return s!=null&&(s.unstable_strictMode===!0&&(h=!0),s.identifierPrefix!==void 0&&(y=s.identifierPrefix),s.onUncaughtError!==void 0&&(M=s.onUncaughtError),s.onCaughtError!==void 0&&(z=s.onCaughtError),s.onRecoverableError!==void 0&&(Z=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(ie=s.unstable_transitionCallbacks)),s=I(r,1,!1,null,null,h,y,M,z,Z,ie,null),r[Qt]=s.current,Tm(r.nodeType===8?r.parentNode:r),new ri(s)},Fm.hydrateRoot=function(r,s,h){if(!C(r))throw Error(x(299));var y=!1,M="",z=ac,Z=Ns,ie=fo,ge=null,ze=null;return h!=null&&(h.unstable_strictMode===!0&&(y=!0),h.identifierPrefix!==void 0&&(M=h.identifierPrefix),h.onUncaughtError!==void 0&&(z=h.onUncaughtError),h.onCaughtError!==void 0&&(Z=h.onCaughtError),h.onRecoverableError!==void 0&&(ie=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(ge=h.unstable_transitionCallbacks),h.formState!==void 0&&(ze=h.formState)),s=I(r,1,!0,s,h??null,y,M,z,Z,ie,ge,ze),s.context=D(null),h=s.current,y=Lr(),M=ul(y),M.callback=null,oc(h,M,y),s.current.lanes=y,Bt(s,y),fs(s),r[Qt]=s.current,Tm(r),new Fi(s)},Fm.version="19.0.0",Fm}var Zx;function j2(){if(Zx)return z_.exports;Zx=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(d){console.error(d)}}return o(),z_.exports=P2(),z_.exports}var z2=j2(),T1={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},$x=So.createContext&&So.createContext(T1),I2=["attr","size","title"];function R2(o,d){if(o==null)return{};var m=D2(o,d),x,C;if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(o);for(C=0;C<k.length;C++)x=k[C],!(d.indexOf(x)>=0)&&Object.prototype.propertyIsEnumerable.call(o,x)&&(m[x]=o[x])}return m}function D2(o,d){if(o==null)return{};var m={};for(var x in o)if(Object.prototype.hasOwnProperty.call(o,x)){if(d.indexOf(x)>=0)continue;m[x]=o[x]}return m}function Oy(){return Oy=Object.assign?Object.assign.bind():function(o){for(var d=1;d<arguments.length;d++){var m=arguments[d];for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&(o[x]=m[x])}return o},Oy.apply(this,arguments)}function Gx(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function By(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?Gx(Object(m),!0).forEach(function(x){N2(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):Gx(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function N2(o,d,m){return d=L2(d),d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}function L2(o){var d=O2(o,"string");return typeof d=="symbol"?d:d+""}function O2(o,d){if(typeof o!="object"||!o)return o;var m=o[Symbol.toPrimitive];if(m!==void 0){var x=m.call(o,d);if(typeof x!="object")return x;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(o)}function M1(o){return o&&o.map((d,m)=>So.createElement(d.tag,By({key:m},d.attr),M1(d.child)))}function Yr(o){return d=>So.createElement(B2,Oy({attr:By({},o.attr)},d),M1(o.child))}function B2(o){var d=m=>{var{attr:x,size:C,title:k}=o,E=R2(o,I2),l=C||m.size||"1em",B;return m.className&&(B=m.className),o.className&&(B=(B?B+" ":"")+o.className),So.createElement("svg",Oy({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},m.attr,x,E,{className:B,style:By(By({color:o.color||m.color},m.style),o.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),k&&So.createElement("title",null,k),o.children)};return $x!==void 0?So.createElement($x.Consumer,null,m=>d(m)):d(T1)}function zu(o){return Yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.125 48 48 141.125 48 256s93.125 208 208 208 208-93.125 208-208S370.875 48 256 48zm107 229h-86v86h-42v-86h-86v-42h86v-86h42v86h86v42z"},child:[]}]})(o)}function Fy(o){return Yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M208 448V320h96v128h97.6V256H464L256 64 48 256h62.4v192z"},child:[]}]})(o)}function Hx(o){return Yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M48 448l416-192L48 64v149.333L346 256 48 298.667z"},child:[]}]})(o)}var Um={},Wx;function F2(){if(Wx)return Um;Wx=1,Object.defineProperty(Um,"__esModule",{value:!0}),Um.parse=E,Um.serialize=V;const o=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,d=/^[\u0021-\u003A\u003C-\u007E]*$/,m=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,x=/^[\u0020-\u003A\u003D-\u007E]*$/,C=Object.prototype.toString,k=(()=>{const re=function(){};return re.prototype=Object.create(null),re})();function E(re,ee){const te=new k,be=re.length;if(be<2)return te;const Ee=(ee==null?void 0:ee.decode)||X;let Ae=0;do{const Ie=re.indexOf("=",Ae);if(Ie===-1)break;const tt=re.indexOf(";",Ae),vt=tt===-1?be:tt;if(Ie>vt){Ae=re.lastIndexOf(";",Ie-1)+1;continue}const nt=l(re,Ae,Ie),Ye=B(re,Ie,nt),st=re.slice(nt,Ye);if(te[st]===void 0){let ot=l(re,Ie+1,vt),at=B(re,vt,ot);const xt=Ee(re.slice(ot,at));te[st]=xt}Ae=vt+1}while(Ae<be);return te}function l(re,ee,te){do{const be=re.charCodeAt(ee);if(be!==32&&be!==9)return ee}while(++ee<te);return te}function B(re,ee,te){for(;ee>te;){const be=re.charCodeAt(--ee);if(be!==32&&be!==9)return ee+1}return te}function V(re,ee,te){const be=(te==null?void 0:te.encode)||encodeURIComponent;if(!o.test(re))throw new TypeError(`argument name is invalid: ${re}`);const Ee=be(ee);if(!d.test(Ee))throw new TypeError(`argument val is invalid: ${ee}`);let Ae=re+"="+Ee;if(!te)return Ae;if(te.maxAge!==void 0){if(!Number.isInteger(te.maxAge))throw new TypeError(`option maxAge is invalid: ${te.maxAge}`);Ae+="; Max-Age="+te.maxAge}if(te.domain){if(!m.test(te.domain))throw new TypeError(`option domain is invalid: ${te.domain}`);Ae+="; Domain="+te.domain}if(te.path){if(!x.test(te.path))throw new TypeError(`option path is invalid: ${te.path}`);Ae+="; Path="+te.path}if(te.expires){if(!ne(te.expires)||!Number.isFinite(te.expires.valueOf()))throw new TypeError(`option expires is invalid: ${te.expires}`);Ae+="; Expires="+te.expires.toUTCString()}if(te.httpOnly&&(Ae+="; HttpOnly"),te.secure&&(Ae+="; Secure"),te.partitioned&&(Ae+="; Partitioned"),te.priority)switch(typeof te.priority=="string"?te.priority.toLowerCase():void 0){case"low":Ae+="; Priority=Low";break;case"medium":Ae+="; Priority=Medium";break;case"high":Ae+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${te.priority}`)}if(te.sameSite)switch(typeof te.sameSite=="string"?te.sameSite.toLowerCase():te.sameSite){case!0:case"strict":Ae+="; SameSite=Strict";break;case"lax":Ae+="; SameSite=Lax";break;case"none":Ae+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${te.sameSite}`)}return Ae}function X(re){if(re.indexOf("%")===-1)return re;try{return decodeURIComponent(re)}catch{return re}}function ne(re){return C.call(re)==="[object Date]"}return Um}F2();/**
 * react-router v7.1.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Xx="popstate";function U2(o={}){function d(x,C){let{pathname:k,search:E,hash:l}=x.location;return X_("",{pathname:k,search:E,hash:l},C.state&&C.state.usr||null,C.state&&C.state.key||"default")}function m(x,C){return typeof C=="string"?C:xg(C)}return q2(d,m,null,o)}function Gi(o,d){if(o===!1||o===null||typeof o>"u")throw new Error(d)}function kl(o,d){if(!o){typeof console<"u"&&console.warn(d);try{throw new Error(d)}catch{}}}function V2(){return Math.random().toString(36).substring(2,10)}function Yx(o,d){return{usr:o.state,key:o.key,idx:d}}function X_(o,d,m=null,x){return{pathname:typeof o=="string"?o:o.pathname,search:"",hash:"",...typeof d=="string"?Bp(d):d,state:m,key:d&&d.key||x||V2()}}function xg({pathname:o="/",search:d="",hash:m=""}){return d&&d!=="?"&&(o+=d.charAt(0)==="?"?d:"?"+d),m&&m!=="#"&&(o+=m.charAt(0)==="#"?m:"#"+m),o}function Bp(o){let d={};if(o){let m=o.indexOf("#");m>=0&&(d.hash=o.substring(m),o=o.substring(0,m));let x=o.indexOf("?");x>=0&&(d.search=o.substring(x),o=o.substring(0,x)),o&&(d.pathname=o)}return d}function q2(o,d,m,x={}){let{window:C=document.defaultView,v5Compat:k=!1}=x,E=C.history,l="POP",B=null,V=X();V==null&&(V=0,E.replaceState({...E.state,idx:V},""));function X(){return(E.state||{idx:null}).idx}function ne(){l="POP";let Ee=X(),Ae=Ee==null?null:Ee-V;V=Ee,B&&B({action:l,location:be.location,delta:Ae})}function re(Ee,Ae){l="PUSH";let Ie=X_(be.location,Ee,Ae);V=X()+1;let tt=Yx(Ie,V),vt=be.createHref(Ie);try{E.pushState(tt,"",vt)}catch(nt){if(nt instanceof DOMException&&nt.name==="DataCloneError")throw nt;C.location.assign(vt)}k&&B&&B({action:l,location:be.location,delta:1})}function ee(Ee,Ae){l="REPLACE";let Ie=X_(be.location,Ee,Ae);V=X();let tt=Yx(Ie,V),vt=be.createHref(Ie);E.replaceState(tt,"",vt),k&&B&&B({action:l,location:be.location,delta:0})}function te(Ee){let Ae=C.location.origin!=="null"?C.location.origin:C.location.href,Ie=typeof Ee=="string"?Ee:xg(Ee);return Ie=Ie.replace(/ $/,"%20"),Gi(Ae,`No window.location.(origin|href) available to create URL for href: ${Ie}`),new URL(Ie,Ae)}let be={get action(){return l},get location(){return o(C,E)},listen(Ee){if(B)throw new Error("A history only accepts one active listener");return C.addEventListener(Xx,ne),B=Ee,()=>{C.removeEventListener(Xx,ne),B=null}},createHref(Ee){return d(C,Ee)},createURL:te,encodeLocation(Ee){let Ae=te(Ee);return{pathname:Ae.pathname,search:Ae.search,hash:Ae.hash}},push:re,replace:ee,go(Ee){return E.go(Ee)}};return be}function E1(o,d,m="/"){return Z2(o,d,m,!1)}function Z2(o,d,m,x){let C=typeof d=="string"?Bp(d):d,k=Oh(C.pathname||"/",m);if(k==null)return null;let E=C1(o);$2(E);let l=null;for(let B=0;l==null&&B<E.length;++B){let V=rS(k);l=eS(E[B],V,x)}return l}function C1(o,d=[],m=[],x=""){let C=(k,E,l)=>{let B={relativePath:l===void 0?k.path||"":l,caseSensitive:k.caseSensitive===!0,childrenIndex:E,route:k};B.relativePath.startsWith("/")&&(Gi(B.relativePath.startsWith(x),`Absolute route path "${B.relativePath}" nested under path "${x}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),B.relativePath=B.relativePath.slice(x.length));let V=ku([x,B.relativePath]),X=m.concat(B);k.children&&k.children.length>0&&(Gi(k.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${V}".`),C1(k.children,d,X,V)),!(k.path==null&&!k.index)&&d.push({path:V,score:Q2(V,k.index),routesMeta:X})};return o.forEach((k,E)=>{var l;if(k.path===""||!((l=k.path)!=null&&l.includes("?")))C(k,E);else for(let B of A1(k.path))C(k,E,B)}),d}function A1(o){let d=o.split("/");if(d.length===0)return[];let[m,...x]=d,C=m.endsWith("?"),k=m.replace(/\?$/,"");if(x.length===0)return C?[k,""]:[k];let E=A1(x.join("/")),l=[];return l.push(...E.map(B=>B===""?k:[k,B].join("/"))),C&&l.push(...E),l.map(B=>o.startsWith("/")&&B===""?"/":B)}function $2(o){o.sort((d,m)=>d.score!==m.score?m.score-d.score:J2(d.routesMeta.map(x=>x.childrenIndex),m.routesMeta.map(x=>x.childrenIndex)))}var G2=/^:[\w-]+$/,H2=3,W2=2,X2=1,Y2=10,K2=-2,Kx=o=>o==="*";function Q2(o,d){let m=o.split("/"),x=m.length;return m.some(Kx)&&(x+=K2),d&&(x+=W2),m.filter(C=>!Kx(C)).reduce((C,k)=>C+(G2.test(k)?H2:k===""?X2:Y2),x)}function J2(o,d){return o.length===d.length&&o.slice(0,-1).every((x,C)=>x===d[C])?o[o.length-1]-d[d.length-1]:0}function eS(o,d,m=!1){let{routesMeta:x}=o,C={},k="/",E=[];for(let l=0;l<x.length;++l){let B=x[l],V=l===x.length-1,X=k==="/"?d:d.slice(k.length)||"/",ne=Uy({path:B.relativePath,caseSensitive:B.caseSensitive,end:V},X),re=B.route;if(!ne&&V&&m&&!x[x.length-1].route.index&&(ne=Uy({path:B.relativePath,caseSensitive:B.caseSensitive,end:!1},X)),!ne)return null;Object.assign(C,ne.params),E.push({params:C,pathname:ku([k,ne.pathname]),pathnameBase:sS(ku([k,ne.pathnameBase])),route:re}),ne.pathnameBase!=="/"&&(k=ku([k,ne.pathnameBase]))}return E}function Uy(o,d){typeof o=="string"&&(o={path:o,caseSensitive:!1,end:!0});let[m,x]=tS(o.path,o.caseSensitive,o.end),C=d.match(m);if(!C)return null;let k=C[0],E=k.replace(/(.)\/+$/,"$1"),l=C.slice(1);return{params:x.reduce((V,{paramName:X,isOptional:ne},re)=>{if(X==="*"){let te=l[re]||"";E=k.slice(0,k.length-te.length).replace(/(.)\/+$/,"$1")}const ee=l[re];return ne&&!ee?V[X]=void 0:V[X]=(ee||"").replace(/%2F/g,"/"),V},{}),pathname:k,pathnameBase:E,pattern:o}}function tS(o,d=!1,m=!0){kl(o==="*"||!o.endsWith("*")||o.endsWith("/*"),`Route path "${o}" will be treated as if it were "${o.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${o.replace(/\*$/,"/*")}".`);let x=[],C="^"+o.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(E,l,B)=>(x.push({paramName:l,isOptional:B!=null}),B?"/?([^\\/]+)?":"/([^\\/]+)"));return o.endsWith("*")?(x.push({paramName:"*"}),C+=o==="*"||o==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):m?C+="\\/*$":o!==""&&o!=="/"&&(C+="(?:(?=\\/|$))"),[new RegExp(C,d?void 0:"i"),x]}function rS(o){try{return o.split("/").map(d=>decodeURIComponent(d).replace(/\//g,"%2F")).join("/")}catch(d){return kl(!1,`The URL path "${o}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${d}).`),o}}function Oh(o,d){if(d==="/")return o;if(!o.toLowerCase().startsWith(d.toLowerCase()))return null;let m=d.endsWith("/")?d.length-1:d.length,x=o.charAt(m);return x&&x!=="/"?null:o.slice(m)||"/"}function iS(o,d="/"){let{pathname:m,search:x="",hash:C=""}=typeof o=="string"?Bp(o):o;return{pathname:m?m.startsWith("/")?m:aS(m,d):d,search:oS(x),hash:lS(C)}}function aS(o,d){let m=d.replace(/\/+$/,"").split("/");return o.split("/").forEach(C=>{C===".."?m.length>1&&m.pop():C!=="."&&m.push(C)}),m.length>1?m.join("/"):"/"}function N_(o,d,m,x){return`Cannot include a '${o}' character in a manually specified \`to.${d}\` field [${JSON.stringify(x)}].  Please separate it out to the \`to.${m}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function nS(o){return o.filter((d,m)=>m===0||d.route.path&&d.route.path.length>0)}function rx(o){let d=nS(o);return d.map((m,x)=>x===d.length-1?m.pathname:m.pathnameBase)}function ix(o,d,m,x=!1){let C;typeof o=="string"?C=Bp(o):(C={...o},Gi(!C.pathname||!C.pathname.includes("?"),N_("?","pathname","search",C)),Gi(!C.pathname||!C.pathname.includes("#"),N_("#","pathname","hash",C)),Gi(!C.search||!C.search.includes("#"),N_("#","search","hash",C)));let k=o===""||C.pathname==="",E=k?"/":C.pathname,l;if(E==null)l=m;else{let ne=d.length-1;if(!x&&E.startsWith("..")){let re=E.split("/");for(;re[0]==="..";)re.shift(),ne-=1;C.pathname=re.join("/")}l=ne>=0?d[ne]:"/"}let B=iS(C,l),V=E&&E!=="/"&&E.endsWith("/"),X=(k||E===".")&&m.endsWith("/");return!B.pathname.endsWith("/")&&(V||X)&&(B.pathname+="/"),B}var ku=o=>o.join("/").replace(/\/\/+/g,"/"),sS=o=>o.replace(/\/+$/,"").replace(/^\/*/,"/"),oS=o=>!o||o==="?"?"":o.startsWith("?")?o:"?"+o,lS=o=>!o||o==="#"?"":o.startsWith("#")?o:"#"+o;function cS(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.internal=="boolean"&&"data"in o}var k1=["POST","PUT","PATCH","DELETE"];new Set(k1);var uS=["GET",...k1];new Set(uS);var Fp=he.createContext(null);Fp.displayName="DataRouter";var r_=he.createContext(null);r_.displayName="DataRouterState";var P1=he.createContext({isTransitioning:!1});P1.displayName="ViewTransition";var hS=he.createContext(new Map);hS.displayName="Fetchers";var dS=he.createContext(null);dS.displayName="Await";var jl=he.createContext(null);jl.displayName="Navigation";var Sg=he.createContext(null);Sg.displayName="Location";var Mo=he.createContext({outlet:null,matches:[],isDataRoute:!1});Mo.displayName="Route";var ax=he.createContext(null);ax.displayName="RouteError";function fS(o,{relative:d}={}){Gi(Up(),"useHref() may be used only in the context of a <Router> component.");let{basename:m,navigator:x}=he.useContext(jl),{hash:C,pathname:k,search:E}=Tg(o,{relative:d}),l=k;return m!=="/"&&(l=k==="/"?m:ku([m,k])),x.createHref({pathname:l,search:E,hash:C})}function Up(){return he.useContext(Sg)!=null}function Iu(){return Gi(Up(),"useLocation() may be used only in the context of a <Router> component."),he.useContext(Sg).location}var j1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function z1(o){he.useContext(jl).static||he.useLayoutEffect(o)}function zl(){let{isDataRoute:o}=he.useContext(Mo);return o?kS():pS()}function pS(){Gi(Up(),"useNavigate() may be used only in the context of a <Router> component.");let o=he.useContext(Fp),{basename:d,navigator:m}=he.useContext(jl),{matches:x}=he.useContext(Mo),{pathname:C}=Iu(),k=JSON.stringify(rx(x)),E=he.useRef(!1);return z1(()=>{E.current=!0}),he.useCallback((B,V={})=>{if(kl(E.current,j1),!E.current)return;if(typeof B=="number"){m.go(B);return}let X=ix(B,JSON.parse(k),C,V.relative==="path");o==null&&d!=="/"&&(X.pathname=X.pathname==="/"?d:ku([d,X.pathname])),(V.replace?m.replace:m.push)(X,V.state,V)},[d,m,k,C,o])}var mS=he.createContext(null);function gS(o){let d=he.useContext(Mo).outlet;return d&&he.createElement(mS.Provider,{value:o},d)}function yS(){let{matches:o}=he.useContext(Mo),d=o[o.length-1];return d?d.params:{}}function Tg(o,{relative:d}={}){let{matches:m}=he.useContext(Mo),{pathname:x}=Iu(),C=JSON.stringify(rx(m));return he.useMemo(()=>ix(o,JSON.parse(C),x,d==="path"),[o,C,x,d])}function _S(o,d){return I1(o,d)}function I1(o,d,m,x){var Ie;Gi(Up(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:C,static:k}=he.useContext(jl),{matches:E}=he.useContext(Mo),l=E[E.length-1],B=l?l.params:{},V=l?l.pathname:"/",X=l?l.pathnameBase:"/",ne=l&&l.route;{let tt=ne&&ne.path||"";R1(V,!ne||tt.endsWith("*")||tt.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${V}" (under <Route path="${tt}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${tt}"> to <Route path="${tt==="/"?"*":`${tt}/*`}">.`)}let re=Iu(),ee;if(d){let tt=typeof d=="string"?Bp(d):d;Gi(X==="/"||((Ie=tt.pathname)==null?void 0:Ie.startsWith(X)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${X}" but pathname "${tt.pathname}" was given in the \`location\` prop.`),ee=tt}else ee=re;let te=ee.pathname||"/",be=te;if(X!=="/"){let tt=X.replace(/^\//,"").split("/");be="/"+te.replace(/^\//,"").split("/").slice(tt.length).join("/")}let Ee=!k&&m&&m.matches&&m.matches.length>0?m.matches:E1(o,{pathname:be});kl(ne||Ee!=null,`No routes matched location "${ee.pathname}${ee.search}${ee.hash}" `),kl(Ee==null||Ee[Ee.length-1].route.element!==void 0||Ee[Ee.length-1].route.Component!==void 0||Ee[Ee.length-1].route.lazy!==void 0,`Matched leaf route at location "${ee.pathname}${ee.search}${ee.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Ae=SS(Ee&&Ee.map(tt=>Object.assign({},tt,{params:Object.assign({},B,tt.params),pathname:ku([X,C.encodeLocation?C.encodeLocation(tt.pathname).pathname:tt.pathname]),pathnameBase:tt.pathnameBase==="/"?X:ku([X,C.encodeLocation?C.encodeLocation(tt.pathnameBase).pathname:tt.pathnameBase])})),E,m,x);return d&&Ae?he.createElement(Sg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...ee},navigationType:"POP"}},Ae):Ae}function vS(){let o=AS(),d=cS(o)?`${o.status} ${o.statusText}`:o instanceof Error?o.message:JSON.stringify(o),m=o instanceof Error?o.stack:null,x="rgba(200,200,200, 0.5)",C={padding:"0.5rem",backgroundColor:x},k={padding:"2px 4px",backgroundColor:x},E=null;return console.error("Error handled by React Router default ErrorBoundary:",o),E=he.createElement(he.Fragment,null,he.createElement("p",null,"💿 Hey developer 👋"),he.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",he.createElement("code",{style:k},"ErrorBoundary")," or"," ",he.createElement("code",{style:k},"errorElement")," prop on your route.")),he.createElement(he.Fragment,null,he.createElement("h2",null,"Unexpected Application Error!"),he.createElement("h3",{style:{fontStyle:"italic"}},d),m?he.createElement("pre",{style:C},m):null,E)}var xS=he.createElement(vS,null),bS=class extends he.Component{constructor(o){super(o),this.state={location:o.location,revalidation:o.revalidation,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,d){return d.location!==o.location||d.revalidation!=="idle"&&o.revalidation==="idle"?{error:o.error,location:o.location,revalidation:o.revalidation}:{error:o.error!==void 0?o.error:d.error,location:d.location,revalidation:o.revalidation||d.revalidation}}componentDidCatch(o,d){console.error("React Router caught the following error during render",o,d)}render(){return this.state.error!==void 0?he.createElement(Mo.Provider,{value:this.props.routeContext},he.createElement(ax.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function wS({routeContext:o,match:d,children:m}){let x=he.useContext(Fp);return x&&x.static&&x.staticContext&&(d.route.errorElement||d.route.ErrorBoundary)&&(x.staticContext._deepestRenderedBoundaryId=d.route.id),he.createElement(Mo.Provider,{value:o},m)}function SS(o,d=[],m=null,x=null){if(o==null){if(!m)return null;if(m.errors)o=m.matches;else if(d.length===0&&!m.initialized&&m.matches.length>0)o=m.matches;else return null}let C=o,k=m==null?void 0:m.errors;if(k!=null){let B=C.findIndex(V=>V.route.id&&(k==null?void 0:k[V.route.id])!==void 0);Gi(B>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(k).join(",")}`),C=C.slice(0,Math.min(C.length,B+1))}let E=!1,l=-1;if(m)for(let B=0;B<C.length;B++){let V=C[B];if((V.route.HydrateFallback||V.route.hydrateFallbackElement)&&(l=B),V.route.id){let{loaderData:X,errors:ne}=m,re=V.route.loader&&!X.hasOwnProperty(V.route.id)&&(!ne||ne[V.route.id]===void 0);if(V.route.lazy||re){E=!0,l>=0?C=C.slice(0,l+1):C=[C[0]];break}}}return C.reduceRight((B,V,X)=>{let ne,re=!1,ee=null,te=null;m&&(ne=k&&V.route.id?k[V.route.id]:void 0,ee=V.route.errorElement||xS,E&&(l<0&&X===0?(R1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),re=!0,te=null):l===X&&(re=!0,te=V.route.hydrateFallbackElement||null)));let be=d.concat(C.slice(0,X+1)),Ee=()=>{let Ae;return ne?Ae=ee:re?Ae=te:V.route.Component?Ae=he.createElement(V.route.Component,null):V.route.element?Ae=V.route.element:Ae=B,he.createElement(wS,{match:V,routeContext:{outlet:B,matches:be,isDataRoute:m!=null},children:Ae})};return m&&(V.route.ErrorBoundary||V.route.errorElement||X===0)?he.createElement(bS,{location:m.location,revalidation:m.revalidation,component:ee,error:ne,children:Ee(),routeContext:{outlet:null,matches:be,isDataRoute:!0}}):Ee()},null)}function nx(o){return`${o} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function TS(o){let d=he.useContext(Fp);return Gi(d,nx(o)),d}function MS(o){let d=he.useContext(r_);return Gi(d,nx(o)),d}function ES(o){let d=he.useContext(Mo);return Gi(d,nx(o)),d}function sx(o){let d=ES(o),m=d.matches[d.matches.length-1];return Gi(m.route.id,`${o} can only be used on routes that contain a unique "id"`),m.route.id}function CS(){return sx("useRouteId")}function AS(){var x;let o=he.useContext(ax),d=MS("useRouteError"),m=sx("useRouteError");return o!==void 0?o:(x=d.errors)==null?void 0:x[m]}function kS(){let{router:o}=TS("useNavigate"),d=sx("useNavigate"),m=he.useRef(!1);return z1(()=>{m.current=!0}),he.useCallback(async(C,k={})=>{kl(m.current,j1),m.current&&(typeof C=="number"?o.navigate(C):await o.navigate(C,{fromRouteId:d,...k}))},[o,d])}var Qx={};function R1(o,d,m){!d&&!Qx[o]&&(Qx[o]=!0,kl(!1,m))}he.memo(PS);function PS({routes:o,future:d,state:m}){return I1(o,void 0,m,d)}function D1({to:o,replace:d,state:m,relative:x}){Gi(Up(),"<Navigate> may be used only in the context of a <Router> component.");let{static:C}=he.useContext(jl);kl(!C,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:k}=he.useContext(Mo),{pathname:E}=Iu(),l=zl(),B=ix(o,rx(k),E,x==="path"),V=JSON.stringify(B);return he.useEffect(()=>{l(JSON.parse(V),{replace:d,state:m,relative:x})},[l,V,x,d,m]),null}function N1(o){return gS(o.context)}function sn(o){Gi(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function jS({basename:o="/",children:d=null,location:m,navigationType:x="POP",navigator:C,static:k=!1}){Gi(!Up(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let E=o.replace(/^\/*/,"/"),l=he.useMemo(()=>({basename:E,navigator:C,static:k,future:{}}),[E,C,k]);typeof m=="string"&&(m=Bp(m));let{pathname:B="/",search:V="",hash:X="",state:ne=null,key:re="default"}=m,ee=he.useMemo(()=>{let te=Oh(B,E);return te==null?null:{location:{pathname:te,search:V,hash:X,state:ne,key:re},navigationType:x}},[E,B,V,X,ne,re,x]);return kl(ee!=null,`<Router basename="${E}"> is not able to match the URL "${B}${V}${X}" because it does not start with the basename, so the <Router> won't render anything.`),ee==null?null:he.createElement(jl.Provider,{value:l},he.createElement(Sg.Provider,{children:d,value:ee}))}function zS({children:o,location:d}){return _S(Y_(o),d)}function Y_(o,d=[]){let m=[];return he.Children.forEach(o,(x,C)=>{if(!he.isValidElement(x))return;let k=[...d,C];if(x.type===he.Fragment){m.push.apply(m,Y_(x.props.children,k));return}Gi(x.type===sn,`[${typeof x.type=="string"?x.type:x.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gi(!x.props.index||!x.props.children,"An index route cannot have child routes.");let E={id:x.props.id||k.join("-"),caseSensitive:x.props.caseSensitive,element:x.props.element,Component:x.props.Component,index:x.props.index,path:x.props.path,loader:x.props.loader,action:x.props.action,hydrateFallbackElement:x.props.hydrateFallbackElement,HydrateFallback:x.props.HydrateFallback,errorElement:x.props.errorElement,ErrorBoundary:x.props.ErrorBoundary,hasErrorBoundary:x.props.hasErrorBoundary===!0||x.props.ErrorBoundary!=null||x.props.errorElement!=null,shouldRevalidate:x.props.shouldRevalidate,handle:x.props.handle,lazy:x.props.lazy};x.props.children&&(E.children=Y_(x.props.children,k)),m.push(E)}),m}var l0="get",c0="application/x-www-form-urlencoded";function i_(o){return o!=null&&typeof o.tagName=="string"}function IS(o){return i_(o)&&o.tagName.toLowerCase()==="button"}function RS(o){return i_(o)&&o.tagName.toLowerCase()==="form"}function DS(o){return i_(o)&&o.tagName.toLowerCase()==="input"}function NS(o){return!!(o.metaKey||o.altKey||o.ctrlKey||o.shiftKey)}function LS(o,d){return o.button===0&&(!d||d==="_self")&&!NS(o)}var r0=null;function OS(){if(r0===null)try{new FormData(document.createElement("form"),0),r0=!1}catch{r0=!0}return r0}var BS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function L_(o){return o!=null&&!BS.has(o)?(kl(!1,`"${o}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${c0}"`),null):o}function FS(o,d){let m,x,C,k,E;if(RS(o)){let l=o.getAttribute("action");x=l?Oh(l,d):null,m=o.getAttribute("method")||l0,C=L_(o.getAttribute("enctype"))||c0,k=new FormData(o)}else if(IS(o)||DS(o)&&(o.type==="submit"||o.type==="image")){let l=o.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let B=o.getAttribute("formaction")||l.getAttribute("action");if(x=B?Oh(B,d):null,m=o.getAttribute("formmethod")||l.getAttribute("method")||l0,C=L_(o.getAttribute("formenctype"))||L_(l.getAttribute("enctype"))||c0,k=new FormData(l,o),!OS()){let{name:V,type:X,value:ne}=o;if(X==="image"){let re=V?`${V}.`:"";k.append(`${re}x`,"0"),k.append(`${re}y`,"0")}else V&&k.append(V,ne)}}else{if(i_(o))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');m=l0,x=null,C=c0,E=o}return k&&C==="text/plain"&&(E=k,k=void 0),{action:x,method:m.toLowerCase(),encType:C,formData:k,body:E}}function ox(o,d){if(o===!1||o===null||typeof o>"u")throw new Error(d)}async function US(o,d){if(o.id in d)return d[o.id];try{let m=await import(o.module);return d[o.id]=m,m}catch(m){return console.error(`Error loading route module \`${o.module}\`, reloading page...`),console.error(m),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function VS(o){return o==null?!1:o.href==null?o.rel==="preload"&&typeof o.imageSrcSet=="string"&&typeof o.imageSizes=="string":typeof o.rel=="string"&&typeof o.href=="string"}async function qS(o,d,m){let x=await Promise.all(o.map(async C=>{let k=d.routes[C.route.id];if(k){let E=await US(k,m);return E.links?E.links():[]}return[]}));return HS(x.flat(1).filter(VS).filter(C=>C.rel==="stylesheet"||C.rel==="preload").map(C=>C.rel==="stylesheet"?{...C,rel:"prefetch",as:"style"}:{...C,rel:"prefetch"}))}function Jx(o,d,m,x,C,k){let E=(B,V)=>m[V]?B.route.id!==m[V].route.id:!0,l=(B,V)=>{var X;return m[V].pathname!==B.pathname||((X=m[V].route.path)==null?void 0:X.endsWith("*"))&&m[V].params["*"]!==B.params["*"]};return k==="assets"?d.filter((B,V)=>E(B,V)||l(B,V)):k==="data"?d.filter((B,V)=>{var ne;let X=x.routes[B.route.id];if(!X||!X.hasLoader)return!1;if(E(B,V)||l(B,V))return!0;if(B.route.shouldRevalidate){let re=B.route.shouldRevalidate({currentUrl:new URL(C.pathname+C.search+C.hash,window.origin),currentParams:((ne=m[0])==null?void 0:ne.params)||{},nextUrl:new URL(o,window.origin),nextParams:B.params,defaultShouldRevalidate:!0});if(typeof re=="boolean")return re}return!0}):[]}function ZS(o,d){return $S(o.map(m=>{let x=d.routes[m.route.id];if(!x)return[];let C=[x.module];return x.imports&&(C=C.concat(x.imports)),C}).flat(1))}function $S(o){return[...new Set(o)]}function GS(o){let d={},m=Object.keys(o).sort();for(let x of m)d[x]=o[x];return d}function HS(o,d){let m=new Set;return new Set(d),o.reduce((x,C)=>{let k=JSON.stringify(GS(C));return m.has(k)||(m.add(k),x.push({key:k,link:C})),x},[])}function WS(o){let d=typeof o=="string"?new URL(o,typeof window>"u"?"server://singlefetch/":window.location.origin):o;return d.pathname==="/"?d.pathname="_root.data":d.pathname=`${d.pathname.replace(/\/$/,"")}.data`,d}function XS(){let o=he.useContext(Fp);return ox(o,"You must render this element inside a <DataRouterContext.Provider> element"),o}function YS(){let o=he.useContext(r_);return ox(o,"You must render this element inside a <DataRouterStateContext.Provider> element"),o}var lx=he.createContext(void 0);lx.displayName="FrameworkContext";function L1(){let o=he.useContext(lx);return ox(o,"You must render this element inside a <HydratedRouter> element"),o}function KS(o,d){let m=he.useContext(lx),[x,C]=he.useState(!1),[k,E]=he.useState(!1),{onFocus:l,onBlur:B,onMouseEnter:V,onMouseLeave:X,onTouchStart:ne}=d,re=he.useRef(null);he.useEffect(()=>{if(o==="render"&&E(!0),o==="viewport"){let be=Ae=>{Ae.forEach(Ie=>{E(Ie.isIntersecting)})},Ee=new IntersectionObserver(be,{threshold:.5});return re.current&&Ee.observe(re.current),()=>{Ee.disconnect()}}},[o]),he.useEffect(()=>{if(x){let be=setTimeout(()=>{E(!0)},100);return()=>{clearTimeout(be)}}},[x]);let ee=()=>{C(!0)},te=()=>{C(!1),E(!1)};return m?o!=="intent"?[k,re,{}]:[k,re,{onFocus:Vm(l,ee),onBlur:Vm(B,te),onMouseEnter:Vm(V,ee),onMouseLeave:Vm(X,te),onTouchStart:Vm(ne,ee)}]:[!1,re,{}]}function Vm(o,d){return m=>{o&&o(m),m.defaultPrevented||d(m)}}function QS({page:o,...d}){let{router:m}=XS(),x=he.useMemo(()=>E1(m.routes,o,m.basename),[m.routes,o,m.basename]);return x?he.createElement(eT,{page:o,matches:x,...d}):null}function JS(o){let{manifest:d,routeModules:m}=L1(),[x,C]=he.useState([]);return he.useEffect(()=>{let k=!1;return qS(o,d,m).then(E=>{k||C(E)}),()=>{k=!0}},[o,d,m]),x}function eT({page:o,matches:d,...m}){let x=Iu(),{manifest:C,routeModules:k}=L1(),{loaderData:E,matches:l}=YS(),B=he.useMemo(()=>Jx(o,d,l,C,x,"data"),[o,d,l,C,x]),V=he.useMemo(()=>Jx(o,d,l,C,x,"assets"),[o,d,l,C,x]),X=he.useMemo(()=>{if(o===x.pathname+x.search+x.hash)return[];let ee=new Set,te=!1;if(d.forEach(Ee=>{var Ie;let Ae=C.routes[Ee.route.id];!Ae||!Ae.hasLoader||(!B.some(tt=>tt.route.id===Ee.route.id)&&Ee.route.id in E&&((Ie=k[Ee.route.id])!=null&&Ie.shouldRevalidate)||Ae.hasClientLoader?te=!0:ee.add(Ee.route.id))}),ee.size===0)return[];let be=WS(o);return te&&ee.size>0&&be.searchParams.set("_routes",d.filter(Ee=>ee.has(Ee.route.id)).map(Ee=>Ee.route.id).join(",")),[be.pathname+be.search]},[E,x,C,B,d,o,k]),ne=he.useMemo(()=>ZS(V,C),[V,C]),re=JS(V);return he.createElement(he.Fragment,null,X.map(ee=>he.createElement("link",{key:ee,rel:"prefetch",as:"fetch",href:ee,...m})),ne.map(ee=>he.createElement("link",{key:ee,rel:"modulepreload",href:ee,...m})),re.map(({key:ee,link:te})=>he.createElement("link",{key:ee,...te})))}function tT(...o){return d=>{o.forEach(m=>{typeof m=="function"?m(d):m!=null&&(m.current=d)})}}var O1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{O1&&(window.__reactRouterVersion="7.1.5")}catch{}function rT({basename:o,children:d,window:m}){let x=he.useRef();x.current==null&&(x.current=U2({window:m,v5Compat:!0}));let C=x.current,[k,E]=he.useState({action:C.action,location:C.location}),l=he.useCallback(B=>{he.startTransition(()=>E(B))},[E]);return he.useLayoutEffect(()=>C.listen(l),[C,l]),he.createElement(jS,{basename:o,children:d,location:k.location,navigationType:k.action,navigator:C})}var B1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zc=he.forwardRef(function({onClick:d,discover:m="render",prefetch:x="none",relative:C,reloadDocument:k,replace:E,state:l,target:B,to:V,preventScrollReset:X,viewTransition:ne,...re},ee){let{basename:te}=he.useContext(jl),be=typeof V=="string"&&B1.test(V),Ee,Ae=!1;if(typeof V=="string"&&be&&(Ee=V,O1))try{let at=new URL(window.location.href),xt=V.startsWith("//")?new URL(at.protocol+V):new URL(V),zt=Oh(xt.pathname,te);xt.origin===at.origin&&zt!=null?V=zt+xt.search+xt.hash:Ae=!0}catch{kl(!1,`<Link to="${V}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let Ie=fS(V,{relative:C}),[tt,vt,nt]=KS(x,re),Ye=nT(V,{replace:E,state:l,target:B,preventScrollReset:X,relative:C,viewTransition:ne});function st(at){d&&d(at),at.defaultPrevented||Ye(at)}let ot=he.createElement("a",{...re,...nt,href:Ee||Ie,onClick:Ae||k?d:st,ref:tT(ee,vt),target:B,"data-discover":!be&&m==="render"?"true":void 0});return tt&&!be?he.createElement(he.Fragment,null,ot,he.createElement(QS,{page:Ie})):ot});zc.displayName="Link";var Sc=he.forwardRef(function({"aria-current":d="page",caseSensitive:m=!1,className:x="",end:C=!1,style:k,to:E,viewTransition:l,children:B,...V},X){let ne=Tg(E,{relative:V.relative}),re=Iu(),ee=he.useContext(r_),{navigator:te,basename:be}=he.useContext(jl),Ee=ee!=null&&uT(ne)&&l===!0,Ae=te.encodeLocation?te.encodeLocation(ne).pathname:ne.pathname,Ie=re.pathname,tt=ee&&ee.navigation&&ee.navigation.location?ee.navigation.location.pathname:null;m||(Ie=Ie.toLowerCase(),tt=tt?tt.toLowerCase():null,Ae=Ae.toLowerCase()),tt&&be&&(tt=Oh(tt,be)||tt);const vt=Ae!=="/"&&Ae.endsWith("/")?Ae.length-1:Ae.length;let nt=Ie===Ae||!C&&Ie.startsWith(Ae)&&Ie.charAt(vt)==="/",Ye=tt!=null&&(tt===Ae||!C&&tt.startsWith(Ae)&&tt.charAt(Ae.length)==="/"),st={isActive:nt,isPending:Ye,isTransitioning:Ee},ot=nt?d:void 0,at;typeof x=="function"?at=x(st):at=[x,nt?"active":null,Ye?"pending":null,Ee?"transitioning":null].filter(Boolean).join(" ");let xt=typeof k=="function"?k(st):k;return he.createElement(zc,{...V,"aria-current":ot,className:at,ref:X,style:xt,to:E,viewTransition:l},typeof B=="function"?B(st):B)});Sc.displayName="NavLink";var iT=he.forwardRef(({discover:o="render",fetcherKey:d,navigate:m,reloadDocument:x,replace:C,state:k,method:E=l0,action:l,onSubmit:B,relative:V,preventScrollReset:X,viewTransition:ne,...re},ee)=>{let te=lT(),be=cT(l,{relative:V}),Ee=E.toLowerCase()==="get"?"get":"post",Ae=typeof l=="string"&&B1.test(l),Ie=tt=>{if(B&&B(tt),tt.defaultPrevented)return;tt.preventDefault();let vt=tt.nativeEvent.submitter,nt=(vt==null?void 0:vt.getAttribute("formmethod"))||E;te(vt||tt.currentTarget,{fetcherKey:d,method:nt,navigate:m,replace:C,state:k,relative:V,preventScrollReset:X,viewTransition:ne})};return he.createElement("form",{ref:ee,method:Ee,action:be,onSubmit:x?B:Ie,...re,"data-discover":!Ae&&o==="render"?"true":void 0})});iT.displayName="Form";function aT(o){return`${o} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function F1(o){let d=he.useContext(Fp);return Gi(d,aT(o)),d}function nT(o,{target:d,replace:m,state:x,preventScrollReset:C,relative:k,viewTransition:E}={}){let l=zl(),B=Iu(),V=Tg(o,{relative:k});return he.useCallback(X=>{if(LS(X,d)){X.preventDefault();let ne=m!==void 0?m:xg(B)===xg(V);l(o,{replace:ne,state:x,preventScrollReset:C,relative:k,viewTransition:E})}},[B,l,V,m,x,d,o,C,k,E])}var sT=0,oT=()=>`__${String(++sT)}__`;function lT(){let{router:o}=F1("useSubmit"),{basename:d}=he.useContext(jl),m=CS();return he.useCallback(async(x,C={})=>{let{action:k,method:E,encType:l,formData:B,body:V}=FS(x,d);if(C.navigate===!1){let X=C.fetcherKey||oT();await o.fetch(X,m,C.action||k,{preventScrollReset:C.preventScrollReset,formData:B,body:V,formMethod:C.method||E,formEncType:C.encType||l,flushSync:C.flushSync})}else await o.navigate(C.action||k,{preventScrollReset:C.preventScrollReset,formData:B,body:V,formMethod:C.method||E,formEncType:C.encType||l,replace:C.replace,state:C.state,fromRouteId:m,flushSync:C.flushSync,viewTransition:C.viewTransition})},[o,d,m])}function cT(o,{relative:d}={}){let{basename:m}=he.useContext(jl),x=he.useContext(Mo);Gi(x,"useFormAction must be used inside a RouteContext");let[C]=x.matches.slice(-1),k={...Tg(o||".",{relative:d})},E=Iu();if(o==null){k.search=E.search;let l=new URLSearchParams(k.search),B=l.getAll("index");if(B.some(X=>X==="")){l.delete("index"),B.filter(ne=>ne).forEach(ne=>l.append("index",ne));let X=l.toString();k.search=X?`?${X}`:""}}return(!o||o===".")&&C.route.index&&(k.search=k.search?k.search.replace(/^\?/,"?index&"):"?index"),m!=="/"&&(k.pathname=k.pathname==="/"?m:ku([m,k.pathname])),xg(k)}function uT(o,d={}){let m=he.useContext(P1);Gi(m!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:x}=F1("useViewTransitionState"),C=Tg(o,{relative:d.relative});if(!m.isTransitioning)return!1;let k=Oh(m.currentLocation.pathname,x)||m.currentLocation.pathname,E=Oh(m.nextLocation.pathname,x)||m.nextLocation.pathname;return Uy(C.pathname,E)!=null||Uy(C.pathname,k)!=null}new TextEncoder;const hT=()=>w.jsxs(w.Fragment,{children:[w.jsx("nav",{className:"bg-white dark:bg-gray-900 fixed w-full z-20 top-0 start-0 border-b border-gray-200 dark:border-gray-600",children:w.jsxs("div",{className:"max-w-6xl mx-auto flex flex-wrap items-center justify-between p-4",children:[w.jsx("span",{className:"self-center text-2xl font-semibold whitespace-nowrap dark:text-white",children:"BeanLink"}),w.jsx("div",{className:"flex items-center gap-2 w-fit md:order-2",children:w.jsx("a",{href:"/login",className:"flex w-full justify-center rounded-full bg-amber-700 border border-transparent px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800",children:"Acceder"})}),w.jsx("div",{className:"hidden md:flex md:items-center",children:w.jsx("ul",{className:"flex space-x-8 font-medium",children:w.jsx("li",{children:w.jsx(zc,{title:"Home",to:"/",className:"text-gray-900 dark:text-white hover:text-lime-700 dark:hover:text-lime-500",children:w.jsx(Fy,{size:20})})})})})]})}),w.jsx("div",{className:"h-[50px]"}),w.jsx("div",{className:"fixed bottom-0 w-full left-0 bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-600 flex justify-around py-3 md:hidden",children:w.jsx(zc,{title:"Home",to:"/",className:"text-gray-900 dark:text-white hover:text-lime-700 dark:hover:text-lime-500",children:w.jsx(Fy,{size:20})})})]}),dT=()=>w.jsx("header",{children:w.jsx(hT,{})}),Wt={url:"https://beanlink.es/api/"},U1=he.createContext(),fT=({children:o})=>{const[d,m]=he.useState(null),[x,C]=he.useState(!0);he.useEffect(()=>{k()},[]);const k=async()=>{const E=localStorage.getItem("token"),l=localStorage.getItem("user");if(!E||!l)return C(!1),!1;const V=JSON.parse(l).id,ne=await(await fetch(Wt.url+"users/"+V,{method:"GET",headers:{Authorization:E}})).json(),re={...ne.user,id:ne.user._id};m(re),C(!1)};return w.jsx(U1.Provider,{value:{auth:d,setAuth:m,loading:x},children:o})},Ri=()=>he.useContext(U1),pT=()=>{const{auth:o,loading:d}=Ri();return d?w.jsxs("div",{className:"flex justify-center items-center mt-4",children:[w.jsxs("svg",{className:"animate-spin h-6 w-6 text-amber-600 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 11-8 8z"})]}),w.jsx("p",{className:"text-amber-600 font-medium",children:"Cargando..."})]}):w.jsxs(w.Fragment,{children:[w.jsx(dT,{}),w.jsx("section",{className:"min-h-screen bg-gray-700",children:!o||!o.id?w.jsx(N1,{}):w.jsx(D1,{to:"/private"})})]})},Il=(o={})=>{const[d,m]=he.useState(o);return{form:d,changed:({target:C})=>{const{name:k,value:E}=C;m({...d,[k]:E})},setForm:m}},cx=()=>{const[o,d]=he.useState({});return{validateRegister:k=>{let E={};return k.username?(k.username.trim().length>30||k.username.trim().length<3)&&(E.username="Longitud de usuario superior a 30 caractéres o inferior a 3"):E.username="Nombre de usuario obligatorio",(!k.email||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(k.email))&&(E.email="El correo electrónico no es válido"),(!k.password||!/^(?=(.*[a-z]))(?=(.*[A-Z]))(?=(.*[\W_])).{8,}$/.test(k.password))&&(E.password="La contraseña debe tener al menos 8 caracteres, una mayúscula, una minúscula y un símbolo."),(!k.password2||!/^(?=(.*[a-z]))(?=(.*[A-Z]))(?=(.*[\W_])).{8,}$/.test(k.password))&&(E.password2="La contraseña debe tener al menos 8 caracteres, una mayúscula, una minúscula y un símbolo."),k.password!==k.password2&&(E.passwordDiferent="Las contraseñas son diferentes"),k.role||(E.role="Se debe seleccionar un roll"),d(E),!Object.keys(E).length>0},validateLogin:k=>{let E={};k.username?(k.username.trim().length>30||k.username.trim().length<3)&&(E.username="Longitud de usuario superior a 30 caractéres o inferior a 3"):E.username="Nombre de usuario obligatorio",(!k.password||!/^(?=(.*[a-z]))(?=(.*[A-Z]))(?=(.*[\W_])).{8,}$/.test(k.password))&&(E.password="La contraseña debe tener al menos 8 caracteres, una mayúscula, una minúscula y un símbolo."),d(E)},validateUpdate:k=>{let E={};return(k.username&&k.username.trim().length>30||k.username.trim().length<3)&&(E.username="Longitud de usuario superior a 30 caractéres o inferior a 3"),k.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(k.email)&&(E.email="El correo electrónico no es válido"),k.password&&!/^(?=(.*[a-z]))(?=(.*[A-Z]))(?=(.*[\W_])).{8,}$/.test(k.password)&&(E.password="La contraseña debe tener al menos 8 caracteres, una mayúscula, una minúscula y un símbolo."),k.password2&&!/^(?=(.*[a-z]))(?=(.*[A-Z]))(?=(.*[\W_])).{8,}$/.test(k.password)&&(E.password2="La contraseña debe tener al menos 8 caracteres, una mayúscula, una minúscula y un símbolo."),k.password&&k.password2&&k.password!==k.password2&&(E.passwordDiferent="Las contraseñas son diferentes"),d(E),!Object.keys(E).length>0},errors:o}},mT=()=>{const{form:o,changed:d}=Il({}),[m,x]=he.useState("not-sended"),[C,k]=he.useState("");zl();const{setAuth:E}=Ri(),{errors:l,validateLogin:B}=cx(),[V,X]=he.useState(!1),ne=async re=>{if(re.preventDefault(),!!B(o))return;let te=o;const Ee=await(await fetch(Wt.url+"auth/login",{method:"POST",body:JSON.stringify(te),headers:{"Content-type":"application/json"},credentials:"include"})).json();Ee.status==="success"?(localStorage.setItem("token",Ee.token),localStorage.setItem("user",JSON.stringify(Ee.user)),x(!0),k(Ee.message),E(Ee.user)):(x(!1),k(Ee.message))};return w.jsx("div",{className:"min-h-screen flex items-center justify-center",children:w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-xs w-full",children:[w.jsx("h1",{className:"text-3xl text-center",children:"Inicio de sesión"}),w.jsxs("form",{className:"space-y-6 mt-8",onSubmit:ne,children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Username"}),w.jsxs("div",{className:"mt-2",children:[w.jsx("input",{type:"text",name:"username",required:!0,onChange:d,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),l.username&&w.jsx("div",{className:"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:w.jsx("strong",{className:"font-bold",children:l.username})})]})]}),w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-900",children:"Password"}),w.jsx("div",{className:"text-sm",children:w.jsx(zc,{to:"/forgot-password",className:"font-semibold text-amber-700 hover:text-amber-500",children:"He olvidado mi contraseña"})})]}),w.jsxs("div",{className:"mt-2",children:[w.jsxs("div",{className:"flex items-center",children:[w.jsx("input",{type:V?"text":"password",name:"password",id:"password",autoComplete:"current-password",required:!0,onChange:d,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),w.jsx("input",{type:"checkbox",checked:V,onChange:()=>X(!V),className:"h-5 w-5 ml-2"})]}),l.password&&w.jsx("div",{className:"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:w.jsx("strong",{className:"font-bold",children:l.password})})]})]}),w.jsx("div",{children:w.jsx("button",{type:"submit",className:"flex w-full justify-center rounded-full bg-amber-700 border border-transparent px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800",children:"Acceder"})})]}),w.jsxs("p",{className:"mt-10 text-center text-sm text-gray-500",children:["¿Todavía no eres miembro?"," ",w.jsx("a",{href:"/register",className:"font-semibold text-amber-700 hover:text-amber-500",children:"Únete"})]}),w.jsx("strong",{children:m==!0?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",C," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""}),w.jsx("strong",{children:m==!1?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",C," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""})]})})},Uh="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGd0lEQVR4nN1YW1cTVxTG57ZP7UNt+4NaX2ytPvVN24ILpNbWMkmQiwJKJomQBAKZmZAQCHKVS1QEQaEqFC9chALKrSCCKFGLIsyEfF37QKsIM0lA++C31l4r65w5+3w5Z19PTMz7DL3Z/TlnFPdxRsHA8WIBx4ula1LAxozivqPZ4mf/K6nfTjm/4IzCsWSLa4TjReh4MZTl8C0VlvllT03TComjrEGmMY4XQ/SNweK6l8SLyfSH3ikxnUl0cSZRSbMWy/UtHbg7fh/LsgI10Nzw+BTqW64jLbdYprWcURTf7qkCO5KM4iEdLy1mOcrkG33DCAZXEC2CwRV09Q4hM98n60zSiySjM550b4vb0WzxI51J8tM1Xvz9JmQliO1ClhU0tt9gpqE3S3WpdvuHWyJ3xFT4icEsdR+3eZWxqRm8bYxOPkC6rVjRm123aa+oT47I0XU8CjzDu8KjwFN25UQy8pMEdujNrgY6uXDkni++ROv1btjcZ5F0UkT8MRuTDLsPnd2DCIXCk5ybf4p0K52kVBeRTXK8kEj2oXWtKyshNLR04lCqHQkpdqTm+mBx+2H3NcFa0oh02xnE6nNh99RCCYa325G/pplNcryQED6U8NIiOYQalpZlmIVKHEy2wuI+h6rWXtS29W8Qd901xKfYkJnnQ7n/CqZnH2uSvNDWBfJuzRBEcY5CiZq30pXZ3LVITMtDsb9jU2Kvi6O8Bem2MhzJKEScIQet13s0vZvskeNFQfX0KJBSnFNDV88QYvU5KKq9GpZc7ety5Q5MrgbE6k+j/+6Eqv7OnkEQB+KygSClIsoQWkE4LdeL47Yz0ZFreyUpOaU4YStV1U/2ShknKVvUbyBIuZXSlxoeB57hR91pSDXtWyYo1rQzHU+eLajuU9t8jXL38DpyZJiU1O9O3FddODgyyZRXXuqOiExlSw9SckpwIq8cZy7eWh271M10DI1Oqu5Dc8RlnbPoeOdecnOtxN/z5yhTXnO5T5NY6fkuZm+H0uw4mmGFPtuGhFQbcypaSzp6BkY0owRVQTpe2LPO/k4WlC1pxqqJaaa8ouk2I1LV0sNiXqajitmW3lSEw8fz2DdHTlhRXVuAxRkPlh4WwyrkITHdDq+/k81TFaSFLEfpMscLuteCs1hANZzWotlHAabc29ABsboNCalWJKTk4KTNDsGTj5JyBxobnRjudWHlsRcIvJKXs8X4OT0HBrOX6ZiZm9ck6PA1ULjJf3WCRqGECk2tRYoSRFxyLru+g4ZcuLz5WLjvWUdES9weIwszcYZcyIq6KRHc1RdXOF70RkWQkGLxsDiYyp9GaD4yYliTC3Wn2OmRjnDYjKAj3BUTHEUlbJPqyuyoyCHgRcu5bLaWdITdZ8MVk5M4fMtaixbmx+C0HGCbXPJvnaDTcgALgXFNgpn5bzgJhRly7WVZ/RDnp3tw1rGHbUKbbZVgreMbpiuqMPNfoNZwf2X5OVqLdqNJ+BKzfRlRE5zty2BrW4u+hiK/UN1nkAK1UQj9aiz6dF02odaQui8tTPRVoVnahalbKVETnLqZgmZxFybu1GjuwVKdWRrckIup0aZEHa5ju1qxHwPN8VET7G+Ox7WK/Zq6qVhIzfXI6+zvzXKLWkMtjPdWotW9G8pcUcTklDkXW0M3oAUqt3S8JKs2+NRUZzl8qgUrQV5awOXivRhs/SligoOtiWwN2bEaqA7IyCuVOV5ybkruX2ehspv6Vi3MjLahSfgK4526sOTGOzj27exYu6bO81f+YCW/3lK4U5XgatB2xlNlQ32rFib765jRd/u/x99j1g3EaKzb/wP7ZnKgXlPXvYlpFlqSjMLBmMjaTqmOmmrqW7UQeNCL69WxLHx0VHyHhQk7FiZs7Dcbq45D4EGfpo65+SdIs3oUziRVx0QKaqKpmaYmhvpWbYTwZHYAXfWHGSkS+k1jNBeOHNmd3izd/IUv/iAmGtBzBJGkppr61nAIhVbw9OEgE/odDnStdHJEjsvyfBwVufUnKdWRTVLfSq3hdrEsK8wh2NuhSaqO+uQ2ANhBHT95GF05xaqtPL8pwSCLc2tX+jwyh4gCa/laWH3A9CiUkoZGJ6FVYNAcfUPfsgxBD5i85AwbSrb/Li0YqDXkeJFdFfUQVE9SoUlC9RyN6VbnYTC7hqjXfadPwJuStRTuTDKK31LupKKXKvM1cdAYlUwbqpL3Df8AdFRr12V+ybcAAAAASUVORK5CYII=",gT=()=>{const{form:o,changed:d}=Il({}),{validateRegister:m,errors:x}=cx(),[C,k]=he.useState("not-saved"),[E,l]=he.useState("not-saved"),B=zl(),[V,X]=he.useState(!1),[ne,re]=he.useState({length:!1,uppercase:!1,lowercase:!1,symbol:!1}),ee=async te=>{if(te.preventDefault(),m(o),x.length>1)return;let be=o;(be.avatar===""||!be.avatar)&&(be.avatar=Uh);const Ae=await(await fetch(Wt.url+"auth/register",{method:"POST",body:JSON.stringify(be),headers:{"Content-type":"application/json"}})).json();Ae.status=="success"?(k("saved"),l(Ae.message),setTimeout(()=>{B("/login")},1800)):(k("error"),l(Ae.message))};return he.useEffect(()=>{const te=o.password;te&&re({length:te.length>=8,uppercase:/[A-Z]/.test(te),lowercase:/[a-z]/.test(te),symbol:/[!@#$%^&*_\-(),.?":{}|<>]/.test(te)})},[o.password]),w.jsx("div",{className:"min-h-screen flex items-center justify-center mb-6",children:w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-4xl w-full",children:[w.jsx("h1",{className:"text-3xl text-center",children:"Registro"}),w.jsxs("form",{className:"space-y-6 mt-8",onSubmit:ee,children:[w.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-900",children:"Username"}),w.jsxs("div",{className:"mt-2",children:[w.jsx("input",{type:"text",name:"username",required:!0,onChange:d,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),x.username&&w.jsx("div",{className:"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:w.jsx("strong",{className:"font-bold",children:x.username})})]})]}),w.jsxs("div",{className:"flex-1 mt-6 md:mt-0",children:[w.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-900",children:"Email"}),w.jsxs("div",{className:"mt-2",children:[w.jsx("input",{type:"email",name:"email",required:!0,onChange:d,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),x.email&&w.jsx("div",{className:"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:w.jsx("strong",{className:"font-bold",children:x.email})})]})]})]}),w.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-900",children:"Contraseña"})}),w.jsx("div",{className:"mt-2 flex items-center",children:w.jsx("input",{type:V?"text":"password",name:"password",id:"password",autoComplete:"current-password",required:!0,onChange:d,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1 mt-6 md:mt-0",children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsx("label",{htmlFor:"password2",className:"block text-sm font-medium text-gray-900",children:"Repite Contraseña"})}),w.jsxs("div",{className:"mt-2 flex items-center",children:[w.jsx("input",{type:V?"text":"password",name:"password2",id:"password2",autoComplete:"current-password",required:!0,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),w.jsx("input",{type:"checkbox",className:"h-5 w-5 ml-2",checked:V,onChange:()=>X(!V)}),x.passwordDiferent&&w.jsx("div",{className:"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:w.jsx("strong",{className:"font-bold",children:x.passwordDiferent})})]})]})]}),w.jsxs("div",{children:[w.jsxs("div",{className:"mt-4 flex justify-around space-y-1 text-center p-2 rounded-md bg-gray-200 p-2",children:[w.jsx("p",{className:`text-sm font-bold ${ne.length?"text-lime-600":"text-amber-500"}`,children:"Mínimo 8 caracteres"}),w.jsx("p",{className:`text-sm font-bold ${ne.uppercase?"text-lime-600":"text-amber-500"}`,children:"Al menos una mayúscula"}),w.jsx("p",{className:`text-sm font-bold ${ne.lowercase?"text-lime-600":"text-amber-500"}`,children:"Al menos una minúscula"}),w.jsx("p",{className:`text-sm font-bold ${ne.symbol?"text-lime-600":"text-amber-500"}`,children:"Al menos un símbolo"})]}),x.password&&w.jsx("div",{className:"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:w.jsx("strong",{className:"font-bold",children:x.password})})]}),w.jsxs("div",{children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-900",children:"Tipo de perfil"})}),w.jsxs("div",{className:"mt-2",children:[w.jsxs("select",{name:"role",onChange:d,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm",children:[w.jsx("option",{value:"",children:"Selecciona rol"}),w.jsx("option",{value:"user",children:"Usuario"}),w.jsx("option",{value:"barista",children:"Barista"}),w.jsx("option",{value:"cafe",children:"Cafetería"}),w.jsx("option",{value:"roaster",children:"Tostador"}),w.jsx("option",{value:"producer",children:"Productor"})]}),x.role&&w.jsx("div",{className:"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:w.jsx("strong",{className:"font-bold",children:x.role})})]})]}),w.jsxs("div",{children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-900",children:"Biografía"})}),w.jsx("div",{className:"mt-2",children:w.jsx("textarea",{name:"bio",rows:"10",cols:"50",onChange:d,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsx("div",{className:"flex justify-center",children:w.jsx("button",{type:"submit",className:"flex justify-center rounded-full bg-amber-700 border border-transparent px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800",children:"Sign Up"})})]}),w.jsx("strong",{children:C=="saved"?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",E," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""}),w.jsx("strong",{children:C=="error"?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",E," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""})]})})},yT="/assets/beans-NdsvLcL4.jpg",V1=()=>w.jsx("footer",{className:"bg-gray-800 w-full h-max-full text-white py-8 mt-1 md:mt-6 mb-6 md:mb-0 overflow-auto",children:w.jsxs("div",{className:"w-full md:max-w-6xl mx-auto px-6",children:[w.jsxs("div",{className:"flex flex-col md:flex-row text-center justify-around gap-4",children:[w.jsxs("div",{children:[w.jsx("h3",{className:"font-semibold text-xl mb-4",children:"Información"}),w.jsxs("ul",{children:[w.jsx("li",{children:w.jsx(zc,{to:"/privacity-policy",className:"text-gray-400 hover:text-white",children:"Política de Privacidad"})}),w.jsx("li",{children:w.jsx(zc,{to:"/privacity-policy",className:"text-gray-400 hover:text-white",children:"Términos de Uso"})})]})]}),w.jsxs("div",{children:[w.jsx("h3",{className:"font-semibold text-xl mb-4",children:"Contacto"}),w.jsx("ul",{children:w.jsx("li",{className:"text-gray-400",children:"Email: support@beanlink.es"})})]})]}),w.jsx("div",{className:"mt-8 border-t border-gray-700 pt-4 text-center text-gray-400",children:w.jsx("p",{children:"© 2025. Todos los derechos reservados."})})]})}),_T=()=>{const{changed:o,form:d}=Il(),[m,x]=he.useState(null),[C,k]=he.useState(null),E=async l=>{l.preventDefault();try{const V=await(await fetch(Wt.url+"send/support-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).json();V.status==="success"?(x(V.message),k(!0),setTimeout(()=>{k(null)},4e3)):(x(V.message),k(!1),setTimeout(()=>{k(null)},4e3))}catch(B){console.log(B),k(!1),x(B.message)}};return w.jsxs("div",{className:"bg-gray-300",children:[w.jsxs("div",{className:"relative",children:[w.jsx("img",{src:yT,alt:"Café de especialidad",className:"w-full h-[400px] object-cover"}),w.jsx("div",{className:"absolute inset-0 flex justify-center items-center",children:w.jsx("h2",{className:"text-4xl font-semibold text-white text-center px-6",children:"Conecta con el mundo del café de especialidad."})})]}),w.jsx("div",{className:"flex justify-center",children:w.jsxs("div",{className:"w-full md:max-w-6xl",children:[w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6",id:"home",children:[w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"En nuestra plataforma, cada taza de café cuenta una historia única, desde la finca que lo cultiva hasta el barista que lo prepara. Nuestro objetivo es crear una red de conexión que valore cada paso del proceso de producción del café y promueva la transparencia, la calidad y la colaboración entre productores, cafeterías y amantes del café."}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"Ya sea que seas un productor de café buscando nuevos mercados, una cafetería queriendo compartir tus mejores recetas o un usuario que disfruta descubrir nuevas experiencias, aquí encontrarás un espacio para ti. A través de nuestra plataforma podrás registrar tus cafés, compartir tus recetas y descubrir publicaciones con recomendaciones y resultados."}),w.jsx("p",{className:"text-xl font-semibold mt-4",children:"Características principales:"}),w.jsxs("ul",{className:"pl-5 space-y-2 mt-4",children:[w.jsxs("li",{children:[w.jsx("strong",{className:"text-gray-700",children:"Conexión entre usuarios:"})," ","conecta con productores, cafeterías y otros amantes del café."]}),w.jsxs("li",{children:[w.jsx("strong",{className:"text-gray-700",children:"Registro de cafés de especialidad:"})," ","guarda y organiza los cafés que pruebas y disfrutas."]}),w.jsxs("li",{children:[w.jsx("strong",{className:"text-gray-700",children:"Recetas personalizadas:"})," ","vincula recetas a tus cafés favoritos y compártelas con la comunidad subiendo publicaciones con el contenido que deseas."]}),w.jsxs("li",{children:[w.jsx("strong",{className:"text-gray-700",children:"Geolocalización dinámica:"})," ","encuentra productores y cafeterías cercanas con nuestro mapa interactivo."]})]})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6",id:"about-us",children:[w.jsx("h2",{className:"text-4xl font-semibold text-center mb-6",children:"Sobre Nosotros"}),w.jsxs("p",{className:"text-lg leading-relaxed mt-4",children:[w.jsx("strong",{className:"text-gray-700",children:"Más que un café, una comunidad."})," ","Somos un equipo apasionado por el café de especialidad y creemos que cada paso en la cadena de producción tiene un impacto significativo en el sabor final de la taza. Nuestro proyecto nace con la misión de crear un espacio en el que cada parte de esa cadena sea reconocida y valorizada. Desde los productores que cultivan el café con cuidado y dedicación, hasta los baristas que convierten cada taza en una obra de arte, todos tienen un lugar en nuestra plataforma."]}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"Queremos facilitar la conexión entre las diferentes partes de este mundo fascinante del café, promoviendo la colaboración, el aprendizaje y la sostenibilidad. A través de nuestra plataforma, buscamos no solo mejorar la experiencia del café, sino también construir una red sólida que apoya la calidad y la transparencia en todo el proceso."}),w.jsxs("p",{className:"text-lg leading-relaxed mt-4",children:[w.jsx("strong",{className:"text-gray-700",children:"Misión"}),": Promover el café de especialidad y conectar a todos los involucrados en su cadena de valor de manera accesible, colaborativa y responsable."]}),w.jsxs("p",{className:"text-lg leading-relaxed mt-4",children:[w.jsx("strong",{className:"text-gray-700",children:"Visión:"})," Ser la plataforma de referencia global para los amantes del café, creando una red interconectada que celebre la excelencia, la creatividad y la sostenibilidad."]})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6",id:"contact",children:[w.jsx("h2",{className:"text-4xl font-semibold text-center mb-6",children:"Contacto"}),w.jsxs("form",{onSubmit:E,children:[w.jsxs("div",{className:"flex flex-wrap gap-6",children:[w.jsxs("div",{className:"w-full sm:w-1/3",children:[w.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-900",children:"Tu nombre"}),w.jsx("input",{name:"name",type:"text",onChange:o,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{className:"w-full sm:w-1/3",children:[w.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-900",children:"Tu email"}),w.jsx("input",{name:"email",type:"email",onChange:o,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]})]}),w.jsx("label",{className:"mt-4 block text-sm font-medium text-gray-900",children:"Tu mensaje"}),w.jsx("textarea",{type:"text",name:"message",onChange:o,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm h-40 resize-none"}),w.jsx("div",{className:"flex justify-center",children:w.jsx("button",{type:"submit",className:"bg-amber-700 text-white py-2 px-4 mt-4 rounded-full hover:bg-amber-800",children:"Enviar"})}),w.jsx("strong",{children:C==!0?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",m," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""}),w.jsx("strong",{children:C==!1?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",m," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""})]})]})]})}),w.jsx(V1,{})]})},vT=()=>{const{changed:o,form:d}=Il(),[m,x]=he.useState(null),[C,k]=he.useState(null),{token:E}=yS(),l=zl(),B=async V=>{V.preventDefault(),d.password1!==d.password2?(x("Las contraseñas no son iguales"),k(!1)):/^(?=(.*[a-z]))(?=(.*[A-Z]))(?=(.*[\W_])).{8,}$/.test(d.password)||(x("La contraseña debe tener al menos 8 caracteres, una mayúscula, una minúscula y un símbolo"),k(!1));try{const ne=await(await fetch(Wt.url+"user/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:E,password:d.password1})})).json();ne.status==="success"&&(k(!0),x(ne.message),setTimeout(()=>{l("/login")},2e3))}catch(X){console.log(X),k(!1),x(X.message)}};return w.jsx("div",{className:"min-h-screen flex items-center justify-center",children:w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-xs w-full",children:[w.jsx("h1",{className:"text-3xl text-center",children:"Restablecer contraseña"}),w.jsxs("form",{className:"space-y-6 mt-8",onSubmit:B,children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Contraseña"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{type:"password",name:"password1",placeholder:"Nueva contraseña",required:!0,onChange:o,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-900",children:"Repite contraseña"})}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{type:"password",name:"password2",placeholder:"Confirmar contraseña",required:!0,onChange:o,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsx("div",{children:w.jsx("button",{type:"submit",className:"flex w-full justify-center rounded-full bg-amber-700 border border-transparent px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800",children:"Cambiar"})}),w.jsx("strong",{children:C==!0?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",m," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""}),w.jsx("strong",{children:C==!1?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",m," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""})]})]})})};function xT(o){return Yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M458.622 255.92l45.985-45.005c13.708-12.977 7.316-36.039-10.664-40.339l-62.65-15.99 17.661-62.015c4.991-17.838-11.829-34.663-29.661-29.671l-61.994 17.667-15.984-62.671C337.085.197 313.765-6.276 300.99 7.228L256 53.57 211.011 7.229c-12.63-13.351-36.047-7.234-40.325 10.668l-15.984 62.671-61.995-17.667C74.87 57.907 58.056 74.738 63.046 92.572l17.661 62.015-62.65 15.99C.069 174.878-6.31 197.944 7.392 210.915l45.985 45.005-45.985 45.004c-13.708 12.977-7.316 36.039 10.664 40.339l62.65 15.99-17.661 62.015c-4.991 17.838 11.829 34.663 29.661 29.671l61.994-17.667 15.984 62.671c4.439 18.575 27.696 24.018 40.325 10.668L256 458.61l44.989 46.001c12.5 13.488 35.987 7.486 40.325-10.668l15.984-62.671 61.994 17.667c17.836 4.994 34.651-11.837 29.661-29.671l-17.661-62.015 62.65-15.99c17.987-4.302 24.366-27.367 10.664-40.339l-45.984-45.004z"},child:[]}]})(o)}function ux(o){return Yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(o)}function q1(o){return Yr({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(o)}function Z1(o){return Yr({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(o)}function bT(o){return Yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(o)}function wT(o){return Yr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(o)}function K_(o){return Yr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M0 117.66v346.32c0 11.32 11.43 19.06 21.94 14.86L160 416V32L20.12 87.95A32.006 32.006 0 0 0 0 117.66zM192 416l192 64V96L192 32v384zM554.06 33.16L416 96v384l139.88-55.95A31.996 31.996 0 0 0 576 394.34V48.02c0-11.32-11.43-19.06-21.94-14.86z"},child:[]}]})(o)}function eb(o){return Yr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(o)}function ST(o){return Yr({attr:{viewBox:"0 0 416 512"},child:[{tag:"path",attr:{d:"M207.9 15.2c.8 4.7 16.1 94.5 16.1 128.8 0 52.3-27.8 89.6-68.9 104.6L168 486.7c.7 13.7-10.2 25.3-24 25.3H80c-13.7 0-24.7-11.5-24-25.3l12.9-238.1C27.7 233.6 0 196.2 0 144 0 109.6 15.3 19.9 16.1 15.2 19.3-5.1 61.4-5.4 64 16.3v141.2c1.3 3.4 15.1 3.2 16 0 1.4-25.3 7.9-139.2 8-141.8 3.3-20.8 44.7-20.8 47.9 0 .2 2.7 6.6 116.5 8 141.8.9 3.2 14.8 3.4 16 0V16.3c2.6-21.6 44.8-21.4 48-1.1zm119.2 285.7l-15 185.1c-1.2 14 9.9 26 23.9 26h56c13.3 0 24-10.7 24-24V24c0-13.2-10.7-24-24-24-82.5 0-221.4 178.5-64.9 300.9z"},child:[]}]})(o)}function TT(o){return Yr({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M16.6256 3.1285L9.29145 10.4626L9.29886 14.7098L13.537 14.7024L20.8682 7.37114C21.5912 8.75438 22 10.3278 22 11.9967C22 17.5196 17.5228 21.9967 12 21.9967C6.47715 21.9967 2 17.5196 2 11.9967C2 6.47386 6.47715 1.9967 12 1.9967C13.6689 1.9967 15.2423 2.40553 16.6256 3.1285ZM20.4853 2.09721L21.8995 3.51142L12.7071 12.7038L11.2954 12.7063L11.2929 11.2896L20.4853 2.09721Z"},child:[]}]})(o)}function Rl(o){return Yr({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 10.5858L9.17157 7.75736L7.75736 9.17157L10.5858 12L7.75736 14.8284L9.17157 16.2426L12 13.4142L14.8284 16.2426L16.2426 14.8284L13.4142 12L16.2426 9.17157L14.8284 7.75736L12 10.5858Z"},child:[]}]})(o)}function Q_(o){return Yr({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18.0326 16.6184L22.3137 20.8995L20.8995 22.3137L16.6184 18.0326C15.0789 19.2639 13.1258 20 11 20C7.46456 20 4.40684 17.964 2.93475 15H6H9L7.69597 17.1734C8.67997 17.7009 9.80489 18 11 18C12.8956 18 14.6146 17.2475 15.8748 16.0247L16.0247 15.8748C17.2475 14.6146 18 12.8956 18 11C18 10.305 17.8988 9.63365 17.7104 9H19.7772C19.923 9.64318 20 10.3126 20 11C20 13.1258 19.2639 15.0789 18.0326 16.6184ZM19.0652 7H13L14.304 4.82662C13.32 4.29912 12.1951 4 11 4C7.1325 4 4 7.1325 4 11C4 11.695 4.10117 12.3663 4.2896 13H2.22279C2.07698 12.3568 2 11.6874 2 11C2 6.0275 6.0275 2 11 2C14.5354 2 17.5932 4.03597 19.0652 7Z"},child:[]}]})(o)}const MT=()=>{const{auth:o}=Ri();return w.jsxs("nav",{className:"bg-white dark:bg-gray-900 fixed w-full z-20 top-0 start-0 border-b border-gray-200 dark:border-gray-600",children:[w.jsxs("div",{className:"max-w-screen-xl flex items-center justify-between mx-auto p-4",children:[w.jsx("span",{className:"text-2xl font-semibold whitespace-nowrap dark:text-white",children:"BeanLink"}),w.jsxs("div",{className:"hidden md:flex md:items-center md:space-x-8",children:[w.jsx(Sc,{title:"Feed",to:"/private/feed",className:"text-gray-900 hover:text-lime-700 dark:text-white dark:hover:text-lime-500",children:w.jsx(Fy,{size:20})}),w.jsx(Sc,{title:"Map",to:"/private/map",className:"text-gray-900 hover:text-lime-700 dark:text-white dark:hover:text-lime-500",children:w.jsx(K_,{size:20})}),w.jsx(Sc,{title:"Search",to:"/private/Search",className:"text-gray-900 hover:text-lime-700 dark:text-white dark:hover:text-lime-500",children:w.jsx(Q_,{size:20})}),w.jsx(Sc,{title:"Perfil",to:"/private/profile",state:{user:o._id},className:"text-gray-900 hover:text-lime-700 dark:text-white dark:hover:text-lime-500",children:w.jsx(eb,{size:20})})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Sc,{to:"/private/logout",type:"button",className:"text-white bg-amber-700 hover:bg-amber-800 focus:ring-4 focus:outline-none font-medium rounded-full text-sm px-4 py-2 dark:bg-amber-700 dark:hover:bg-amber-600",children:"Salir"}),w.jsx("img",{className:"border rounded-full w-10 h-10 object-cover",src:o&&o.avatar?o.avatar:Uh,alt:"Avatar"})]})]}),w.jsxs("div",{className:"fixed bottom-0 left-0 w-full bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-600 p-3 flex justify-around md:hidden",children:[w.jsx(Sc,{title:"Feed",to:"/private/feed",className:"text-gray-900 dark:text-white",children:w.jsx(Fy,{size:20})}),w.jsx(Sc,{title:"Search",to:"/private/search",className:"text-gray-900 dark:text-white",children:w.jsx(Q_,{size:20})}),w.jsx(Sc,{title:"Map",to:"/private/map",className:"text-gray-900 dark:text-white",children:w.jsx(K_,{size:20})}),w.jsx(Sc,{title:"Perfil",to:"/private/profile",state:{user:o._id},className:"text-gray-900 dark:text-white",children:w.jsx(eb,{size:20})})]})]})},ET=()=>w.jsx("header",{children:w.jsx(MT,{})}),CT=()=>{const{auth:o,loading:d}=Ri();return d?w.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-700",children:w.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg flex flex-col items-center",children:[w.jsxs("svg",{className:"animate-spin h-6 w-6 text-amber-600 mb-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 11-8 8z"})]}),w.jsx("p",{className:"text-amber-600 font-medium",children:"Cargando..."})]})}):w.jsxs(w.Fragment,{children:[w.jsx(ET,{}),w.jsx("section",{className:"min-h-screen bg-gray-700 p-1",children:o&&o.id?w.jsx(N1,{}):w.jsx(D1,{to:"/"})})]})};function AT(o){return Yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"},child:[]}]})(o)}function kT(o){return Yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm-88 302a24 24 0 1 1 24-24 24 24 0 0 1-24 24zm0-71a24 24 0 1 1 24-24 24 24 0 0 1-24 24zm0-73a24 24 0 1 1 24-24 24 24 0 0 1-24 24zm184 135H224a16 16 0 0 1 0-32h128a16 16 0 0 1 0 32zm0-71H224a16 16 0 0 1 0-32h128a16 16 0 0 1 0 32zm0-72H224a16 16 0 0 1 0-32h128a16 16 0 0 1 0 32z"},child:[]}]})(o)}function PT(o){return Yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 176a80 80 0 1 0 80 80 80.24 80.24 0 0 0-80-80zm172.72 80a165.53 165.53 0 0 1-1.64 22.34l48.69 38.12a11.59 11.59 0 0 1 2.63 14.78l-46.06 79.52a11.64 11.64 0 0 1-14.14 4.93l-57.25-23a176.56 176.56 0 0 1-38.82 22.67l-8.56 60.78a11.93 11.93 0 0 1-11.51 9.86h-92.12a12 12 0 0 1-11.51-9.53l-8.56-60.78A169.3 169.3 0 0 1 151.05 393L93.8 416a11.64 11.64 0 0 1-14.14-4.92L33.6 331.57a11.59 11.59 0 0 1 2.63-14.78l48.69-38.12A174.58 174.58 0 0 1 83.28 256a165.53 165.53 0 0 1 1.64-22.34l-48.69-38.12a11.59 11.59 0 0 1-2.63-14.78l46.06-79.52a11.64 11.64 0 0 1 14.14-4.93l57.25 23a176.56 176.56 0 0 1 38.82-22.67l8.56-60.78A11.93 11.93 0 0 1 209.94 26h92.12a12 12 0 0 1 11.51 9.53l8.56 60.78A169.3 169.3 0 0 1 361 119l57.2-23a11.64 11.64 0 0 1 14.14 4.92l46.06 79.52a11.59 11.59 0 0 1-2.63 14.78l-48.69 38.12a174.58 174.58 0 0 1 1.64 22.66z"},child:[]}]})(o)}const $1=({isOpen:o,onClose:d,coffeToView:m})=>{const[x,C]=he.useState(0);if(!o||!m)return null;const{coffeeName:k,origin:E,varietal:l,process:B,high:V,score:X,tastingNotes:ne,brewMethod:re,roaster:ee,notes:te,media:be}=m,Ee=()=>{C(Ie=>(Ie+1)%be.length)},Ae=()=>{C(Ie=>(Ie-1+be.length)%be.length)};return w.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-900/30 backdrop-blur-md transition-all duration-300 z-50 overflow-auto",children:w.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full p-6 relative text-center",children:[w.jsx(AT,{onClick:d,className:"absolute top-3 right-3 text-gray-600 hover:text-red-600 cursor-pointer",size:25}),w.jsx("h2",{className:"mb-4 text-2xl font-bold text-gray-800",children:k}),w.jsxs("div",{className:"relative w-full h-90 flex justify-center items-center",children:[be.length>1&&w.jsx(q1,{className:"absolute left-2 text-gray-700 bg-white p-2 rounded-full shadow-md cursor-pointer hover:bg-gray-200",size:30,onClick:Ae}),w.jsx("img",{src:be[x],alt:`Coffe ${k}`,className:"w-full h-full object-cover rounded-lg shadow"}),be.length>1&&w.jsx(Z1,{className:"absolute right-2 text-gray-700 bg-white p-2 rounded-full shadow-md cursor-pointer hover:bg-gray-200",size:30,onClick:Ee})]}),w.jsxs("div",{className:"mt-4",children:[w.jsx("p",{className:"text-gray-600 text-lg",children:E}),w.jsxs("p",{className:"text-gray-500",children:["Varietal: ",l]}),w.jsxs("p",{className:"text-gray-500",children:["Proceso: ",B]}),w.jsxs("p",{className:"text-gray-500",children:["Altitud: ",V," m"]}),w.jsxs("p",{className:"text-gray-500 font-semibold",children:["SCA: ",X]}),w.jsxs("p",{className:"text-gray-500",children:["Método de preparación: ",re]}),w.jsxs("p",{className:"text-gray-500",children:["Tostador: ",ee]}),w.jsxs("p",{className:"text-gray-500",children:["Notas de cata: ",ne.join(", ")]}),te&&w.jsxs("p",{className:"text-gray-500",children:["Notas adicionales: ",te]})]})]})})},hx=({isOpen:o,onClose:d,recipe:m})=>{const[x,C]=he.useState(!1),[k,E]=he.useState({}),[l,B]=he.useState({}),[V,X]=he.useState(null);he.useEffect(()=>{ne()},[]),he.useEffect(()=>{re()},[V]);const ne=async()=>{try{const te=await(await fetch(Wt.url+"recipes/recipe/"+m._id,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();te.status==="success"&&(E(te.recipe),X(te.recipe.coffee._id))}catch(ee){console.log(ee)}},re=async()=>{try{const te=await(await fetch(Wt.url+"coffeelog/coffee/"+V,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();te.status==="success"&&B(te.coffee)}catch(ee){console.log(ee)}};return o&&w.jsxs("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-900/30 backdrop-blur-md z-50",children:[w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-4xl w-full h-full md:max-h-[98vh] relative overflow-auto",children:[w.jsx(Rl,{size:30,onClick:d,className:"absolute top-2 right-2 text-gray-600 cursor-pointer hover:text-gray-800"}),w.jsx("h2",{className:"text-lg font-semibold text-center mb-6",children:"Detalles de la Receta"}),w.jsxs("div",{className:"mb-6",children:[w.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:"Información Básica"}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[w.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow",children:[w.jsx("p",{className:"text-gray-500 text-sm",children:"Título"}),w.jsx("p",{className:"text-gray-900 font-semibold",children:k.title})]}),w.jsxs("div",{onClick:()=>{C(!0)},className:"bg-gray-100 p-4 rounded-lg shadow cursor-pointer",children:[w.jsx("p",{className:"text-gray-500 text-sm",children:"Café"}),w.jsx("p",{className:"text-gray-900 font-semibold",children:l.coffeeName})]})]})]}),w.jsxs("div",{className:"mb-6",children:[w.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:"Preparación"}),w.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[w.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow",children:[w.jsx("p",{className:"text-gray-500 text-sm",children:"Método"}),w.jsx("p",{className:"text-gray-900 font-semibold",children:k.method})]}),w.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow",children:[w.jsx("p",{className:"text-gray-500 text-sm",children:"Peso (g)"}),w.jsx("p",{className:"text-gray-900 font-semibold",children:k.coffee_weight})]}),w.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow",children:[w.jsx("p",{className:"text-gray-500 text-sm",children:"Tiempo extracción"}),w.jsxs("p",{className:"text-gray-900 font-semibold",children:[k.brew_time," s"]})]}),w.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow",children:[w.jsx("p",{className:"text-gray-500 text-sm",children:"Temperatura"}),w.jsxs("p",{className:"text-gray-900 font-semibold",children:[k.temperature," ºC"]})]})]})]}),w.jsxs("div",{className:"mb-6",children:[w.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:"Parámetros Adicionales"}),w.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:[w.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow",children:[w.jsx("p",{className:"text-gray-500 text-sm",children:"Ratio"}),w.jsx("p",{className:"text-gray-900 font-semibold",children:k.ratio})]}),w.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow",children:[w.jsx("p",{className:"text-gray-500 text-sm",children:"Molienda"}),w.jsx("p",{className:"text-gray-900 font-semibold",children:k.grind_size})]}),w.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow",children:[w.jsx("p",{className:"text-gray-500 text-sm",children:"Preinfusión"}),w.jsxs("p",{className:"text-gray-900 font-semibold",children:[k.preinfusion_time," s"]})]})]})]}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:"Descripción"}),w.jsx("div",{className:"bg-gray-100 p-4 rounded-lg shadow",children:w.jsx("p",{className:"text-gray-900",children:k.description})})]})]}),x&&w.jsx($1,{isOpen:x,onClose:()=>C(!1),coffeToView:l})]})};var O_={exports:{}},B_,tb;function jT(){if(tb)return B_;tb=1;var o="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return B_=o,B_}var F_,rb;function zT(){if(rb)return F_;rb=1;var o=jT();function d(){}function m(){}return m.resetWarningCache=d,F_=function(){function x(E,l,B,V,X,ne){if(ne!==o){var re=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw re.name="Invariant Violation",re}}x.isRequired=x;function C(){return x}var k={array:x,bigint:x,bool:x,func:x,number:x,object:x,string:x,symbol:x,any:x,arrayOf:C,element:x,elementType:x,instanceOf:C,node:x,objectOf:C,oneOf:C,oneOfType:C,shape:C,exact:C,checkPropTypes:m,resetWarningCache:d};return k.PropTypes=k,k},F_}var ib;function IT(){return ib||(ib=1,O_.exports=zT()()),O_.exports}var RT=IT();const Or=lf(RT);var DT=["date","verboseDate","tooltip","children"];function J_(){return J_=Object.assign||function(o){for(var d=1;d<arguments.length;d++){var m=arguments[d];for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&(o[x]=m[x])}return o},J_.apply(this,arguments)}function NT(o,d){if(o==null)return{};var m=LT(o,d),x,C;if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(o);for(C=0;C<k.length;C++)x=k[C],!(d.indexOf(x)>=0)&&Object.prototype.propertyIsEnumerable.call(o,x)&&(m[x]=o[x])}return m}function LT(o,d){if(o==null)return{};var m={},x=Object.keys(o),C,k;for(k=0;k<x.length;k++)C=x[k],!(d.indexOf(C)>=0)&&(m[C]=o[C]);return m}function Vy(o,d){var m=o.date,x=o.verboseDate,C=o.tooltip,k=o.children,E=NT(o,DT),l=he.useMemo(function(){return m.toISOString()},[m]);return So.createElement("time",J_({ref:d},E,{dateTime:l,title:C?x:void 0}),k)}Vy=So.forwardRef(Vy);Vy.propTypes={date:Or.instanceOf(Date).isRequired,verboseDate:Or.string,tooltip:Or.bool.isRequired,children:Or.string.isRequired};var G1="en",dx={},ev={};function H1(){return G1}function OT(o){G1=o}function BT(o){return dx[o]}function FT(o){if(!o)throw new Error("No locale data passed");dx[o.locale]=o,ev[o.locale.toLowerCase()]=o.locale}function ab(o){if(dx[o])return o;if(ev[o.toLowerCase()])return ev[o.toLowerCase()]}function W1(o){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=d.localeMatcher||"lookup";switch(m){case"lookup":return nb(o);case"best fit":return nb(o);default:throw new RangeError('Invalid "localeMatcher" option: '.concat(m))}}function nb(o){var d=ab(o);if(d)return d;for(var m=o.split("-");o.length>1;){m.pop(),o=m.join("-");var x=ab(o);if(x)return x}}var De={af:function(d){return d==1?"one":"other"},am:function(d){return d>=0&&d<=1?"one":"other"},ar:function(d){var m=String(d).split("."),x=Number(m[0])==d,C=x&&m[0].slice(-2);return d==0?"zero":d==1?"one":d==2?"two":C>=3&&C<=10?"few":C>=11&&C<=99?"many":"other"},ast:function(d){var m=String(d).split("."),x=!m[1];return d==1&&x?"one":"other"},be:function(d){var m=String(d).split("."),x=Number(m[0])==d,C=x&&m[0].slice(-1),k=x&&m[0].slice(-2);return C==1&&k!=11?"one":C>=2&&C<=4&&(k<12||k>14)?"few":x&&C==0||C>=5&&C<=9||k>=11&&k<=14?"many":"other"},br:function(d){var m=String(d).split("."),x=Number(m[0])==d,C=x&&m[0].slice(-1),k=x&&m[0].slice(-2),E=x&&m[0].slice(-6);return C==1&&k!=11&&k!=71&&k!=91?"one":C==2&&k!=12&&k!=72&&k!=92?"two":(C==3||C==4||C==9)&&(k<10||k>19)&&(k<70||k>79)&&(k<90||k>99)?"few":d!=0&&x&&E==0?"many":"other"},bs:function(d){var m=String(d).split("."),x=m[0],C=m[1]||"",k=!m[1],E=x.slice(-1),l=x.slice(-2),B=C.slice(-1),V=C.slice(-2);return k&&E==1&&l!=11||B==1&&V!=11?"one":k&&E>=2&&E<=4&&(l<12||l>14)||B>=2&&B<=4&&(V<12||V>14)?"few":"other"},ca:function(d){var m=String(d).split("."),x=m[0],C=!m[1],k=x.slice(-6);return d==1&&C?"one":x!=0&&k==0&&C?"many":"other"},ceb:function(d){var m=String(d).split("."),x=m[0],C=m[1]||"",k=!m[1],E=x.slice(-1),l=C.slice(-1);return k&&(x==1||x==2||x==3)||k&&E!=4&&E!=6&&E!=9||!k&&l!=4&&l!=6&&l!=9?"one":"other"},cs:function(d){var m=String(d).split("."),x=m[0],C=!m[1];return d==1&&C?"one":x>=2&&x<=4&&C?"few":C?"other":"many"},cy:function(d){return d==0?"zero":d==1?"one":d==2?"two":d==3?"few":d==6?"many":"other"},da:function(d){var m=String(d).split("."),x=m[0],C=Number(m[0])==d;return d==1||!C&&(x==0||x==1)?"one":"other"},dsb:function(d){var m=String(d).split("."),x=m[0],C=m[1]||"",k=!m[1],E=x.slice(-2),l=C.slice(-2);return k&&E==1||l==1?"one":k&&E==2||l==2?"two":k&&(E==3||E==4)||l==3||l==4?"few":"other"},dz:function(d){return"other"},es:function(d){var m=String(d).split("."),x=m[0],C=!m[1],k=x.slice(-6);return d==1?"one":x!=0&&k==0&&C?"many":"other"},ff:function(d){return d>=0&&d<2?"one":"other"},fr:function(d){var m=String(d).split("."),x=m[0],C=!m[1],k=x.slice(-6);return d>=0&&d<2?"one":x!=0&&k==0&&C?"many":"other"},ga:function(d){var m=String(d).split("."),x=Number(m[0])==d;return d==1?"one":d==2?"two":x&&d>=3&&d<=6?"few":x&&d>=7&&d<=10?"many":"other"},gd:function(d){var m=String(d).split("."),x=Number(m[0])==d;return d==1||d==11?"one":d==2||d==12?"two":x&&d>=3&&d<=10||x&&d>=13&&d<=19?"few":"other"},he:function(d){var m=String(d).split("."),x=m[0],C=!m[1];return x==1&&C||x==0&&!C?"one":x==2&&C?"two":"other"},is:function(d){var m=String(d).split("."),x=m[0],C=(m[1]||"").replace(/0+$/,""),k=Number(m[0])==d,E=x.slice(-1),l=x.slice(-2);return k&&E==1&&l!=11||C%10==1&&C%100!=11?"one":"other"},ksh:function(d){return d==0?"zero":d==1?"one":"other"},lt:function(d){var m=String(d).split("."),x=m[1]||"",C=Number(m[0])==d,k=C&&m[0].slice(-1),E=C&&m[0].slice(-2);return k==1&&(E<11||E>19)?"one":k>=2&&k<=9&&(E<11||E>19)?"few":x!=0?"many":"other"},lv:function(d){var m=String(d).split("."),x=m[1]||"",C=x.length,k=Number(m[0])==d,E=k&&m[0].slice(-1),l=k&&m[0].slice(-2),B=x.slice(-2),V=x.slice(-1);return k&&E==0||l>=11&&l<=19||C==2&&B>=11&&B<=19?"zero":E==1&&l!=11||C==2&&V==1&&B!=11||C!=2&&V==1?"one":"other"},mk:function(d){var m=String(d).split("."),x=m[0],C=m[1]||"",k=!m[1],E=x.slice(-1),l=x.slice(-2),B=C.slice(-1),V=C.slice(-2);return k&&E==1&&l!=11||B==1&&V!=11?"one":"other"},mt:function(d){var m=String(d).split("."),x=Number(m[0])==d,C=x&&m[0].slice(-2);return d==1?"one":d==2?"two":d==0||C>=3&&C<=10?"few":C>=11&&C<=19?"many":"other"},pa:function(d){return d==0||d==1?"one":"other"},pl:function(d){var m=String(d).split("."),x=m[0],C=!m[1],k=x.slice(-1),E=x.slice(-2);return d==1&&C?"one":C&&k>=2&&k<=4&&(E<12||E>14)?"few":C&&x!=1&&(k==0||k==1)||C&&k>=5&&k<=9||C&&E>=12&&E<=14?"many":"other"},pt:function(d){var m=String(d).split("."),x=m[0],C=!m[1],k=x.slice(-6);return x==0||x==1?"one":x!=0&&k==0&&C?"many":"other"},ro:function(d){var m=String(d).split("."),x=!m[1],C=Number(m[0])==d,k=C&&m[0].slice(-2);return d==1&&x?"one":!x||d==0||d!=1&&k>=1&&k<=19?"few":"other"},ru:function(d){var m=String(d).split("."),x=m[0],C=!m[1],k=x.slice(-1),E=x.slice(-2);return C&&k==1&&E!=11?"one":C&&k>=2&&k<=4&&(E<12||E>14)?"few":C&&k==0||C&&k>=5&&k<=9||C&&E>=11&&E<=14?"many":"other"},se:function(d){return d==1?"one":d==2?"two":"other"},si:function(d){var m=String(d).split("."),x=m[0],C=m[1]||"";return d==0||d==1||x==0&&C==1?"one":"other"},sl:function(d){var m=String(d).split("."),x=m[0],C=!m[1],k=x.slice(-2);return C&&k==1?"one":C&&k==2?"two":C&&(k==3||k==4)||!C?"few":"other"}};De.as=De.am;De.az=De.af;De.bg=De.af;De.bn=De.am;De.brx=De.af;De.ce=De.af;De.chr=De.af;De.de=De.ast;De.ee=De.af;De.el=De.af;De.en=De.ast;De.et=De.ast;De.eu=De.af;De.fa=De.am;De.fi=De.ast;De.fil=De.ceb;De.fo=De.af;De.fur=De.af;De.fy=De.ast;De.gl=De.ast;De.gu=De.am;De.ha=De.af;De.hi=De.am;De.hr=De.bs;De.hsb=De.dsb;De.hu=De.af;De.hy=De.ff;De.ia=De.ast;De.id=De.dz;De.ig=De.dz;De.it=De.ca;De.ja=De.dz;De.jgo=De.af;De.jv=De.dz;De.ka=De.af;De.kea=De.dz;De.kk=De.af;De.kl=De.af;De.km=De.dz;De.kn=De.am;De.ko=De.dz;De.ks=De.af;De.ku=De.af;De.ky=De.af;De.lb=De.af;De.lkt=De.dz;De.lo=De.dz;De.ml=De.af;De.mn=De.af;De.mr=De.af;De.ms=De.dz;De.my=De.dz;De.nb=De.af;De.ne=De.af;De.nl=De.ast;De.nn=De.af;De.no=De.af;De.or=De.af;De.pcm=De.am;De.ps=De.af;De.rm=De.af;De.sah=De.dz;De.sc=De.ast;De.sd=De.af;De.sk=De.cs;De.so=De.af;De.sq=De.af;De.sr=De.bs;De.su=De.dz;De.sv=De.ast;De.sw=De.ast;De.ta=De.af;De.te=De.af;De.th=De.dz;De.ti=De.pa;De.tk=De.af;De.to=De.dz;De.tr=De.af;De.ug=De.af;De.uk=De.ru;De.ur=De.ast;De.uz=De.af;De.vi=De.dz;De.wae=De.af;De.wo=De.dz;De.xh=De.af;De.yi=De.ast;De.yo=De.dz;De.yue=De.dz;De.zh=De.dz;De.zu=De.am;function sb(o){return o==="pt-PT"?o:VT(o)}var UT=/^([a-z0-9]+)/i;function VT(o){var d=o.match(UT);if(!d)throw new TypeError("Invalid locale: ".concat(o));return d[1]}function qT(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")}function ob(o,d){for(var m=0;m<d.length;m++){var x=d[m];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(o,x.key,x)}}function ZT(o,d,m){return d&&ob(o.prototype,d),m&&ob(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}var tv=function(){function o(d,m){qT(this,o);var x=o.supportedLocalesOf(d);if(x.length===0)throw new RangeError("Unsupported locale: "+d);if(m&&m.type!=="cardinal")throw new RangeError('Only "cardinal" "type" is supported');this.$=De[sb(x[0])]}return ZT(o,[{key:"select",value:function(m){return this.$(m)}}],[{key:"supportedLocalesOf",value:function(m){return typeof m=="string"&&(m=[m]),m.filter(function(x){return De[sb(x)]})}}]),o}();function rv(o){"@babel/helpers - typeof";return rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},rv(o)}function lb(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function cb(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?lb(Object(m),!0).forEach(function(x){$T(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):lb(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function $T(o,d,m){return d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}function ub(o,d){return XT(o)||WT(o,d)||HT(o,d)||GT()}function GT(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HT(o,d){if(o){if(typeof o=="string")return hb(o,d);var m=Object.prototype.toString.call(o).slice(8,-1);if(m==="Object"&&o.constructor&&(m=o.constructor.name),m==="Map"||m==="Set")return Array.from(o);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return hb(o,d)}}function hb(o,d){(d==null||d>o.length)&&(d=o.length);for(var m=0,x=new Array(d);m<d;m++)x[m]=o[m];return x}function WT(o,d){var m=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(m!=null){var x=[],C=!0,k=!1,E,l;try{for(m=m.call(o);!(C=(E=m.next()).done)&&(x.push(E.value),!(d&&x.length===d));C=!0);}catch(B){k=!0,l=B}finally{try{!C&&m.return!=null&&m.return()}finally{if(k)throw l}}return x}}function XT(o){if(Array.isArray(o))return o}function YT(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")}function KT(o,d){for(var m=0;m<d.length;m++){var x=d[m];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(o,x.key,x)}}function QT(o,d,m){return d&&KT(o.prototype,d),Object.defineProperty(o,"prototype",{writable:!1}),o}var JT=["second","minute","hour","day","week","month","quarter","year"],eM=["auto","always"],tM=["long","short","narrow"],rM=["lookup","best fit"],Bh=function(){function o(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};YT(this,o);var x=m.numeric,C=m.style,k=m.localeMatcher;if(this.numeric="always",this.style="long",this.localeMatcher="lookup",x!==void 0){if(eM.indexOf(x)<0)throw new RangeError('Invalid "numeric" option: '.concat(x));this.numeric=x}if(C!==void 0){if(tM.indexOf(C)<0)throw new RangeError('Invalid "style" option: '.concat(C));this.style=C}if(k!==void 0){if(rM.indexOf(k)<0)throw new RangeError('Invalid "localeMatcher" option: '.concat(k));this.localeMatcher=k}if(typeof d=="string"&&(d=[d]),d.push(H1()),this.locale=o.supportedLocalesOf(d,{localeMatcher:this.localeMatcher})[0],!this.locale)throw new Error("No supported locale was found");tv.supportedLocalesOf(this.locale).length>0?this.pluralRules=new tv(this.locale):console.warn('"'.concat(this.locale,'" locale is not supported')),typeof Intl<"u"&&Intl.NumberFormat?(this.numberFormat=new Intl.NumberFormat(this.locale),this.numberingSystem=this.numberFormat.resolvedOptions().numberingSystem):this.numberingSystem="latn",this.locale=W1(this.locale,{localeMatcher:this.localeMatcher})}return QT(o,[{key:"format",value:function(){var m=db(arguments),x=ub(m,2),C=x[0],k=x[1];return this.getRule(C,k).replace("{0}",this.formatNumber(Math.abs(C)))}},{key:"formatToParts",value:function(){var m=db(arguments),x=ub(m,2),C=x[0],k=x[1],E=this.getRule(C,k),l=E.indexOf("{0}");if(l<0)return[{type:"literal",value:E}];var B=[];return l>0&&B.push({type:"literal",value:E.slice(0,l)}),B=B.concat(this.formatNumberToParts(Math.abs(C)).map(function(V){return cb(cb({},V),{},{unit:k})})),l+3<E.length-1&&B.push({type:"literal",value:E.slice(l+3)}),B}},{key:"getRule",value:function(m,x){var C=BT(this.locale)[this.style][x];if(typeof C=="string")return C;if(this.numeric==="auto"){if(m===-2||m===-1){var k=C["previous".concat(m===-1?"":"-"+Math.abs(m))];if(k)return k}else if(m===1||m===2){var E=C["next".concat(m===1?"":"-"+Math.abs(m))];if(E)return E}else if(m===0&&C.current)return C.current}var l=C[oM(m)?"past":"future"];if(typeof l=="string")return l;var B=this.pluralRules&&this.pluralRules.select(Math.abs(m))||"other";return l[B]||l.other}},{key:"formatNumber",value:function(m){return this.numberFormat?this.numberFormat.format(m):String(m)}},{key:"formatNumberToParts",value:function(m){return this.numberFormat&&this.numberFormat.formatToParts?this.numberFormat.formatToParts(m):[{type:"integer",value:this.formatNumber(m)}]}},{key:"resolvedOptions",value:function(){return{locale:this.locale,style:this.style,numeric:this.numeric,numberingSystem:this.numberingSystem}}}]),o}();Bh.supportedLocalesOf=function(o){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof o=="string")o=[o];else if(!Array.isArray(o))throw new TypeError('Invalid "locales" argument');return o.filter(function(m){return W1(m,d)})};Bh.addLocale=FT;Bh.setDefaultLocale=OT;Bh.getDefaultLocale=H1;Bh.PluralRules=tv;var U_='Invalid "unit" argument';function iM(o){if(rv(o)==="symbol")throw new TypeError(U_);if(typeof o!="string")throw new RangeError("".concat(U_,": ").concat(o));if(o[o.length-1]==="s"&&(o=o.slice(0,o.length-1)),JT.indexOf(o)<0)throw new RangeError("".concat(U_,": ").concat(o));return o}var aM='Invalid "number" argument';function nM(o){if(o=Number(o),Number.isFinite&&!Number.isFinite(o))throw new RangeError("".concat(aM,": ").concat(o));return o}function sM(o){return 1/o===-1/0}function oM(o){return o<0||o===0&&sM(o)}function db(o){if(o.length<2)throw new TypeError('"unit" argument is required');return[nM(o[0]),iM(o[1])]}function qy(o){"@babel/helpers - typeof";return qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},qy(o)}function lM(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")}function cM(o,d){for(var m=0;m<d.length;m++){var x=d[m];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(o,x.key,x)}}function uM(o,d,m){return d&&cM(o.prototype,d),Object.defineProperty(o,"prototype",{writable:!1}),o}var fb=function(){function o(){lM(this,o),this.cache={}}return uM(o,[{key:"get",value:function(){for(var m=this.cache,x=arguments.length,C=new Array(x),k=0;k<x;k++)C[k]=arguments[k];for(var E=0,l=C;E<l.length;E++){var B=l[E];if(qy(m)!=="object")return;m=m[B]}return m}},{key:"put",value:function(){for(var m=arguments.length,x=new Array(m),C=0;C<m;C++)x[C]=arguments[C];for(var k=x.pop(),E=x.pop(),l=this.cache,B=0,V=x;B<V.length;B++){var X=V[B];qy(l[X])!=="object"&&(l[X]={}),l=l[X]}return l[E]=k}}]),o}();function iv(o){"@babel/helpers - typeof";return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},iv(o)}function hM(o,d){var m=typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(m)return(m=m.call(o)).next.bind(m);if(Array.isArray(o)||(m=dM(o))||d){m&&(o=m);var x=0;return function(){return x>=o.length?{done:!0}:{done:!1,value:o[x++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dM(o,d){if(o){if(typeof o=="string")return pb(o,d);var m=Object.prototype.toString.call(o).slice(8,-1);if(m==="Object"&&o.constructor&&(m=o.constructor.name),m==="Map"||m==="Set")return Array.from(o);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return pb(o,d)}}function pb(o,d){(d==null||d>o.length)&&(d=o.length);for(var m=0,x=new Array(d);m<d;m++)x[m]=o[m];return x}function fM(o,d){for(var m=hM(o),x;!(x=m()).done;){var C=x.value;if(d(C))return C;for(var k=C.split("-");k.length>1;)if(k.pop(),C=k.join("-"),d(C))return C}throw new Error("No locale data has been registered for any of the locales: ".concat(o.join(", ")))}function pM(){var o=(typeof Intl>"u"?"undefined":iv(Intl))==="object";return o&&typeof Intl.DateTimeFormat=="function"}function av(o){"@babel/helpers - typeof";return av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},av(o)}function mM(o){return yM(o)&&(Array.isArray(o.steps)||Array.isArray(o.gradation)||Array.isArray(o.flavour)||typeof o.flavour=="string"||Array.isArray(o.labels)||typeof o.labels=="string"||Array.isArray(o.units)||typeof o.custom=="function")}var gM={}.constructor;function yM(o){return av(o)!==void 0&&o!==null&&o.constructor===gM}var Cu=60,Zy=60*Cu,rf=24*Zy,nv=7*rf,sv=30.44*rf,X1=146097/400*rf;function Rp(o){switch(o){case"second":return 1;case"minute":return Cu;case"hour":return Zy;case"day":return rf;case"week":return nv;case"month":return sv;case"year":return X1}}function Y1(o){return o.factor!==void 0?o.factor:Rp(o.unit||o.formatAs)||1}function bg(o){switch(o){case"floor":return Math.floor;default:return Math.round}}function fx(o){switch(o){case"floor":return 1;default:return .5}}function ov(o){"@babel/helpers - typeof";return ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},ov(o)}function K1(o,d){var m=d.prevStep,x=d.timestamp,C=d.now,k=d.future,E=d.round,l;return m&&(m.id||m.unit)&&(l=o["threshold_for_".concat(m.id||m.unit)]),l===void 0&&o.threshold!==void 0&&(l=o.threshold,typeof l=="function"&&(l=l(C,k))),l===void 0&&(l=o.minTime),ov(l)==="object"&&(m&&m.id&&l[m.id]!==void 0?l=l[m.id]:l=l.default),typeof l=="function"&&(l=l(x,{future:k,getMinTimeForUnit:function(V,X){return mb(V,X||m&&m.formatAs,{round:E})}})),l===void 0&&o.test&&(o.test(x,{now:C,future:k})?l=0:l=9007199254740991),l===void 0&&(m?o.formatAs&&m.formatAs&&(l=mb(o.formatAs,m.formatAs,{round:E})):l=0),l===void 0&&console.warn("[javascript-time-ago] A step should specify `minTime`:\n"+JSON.stringify(o,null,2)),l}function mb(o,d,m){var x=m.round,C=Rp(o),k;if(d==="now"?k=Rp(o):k=Rp(d),C!==void 0&&k!==void 0)return C-k*(1-fx(x))}function gb(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function _M(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?gb(Object(m),!0).forEach(function(x){vM(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):gb(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function vM(o,d,m){return d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}function xM(o,d,m){var x=m.now,C=m.future,k=m.round,E=m.units;o=wM(o,E);var l=bM(o,d,{now:x,future:C,round:k});{if(l){var B=o[o.indexOf(l)-1],V=o[o.indexOf(l)+1];return[B,l,V]}return[void 0,void 0,o[0]]}}function bM(o,d,m){var x=m.now,C=m.future,k=m.round;if(o.length!==0){var E=Q1(o,d,{now:x,future:C||d<0,round:k});if(E!==-1){var l=o[E];if(l.granularity){var B=bg(k)(Math.abs(d)/Y1(l)/l.granularity)*l.granularity;if(B===0&&E>0)return o[E-1]}return l}}}function Q1(o,d,m){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,C=K1(o[x],_M({prevStep:o[x-1],timestamp:m.now-d*1e3},m));return C===void 0||Math.abs(d)<C?x-1:x===o.length-1?x:Q1(o,d,m,x+1)}function wM(o,d){return o.filter(function(m){var x=m.unit,C=m.formatAs;return x=x||C,x?d.indexOf(x)>=0:!0})}function SM(o,d,m){var x=m.now,C=m.round;if(Rp(o)){var k=Rp(o)*1e3,E=d>x,l=Math.abs(d-x),B=bg(C)(l/k)*k;return E?B>0?l-B+MM(C,k):l-B+1:-(l-B)+TM(C,k)}}function TM(o,d){return fx(o)*d}function MM(o,d){return(1-fx(o))*d+1}var EM=365*24*60*60*1e3,J1=1e3*EM;function CM(o,d,m){var x=m.prevStep,C=m.nextStep,k=m.now,E=m.future,l=m.round,B=o.getTime?o.getTime():o,V=function(te){return SM(te,B,{now:k,round:l})},X=kM(E?d:C,B,{future:E,now:k,round:l,prevStep:E?x:d});if(X!==void 0){var ne;if(d&&(d.getTimeToNextUpdate&&(ne=d.getTimeToNextUpdate(B,{getTimeToNextUpdateForUnit:V,getRoundFunction:bg,now:k,future:E,round:l})),ne===void 0)){var re=d.unit||d.formatAs;re&&(ne=V(re))}return ne===void 0?X:Math.min(ne,X)}}function AM(o,d,m){var x=m.now,C=m.future,k=m.round,E=m.prevStep,l=K1(o,{timestamp:d,now:x,future:C,round:k,prevStep:E});if(l!==void 0)return C?d-l*1e3+1:l===0&&d===x?J1:d+l*1e3}function kM(o,d,m){var x=m.now,C=m.future,k=m.round,E=m.prevStep;if(o){var l=AM(o,d,{now:x,future:C,round:k,prevStep:E});return l===void 0?void 0:l-x}else return C?d-x+1:J1}var ew={};function jp(o){return ew[o]}function tw(o){if(!o)throw new Error("[javascript-time-ago] No locale data passed.");ew[o.locale]=o}const PM=[{formatAs:"now"},{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"},{formatAs:"day"},{formatAs:"week"},{formatAs:"month"},{formatAs:"year"}],lv={steps:PM,labels:"long"};function yb(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function _b(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?yb(Object(m),!0).forEach(function(x){jM(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):yb(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function jM(o,d,m){return d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}const cv=_b(_b({},lv),{},{steps:lv.steps.filter(function(o){return o.formatAs!=="second"})}),rw=[{factor:1,unit:"now"},{threshold:1,threshold_for_now:45.5,factor:1,unit:"second"},{threshold:45.5,factor:Cu,unit:"minute"},{threshold:2.5*Cu,granularity:5,factor:Cu,unit:"minute"},{threshold:22.5*Cu,factor:.5*Zy,unit:"half-hour"},{threshold:42.5*Cu,threshold_for_minute:52.5*Cu,factor:Zy,unit:"hour"},{threshold:20.5/24*rf,factor:rf,unit:"day"},{threshold:5.5*rf,factor:nv,unit:"week"},{threshold:3.5*nv,factor:sv,unit:"month"},{threshold:10.5*sv,factor:X1,unit:"year"}],vb={gradation:rw,flavour:"long",units:["now","minute","hour","day","week","month","year"]},zM={gradation:rw,flavour:"long-time",units:["now","minute","hour","day","week","month","year"]};function iw(o){return o instanceof Date?o:new Date(o)}var uv=[{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"}],Pc={},IM={minTime:function(d,m){m.future;var x=m.getMinTimeForUnit;return x("day")},format:function(d,m){return Pc[m]||(Pc[m]={}),Pc[m].dayMonth||(Pc[m].dayMonth=new Intl.DateTimeFormat(m,{month:"short",day:"numeric"})),Pc[m].dayMonth.format(iw(d))}},RM={minTime:function(d,m){var x=m.future;if(x){var C=new Date(new Date(d).getFullYear(),0).getTime()-1;return(d-C)/1e3}else{var k=new Date(new Date(d).getFullYear()+1,0).getTime();return(k-d)/1e3}},format:function(d,m){return Pc[m]||(Pc[m]={}),Pc[m].dayMonthYear||(Pc[m].dayMonthYear=new Intl.DateTimeFormat(m,{year:"numeric",month:"short",day:"numeric"})),Pc[m].dayMonthYear.format(iw(d))}};pM()?uv.push(IM,RM):uv.push({formatAs:"day"},{formatAs:"week"},{formatAs:"month"},{formatAs:"year"});const nf={steps:uv,labels:["mini","short-time","narrow","short"]};function xb(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function bb(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?xb(Object(m),!0).forEach(function(x){DM(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):xb(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function DM(o,d,m){return d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}const NM=bb(bb({},nf),{},{steps:[{formatAs:"now"}].concat(nf.steps)});function wb(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function Sb(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?wb(Object(m),!0).forEach(function(x){LM(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):wb(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function LM(o,d,m){return d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}const hv=Sb(Sb({},nf),{},{steps:nf.steps.filter(function(o){return o.formatAs!=="second"})});function Tb(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function Mb(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?Tb(Object(m),!0).forEach(function(x){OM(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):Tb(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function OM(o,d,m){return d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}const BM=Mb(Mb({},hv),{},{steps:[{formatAs:"now"}].concat(hv.steps)});function Eb(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function i0(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?Eb(Object(m),!0).forEach(function(x){FM(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):Eb(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function FM(o,d,m){return d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}const UM=i0(i0({},nf),{},{steps:nf.steps.filter(function(o){return o.formatAs!=="second"}).map(function(o){return o.formatAs==="minute"?i0(i0({},o),{},{minTime:Cu}):o})}),wg={steps:[{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"},{formatAs:"day"},{formatAs:"month"},{formatAs:"year"}],labels:["mini","short-time","narrow","short"]};function Cb(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function Ab(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?Cb(Object(m),!0).forEach(function(x){VM(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):Cb(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function VM(o,d,m){return d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}const qM=Ab(Ab({},wg),{},{steps:[{formatAs:"now"}].concat(wg.steps)});function kb(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function Pb(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?kb(Object(m),!0).forEach(function(x){ZM(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):kb(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function ZM(o,d,m){return d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}const dv=Pb(Pb({},wg),{},{steps:wg.steps.filter(function(o){return o.formatAs!=="second"})});function jb(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function zb(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?jb(Object(m),!0).forEach(function(x){$M(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):jb(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function $M(o,d,m){return d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}const GM=zb(zb({},dv),{},{steps:[{formatAs:"now"}].concat(dv.steps)});function HM(o){switch(o){case"default":case"round":return lv;case"round-minute":return cv;case"approximate":return vb;case"time":case"approximate-time":return zM;case"mini":return wg;case"mini-now":return qM;case"mini-minute":return dv;case"mini-minute-now":return GM;case"twitter":return nf;case"twitter-now":return NM;case"twitter-minute":return hv;case"twitter-minute-now":return BM;case"twitter-first-minute":return UM;default:return vb}}function $y(o){"@babel/helpers - typeof";return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},$y(o)}function WM(o,d){var m=typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(m)return(m=m.call(o)).next.bind(m);if(Array.isArray(o)||(m=aw(o))||d){m&&(o=m);var x=0;return function(){return x>=o.length?{done:!0}:{done:!1,value:o[x++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XM(o,d){return QM(o)||KM(o,d)||aw(o,d)||YM()}function YM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aw(o,d){if(o){if(typeof o=="string")return Ib(o,d);var m=Object.prototype.toString.call(o).slice(8,-1);if(m==="Object"&&o.constructor&&(m=o.constructor.name),m==="Map"||m==="Set")return Array.from(o);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return Ib(o,d)}}function Ib(o,d){(d==null||d>o.length)&&(d=o.length);for(var m=0,x=new Array(d);m<d;m++)x[m]=o[m];return x}function KM(o,d){var m=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(m!=null){var x=[],C=!0,k=!1,E,l;try{for(m=m.call(o);!(C=(E=m.next()).done)&&(x.push(E.value),!(d&&x.length===d));C=!0);}catch(B){k=!0,l=B}finally{try{!C&&m.return!=null&&m.return()}finally{if(k)throw l}}return x}}function QM(o){if(Array.isArray(o))return o}function JM(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")}function eE(o,d){for(var m=0;m<d.length;m++){var x=d[m];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(o,x.key,x)}}function tE(o,d,m){return d&&eE(o.prototype,d),Object.defineProperty(o,"prototype",{writable:!1}),o}var qs=function(){function o(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x=m.polyfill;JM(this,o),typeof d=="string"&&(d=[d]),this.locale=fM(d.concat(o.getDefaultLocale()),jp),typeof Intl<"u"&&Intl.NumberFormat&&(this.numberFormat=new Intl.NumberFormat(this.locale)),x===!1?(this.IntlRelativeTimeFormat=Intl.RelativeTimeFormat,this.IntlPluralRules=Intl.PluralRules):(this.IntlRelativeTimeFormat=Bh,this.IntlPluralRules=Bh.PluralRules),this.relativeTimeFormatCache=new fb,this.pluralRulesCache=new fb}return tE(o,[{key:"format",value:function(m,x,C){C||(x&&!sE(x)?(C=x,x=void 0):C={}),x||(x=cv),typeof x=="string"&&(x=HM(x));var k=rE(m),E=this.getLabels(x.flavour||x.labels),l=E.labels,B=E.labelsType,V;x.now!==void 0&&(V=x.now),V===void 0&&C.now!==void 0&&(V=C.now),V===void 0&&(V=Date.now());var X=(V-k)/1e3,ne=C.future||X<0,re=nE(l,jp(this.locale).now,jp(this.locale).long,ne);if(x.custom){var ee=x.custom({now:V,date:new Date(k),time:k,elapsed:X,locale:this.locale});if(ee!==void 0)return ee}var te=aE(x.units,l,re),be=C.round||x.round,Ee=xM(x.gradation||x.steps||cv.steps,X,{now:V,units:te,round:be,future:ne}),Ae=XM(Ee,3),Ie=Ae[0],tt=Ae[1],vt=Ae[2],nt=this.formatDateForStep(k,tt,X,{labels:l,labelsType:B,nowLabel:re,now:V,future:ne,round:be})||"";if(C.getTimeToNextUpdate){var Ye=CM(k,tt,{nextStep:vt,prevStep:Ie,now:V,future:ne,round:be});return[nt,Ye]}return nt}},{key:"formatDateForStep",value:function(m,x,C,k){var E=this,l=k.labels,B=k.labelsType,V=k.nowLabel,X=k.now,ne=k.future,re=k.round;if(x){if(x.format)return x.format(m,this.locale,{formatAs:function(Ae,Ie){return E.formatValue(Ie,Ae,{labels:l,future:ne})},now:X,future:ne});var ee=x.unit||x.formatAs;if(!ee)throw new Error("[javascript-time-ago] Each step must define either `formatAs` or `format()`. Step: ".concat(JSON.stringify(x)));if(ee==="now")return V;var te=Math.abs(C)/Y1(x);x.granularity&&(te=bg(re)(te/x.granularity)*x.granularity);var be=-1*Math.sign(C)*bg(re)(te);switch(be===0&&(ne?be=0:be=-0),B){case"long":case"short":case"narrow":return this.getFormatter(B).format(be,ee);default:return this.formatValue(be,ee,{labels:l,future:ne})}}}},{key:"formatValue",value:function(m,x,C){var k=C.labels,E=C.future;return this.getFormattingRule(k,x,m,{future:E}).replace("{0}",this.formatNumber(Math.abs(m)))}},{key:"getFormattingRule",value:function(m,x,C,k){var E=k.future;if(this.locale,m=m[x],typeof m=="string")return m;var l=C===0?E?"future":"past":C<0?"past":"future",B=m[l]||m;if(typeof B=="string")return B;var V=this.getPluralRules().select(Math.abs(C));return B[V]||B.other}},{key:"formatNumber",value:function(m){return this.numberFormat?this.numberFormat.format(m):String(m)}},{key:"getFormatter",value:function(m){return this.relativeTimeFormatCache.get(this.locale,m)||this.relativeTimeFormatCache.put(this.locale,m,new this.IntlRelativeTimeFormat(this.locale,{style:m}))}},{key:"getPluralRules",value:function(){return this.pluralRulesCache.get(this.locale)||this.pluralRulesCache.put(this.locale,new this.IntlPluralRules(this.locale))}},{key:"getLabels",value:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];typeof m=="string"&&(m=[m]),m=m.map(function(l){switch(l){case"tiny":case"mini-time":return"mini";default:return l}}),m=m.concat("long");for(var x=jp(this.locale),C=WM(m),k;!(k=C()).done;){var E=k.value;if(x[E])return{labelsType:E,labels:x[E]}}}}]),o}(),nw="en";qs.getDefaultLocale=function(){return nw};qs.setDefaultLocale=function(o){return nw=o};qs.addDefaultLocale=function(o){if(Rb)return console.error("[javascript-time-ago] `TimeAgo.addDefaultLocale()` can only be called once. To add other locales, use `TimeAgo.addLocale()`.");Rb=!0,qs.setDefaultLocale(o.locale),qs.addLocale(o)};var Rb;qs.addLocale=function(o){tw(o),Bh.addLocale(o)};qs.locale=qs.addLocale;qs.addLabels=function(o,d,m){var x=jp(o);x||(tw({locale:o}),x=jp(o)),x[d]=m};function rE(o){if(o.constructor===Date||iE(o))return o.getTime();if(typeof o=="number")return o;throw new Error("Unsupported relative time formatter input: ".concat($y(o),", ").concat(o))}function iE(o){return $y(o)==="object"&&typeof o.getTime=="function"}function aE(o,d,m){var x=Object.keys(d);return m&&x.push("now"),o&&(x=o.filter(function(C){return C==="now"||x.indexOf(C)>=0})),x}function nE(o,d,m,x){var C=o.now||d&&d.now;if(C)return typeof C=="string"?C:x?C.future:C.past;if(m&&m.second&&m.second.current)return m.second.current}function sE(o){return typeof o=="string"||mM(o)}var Db=Number.isNaN||function(d){return typeof d=="number"&&d!==d};function oE(o,d){return!!(o===d||Db(o)&&Db(d))}function lE(o,d){if(o.length!==d.length)return!1;for(var m=0;m<o.length;m++)if(!oE(o[m],d[m]))return!1;return!0}function cE(o,d){d===void 0&&(d=lE);var m=null;function x(){for(var C=[],k=0;k<arguments.length;k++)C[k]=arguments[k];if(m&&m.lastThis===this&&d(C,m.lastArgs))return m.lastResult;var E=o.apply(this,C);return m={lastResult:E,lastArgs:C,lastThis:this},E}return x.clear=function(){m=null},x}function fv(o){"@babel/helpers - typeof";return fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},fv(o)}function uE(o){if(sw())return Intl.DateTimeFormat.supportedLocalesOf(o)[0]}function sw(){var o=(typeof Intl>"u"?"undefined":fv(Intl))==="object";return o&&typeof Intl.DateTimeFormat=="function"}function Gy(o){"@babel/helpers - typeof";return Gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},Gy(o)}function hE(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")}function dE(o,d){for(var m=0;m<d.length;m++){var x=d[m];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(o,x.key,x)}}function fE(o,d,m){return d&&dE(o.prototype,d),Object.defineProperty(o,"prototype",{writable:!1}),o}var ow=function(){function o(){hE(this,o),this.cache={}}return fE(o,[{key:"get",value:function(){for(var m=this.cache,x=arguments.length,C=new Array(x),k=0;k<x;k++)C[k]=arguments[k];for(var E=0,l=C;E<l.length;E++){var B=l[E];if(Gy(m)!=="object")return;m=m[B]}return m}},{key:"put",value:function(){for(var m=arguments.length,x=new Array(m),C=0;C<m;C++)x[C]=arguments[C];for(var k=x.pop(),E=x.pop(),l=this.cache,B=0,V=x;B<V.length;B++){var X=V[B];Gy(l[X])!=="object"&&(l[X]={}),l=l[X]}return l[E]=k}}]),o}(),Nb=new ow,pE=sw(),mE=function(d){return d.toString()};function gE(o,d){if(!pE)return mE;var m=_E(o),x=JSON.stringify(d),C=Nb.get(String(m),x)||Nb.put(String(m),x,new Intl.DateTimeFormat(m,d));return function(k){return C.format(k)}}const yE=cE(gE);var V_={};function _E(o){var d=o.toString();return V_[d]?V_[d]:V_[d]=uE(o)}function pv(o){"@babel/helpers - typeof";return pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},pv(o)}function vE(o){return xE(o)?o:new Date(o)}function xE(o){return o instanceof Date||bE(o)}function bE(o){return pv(o)==="object"&&typeof o.getTime=="function"}var Lb=new ow;function wE(o,d){var m=d.polyfill,x=String(o)+":"+String(m);return Lb.get(x)||Lb.put(x,new qs(o,{polyfill:m}))}var qm={exports:{}},Xd={exports:{}},SE=Xd.exports,Ob;function TE(){return Ob||(Ob=1,(function(){var o,d,m,x,C,k;typeof performance<"u"&&performance!==null&&performance.now?Xd.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(Xd.exports=function(){return(o()-C)/1e6},d=process.hrtime,o=function(){var E;return E=d(),E[0]*1e9+E[1]},x=o(),k=process.uptime()*1e9,C=x-k):Date.now?(Xd.exports=function(){return Date.now()-m},m=Date.now()):(Xd.exports=function(){return new Date().getTime()-m},m=new Date().getTime())}).call(SE)),Xd.exports}var Bb;function ME(){if(Bb)return qm.exports;Bb=1;for(var o=TE(),d=typeof window>"u"?w2:window,m=["moz","webkit"],x="AnimationFrame",C=d["request"+x],k=d["cancel"+x]||d["cancelRequest"+x],E=0;!C&&E<m.length;E++)C=d[m[E]+"Request"+x],k=d[m[E]+"Cancel"+x]||d[m[E]+"CancelRequest"+x];if(!C||!k){var l=0,B=0,V=[],X=1e3/60;C=function(ne){if(V.length===0){var re=o(),ee=Math.max(0,X-(re-l));l=ee+re,setTimeout(function(){var te=V.slice(0);V.length=0;for(var be=0;be<te.length;be++)if(!te[be].cancelled)try{te[be].callback(l)}catch(Ee){setTimeout(function(){throw Ee},0)}},Math.round(ee))}return V.push({handle:++B,callback:ne,cancelled:!1}),B},k=function(ne){for(var re=0;re<V.length;re++)V[re].handle===ne&&(V[re].cancelled=!0)}}return qm.exports=function(ne){return C.call(d,ne)},qm.exports.cancel=function(){k.apply(d,arguments)},qm.exports.polyfill=function(ne){ne||(ne=d),ne.requestAnimationFrame=C,ne.cancelAnimationFrame=k},qm.exports}var EE=ME();const Fb=lf(EE);function CE(o,d){if(o.length===0)return 0;for(var m=0,x=o.length-1,C;m<=x;){C=Math.floor((x+m)/2);var k=d(o[C]);if(k===0)return C;if(k<0){if(m=C+1,m>x)return m}else if(x=C-1,x<m)return m}}function AE(o,d){return zE(o)||jE(o,d)||PE(o,d)||kE()}function kE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PE(o,d){if(o){if(typeof o=="string")return Ub(o,d);var m=Object.prototype.toString.call(o).slice(8,-1);if(m==="Object"&&o.constructor&&(m=o.constructor.name),m==="Map"||m==="Set")return Array.from(o);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return Ub(o,d)}}function Ub(o,d){(d==null||d>o.length)&&(d=o.length);for(var m=0,x=new Array(d);m<d;m++)x[m]=o[m];return x}function jE(o,d){var m=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(m!=null){var x=[],C=!0,k=!1,E,l;try{for(m=m.call(o);!(C=(E=m.next()).done)&&(x.push(E.value),!(d&&x.length===d));C=!0);}catch(B){k=!0,l=B}finally{try{!C&&m.return!=null&&m.return()}finally{if(k)throw l}}return x}}function zE(o){if(Array.isArray(o))return o}const IE={instances:[],add:function(d){var m=this,x=this.instances.length===0;return lw(this.instances,d),x&&this.start(),{stop:function(){cw(m.instances,d),m.instances.length===0&&m.stop()},forceUpdate:function(){Vb(d,m.instances)}}},tick:function(){for(var d=Date.now();;){var m=this.instances[0];if(d>=m.nextUpdateTime)Vb(m,this.instances);else break}},scheduleNextTick:function(){var d=this;this.scheduledTick=Fb(function(){d.tick(),d.scheduleNextTick()})},start:function(){this.scheduleNextTick()},stop:function(){Fb.cancel(this.scheduledTick)}};function RE(o){var d=o.getNextValue(),m=AE(d,2),x=m[0],C=m[1];o.setValue(x),o.nextUpdateTime=C}function Vb(o,d){RE(o),cw(d,o),lw(d,o)}function lw(o,d){var m=DE(o,d);o.splice(m,0,d)}function cw(o,d){var m=o.indexOf(d);o.splice(m,1)}function DE(o,d){var m=d.nextUpdateTime;return CE(o,function(x){return x.nextUpdateTime===m?0:x.nextUpdateTime>m?1:-1})}function a0(o,d){return BE(o)||OE(o,d)||LE(o,d)||NE()}function NE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LE(o,d){if(o){if(typeof o=="string")return qb(o,d);var m=Object.prototype.toString.call(o).slice(8,-1);if(m==="Object"&&o.constructor&&(m=o.constructor.name),m==="Map"||m==="Set")return Array.from(o);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return qb(o,d)}}function qb(o,d){(d==null||d>o.length)&&(d=o.length);for(var m=0,x=new Array(d);m<d;m++)x[m]=o[m];return x}function OE(o,d){var m=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(m!=null){var x=[],C=!0,k=!1,E,l;try{for(m=m.call(o);!(C=(E=m.next()).done)&&(x.push(E.value),!(d&&x.length===d));C=!0);}catch(B){k=!0,l=B}finally{try{!C&&m.return!=null&&m.return()}finally{if(k)throw l}}return x}}function BE(o){if(Array.isArray(o))return o}function FE(o){var d=o.date,m=o.future,x=o.locale,C=o.locales,k=o.timeStyle,E=o.round,l=o.minTimeLeft,B=o.formatVerboseDate,V=o.verboseDateFormat,X=V===void 0?qE:V,ne=o.updateInterval,re=o.tick,ee=re===void 0?!0:re,te=o.now,be=o.timeOffset,Ee=be===void 0?0:be,Ae=o.polyfill,Ie=he.useMemo(function(){return x&&(C=[x]),C.concat(qs.getDefaultLocale())},[x,C]),tt=he.useMemo(function(){return wE(Ie,{polyfill:Ae})},[Ie,Ae]);d=he.useMemo(function(){return vE(d)},[d]);var vt=he.useCallback(function(){var yt=(te||Date.now())-Ee,Je;if(m&&yt>=d.getTime()&&(yt=d.getTime(),Je=!0),l!==void 0){var Pt=d.getTime()-l*1e3;yt>Pt&&(yt=Pt,Je=!0)}var Se=tt.format(d,k,{getTimeToNextUpdate:!0,now:yt,future:m,round:E}),_t=a0(Se,2),Ot=_t[0],It=_t[1];return Je?It=VE:It=ne||It||60*1e3,[Ot,yt+It]},[d,m,k,ne,E,l,tt,te]),nt=he.useRef();nt.current=vt;var Ye=he.useMemo(vt,[]),st=a0(Ye,2),ot=st[0],at=st[1],xt=he.useState(ot),zt=a0(xt,2),Ht=zt[0],Yt=zt[1],er=he.useRef();he.useEffect(function(){if(ee)return er.current=IE.add({getNextValue:function(){return nt.current()},setValue:Yt,nextUpdateTime:at}),function(){return er.current.stop()}},[ee]),he.useEffect(function(){if(er.current)er.current.forceUpdate();else{var yt=vt(),Je=a0(yt,1),Pt=Je[0];Yt(Pt)}},[vt]);var Rr=he.useMemo(function(){return yE(Ie,X)},[Ie,X]),Mt=he.useMemo(function(){return B?B(d):Rr(d)},[d,B,Rr]);return{date:d,formattedDate:Ht,verboseDate:Mt}}var UE=365*24*60*60*1e3,VE=1e3*UE,qE={weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit"},mv=Or.oneOfType,Zb=Or.arrayOf,zp=Or.string,$b=Or.number,Gm=Or.shape,n0=Or.func,ZE=mv([Gm({minTime:$b,formatAs:zp.isRequired}),Gm({test:n0,formatAs:zp.isRequired}),Gm({minTime:$b,format:n0.isRequired}),Gm({test:n0,format:n0.isRequired})]),$E=mv([zp,Gm({steps:Zb(ZE).isRequired,labels:mv([zp,Zb(zp)]).isRequired,round:zp})]),GE=["date","future","timeStyle","round","minTimeLeft","locale","locales","formatVerboseDate","verboseDateFormat","updateInterval","tick","now","timeOffset","polyfill","tooltip","component","container","wrapperComponent","wrapperProps"];function Hy(){return Hy=Object.assign||function(o){for(var d=1;d<arguments.length;d++){var m=arguments[d];for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&(o[x]=m[x])}return o},Hy.apply(this,arguments)}function HE(o,d){if(o==null)return{};var m=WE(o,d),x,C;if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(o);for(C=0;C<k.length;C++)x=k[C],!(d.indexOf(x)>=0)&&Object.prototype.propertyIsEnumerable.call(o,x)&&(m[x]=o[x])}return m}function WE(o,d){if(o==null)return{};var m={},x=Object.keys(o),C,k;for(k=0;k<x.length;k++)C=x[k],!(d.indexOf(C)>=0)&&(m[C]=o[C]);return m}function Dp(o){var d=o.date,m=o.future,x=o.timeStyle,C=o.round,k=o.minTimeLeft,E=o.locale,l=o.locales,B=l===void 0?[]:l,V=o.formatVerboseDate,X=o.verboseDateFormat,ne=o.updateInterval,re=o.tick,ee=o.now,te=o.timeOffset,be=o.polyfill,Ee=o.tooltip,Ae=Ee===void 0?!0:Ee,Ie=o.component,tt=Ie===void 0?Vy:Ie,vt=o.container,nt=o.wrapperComponent,Ye=o.wrapperProps,st=HE(o,GE),ot=FE({date:d,future:m,timeStyle:x,round:C,minTimeLeft:k,locale:E,locales:B,formatVerboseDate:V,verboseDateFormat:X,updateInterval:ne,tick:re,now:ee,timeOffset:te,polyfill:be}),at=ot.date,xt=ot.verboseDate,zt=ot.formattedDate,Ht=So.createElement(tt,Hy({date:at,verboseDate:xt,tooltip:Ae},st),zt),Yt=nt||vt;return Yt?So.createElement(Yt,Hy({},Ye,{verboseDate:xt}),Ht):Ht}Dp.propTypes={date:Or.oneOfType([Or.instanceOf(Date),Or.number]).isRequired,locale:Or.string,locales:Or.arrayOf(Or.string),future:Or.bool,timeStyle:$E,round:Or.string,minTimeLeft:Or.number,component:Or.elementType,tooltip:Or.bool,formatVerboseDate:Or.func,verboseDateFormat:Or.object,updateInterval:Or.oneOfType([Or.number,Or.arrayOf(Or.shape({threshold:Or.number,interval:Or.number.isRequired}))]),tick:Or.bool,now:Or.number,timeOffset:Or.number,polyfill:Or.bool,wrapperComponent:Or.elementType,wrapperProps:Or.object};Dp=So.memo(Dp);const a_=o=>{const d=new FormData(o),m={};for(let[x,C]of d)if(m.hasOwnProperty(x)?(Array.isArray(m[x])||(m[x]=[m[x]]),m[x].push(C)):m[x]=C,m.openingHours||(m.openingHours={}),m.day&&m.hour){const k=Array.isArray(m.day)?m.day:[m.day],E=Array.isArray(m.hour)?m.hour:[m.hour];k.forEach((l,B)=>{const V=E[B]||"";m.openingHours[l]?(Array.isArray(m.openingHours[l])||(m.openingHours[l]=[m.openingHours[l]]),m.openingHours[l].push(V)):m.openingHours[l]=V}),delete m.day,delete m.hour}return m.location&&(m.location={type:"Point",coordinates:[m.location[0],m.location[1]]}),m},XE=({isOpen:o,onClose:d,post:m,onUpdate:x})=>{const{auth:C}=Ri(),[k,E]=he.useState(m),[l,B]=he.useState([]),[V,X]=he.useState(m.media||[]),[ne,re]=he.useState("not-loaded"),[ee,te]=he.useState("not-loaded"),[be,Ee]=he.useState(""),[Ae,Ie]=he.useState([]);he.useEffect(()=>{st()},[]);const tt=ot=>{const at=Array.from(ot.target.files);if(l.length+V.length+at.length>5){alert("Solo puedes subir hasta 5 imágenes.");return}B([...l,...at])},vt=ot=>{B(l.filter((at,xt)=>xt!==ot))},nt=async(ot,at)=>{te("charging");try{const zt=await(await fetch(Wt.url+"posts/post/media/"+m._id,{method:"DELETE",body:JSON.stringify({url:ot}),headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}})).json();zt.status==="success"&&(te("charged"),Ee(zt.message),re("saved"),E(zt.publication),X(zt.publication.media),x(zt.publication))}catch(xt){te("charged"),Ee(xt.message),re("error")}},Ye=async ot=>{te("charging"),ot.preventDefault();const at=a_(ot.target),xt=new FormData;l.forEach((zt,Ht)=>{xt.append("file0",zt)});try{const Ht=await(await fetch(Wt.url+"posts/post/"+m._id,{method:"PUT",body:JSON.stringify({text:at.text,recipe:at.recipe}),headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}})).json(),er=await(await fetch(Wt.url+"posts/post/media/"+m._id,{method:"PUT",body:xt,headers:{Authorization:localStorage.getItem("token")}})).json();Ht.status==="success"&&(te("charged"),Ee(Ht.message),re("saved"),E(Ht.publication),x(Ht.publication)),er.status==="success"&&(te("charged"),Ee(er.message),re("saved"),E(er.publication),x(er.publication))}catch(zt){te("charged"),Ee(zt.message),re("error")}},st=async()=>{try{const at=await(await fetch(Wt.url+"recipes/"+C._id,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();at.status==="success"&&Ie(at.recipes)}catch(ot){console.log(ot)}};return o&&w.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-900/30 backdrop-blur-md z-50",children:w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-4xl w-full max-h-[98vh] relative overflow-auto",children:[w.jsx(Rl,{size:30,className:"absolute top-2 right-2 text-gray-600 cursor-pointer hover:text-gray-800",onClick:d}),w.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Editar Publicación"}),w.jsxs("form",{className:"space-y-6",onSubmit:Ye,children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Descripción"}),w.jsx("input",{type:"text",name:"text",defaultValue:k.text,className:"block w-full bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 file:py-2 file:px-4 file:bg-amber-700 file:text-white hover:file:bg-amber-800"}),w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Recetas"}),w.jsxs("select",{name:"recipe",className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm",children:[w.jsx("option",{value:"",children:"Selecciona una Receta"}),Ae.map(ot=>w.jsx("option",{value:ot._id,children:ot.title},ot.id))]}),w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Imágenes (Máx. 5)"}),w.jsx("input",{type:"file",multiple:!0,accept:"image/*",name:"file0",onChange:tt,className:"block w-full bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 file:py-2 file:px-4 file:bg-amber-700 file:text-white hover:file:bg-amber-800"}),w.jsx("div",{className:"flex flex-wrap gap-2 mt-2 justify-center",children:w.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 justify-center",children:[V.map((ot,at)=>w.jsxs("div",{className:"relative",children:[w.jsx("img",{src:ot,alt:"Imagen guardada",className:"w-20 h-20 object-cover rounded-md"}),w.jsx("button",{type:"button",className:"absolute top-0 right-0 bg-red-500 text-white rounded-full px-1",onClick:()=>nt(ot),children:"×"})]},at)),l.map((ot,at)=>w.jsxs("div",{className:"relative",children:[w.jsx("img",{src:URL.createObjectURL(ot),alt:"Nueva imagen",className:"w-20 h-20 object-cover rounded-md"}),w.jsx("button",{type:"button",className:"absolute top-0 right-0 bg-red-500 text-white rounded-full px-1",onClick:()=>vt(at),children:"×"})]},`new-${at}`))]})}),w.jsx("div",{className:"text-center",children:w.jsx("button",{type:"submit",className:"bg-amber-700 text-white py-2 px-4 rounded-full hover:bg-amber-800",children:"Agregar"})}),ee==="charging"&&w.jsxs("div",{className:"flex justify-center items-center mt-4",children:[w.jsxs("svg",{className:"animate-spin h-6 w-6 text-amber-600 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 11-8 8z"})]}),w.jsx("p",{className:"text-amber-600 font-medium",children:"Actualizando publicacion..."})]}),w.jsx("strong",{children:ne==="saved"?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",be," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""}),w.jsx("strong",{children:ne=="error"?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",be," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""})]})]})})};function Pl(o){return Yr({attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 4c-4.419 0-8 3.582-8 8s3.581 8 8 8 8-3.582 8-8-3.581-8-8-8zm3.707 10.293c.391.391.391 1.023 0 1.414-.195.195-.451.293-.707.293s-.512-.098-.707-.293l-2.293-2.293-2.293 2.293c-.195.195-.451.293-.707.293s-.512-.098-.707-.293c-.391-.391-.391-1.023 0-1.414l2.293-2.293-2.293-2.293c-.391-.391-.391-1.023 0-1.414s1.023-.391 1.414 0l2.293 2.293 2.293-2.293c.391-.391 1.023-.391 1.414 0s.391 1.023 0 1.414l-2.293 2.293 2.293 2.293z"},child:[]}]})(o)}function n_(o){return Yr({attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M21.561 5.318l-2.879-2.879c-.293-.293-.677-.439-1.061-.439-.385 0-.768.146-1.061.439l-3.56 3.561h-9c-.552 0-1 .447-1 1v13c0 .553.448 1 1 1h13c.552 0 1-.447 1-1v-9l3.561-3.561c.293-.293.439-.677.439-1.061s-.146-.767-.439-1.06zm-10.061 9.354l-2.172-2.172 6.293-6.293 2.172 2.172-6.293 6.293zm-2.561-1.339l1.756 1.728-1.695-.061-.061-1.667zm7.061 5.667h-11v-11h6l-3.18 3.18c-.293.293-.478.812-.629 1.289-.16.5-.191 1.056-.191 1.47v3.061h3.061c.414 0 1.108-.1 1.571-.29.464-.19.896-.347 1.188-.64l3.18-3.07v6zm2.5-11.328l-2.172-2.172 1.293-1.293 2.171 2.172-1.292 1.293z"},child:[]}]})(o)}function YE(o){return Yr({attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M17.414 6.586c-.78-.781-2.048-.781-2.828 0l-2.586 2.586-2.586-2.586c-.78-.781-2.048-.781-2.828 0-.781.781-.781 2.047 0 2.828l2.585 2.586-2.585 2.586c-.781.781-.781 2.047 0 2.828.39.391.902.586 1.414.586s1.024-.195 1.414-.586l2.586-2.586 2.586 2.586c.39.391.902.586 1.414.586s1.024-.195 1.414-.586c.781-.781.781-2.047 0-2.828l-2.585-2.586 2.585-2.586c.781-.781.781-2.047 0-2.828z"},child:[]}]})(o)}function s_(o){return Yr({attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M18 7h-1v-1c0-1.104-.896-2-2-2h-7c-1.104 0-2 .896-2 2v1h-1c-.552 0-1 .448-1 1s.448 1 1 1v8c0 2.206 1.794 4 4 4h5c2.206 0 4-1.794 4-4v-8c.552 0 1-.448 1-1s-.448-1-1-1zm-10-1h7v1h-7v-1zm8 11c0 1.104-.896 2-2 2h-5c-1.104 0-2-.896-2-2v-8h9v8zM8.5 10.5c-.275 0-.5.225-.5.5v6c0 .275.225.5.5.5s.5-.225.5-.5v-6c0-.275-.225-.5-.5-.5zM10.5 10.5c-.275 0-.5.225-.5.5v6c0 .275.225.5.5.5s.5-.225.5-.5v-6c0-.275-.225-.5-.5-.5zM12.5 10.5c-.275 0-.5.225-.5.5v6c0 .275.225.5.5.5s.5-.225.5-.5v-6c0-.275-.225-.5-.5-.5zM14.5 10.5c-.275 0-.5.225-.5.5v6c0 .275.225.5.5.5s.5-.225.5-.5v-6c0-.275-.225-.5-.5-.5z"},child:[]}]})(o)}const KE=({comments:o,idPost:d})=>{const{auth:m}=Ri(),[x,C]=he.useState(o),[k,E]=he.useState(null),[l,B]=he.useState(""),[V,X]=he.useState(!1),ne=async te=>{try{const Ee=await(await fetch(Wt.url+`posts/post/${d}/comment/${te}`,{method:"DELETE",headers:{Authorization:localStorage.getItem("token")}})).json();Ee.status==="success"&&C(Ee.post.comments)}catch(be){console.log(be)}},re=async te=>{const be=new URLSearchParams;be.append("text",l);try{const Ae=await(await fetch(Wt.url+`posts/post/${d}/comment/${te}`,{method:"PUT",body:be,headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:localStorage.getItem("token")}})).json();Ae.status==="success"&&(console.log(Ae),C(Ae.post.comments),E(null))}catch(Ee){console.log(Ee)}},ee=async()=>{const te=new URLSearchParams;te.append("text",l);try{const Ee=await(await fetch(Wt.url+`posts/post/comment/${d}`,{method:"POST",body:te,headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:localStorage.getItem("token")}})).json();Ee.status==="success"&&(C(Ee.post.comments),X(!1))}catch(be){console.log(be)}};return w.jsxs("div",{className:"mt-6",children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Comentarios"}),w.jsxs("div",{className:"space-y-4",children:[x&&x.length>0?x.map(te=>w.jsxs("div",{className:"flex items-start gap-4 border-b py-4",children:[w.jsx("img",{src:te.user.avatar,alt:`Avatar de ${te.user.username}`,className:"w-10 h-10 rounded-full object-cover"}),k&&k._id===te._id?w.jsxs("div",{className:"flex-1",children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsx("h4",{className:"font-semibold text-gray-800",children:te.user.username})}),w.jsxs("div",{className:"flex justify-around items-center gap-2",children:[w.jsx("input",{name:"text",defaultValue:te.text,onChange:be=>B(be.target.value),className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 file:py-2 file:px-4 file:bg-amber-700 file:text-white file:rounded-md hover:border-amber-500 focus:outline-none hover:file:bg-amber-800"}),w.jsx(Hx,{onClick:()=>re(te._id),className:"text-blue-500 hover:text-blue-700 cursor-pointer",size:25})]})]}):w.jsxs("div",{className:"flex-1",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("h4",{className:"font-semibold text-gray-800",children:te.user.username}),w.jsx("p",{className:"text-sm text-gray-500",children:w.jsx(Dp,{date:te.created_at,locale:"es-ES"})})]}),w.jsx("p",{className:"text-gray-700 mt-2",children:te.text})]}),w.jsx("div",{className:"flex",children:te.user._id===m._id&&w.jsxs(w.Fragment,{children:[w.jsx(s_,{className:"text-red-500 hover:text-red-700 cursor-pointer",size:20,onClick:()=>ne(te._id)}),w.jsx(n_,{onClick:()=>{k&&k._id===te._id?E(null):(E(te),B(te.text))},className:"text-amber-500 hover:text-amber-700 cursor-pointer",size:20})]})})]},te._id)):w.jsx("p",{className:"text-gray-500",children:"No hay comentarios aún."}),V&&w.jsx("div",{className:"flex-1",children:w.jsxs("div",{className:"flex justify-around items-center gap-2",children:[w.jsx("input",{name:"text",onChange:te=>B(te.target.value),className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 file:py-2 file:px-4 file:bg-amber-700 file:text-white file:rounded-md hover:border-amber-500 focus:outline-none hover:file:bg-amber-800"}),w.jsx(Hx,{onClick:ee,className:"text-blue-500 hover:text-blue-700 cursor-pointer",size:25})]})}),w.jsx("div",{className:"flex items-center justify-center hover:text-lime-700",children:w.jsx(zu,{size:25,onClick:()=>X(!0)})})]})]})};function uw(o){return Yr({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M.5 6a.5.5 0 0 0-.488.608l1.652 7.434A2.5 2.5 0 0 0 4.104 16h5.792a2.5 2.5 0 0 0 2.44-1.958l.131-.59a3 3 0 0 0 1.3-5.854l.221-.99A.5.5 0 0 0 13.5 6zM13 12.5a2 2 0 0 1-.316-.025l.867-3.898A2.001 2.001 0 0 1 13 12.5"},child:[]},{tag:"path",attr:{d:"m4.4.8-.003.004-.014.019a4 4 0 0 0-.204.31 2 2 0 0 0-.141.267c-.026.06-.034.092-.037.103v.004a.6.6 0 0 0 .091.248c.075.133.178.272.308.445l.01.012c.118.158.26.347.37.543.112.2.22.455.22.745 0 .188-.065.368-.119.494a3 3 0 0 1-.202.388 5 5 0 0 1-.253.382l-.018.025-.005.008-.002.002A.5.5 0 0 1 3.6 4.2l.003-.004.014-.019a4 4 0 0 0 .204-.31 2 2 0 0 0 .141-.267c.026-.06.034-.092.037-.103a.6.6 0 0 0-.09-.252A4 4 0 0 0 3.6 2.8l-.01-.012a5 5 0 0 1-.37-.543A1.53 1.53 0 0 1 3 1.5c0-.188.065-.368.119-.494.059-.138.134-.274.202-.388a6 6 0 0 1 .253-.382l.025-.035A.5.5 0 0 1 4.4.8m3 0-.003.004-.014.019a4 4 0 0 0-.204.31 2 2 0 0 0-.141.267c-.026.06-.034.092-.037.103v.004a.6.6 0 0 0 .091.248c.075.133.178.272.308.445l.01.012c.118.158.26.347.37.543.112.2.22.455.22.745 0 .188-.065.368-.119.494a3 3 0 0 1-.202.388 5 5 0 0 1-.253.382l-.018.025-.005.008-.002.002A.5.5 0 0 1 6.6 4.2l.003-.004.014-.019a4 4 0 0 0 .204-.31 2 2 0 0 0 .141-.267c.026-.06.034-.092.037-.103a.6.6 0 0 0-.09-.252A4 4 0 0 0 6.6 2.8l-.01-.012a5 5 0 0 1-.37-.543A1.53 1.53 0 0 1 6 1.5c0-.188.065-.368.119-.494.059-.138.134-.274.202-.388a6 6 0 0 1 .253-.382l.025-.035A.5.5 0 0 1 7.4.8m3 0-.003.004-.014.019a4 4 0 0 0-.204.31 2 2 0 0 0-.141.267c-.026.06-.034.092-.037.103v.004a.6.6 0 0 0 .091.248c.075.133.178.272.308.445l.01.012c.118.158.26.347.37.543.112.2.22.455.22.745 0 .188-.065.368-.119.494a3 3 0 0 1-.202.388 5 5 0 0 1-.252.382l-.019.025-.005.008-.002.002A.5.5 0 0 1 9.6 4.2l.003-.004.014-.019a4 4 0 0 0 .204-.31 2 2 0 0 0 .141-.267c.026-.06.034-.092.037-.103a.6.6 0 0 0-.09-.252A4 4 0 0 0 9.6 2.8l-.01-.012a5 5 0 0 1-.37-.543A1.53 1.53 0 0 1 9 1.5c0-.188.065-.368.119-.494.059-.138.134-.274.202-.388a6 6 0 0 1 .253-.382l.025-.035A.5.5 0 0 1 10.4.8"},child:[]}]})(o)}const hw=({isOpen:o,onClose:d,post:m})=>{const{auth:x}=Ri(),[C,k]=he.useState(m),[E,l]=he.useState(0),[B,V]=he.useState(!1),[X,ne]=he.useState(!1),re=()=>{l(Ae=>(Ae+1)%C.media.length)},ee=()=>{l(Ae=>(Ae-1+C.media.length)%C.media.length)},te=async Ae=>{const Ie=Ae._id;try{(await(await fetch(Wt.url+"posts/post/"+Ie,{method:"DELETE",headers:{Authorization:localStorage.getItem("token")}})).json()).status==="success"&&setTimeout(()=>{d()},500)}catch{}},be=Ae=>{k(Ae)},Ee=async Ae=>{const Ie=Ae._id;try{(await(await fetch(Wt.url+`posts/post/like/${Ie}`,{method:"POST",headers:{Authorization:localStorage.getItem("token")}})).json()).status==="success"&&k(nt=>({...nt,likes:nt.likes.includes(x._id)?nt.likes.filter(Ye=>Ye!==x._id):[...nt.likes,x._id]}))}catch(tt){console.log(tt)}};return w.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-900/30 backdrop-blur-md transition-all duration-300 z-50 overflow-auto",children:w.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full sm:w-[75%] h-[90vh] flex flex-col sm:flex-row relative",children:[w.jsxs("div",{className:"relative flex-1 flex justify-center items-center bg-black",children:[C.media.length>1&&w.jsx(q1,{className:"absolute left-4 text-white bg-gray-700 p-2 rounded-full shadow-md cursor-pointer hover:bg-gray-600",size:40,onClick:ee}),w.jsx("img",{src:C.media[E],alt:`Coffe ${C.user}`,className:"max-h-full max-w-full object-cover"}),C.media.length>1&&w.jsx(Z1,{className:"absolute right-4 text-white bg-gray-700 p-2 rounded-full shadow-md cursor-pointer hover:bg-gray-600",size:40,onClick:re})]}),w.jsxs("div",{className:"w-full sm:w-[35%] bg-white p-6 flex flex-col justify-between sm:mt-0 mt-4",children:[w.jsxs("div",{className:"bg-white flex flex-col justify-between",children:[w.jsxs("div",{className:"absolute top-1 right-4 flex gap-2 items-center",children:[x._id===m.user._id&&w.jsx(s_,{onClick:()=>te(C),className:"text-red-500 hover:text-red-700 cursor-pointer",size:20}),x._id===m.user._id&&w.jsx(n_,{onClick:()=>{V(!0),ne(!1)},className:"text-amber-500 hover:text-amber-700 cursor-pointer",size:20}),w.jsx(YE,{onClick:d,className:"text-gray-600 hover:text-red-600 cursor-pointer",size:25})]}),w.jsxs("div",{children:[w.jsxs("div",{className:"flex gap-4 items-center mb-2",children:[w.jsx("img",{src:C.user.avatar,alt:`Avatar de ${C.user.username}`,className:"border rounded-full w-10 h-10 object-cover"}),w.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:C.user.username})]}),w.jsx("hr",{}),w.jsx("p",{className:"text-gray-600 mt-2",children:C.text}),C.recipe&&w.jsxs("div",{onClick:()=>{ne(!0),V(!1)},className:"mt-4 p-4 bg-gray-100 rounded-lg shadow-md cursor-pointer",children:[w.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["🍽️ ",C.recipe.title]}),w.jsx("p",{className:"text-gray-600 mt-2 whitespace-pre-wrap",children:C.recipe.method})]})]})]}),w.jsx("div",{className:"overflow-auto max-h-[90%] mt-4",children:w.jsx("div",{className:"space-y-4",children:w.jsx(KE,{comments:C.comments,idPost:C._id})})}),w.jsxs("div",{children:[C.likes&&w.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",children:[w.jsx(uw,{className:C.likes.includes(x._id)?"text-red-700":"text-gray-400",size:25,onClick:()=>{Ee(C)}}),w.jsx("p",{children:C.likes.length})]}),w.jsx("p",{className:"text-gray-400 mt-4",children:w.jsx(Dp,{date:C.created_at,locale:"es-ES"})})]})]}),B&&w.jsx(XE,{isOpen:B,onClose:()=>V(!1),post:C,onUpdate:be}),X&&w.jsx(hx,{isOpen:X,onClose:()=>ne(!1),recipe:C.recipe})]})})};function o_(o){return Yr({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"},child:[]}]})(o)}function l_(o){return Yr({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"},child:[]}]})(o)}function QE(o){return Yr({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M18 6V4h2V2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14v-2h-4.03A4.966 4.966 0 0 0 18 16v-5H8v5c0 1.64.81 3.09 2.03 4H6V4h2v2c0 .55.45 1 1 1h8c.55 0 1-.45 1-1zm-8 10v-3h6v3c0 1.65-1.35 3-3 3s-3-1.35-3-3z"},child:[]},{tag:"circle",attr:{cx:"13",cy:"9",r:"1"},child:[]}]})(o)}function JE(o){return Yr({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M16 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V8l-5-5zm3 16H5V5h10v4h4v10zM7 17h10v-2H7v2zm5-10H7v2h5V7zm-5 6h10v-2H7v2z"},child:[]}]})(o)}function eC(o){return Yr({attr:{version:"1.1",viewBox:"0 0 17 17"},child:[{tag:"g",attr:{},child:[]},{tag:"path",attr:{d:"M6 8h-6v-6h1v4.109c1.013-3.193 4.036-5.484 7.5-5.484 3.506 0 6.621 2.36 7.574 5.739l-0.963 0.271c-0.832-2.95-3.551-5.011-6.611-5.011-3.226 0.001-6.016 2.276-6.708 5.376h4.208v1zM11 9v1h4.208c-0.693 3.101-3.479 5.375-6.708 5.375-3.062 0-5.78-2.061-6.611-5.011l-0.963 0.271c0.952 3.379 4.067 5.739 7.574 5.739 3.459 0 6.475-2.28 7.5-5.482v4.108h1v-6h-6z"},child:[]}]})(o)}const Gb=({onUpdate:o})=>{const{auth:d}=Ri(),m=zl(),[x,C]=he.useState({}),[k,E]=he.useState(1),[l,B]=he.useState(null),[V,X]=he.useState(null),[ne,re]=he.useState(1),[ee,te]=he.useState(!1),[be,Ee]=he.useState(null),[Ae,Ie]=he.useState(!1),[tt,vt]=he.useState(null);he.useEffect(()=>{nt()},[k]);const nt=async(st=!1)=>{try{st&&(C({}),E(1));const at=await(await fetch(Wt.url+`posts/feed/${k}`,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();at.status==="success"&&(C(at.publications.docs),at.publications.hasNextPage&&B(at.publications.hasNextPage),at.publications.hasPrevPage&&X(at.publications.hasPrevPage),at.publications.totalPages&&re(at.publications.totalPages))}catch(ot){console.log(ot),C({})}},Ye=async st=>{const ot=st._id;try{const xt=await(await fetch(Wt.url+`posts/post/like/${ot}`,{method:"POST",headers:{Authorization:localStorage.getItem("token")}})).json();xt.status==="success"&&xt.message==="Like agregado a la publicación"&&C(zt=>zt.map(Ht=>Ht._id===ot?{...Ht,likes:xt.post.likes}:Ht)),xt.status==="success"&&xt.message==="Like eliminado"&&C(zt=>zt.map(Ht=>Ht._id===ot?{...Ht,likes:Ht.likes.filter(Yt=>Yt!==xt.userId)}:Ht))}catch(at){console.log(at)}};return w.jsxs("div",{className:"w-full max-w-4xl md:max-w-2xl lg:max-w-3xl xl:max-w-4xl mx-auto bg-white shadow-md rounded-lg overflow-hidden mt-[20%] sm:mt-[20%] md:mt-[10%] lg:mt-[7%] xl:mt-[7%] 2xl:mt-[5%] mb-10 md:mb-0",children:[w.jsxs("div",{className:"relative items-center mb-6",children:[w.jsx("div",{className:"flex justify-center",children:w.jsx(eC,{className:"text-gray-600 bg-white rounded-md p-2 hover:text-gray-800 hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",size:35,onClick:()=>nt(!0)})}),x.length>0?x.map((st,ot)=>w.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 m-8 sm:m-1 flex flex-col gap-3 cursor-pointer",children:[w.jsxs("div",{onClick:()=>m("/private/profile/",{state:{user:st.user._id}}),className:"flex items-center gap-3 cursor-pointer",children:[w.jsx("img",{className:"w-10 h-10 rounded-full object-cover",src:st.user.avatar?st.user.avatar:Uh,alt:st.user.username}),w.jsx("span",{className:"font-semibold text-gray-800",children:st.user.username})]}),w.jsx("div",{className:"cursor-pointer",onClick:()=>{Ie(!0),te(!1),vt(st)},children:w.jsx("img",{className:"w-full rounded-lg object-cover",src:st.media[0],alt:"Preview"})}),w.jsx("p",{className:"text-gray-700 text-sm",children:st.text}),st.recipe&&w.jsxs("div",{onClick:()=>{te(!0),Ie(!1),Ee(st.recipe)},className:"mt-2 mb-2 p-4 bg-gray-100 rounded-lg shadow-md cursor-pointer",children:[w.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["🍽️ ",st.recipe.title]}),w.jsx("p",{className:"text-gray-600 mt-2 whitespace-pre-wrap",children:st.recipe.method})]}),w.jsx("div",{children:w.jsx("p",{className:"text-gray-600 mt-2 whitespace-pre-wrap",children:w.jsx(Dp,{date:st.created_at,locale:"es-ES"})})}),st.likes&&w.jsx(uw,{className:st.likes.includes(d._id)?"text-red-700":"text-gray-400",size:25,onClick:()=>{Ye(st)}})]},ot)):w.jsx("p",{className:"text-center text-gray-600",children:"No hay publicaciones"}),ne&&ne>1&&w.jsxs("div",{className:"flex justify-between items-center mt-6",children:[w.jsx(o_,{className:"text-gray-600 bg-white rounded-full p-2 hover:text-gray-800 hover:rounded-full hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",onClick:()=>{V&&E(st=>Math.max(st-1,1))},size:40}),w.jsxs("span",{className:"text-gray-700",children:["Página ",k," de ",ne]}),w.jsx(l_,{className:"text-gray-600 bg-white rounded-full p-2 hover:text-gray-800 hover:rounded-full hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",size:40,onClick:()=>{l&&E(st=>Math.min(st+1,ne))}})]})]}),ee&&w.jsx(hx,{isOpen:ee,onClose:()=>{te(!1),o()},recipe:be}),Ae&&w.jsx(hw,{isOpen:Ae,onClose:()=>{Ie(!1),o()},post:tt})]})};function dw(o){return Yr({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]},{tag:"line",attr:{x1:"12",y1:"12",x2:"12",y2:"21"},child:[]},{tag:"path",attr:{d:"M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"},child:[]},{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]}]})(o)}const tC=({isOpen:o,onClose:d})=>{const{auth:m,setAuth:x}=Ri(),[C,k]=he.useState("not-loaded"),E=he.useRef(null);he.useEffect(()=>{C==="charged"&&setTimeout(()=>{d(),k("not-loaded")},500)},[C,d]);const l=async()=>{k("charging");let B=document.querySelector("#file");if(B.files[0]){const V=new FormData;V.append("file0",B.files[0]);try{const ne=await(await fetch(Wt.url+"/users/avatar/"+m._id,{method:"PUT",body:V,headers:{Authorization:localStorage.getItem("token")}})).json();ne.status==="success"&&(x(re=>({...re,avatar:ne.user.avatar})),k("charged"))}catch(X){console.log(X)}}};return o&&w.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-900/30 backdrop-blur-md transition-all duration-300 z-50",children:w.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg relative w-80",children:[w.jsx(Rl,{size:30,className:"absolute top-2 right-2 text-gray-600 cursor-pointer hover:text-gray-800",onClick:d}),w.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Actualizar Imagen"}),w.jsx("div",{className:"flex justify-center mb-4",children:w.jsx("img",{className:"w-32 h-32 border rounded-full object-cover",src:m.avatar?m.avatar:Uh,alt:"Preview"})}),w.jsxs("div",{className:"border-2 border-dashed border-gray-300 p-4 rounded-lg text-center cursor-pointer hover:bg-gray-100",onClick:()=>E.current.click(),children:[w.jsx(dw,{className:"mx-auto text-gray-500",size:40}),w.jsx("p",{className:"text-sm text-gray-500",children:"Haz clic para subir una imagen"})]}),w.jsx("input",{type:"file",name:"file0",className:"hidden",id:"file",ref:E,onChange:l}),C==="charging"&&w.jsxs("div",{className:"flex justify-center items-center mt-4",children:[w.jsxs("svg",{className:"animate-spin h-6 w-6 text-amber-600 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 11-8 8z"})]}),w.jsx("p",{className:"text-amber-600 font-medium",children:"Subiendo imagen..."})]})]})})},rC=()=>{const{auth:o}=Ri(),[d,m]=he.useState({}),{changed:x,form:C}=Il(),[k,E]=he.useState({});he.useEffect(()=>{o.openingHours&&m(o.openingHours)},[]);const l=X=>{m(ne=>{let re={...ne};return delete re[X],re})},B=()=>{m(X=>({...X,"":{hour:"",isNew:!0}}))},V=()=>{let X={};if(!C.day){X.day="Es necesario que escriba un día",E(X);return}m(ne=>{let re={...ne};return delete re[""],re[C.day]=C.hour,re}),E({})};return w.jsxs("div",{children:[w.jsx("label",{className:"block mt-2 text-lg font-medium text-gray-900",children:"Horario"}),Object.entries(d).map(X=>w.jsxs("div",{className:"flex flex-col md:flex-row md:justify-start items-start md:items-center mt-4 p-2",children:[w.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center md:space-x-4 w-full",children:[w.jsx("input",{name:"day",defaultValue:X[0],onChange:x,className:"block w-full md:w-auto font-bold rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),w.jsx("input",{name:"hour",defaultValue:typeof X[1]=="object"?"":X[1],onChange:x,className:"block w-full md:w-auto mt-2 md:mt-0 rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsx("div",{className:"flex items-center mt-2 md:mt-0 md:ml-4",children:X[1].isNew?w.jsx(ux,{className:"ml-2 p-1 hover:text-green-600 cursor-pointer",onClick:V,size:23}):w.jsx(Pl,{className:"ml-2 p-1 hover:text-red-600 cursor-pointer",onClick:()=>l(X[0]),size:30})})]},X[0])),k.day&&w.jsx("div",{className:"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:w.jsx("strong",{className:"font-bold",children:k.day})}),w.jsx("div",{className:"mt-2 p-1 flex justify-center hover:text-lime-700",children:w.jsx(zu,{onClick:B,className:"cursor-pointer",size:Object.entries(d).length===0?"30":"25"})})]})},iC=()=>{const{auth:o}=Ri(),[d,m]=he.useState([]);he.useEffect(()=>{o.menu&&m(o.menu)},[]);const x=()=>{m(k=>[...k,{name:"",isNew:!0}])},C=k=>{console.log(k),m(E=>[...E].filter((V,X)=>X!==k))};return w.jsxs("div",{children:[w.jsx("label",{className:"block mt-2 text-sm font-medium text-gray-900",children:"Menú"}),d.map((k,E)=>w.jsxs("div",{className:"flex mt-2 justify-start",children:[w.jsx("input",{name:"menu",defaultValue:k.isNew?k.name:k,className:"block w-auto rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),w.jsx("div",{className:"ml-2 p-1 border-hidden flex justify-center items-center hover:text-red-600",children:w.jsx(Pl,{onClick:()=>C(E),size:20})})]},E)),w.jsx("div",{className:"mt-2 p-1 flex justify-center hover:text-lime-700",children:w.jsx(zu,{onClick:x,size:25})})]})},aC=()=>{const{auth:o}=Ri(),[d,m]=he.useState([]);he.useEffect(()=>{o.origin&&m(o.origin)},[]);const x=()=>{m(k=>[...k,{name:"",isNew:!0}])},C=k=>{m(E=>[...E].filter((V,X)=>X!==k))};return w.jsxs("div",{children:[w.jsx("label",{className:"block mt-2 text-sm font-medium text-gray-900",children:"Origenes"}),d.map((k,E)=>w.jsxs("div",{className:"flex mt-2 justify-start",children:[w.jsx("input",{name:"origin",defaultValue:k.isNew?k.name:k,className:"block w-auto rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),w.jsx("div",{className:"ml-2 p-1 border-hidden flex justify-center items-center hover:text-red-600",children:w.jsx(Pl,{onClick:()=>C(E),size:20})})]},E)),w.jsx("div",{className:"mt-2 p-1 flex justify-center hover:text-lime-700",children:w.jsx(zu,{onClick:x,size:25})})]})},nC=()=>{const{auth:o}=Ri(),[d,m]=he.useState([]);he.useEffect(()=>{o.certifications&&m(o.certifications)},[]);const x=()=>{m(k=>[...k,{name:"",isNew:!0}])},C=k=>{m(E=>[...E].filter((V,X)=>X!==k))};return w.jsxs("div",{children:[w.jsx("label",{className:"block mt-2 text-sm font-medium text-gray-900",children:"Certificaciones"}),d.map((k,E)=>w.jsxs("div",{className:"flex mt-2 justify-start",children:[w.jsx("input",{name:"certifications",defaultValue:k.isNew?k.name:k,className:"block w-auto rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),w.jsx("div",{className:"ml-2 p-1 border-hidden flex justify-center items-center hover:text-red-600",children:w.jsx(Pl,{onClick:()=>C(E),size:20})})]},E)),w.jsx("div",{className:"mt-2 p-1 flex justify-center hover:text-lime-700",children:w.jsx(zu,{onClick:x,size:25})})]})},sC=()=>{const{auth:o}=Ri(),[d,m]=he.useState([]);he.useEffect(()=>{o.coffeeVarieties&&m(o.coffeeVarieties)},[]);const x=()=>{m(k=>[...k,{name:"",isNew:!0}])},C=k=>{m(E=>[...E].filter((V,X)=>X!==k))};return w.jsxs("div",{children:[w.jsx("label",{className:"block mt-2 text-sm font-medium text-gray-900",children:"Varietales"}),d.map((k,E)=>w.jsxs("div",{className:"flex mt-2 justify-start",children:[w.jsx("input",{name:"coffeeVarieties",defaultValue:k.isNew?k.name:k,className:"block w-auto rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),w.jsx("div",{className:"ml-2 p-1 border-hidden flex justify-center items-center hover:text-red-600",children:w.jsx(Pl,{onClick:()=>C(E),size:20})})]},E)),w.jsx("div",{className:"mt-2 p-1 flex justify-center hover:text-lime-700",children:w.jsx(zu,{onClick:x,size:25})})]})};var oC=Object.defineProperty,lC=Object.defineProperties,cC=Object.getOwnPropertyDescriptors,Wy=Object.getOwnPropertySymbols,fw=Object.prototype.hasOwnProperty,pw=Object.prototype.propertyIsEnumerable,Hb=(o,d,m)=>d in o?oC(o,d,{enumerable:!0,configurable:!0,writable:!0,value:m}):o[d]=m,_i=(o,d)=>{for(var m in d||(d={}))fw.call(d,m)&&Hb(o,m,d[m]);if(Wy)for(var m of Wy(d))pw.call(d,m)&&Hb(o,m,d[m]);return o},Nh=(o,d)=>lC(o,cC(d)),c_=(o,d)=>{var m={};for(var x in o)fw.call(o,x)&&d.indexOf(x)<0&&(m[x]=o[x]);if(o!=null&&Wy)for(var x of Wy(o))d.indexOf(x)<0&&pw.call(o,x)&&(m[x]=o[x]);return m},px=(o,d,m)=>{if(!d.has(o))throw TypeError("Cannot "+m)},on=(o,d,m)=>(px(o,d,"read from private field"),m?m.call(o):d.get(o)),Us=(o,d,m)=>{if(d.has(o))throw TypeError("Cannot add the same private member more than once");d instanceof WeakSet?d.add(o):d.set(o,m)},Cl=(o,d,m,x)=>(px(o,d,"write to private field"),d.set(o,m),m),uC=(o,d,m,x)=>({set _(C){Cl(o,d,C)},get _(){return on(o,d,x)}}),Np=(o,d,m)=>(px(o,d,"access private method"),m),xs=(o,d,m)=>new Promise((x,C)=>{var k=B=>{try{l(m.next(B))}catch(V){C(V)}},E=B=>{try{l(m.throw(B))}catch(V){C(V)}},l=B=>B.done?x(B.value):Promise.resolve(B.value).then(k,E);l((m=m.apply(o,d)).next())}),mw="https://api.mapbox.com/autofill/v1",hC="suggest",dC="retrieve",fC=`${mw}/${hC}`,pC=`${mw}/${dC}`,sa=class{constructor(o,d){if(isNaN(o)||isNaN(d))throw new Error(`Invalid LngLat object: (${o}, ${d})`);if(this.lng=+o,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90");if(this.lng>180||this.lng<-180)throw new Error("Invalid LngLat longitude value: must be between -180 and 180")}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}static convert(o){if(o instanceof sa)return new sa(o.lng,o.lat);if(Array.isArray(o)&&o.length===2)return new sa(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null&&("lng"in o||"lon"in o)&&"lat"in o)return new sa(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}},Vs=class{constructor(o,d){this._sw=sa.convert(o),this._ne=sa.convert(d)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new sa(this.getWest(),this.getNorth())}getSouthEast(){return new sa(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toFlatArray(){return[this._sw.lng,this._sw.lat,this._ne.lng,this._ne.lat]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}static convert(o){if(!o)throw new Error("Invalid LngLatBounds convert value: falsy");if(o instanceof Vs)return new Vs(o.getSouthWest(),o.getNorthEast());if(Array.isArray(o)&&o.length===2)return new Vs(sa.convert(o[0]),sa.convert(o[1]));if(Array.isArray(o)&&o.length===4)return new Vs(sa.convert([o[0],o[1]]),sa.convert([o[2],o[3]]));throw new Error("`LngLatBoundsLike` argument must be specified as an array [<LngLatLike>, <LngLatLike>] or an array [<west>, <south>, <east>, <north>]")}};function mC(){const d=(Math.random().toString(16)+Date.now().toString(16)+Math.random().toString(16)).replace(/\./g,"");return[d.slice(0,8),d.slice(8,12),"4"+d.slice(12,15)+"-8"+d.slice(15,18),d.slice(18,30)].join("-")}var To=class{constructor(o){this.id=o??mC()}toString(){return this.id}static convert(o){return new To(o instanceof To?o.id:o.toString())}},gC="Unknown error",yC=class extends Error{constructor(o,d){super(String(o.message||o.error||gC)),this.name="MapboxError",this.statusCode=d}toString(){return`${this.name} (${this.statusCode}): ${this.message}`}};function Au(o){return xs(this,null,function*(){if(!o.ok){const d=yield o.json();throw new yC(d,o.status)}})}var Wb=globalThis.fetch,_C=globalThis.AbortController;function jc(){if(!Wb)throw new Error("Fetch implementation not found. Please include a fetch polyfill in your application or use `polyfillFetch` from `@mapbox/search-js-core` to fix this issue.");return{fetch:Wb,AbortController:_C}}function sf(...o){const d=[];for(const m of o){if(!m)continue;const x=Object.entries(m);for(const[C,k]of x)k!=null&&d.push(`${C}=${encodeURIComponent(String(k))}`)}return d.join("&")}var u0,gv,gw,yw=class{constructor(o={}){Us(this,gv),Us(this,u0,void 0);const d=o,{accessToken:m}=d,x=c_(d,["accessToken"]);this.accessToken=m,this.defaults=_i(_i({},yw.defaults),x)}get responseHeaders(){return on(this,u0)}suggest(o,d){return xs(this,null,function*(){if(!o)throw new Error("searchText is required");const{sessionToken:m,signal:x}=d,C=Nh(_i(_i({},this.defaults),d),{sessionToken:m}),k=new URL(`${fC}/${encodeURIComponent(o)}`);k.search=Np(this,gv,gw).call(this,C);const{fetch:E}=jc(),l=yield E(k.toString(),{signal:x});Cl(this,u0,l.headers),yield Au(l);const B=yield l.json();return Nh(_i({},B),{suggestions:B.suggestions.map(V=>Nh(_i({},V),{original_search_text:o})),url:k.toString()})})}retrieve(o,d){return xs(this,null,function*(){if(!o)throw new Error("suggestion is required");if(!this.canRetrieve(o))throw new Error("suggestion cannot be retrieved");const{sessionToken:m,signal:x}=d,C=To.convert(m),k=new URL(`${pC}/${o.action.id}`);k.search=sf({access_token:this.accessToken,session_token:C.id});const{fetch:E}=jc(),l=yield E(k.toString(),{signal:x});yield Au(l);const B=yield l.json();return B.url=k.toString(),B})}canRetrieve(o){const d=o.action;return typeof(d==null?void 0:d.id)=="string"}},_w=yw;u0=new WeakMap;gv=new WeakSet;gw=function(o){return sf({types:"address",access_token:this.accessToken,streets:o.streets,language:o.language,country:o.country,limit:o.limit},o.sessionToken&&{session_token:To.convert(o.sessionToken).id},o.proximity&&{proximity:typeof o.proximity=="string"?o.proximity:sa.convert(o.proximity).toArray().join(",")},o.bbox&&{bbox:typeof o.bbox=="string"?o.bbox:Vs.convert(o.bbox).toFlatArray().join(",")})};_w.defaults={language:"en",proximity:"ip",streets:!0};var u_="https://api.mapbox.com/search/searchbox/v1",vC="suggest",xC="retrieve",bC="category",wC="reverse",SC=`${u_}/${vC}`,TC=`${u_}/${xC}`,MC=`${u_}/${bC}`,EC=`${u_}/${wC}`,h0,yv,vw=class{constructor(o={}){Us(this,h0);const d=o,{accessToken:m}=d,x=c_(d,["accessToken"]);this.accessToken=m,this.defaults=_i(_i({},vw.defaults),x)}suggest(o,d){return xs(this,null,function*(){if(!o)throw new Error("searchText is required");const{sessionToken:m,signal:x}=d,C=Nh(_i(_i({},this.defaults),d),{q:o,sessionToken:m});if(C.eta_type&&(!C.origin||!C.navigation_profile))throw new Error("to provide eta estimate: eta, navigation_profile, and origin are required");if(C.origin&&!C.navigation_profile)throw new Error("to provide distance estimate: both navigation_profile and origin are required");const k=new URL(SC);k.search=Np(this,h0,yv).call(this,C);const{fetch:E}=jc(),l=yield E(k.toString(),{signal:x});yield Au(l);const B=yield l.json();return B.url=k.toString(),B})}retrieve(o,d){return xs(this,null,function*(){if(!o)throw new Error("suggestion is required");const{sessionToken:m,signal:x,language:C}=d,k=To.convert(m),E=_i(_i({},this.defaults),C&&{language:C}),l=new URL(`${TC}/${encodeURIComponent(o.mapbox_id)}`);l.search=sf({access_token:this.accessToken,session_token:k.id},{language:E.language});const{fetch:B}=jc(),V=yield B(l.toString(),{signal:x});yield Au(V);const X=yield V.json();return X.url=l.toString(),X})}category(o){return xs(this,arguments,function*(d,m={}){if(!d)throw new Error("category is required");const x=_i(_i({},this.defaults),m),C=new URL(`${MC}/${encodeURIComponent(d)}`);C.search=Np(this,h0,yv).call(this,x);const{fetch:k}=jc(),E=yield k(C.toString(),{signal:x.signal});yield Au(E);const l=yield E.json();return l.url=C.toString(),l})}reverse(o){return xs(this,arguments,function*(d,m={}){if(!d)throw new Error("lngLat is required");const[x,C]=typeof d=="string"?d.split(",").map(X=>parseFloat(X)):sa.convert(d).toArray();if(isNaN(x)||isNaN(C))throw new Error("lngLat is required");const k=_i(_i({},this.defaults),m),E=new URL(EC);E.search=sf({access_token:this.accessToken,language:k.language,limit:k.limit,longitude:x,latitude:C},k.types&&{types:typeof k.types=="string"?k.types:[...k.types].join(",")});const{fetch:l}=jc(),B=yield l(E.toString(),{signal:k.signal});yield Au(B);const V=yield B.json();return V.url=E.toString(),V})}},xw=vw;h0=new WeakSet;yv=function(o){return sf({q:o.q,access_token:this.accessToken,language:o.language,limit:o.limit,navigation_profile:o.navigation_profile,route:o.route,route_geometry:o.route_geometry,sar_type:o.sar_type,time_deviation:o.time_deviation,eta_type:o.eta_type,country:o.country,poi_category:o.poi_category,rich_metadata_provider:o.rich_metadata_provider,poi_category_exclusions:o.poi_category_exclusions},o.sessionToken&&{session_token:To.convert(o.sessionToken).id},o.proximity&&{proximity:typeof o.proximity=="string"?o.proximity:sa.convert(o.proximity).toArray().join(",")},o.origin&&{origin:typeof o.origin=="string"?o.origin:sa.convert(o.origin).toArray().join(",")},o.bbox&&{bbox:typeof o.bbox=="string"?o.bbox:Vs.convert(o.bbox).toFlatArray().join(",")},o.types&&{types:typeof o.types=="string"?o.types:[...o.types].join(",")})};xw.defaults={language:"en"};var CC="https://api.mapbox.com/autofill/v1",AC="retrieve",kC=`${CC}/${AC}`,_v,bw,ww=class{constructor(o={}){Us(this,_v);const d=o,{accessToken:m}=d,x=c_(d,["accessToken"]);this.accessToken=m,this.defaults=_i(_i({},ww.defaults),x)}validate(o,d){return xs(this,null,function*(){if(!o)throw new Error("searchText is required");const{sessionToken:m,signal:x}=d,C=Nh(_i(_i({},this.defaults),d),{sessionToken:m}),k=new URL(`${kC}/${encodeURIComponent(o)}`);k.search=Np(this,_v,bw).call(this,C);const{fetch:E}=jc(),l=yield E(k.toString(),{signal:x});yield Au(l);const B=yield l.json();return B.url=k.toString(),B.features.length>0&&(B.features=[B.features[0]]),B})}},Sw=ww;_v=new WeakSet;bw=function(o){return sf({access_token:this.accessToken,language:o.language,country:o.country},o.sessionToken&&{session_token:To.convert(o.sessionToken).id},o.proximity&&{proximity:typeof o.proximity=="string"?o.proximity:sa.convert(o.proximity).toArray().join(",")},o.bbox&&{bbox:typeof o.bbox=="string"?o.bbox:Vs.convert(o.bbox).toFlatArray().join(",")})};Sw.defaults={language:"en",proximity:"ip"};var Tw="https://api.mapbox.com/search/geocode/v6",PC=`${Tw}/forward`,jC=`${Tw}/reverse`,zC=/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/,IC=/[\s,]+/,Hm,d0,vv,RC=class{constructor(o={}){Us(this,d0),Us(this,Hm,void 0);const d=o,{accessToken:m}=d,x=c_(d,["accessToken"]);this.accessToken=m,this.defaults=_i({},x)}get responseHeaders(){return on(this,Hm)}forward(o,d){return xs(this,null,function*(){if(!o)throw new Error("searchText is required");let m;d&&({signal:m}=d);const x=Nh(_i(_i({},this.defaults),d),{q:o}),C=new URL(`${PC}`);C.search=Np(this,d0,vv).call(this,x);const{fetch:k}=jc(),E=m?{signal:m}:{},l=yield k(C.toString(),E);Cl(this,Hm,l.headers),yield Au(l);const B=yield l.json();return B.url=C.toString(),B})}reverse(o,d){return xs(this,null,function*(){if(!o)throw new Error("lngLat is required");let m;d&&({signal:m}=d);let x;if(typeof o=="string"){const[X,ne]=o.split(",");x=new sa(Number(X),Number(ne))}else x=sa.convert(o);const C=Nh(_i(_i({},this.defaults),d),{longitude:x.lng,latitude:x.lat}),k=new URL(`${jC}`);k.search=Np(this,d0,vv).call(this,C,!0);const{fetch:E}=jc(),l=m?{signal:m}:{},B=yield E(k.toString(),l);Cl(this,Hm,B.headers),yield Au(B);const V=yield B.json();return V.url=k.toString(),V})}suggest(o,d){return xs(this,null,function*(){if(zC.test(o)){const x=o.trim().split(IC).map(C=>C.trim()).join(",");return this.reverse(x,d)}else return this.forward(o,d)})}retrieve(o){return xs(this,null,function*(){return o})}};Hm=new WeakMap;d0=new WeakSet;vv=function(o,d=!1){return d&&["proximity","autocomplete","bbox"].forEach(m=>{m in o&&delete o[m]}),sf({q:o.q,longitude:o.longitude,latitude:o.latitude,access_token:this.accessToken,permanent:o.permanent,language:o.language,country:o.country,limit:o.limit,autocomplete:o.autocomplete,worldview:o.worldview},o.sessionToken&&{session_token:To.convert(o.sessionToken).id},o.proximity&&{proximity:typeof o.proximity=="string"?o.proximity:sa.convert(o.proximity).toArray().join(",")},o.bbox&&{bbox:typeof o.bbox=="string"?o.bbox:Vs.convert(o.bbox).toFlatArray().join(",")},o.types&&{types:typeof o.types=="string"?o.types:[...o.types].join(",")})};var Mw=(o=>(o.exact="exact",o.high="high",o.medium="medium",o.low="low",o))(Mw||{}),Wm,DC=class{constructor(){Us(this,Wm,{})}addEventListener(o,d){const m=on(this,Wm);m[o]||(m[o]=[]),m[o].push(d)}removeEventListener(o,d){const m=on(this,Wm);if(!m[o])return;const x=m[o],C=x.indexOf(d);C!==-1&&x.splice(C,1)}fire(o,d){const m=on(this,Wm);if(!m[o])return;const x=m[o];for(const C of x)C(d)}};Wm=new WeakMap;function Ew(o,d,m){let x=null;return(...C)=>{x!==null&&clearTimeout(x);const k=m&&m();x=setTimeout(()=>{x=null,!(k!=null&&k.aborted)&&o(...C)},d)}}function q_(){const{AbortController:o}=jc();return new o}var Xm,f0,p0,pp,Ph,m0,mx=class extends DC{constructor(o,d=0){super(),Us(this,Xm,new To),Us(this,f0,0),Us(this,p0,!1),Us(this,pp,void 0),Us(this,Ph,q_()),Us(this,m0,void 0),Cl(this,m0,Ew((m,...x)=>xs(this,[m,...x],function*(C,k={}){if(on(this,Ph).abort(),Cl(this,Ph,q_()),!C){Cl(this,pp,null),this.fire("suggest",on(this,pp));return}try{const E=yield this.search.suggest(C,Nh(_i({sessionToken:this.sessionToken},k),{signal:on(this,Ph).signal}));Cl(this,pp,E),this.fire("suggest",E)}catch(E){if(E.name==="AbortError")return;this.fire("suggesterror",E)}}),d,()=>on(this,Ph).signal)),Object.defineProperties(this,{search:{value:o,writable:!1},debounce:{value:d,writable:!1}})}get sessionToken(){return on(this,p0)?on(this,Xm).id:`${on(this,Xm).id}.${on(this,f0)}`}set sessionToken(o){Cl(this,p0,!0),Cl(this,Xm,new To(o))}get suggestions(){return on(this,pp)}suggest(o,d){return on(this,m0).call(this,o,d),new Promise((m,x)=>{let C,k;C=E=>{this.removeEventListener("suggest",C),this.removeEventListener("suggesterror",k),m(E)},k=E=>{this.removeEventListener("suggest",C),this.removeEventListener("suggesterror",k),x(E)},this.addEventListener("suggest",C),this.addEventListener("suggesterror",k)})}clear(){this.suggest("")}retrieve(o,d){return xs(this,null,function*(){const m=yield this.search.retrieve(o,_i({sessionToken:this.sessionToken},d));return this.fire("retrieve",m),m})}canRetrieve(o){return this.search.canRetrieve?this.search.canRetrieve(o):!0}canSuggest(o){return this.search.canSuggest?this.search.canSuggest(o):!0}abort(){on(this,Ph).abort(),Cl(this,Ph,q_())}incrementSession(){uC(this,f0)._++}};Xm=new WeakMap;f0=new WeakMap;p0=new WeakMap;pp=new WeakMap;Ph=new WeakMap;m0=new WeakMap;function gx(o){const{properties:d}=o;return _i({},d)}function h_(o){return o.split("-")[0]}function yx(o){return o.split("-")[1]}function _x(o){return["top","bottom"].includes(h_(o))?"x":"y"}function Cw(o){return o==="y"?"height":"width"}function Xb(o,d,m){let{reference:x,floating:C}=o;const k=x.x+x.width/2-C.width/2,E=x.y+x.height/2-C.height/2,l=_x(d),B=Cw(l),V=x[B]/2-C[B]/2,X=l==="x";let ne;switch(h_(d)){case"top":ne={x:k,y:x.y-C.height};break;case"bottom":ne={x:k,y:x.y+x.height};break;case"right":ne={x:x.x+x.width,y:E};break;case"left":ne={x:x.x-C.width,y:E};break;default:ne={x:x.x,y:x.y}}switch(yx(d)){case"start":ne[l]-=V*(m&&X?-1:1);break;case"end":ne[l]+=V*(m&&X?-1:1)}return ne}const NC=async(o,d,m)=>{const{placement:x="bottom",strategy:C="absolute",middleware:k=[],platform:E}=m,l=await(E.isRTL==null?void 0:E.isRTL(d));let B=await E.getElementRects({reference:o,floating:d,strategy:C}),{x:V,y:X}=Xb(B,x,l),ne=x,re={},ee=0;for(let te=0;te<k.length;te++){const{name:be,fn:Ee}=k[te],{x:Ae,y:Ie,data:tt,reset:vt}=await Ee({x:V,y:X,initialPlacement:x,placement:ne,strategy:C,middlewareData:re,rects:B,platform:E,elements:{reference:o,floating:d}});V=Ae??V,X=Ie??X,re={...re,[be]:{...re[be],...tt}},vt&&ee<=50&&(ee++,typeof vt=="object"&&(vt.placement&&(ne=vt.placement),vt.rects&&(B=vt.rects===!0?await E.getElementRects({reference:o,floating:d,strategy:C}):vt.rects),{x:V,y:X}=Xb(B,ne,l)),te=-1)}return{x:V,y:X,placement:ne,strategy:C,middlewareData:re}};function LC(o){return typeof o!="number"?function(d){return{top:0,right:0,bottom:0,left:0,...d}}(o):{top:o,right:o,bottom:o,left:o}}function Xy(o){return{...o,top:o.y,left:o.x,right:o.x+o.width,bottom:o.y+o.height}}async function OC(o,d){var m;d===void 0&&(d={});const{x,y:C,platform:k,rects:E,elements:l,strategy:B}=o,{boundary:V="clippingAncestors",rootBoundary:X="viewport",elementContext:ne="floating",altBoundary:re=!1,padding:ee=0}=d,te=LC(ee),be=l[re?ne==="floating"?"reference":"floating":ne],Ee=Xy(await k.getClippingRect({element:(m=await(k.isElement==null?void 0:k.isElement(be)))==null||m?be:be.contextElement||await(k.getDocumentElement==null?void 0:k.getDocumentElement(l.floating)),boundary:V,rootBoundary:X,strategy:B})),Ae=Xy(k.convertOffsetParentRelativeRectToViewportRelativeRect?await k.convertOffsetParentRelativeRectToViewportRelativeRect({rect:ne==="floating"?{...E.floating,x,y:C}:E.reference,offsetParent:await(k.getOffsetParent==null?void 0:k.getOffsetParent(l.floating)),strategy:B}):E[ne]);return{top:Ee.top-Ae.top+te.top,bottom:Ae.bottom-Ee.bottom+te.bottom,left:Ee.left-Ae.left+te.left,right:Ae.right-Ee.right+te.right}}const BC={left:"right",right:"left",bottom:"top",top:"bottom"};function Yy(o){return o.replace(/left|right|bottom|top/g,d=>BC[d])}function FC(o,d,m){m===void 0&&(m=!1);const x=yx(o),C=_x(o),k=Cw(C);let E=C==="x"?x===(m?"end":"start")?"right":"left":x==="start"?"bottom":"top";return d.reference[k]>d.floating[k]&&(E=Yy(E)),{main:E,cross:Yy(E)}}const UC={start:"end",end:"start"};function Yb(o){return o.replace(/start|end/g,d=>UC[d])}const VC=["top","right","bottom","left"];VC.reduce((o,d)=>o.concat(d,d+"-start",d+"-end"),[]);const qC=function(o){return o===void 0&&(o={}),{name:"flip",options:o,async fn(d){var m;const{placement:x,middlewareData:C,rects:k,initialPlacement:E,platform:l,elements:B}=d,{mainAxis:V=!0,crossAxis:X=!0,fallbackPlacements:ne,fallbackStrategy:re="bestFit",flipAlignment:ee=!0,...te}=o,be=h_(x),Ee=ne||(be===E||!ee?[Yy(E)]:function(ot){const at=Yy(ot);return[Yb(ot),at,Yb(at)]}(E)),Ae=[E,...Ee],Ie=await OC(d,te),tt=[];let vt=((m=C.flip)==null?void 0:m.overflows)||[];if(V&&tt.push(Ie[be]),X){const{main:ot,cross:at}=FC(x,k,await(l.isRTL==null?void 0:l.isRTL(B.floating)));tt.push(Ie[ot],Ie[at])}if(vt=[...vt,{placement:x,overflows:tt}],!tt.every(ot=>ot<=0)){var nt,Ye;const ot=((nt=(Ye=C.flip)==null?void 0:Ye.index)!=null?nt:0)+1,at=Ae[ot];if(at)return{data:{index:ot,overflows:vt},reset:{placement:at}};let xt="bottom";switch(re){case"bestFit":{var st;const zt=(st=vt.map(Ht=>[Ht,Ht.overflows.filter(Yt=>Yt>0).reduce((Yt,er)=>Yt+er,0)]).sort((Ht,Yt)=>Ht[1]-Yt[1])[0])==null?void 0:st[0].placement;zt&&(xt=zt);break}case"initialPlacement":xt=E}if(x!==xt)return{reset:{placement:xt}}}return{}}}},ZC=function(o){return o===void 0&&(o=0),{name:"offset",options:o,async fn(d){const{x:m,y:x}=d,C=await async function(k,E){const{placement:l,platform:B,elements:V}=k,X=await(B.isRTL==null?void 0:B.isRTL(V.floating)),ne=h_(l),re=yx(l),ee=_x(l)==="x",te=["left","top"].includes(ne)?-1:1,be=X&&ee?-1:1,Ee=typeof E=="function"?E(k):E;let{mainAxis:Ae,crossAxis:Ie,alignmentAxis:tt}=typeof Ee=="number"?{mainAxis:Ee,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...Ee};return re&&typeof tt=="number"&&(Ie=re==="end"?-1*tt:tt),ee?{x:Ie*be,y:Ae*te}:{x:Ae*te,y:Ie*be}}(d,o);return{x:m+C.x,y:x+C.y,data:C}}}};function Aw(o){return o&&o.document&&o.location&&o.alert&&o.setInterval}function Ru(o){if(o==null)return window;if(!Aw(o)){const d=o.ownerDocument;return d&&d.defaultView||window}return o}function Mg(o){return Ru(o).getComputedStyle(o)}function Pu(o){return Aw(o)?"":o?(o.nodeName||"").toLowerCase():""}function kw(){const o=navigator.userAgentData;return o!=null&&o.brands?o.brands.map(d=>d.brand+"/"+d.version).join(" "):navigator.userAgent}function Ic(o){return o instanceof Ru(o).HTMLElement}function Fh(o){return o instanceof Ru(o).Element}function vx(o){return typeof ShadowRoot>"u"?!1:o instanceof Ru(o).ShadowRoot||o instanceof ShadowRoot}function d_(o){const{overflow:d,overflowX:m,overflowY:x}=Mg(o);return/auto|scroll|overlay|hidden/.test(d+x+m)}function $C(o){return["table","td","th"].includes(Pu(o))}function Kb(o){const d=/firefox/i.test(kw()),m=Mg(o);return m.transform!=="none"||m.perspective!=="none"||m.contain==="paint"||["transform","perspective"].includes(m.willChange)||d&&m.willChange==="filter"||d&&!!m.filter&&m.filter!=="none"}function Pw(){return!/^((?!chrome|android).)*safari/i.test(kw())}const Qb=Math.min,yg=Math.max,Ky=Math.round;function ju(o,d,m){var x,C,k,E;d===void 0&&(d=!1),m===void 0&&(m=!1);const l=o.getBoundingClientRect();let B=1,V=1;d&&Ic(o)&&(B=o.offsetWidth>0&&Ky(l.width)/o.offsetWidth||1,V=o.offsetHeight>0&&Ky(l.height)/o.offsetHeight||1);const X=Fh(o)?Ru(o):window,ne=!Pw()&&m,re=(l.left+(ne&&(x=(C=X.visualViewport)==null?void 0:C.offsetLeft)!=null?x:0))/B,ee=(l.top+(ne&&(k=(E=X.visualViewport)==null?void 0:E.offsetTop)!=null?k:0))/V,te=l.width/B,be=l.height/V;return{width:te,height:be,top:ee,right:re+te,bottom:ee+be,left:re,x:re,y:ee}}function Lh(o){return(d=o,(d instanceof Ru(d).Node?o.ownerDocument:o.document)||window.document).documentElement;var d}function f_(o){return Fh(o)?{scrollLeft:o.scrollLeft,scrollTop:o.scrollTop}:{scrollLeft:o.pageXOffset,scrollTop:o.pageYOffset}}function jw(o){return ju(Lh(o)).left+f_(o).scrollLeft}function GC(o,d,m){const x=Ic(d),C=Lh(d),k=ju(o,x&&function(B){const V=ju(B);return Ky(V.width)!==B.offsetWidth||Ky(V.height)!==B.offsetHeight}(d),m==="fixed");let E={scrollLeft:0,scrollTop:0};const l={x:0,y:0};if(x||!x&&m!=="fixed")if((Pu(d)!=="body"||d_(C))&&(E=f_(d)),Ic(d)){const B=ju(d,!0);l.x=B.x+d.clientLeft,l.y=B.y+d.clientTop}else C&&(l.x=jw(C));return{x:k.left+E.scrollLeft-l.x,y:k.top+E.scrollTop-l.y,width:k.width,height:k.height}}function zw(o){return Pu(o)==="html"?o:o.assignedSlot||o.parentNode||(vx(o)?o.host:null)||Lh(o)}function Jb(o){return Ic(o)&&getComputedStyle(o).position!=="fixed"?o.offsetParent:null}function xv(o){const d=Ru(o);let m=Jb(o);for(;m&&$C(m)&&getComputedStyle(m).position==="static";)m=Jb(m);return m&&(Pu(m)==="html"||Pu(m)==="body"&&getComputedStyle(m).position==="static"&&!Kb(m))?d:m||function(x){let C=zw(x);for(vx(C)&&(C=C.host);Ic(C)&&!["html","body"].includes(Pu(C));){if(Kb(C))return C;C=C.parentNode}return null}(o)||d}function e1(o){if(Ic(o))return{width:o.offsetWidth,height:o.offsetHeight};const d=ju(o);return{width:d.width,height:d.height}}function Iw(o){const d=zw(o);return["html","body","#document"].includes(Pu(d))?o.ownerDocument.body:Ic(d)&&d_(d)?d:Iw(d)}function Qy(o,d){var m;d===void 0&&(d=[]);const x=Iw(o),C=x===((m=o.ownerDocument)==null?void 0:m.body),k=Ru(x),E=C?[k].concat(k.visualViewport||[],d_(x)?x:[]):x,l=d.concat(E);return C?l:l.concat(Qy(E))}function t1(o,d,m){return d==="viewport"?Xy(function(x,C){const k=Ru(x),E=Lh(x),l=k.visualViewport;let B=E.clientWidth,V=E.clientHeight,X=0,ne=0;if(l){B=l.width,V=l.height;const re=Pw();(re||!re&&C==="fixed")&&(X=l.offsetLeft,ne=l.offsetTop)}return{width:B,height:V,x:X,y:ne}}(o,m)):Fh(d)?function(x,C){const k=ju(x,!1,C==="fixed"),E=k.top+x.clientTop,l=k.left+x.clientLeft;return{top:E,left:l,x:l,y:E,right:l+x.clientWidth,bottom:E+x.clientHeight,width:x.clientWidth,height:x.clientHeight}}(d,m):Xy(function(x){var C;const k=Lh(x),E=f_(x),l=(C=x.ownerDocument)==null?void 0:C.body,B=yg(k.scrollWidth,k.clientWidth,l?l.scrollWidth:0,l?l.clientWidth:0),V=yg(k.scrollHeight,k.clientHeight,l?l.scrollHeight:0,l?l.clientHeight:0);let X=-E.scrollLeft+jw(x);const ne=-E.scrollTop;return Mg(l||k).direction==="rtl"&&(X+=yg(k.clientWidth,l?l.clientWidth:0)-B),{width:B,height:V,x:X,y:ne}}(Lh(o)))}function HC(o){const d=Qy(o),m=["absolute","fixed"].includes(Mg(o).position)&&Ic(o)?xv(o):o;return Fh(m)?d.filter(x=>Fh(x)&&function(C,k){const E=k.getRootNode==null?void 0:k.getRootNode();if(C.contains(k))return!0;if(E&&vx(E)){let l=k;do{if(l&&C===l)return!0;l=l.parentNode||l.host}while(l)}return!1}(x,m)&&Pu(x)!=="body"):[]}const WC={getClippingRect:function(o){let{element:d,boundary:m,rootBoundary:x,strategy:C}=o;const k=[...m==="clippingAncestors"?HC(d):[].concat(m),x],E=k[0],l=k.reduce((B,V)=>{const X=t1(d,V,C);return B.top=yg(X.top,B.top),B.right=Qb(X.right,B.right),B.bottom=Qb(X.bottom,B.bottom),B.left=yg(X.left,B.left),B},t1(d,E,C));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(o){let{rect:d,offsetParent:m,strategy:x}=o;const C=Ic(m),k=Lh(m);if(m===k)return d;let E={scrollLeft:0,scrollTop:0};const l={x:0,y:0};if((C||!C&&x!=="fixed")&&((Pu(m)!=="body"||d_(k))&&(E=f_(m)),Ic(m))){const B=ju(m,!0);l.x=B.x+m.clientLeft,l.y=B.y+m.clientTop}return{...d,x:d.x-E.scrollLeft+l.x,y:d.y-E.scrollTop+l.y}},isElement:Fh,getDimensions:e1,getOffsetParent:xv,getDocumentElement:Lh,getElementRects:o=>{let{reference:d,floating:m,strategy:x}=o;return{reference:GC(d,xv(m),x),floating:{...e1(m),x:0,y:0}}},getClientRects:o=>Array.from(o.getClientRects()),isRTL:o=>Mg(o).direction==="rtl"};function XC(o,d,m,x){x===void 0&&(x={});const{ancestorScroll:C=!0,ancestorResize:k=!0,elementResize:E=!0,animationFrame:l=!1}=x,B=C&&!l,V=k&&!l,X=B||V?[...Fh(o)?Qy(o):[],...Qy(d)]:[];X.forEach(te=>{B&&te.addEventListener("scroll",m,{passive:!0}),V&&te.addEventListener("resize",m)});let ne,re=null;if(E){let te=!0;re=new ResizeObserver(()=>{te||m(),te=!1}),Fh(o)&&!l&&re.observe(o),re.observe(d)}let ee=l?ju(o):null;return l&&function te(){const be=ju(o);!ee||be.x===ee.x&&be.y===ee.y&&be.width===ee.width&&be.height===ee.height||m(),ee=be,ne=requestAnimationFrame(te)}(),m(),()=>{var te;X.forEach(be=>{B&&be.removeEventListener("scroll",m),V&&be.removeEventListener("resize",m)}),(te=re)==null||te.disconnect(),re=null,l&&cancelAnimationFrame(ne)}}const YC=(o,d,m)=>NC(o,d,{platform:WC,...m});var Z_={exports:{}},r1;function KC(){return r1||(r1=1,function(o){(function(d){var m=!1,x,C;function k(){if(typeof x<"u")return x;var ne=document.documentElement,re=document.createElement("div");return re.setAttribute("style","width:99px;height:99px;position:absolute;top:-9999px;overflow:scroll;"),ne.appendChild(re),x=re.offsetWidth-re.clientWidth,ne.removeChild(re),x}function E(){return document.documentElement.scrollHeight>window.innerHeight}function l(ne){if(!(typeof document>"u"||m)){var re=document.documentElement;C=window.pageYOffset,E()?re.style.width="calc(100% - "+k()+"px)":re.style.width="100%",re.style.position="fixed",re.style.top=-C+"px",re.style.overflow="hidden",m=!0}}function B(){if(!(typeof document>"u"||!m)){var ne=document.documentElement;ne.style.width="",ne.style.position="",ne.style.top="",ne.style.overflow="",window.scroll(0,C),m=!1}}function V(){if(m){B();return}l()}var X={on:l,off:B,toggle:V};o.exports=X})()}(Z_)),Z_.exports}var QC=KC();const i1=lf(QC);/*!
* tabbable 5.3.3
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var Rw=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],Jy=Rw.join(","),Dw=typeof Element>"u",of=Dw?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,bv=!Dw&&Element.prototype.getRootNode?function(o){return o.getRootNode()}:function(o){return o.ownerDocument},Nw=function(d,m,x){var C=Array.prototype.slice.apply(d.querySelectorAll(Jy));return m&&of.call(d,Jy)&&C.unshift(d),C=C.filter(x),C},Lw=function o(d,m,x){for(var C=[],k=Array.from(d);k.length;){var E=k.shift();if(E.tagName==="SLOT"){var l=E.assignedElements(),B=l.length?l:E.children,V=o(B,!0,x);x.flatten?C.push.apply(C,V):C.push({scope:E,candidates:V})}else{var X=of.call(E,Jy);X&&x.filter(E)&&(m||!d.includes(E))&&C.push(E);var ne=E.shadowRoot||typeof x.getShadowRoot=="function"&&x.getShadowRoot(E),re=!x.shadowRootFilter||x.shadowRootFilter(E);if(ne&&re){var ee=o(ne===!0?E.children:ne.children,!0,x);x.flatten?C.push.apply(C,ee):C.push({scope:E,candidates:ee})}else k.unshift.apply(k,E.children)}}return C},Ow=function(d,m){return d.tabIndex<0&&(m||/^(AUDIO|VIDEO|DETAILS)$/.test(d.tagName)||d.isContentEditable)&&isNaN(parseInt(d.getAttribute("tabindex"),10))?0:d.tabIndex},JC=function(d,m){return d.tabIndex===m.tabIndex?d.documentOrder-m.documentOrder:d.tabIndex-m.tabIndex},Bw=function(d){return d.tagName==="INPUT"},e3=function(d){return Bw(d)&&d.type==="hidden"},t3=function(d){var m=d.tagName==="DETAILS"&&Array.prototype.slice.apply(d.children).some(function(x){return x.tagName==="SUMMARY"});return m},r3=function(d,m){for(var x=0;x<d.length;x++)if(d[x].checked&&d[x].form===m)return d[x]},i3=function(d){if(!d.name)return!0;var m=d.form||bv(d),x=function(l){return m.querySelectorAll('input[type="radio"][name="'+l+'"]')},C;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")C=x(window.CSS.escape(d.name));else try{C=x(d.name)}catch(E){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",E.message),!1}var k=r3(C,d.form);return!k||k===d},a3=function(d){return Bw(d)&&d.type==="radio"},n3=function(d){return a3(d)&&!i3(d)},a1=function(d){var m=d.getBoundingClientRect(),x=m.width,C=m.height;return x===0&&C===0},s3=function(d,m){var x=m.displayCheck,C=m.getShadowRoot;if(getComputedStyle(d).visibility==="hidden")return!0;var k=of.call(d,"details>summary:first-of-type"),E=k?d.parentElement:d;if(of.call(E,"details:not([open]) *"))return!0;var l=bv(d).host,B=(l==null?void 0:l.ownerDocument.contains(l))||d.ownerDocument.contains(d);if(!x||x==="full"){if(typeof C=="function"){for(var V=d;d;){var X=d.parentElement,ne=bv(d);if(X&&!X.shadowRoot&&C(X)===!0)return a1(d);d.assignedSlot?d=d.assignedSlot:!X&&ne!==d.ownerDocument?d=ne.host:d=X}d=V}if(B)return!d.getClientRects().length}else if(x==="non-zero-area")return a1(d);return!1},o3=function(d){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(d.tagName))for(var m=d.parentElement;m;){if(m.tagName==="FIELDSET"&&m.disabled){for(var x=0;x<m.children.length;x++){var C=m.children.item(x);if(C.tagName==="LEGEND")return of.call(m,"fieldset[disabled] *")?!0:!C.contains(d)}return!0}m=m.parentElement}return!1},e_=function(d,m){return!(m.disabled||e3(m)||s3(m,d)||t3(m)||o3(m))},wv=function(d,m){return!(n3(m)||Ow(m)<0||!e_(d,m))},l3=function(d){var m=parseInt(d.getAttribute("tabindex"),10);return!!(isNaN(m)||m>=0)},c3=function o(d){var m=[],x=[];return d.forEach(function(C,k){var E=!!C.scope,l=E?C.scope:C,B=Ow(l,E),V=E?o(C.candidates):l;B===0?E?m.push.apply(m,V):m.push(l):x.push({documentOrder:k,tabIndex:B,item:C,isScope:E,content:V})}),x.sort(JC).reduce(function(C,k){return k.isScope?C.push.apply(C,k.content):C.push(k.content),C},[]).concat(m)},u3=function(d,m){m=m||{};var x;return m.getShadowRoot?x=Lw([d],m.includeContainer,{filter:wv.bind(null,m),flatten:!1,getShadowRoot:m.getShadowRoot,shadowRootFilter:l3}):x=Nw(d,m.includeContainer,wv.bind(null,m)),c3(x)},h3=function(d,m){m=m||{};var x;return m.getShadowRoot?x=Lw([d],m.includeContainer,{filter:e_.bind(null,m),flatten:!0,getShadowRoot:m.getShadowRoot}):x=Nw(d,m.includeContainer,e_.bind(null,m)),x},s0=function(d,m){if(m=m||{},!d)throw new Error("No node provided");return of.call(d,Jy)===!1?!1:wv(m,d)},d3=Rw.concat("iframe").join(","),$_=function(d,m){if(m=m||{},!d)throw new Error("No node provided");return of.call(d,d3)===!1?!1:e_(m,d)};/*!
* focus-trap 6.9.4
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function n1(o,d){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(o);d&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(o,C).enumerable})),m.push.apply(m,x)}return m}function s1(o){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?n1(Object(m),!0).forEach(function(x){f3(o,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):n1(Object(m)).forEach(function(x){Object.defineProperty(o,x,Object.getOwnPropertyDescriptor(m,x))})}return o}function f3(o,d,m){return d in o?Object.defineProperty(o,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[d]=m,o}var o1=function(){var o=[];return{activateTrap:function(m){if(o.length>0){var x=o[o.length-1];x!==m&&x.pause()}var C=o.indexOf(m);C===-1||o.splice(C,1),o.push(m)},deactivateTrap:function(m){var x=o.indexOf(m);x!==-1&&o.splice(x,1),o.length>0&&o[o.length-1].unpause()}}}(),p3=function(d){return d.tagName&&d.tagName.toLowerCase()==="input"&&typeof d.select=="function"},m3=function(d){return d.key==="Escape"||d.key==="Esc"||d.keyCode===27},g3=function(d){return d.key==="Tab"||d.keyCode===9},l1=function(d){return setTimeout(d,0)},c1=function(d,m){var x=-1;return d.every(function(C,k){return m(C)?(x=k,!1):!0}),x},Zm=function(d){for(var m=arguments.length,x=new Array(m>1?m-1:0),C=1;C<m;C++)x[C-1]=arguments[C];return typeof d=="function"?d.apply(void 0,x):d},o0=function(d){return d.target.shadowRoot&&typeof d.composedPath=="function"?d.composedPath()[0]:d.target},y3=function(d,m){var x=(m==null?void 0:m.document)||document,C=s1({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},m),k={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0},E,l=function(Ye,st,ot){return Ye&&Ye[st]!==void 0?Ye[st]:C[ot||st]},B=function(Ye){return k.containerGroups.findIndex(function(st){var ot=st.container,at=st.tabbableNodes;return ot.contains(Ye)||at.find(function(xt){return xt===Ye})})},V=function(Ye){var st=C[Ye];if(typeof st=="function"){for(var ot=arguments.length,at=new Array(ot>1?ot-1:0),xt=1;xt<ot;xt++)at[xt-1]=arguments[xt];st=st.apply(void 0,at)}if(st===!0&&(st=void 0),!st){if(st===void 0||st===!1)return st;throw new Error("`".concat(Ye,"` was specified but was not a node, or did not return a node"))}var zt=st;if(typeof st=="string"&&(zt=x.querySelector(st),!zt))throw new Error("`".concat(Ye,"` as selector refers to no known node"));return zt},X=function(){var Ye=V("initialFocus");if(Ye===!1)return!1;if(Ye===void 0)if(B(x.activeElement)>=0)Ye=x.activeElement;else{var st=k.tabbableGroups[0],ot=st&&st.firstTabbableNode;Ye=ot||V("fallbackFocus")}if(!Ye)throw new Error("Your focus-trap needs to have at least one focusable element");return Ye},ne=function(){if(k.containerGroups=k.containers.map(function(Ye){var st=u3(Ye,C.tabbableOptions),ot=h3(Ye,C.tabbableOptions);return{container:Ye,tabbableNodes:st,focusableNodes:ot,firstTabbableNode:st.length>0?st[0]:null,lastTabbableNode:st.length>0?st[st.length-1]:null,nextTabbableNode:function(xt){var zt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,Ht=ot.findIndex(function(Yt){return Yt===xt});if(!(Ht<0))return zt?ot.slice(Ht+1).find(function(Yt){return s0(Yt,C.tabbableOptions)}):ot.slice(0,Ht).reverse().find(function(Yt){return s0(Yt,C.tabbableOptions)})}}}),k.tabbableGroups=k.containerGroups.filter(function(Ye){return Ye.tabbableNodes.length>0}),k.tabbableGroups.length<=0&&!V("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times")},re=function nt(Ye){if(Ye!==!1&&Ye!==x.activeElement){if(!Ye||!Ye.focus){nt(X());return}Ye.focus({preventScroll:!!C.preventScroll}),k.mostRecentlyFocusedNode=Ye,p3(Ye)&&Ye.select()}},ee=function(Ye){var st=V("setReturnFocus",Ye);return st||(st===!1?!1:Ye)},te=function(Ye){var st=o0(Ye);if(!(B(st)>=0)){if(Zm(C.clickOutsideDeactivates,Ye)){E.deactivate({returnFocus:C.returnFocusOnDeactivate&&!$_(st,C.tabbableOptions)});return}Zm(C.allowOutsideClick,Ye)||Ye.preventDefault()}},be=function(Ye){var st=o0(Ye),ot=B(st)>=0;ot||st instanceof Document?ot&&(k.mostRecentlyFocusedNode=st):(Ye.stopImmediatePropagation(),re(k.mostRecentlyFocusedNode||X()))},Ee=function(Ye){var st=o0(Ye);ne();var ot=null;if(k.tabbableGroups.length>0){var at=B(st),xt=at>=0?k.containerGroups[at]:void 0;if(at<0)Ye.shiftKey?ot=k.tabbableGroups[k.tabbableGroups.length-1].lastTabbableNode:ot=k.tabbableGroups[0].firstTabbableNode;else if(Ye.shiftKey){var zt=c1(k.tabbableGroups,function(yt){var Je=yt.firstTabbableNode;return st===Je});if(zt<0&&(xt.container===st||$_(st,C.tabbableOptions)&&!s0(st,C.tabbableOptions)&&!xt.nextTabbableNode(st,!1))&&(zt=at),zt>=0){var Ht=zt===0?k.tabbableGroups.length-1:zt-1,Yt=k.tabbableGroups[Ht];ot=Yt.lastTabbableNode}}else{var er=c1(k.tabbableGroups,function(yt){var Je=yt.lastTabbableNode;return st===Je});if(er<0&&(xt.container===st||$_(st,C.tabbableOptions)&&!s0(st,C.tabbableOptions)&&!xt.nextTabbableNode(st))&&(er=at),er>=0){var Rr=er===k.tabbableGroups.length-1?0:er+1,Mt=k.tabbableGroups[Rr];ot=Mt.firstTabbableNode}}}else ot=V("fallbackFocus");ot&&(Ye.preventDefault(),re(ot))},Ae=function(Ye){if(m3(Ye)&&Zm(C.escapeDeactivates,Ye)!==!1){Ye.preventDefault(),E.deactivate();return}if(g3(Ye)){Ee(Ye);return}},Ie=function(Ye){var st=o0(Ye);B(st)>=0||Zm(C.clickOutsideDeactivates,Ye)||Zm(C.allowOutsideClick,Ye)||(Ye.preventDefault(),Ye.stopImmediatePropagation())},tt=function(){if(k.active)return o1.activateTrap(E),k.delayInitialFocusTimer=C.delayInitialFocus?l1(function(){re(X())}):re(X()),x.addEventListener("focusin",be,!0),x.addEventListener("mousedown",te,{capture:!0,passive:!1}),x.addEventListener("touchstart",te,{capture:!0,passive:!1}),x.addEventListener("click",Ie,{capture:!0,passive:!1}),x.addEventListener("keydown",Ae,{capture:!0,passive:!1}),E},vt=function(){if(k.active)return x.removeEventListener("focusin",be,!0),x.removeEventListener("mousedown",te,!0),x.removeEventListener("touchstart",te,!0),x.removeEventListener("click",Ie,!0),x.removeEventListener("keydown",Ae,!0),E};return E={get active(){return k.active},get paused(){return k.paused},activate:function(Ye){if(k.active)return this;var st=l(Ye,"onActivate"),ot=l(Ye,"onPostActivate"),at=l(Ye,"checkCanFocusTrap");at||ne(),k.active=!0,k.paused=!1,k.nodeFocusedBeforeActivation=x.activeElement,st&&st();var xt=function(){at&&ne(),tt(),ot&&ot()};return at?(at(k.containers.concat()).then(xt,xt),this):(xt(),this)},deactivate:function(Ye){if(!k.active)return this;var st=s1({onDeactivate:C.onDeactivate,onPostDeactivate:C.onPostDeactivate,checkCanReturnFocus:C.checkCanReturnFocus},Ye);clearTimeout(k.delayInitialFocusTimer),k.delayInitialFocusTimer=void 0,vt(),k.active=!1,k.paused=!1,o1.deactivateTrap(E);var ot=l(st,"onDeactivate"),at=l(st,"onPostDeactivate"),xt=l(st,"checkCanReturnFocus"),zt=l(st,"returnFocus","returnFocusOnDeactivate");ot&&ot();var Ht=function(){l1(function(){zt&&re(ee(k.nodeFocusedBeforeActivation)),at&&at()})};return zt&&xt?(xt(ee(k.nodeFocusedBeforeActivation)).then(Ht,Ht),this):(Ht(),this)},pause:function(){return k.paused||!k.active?this:(k.paused=!0,vt(),this)},unpause:function(){return!k.paused||!k.active?this:(k.paused=!1,ne(),tt(),this)},updateContainerElements:function(Ye){var st=[].concat(Ye).filter(Boolean);return k.containers=st.map(function(ot){return typeof ot=="string"?x.querySelector(ot):ot}),k.active&&ne(),this}},E.updateContainerElements(d),E},g0={exports:{}},_3=g0.exports,u1;function v3(){return u1||(u1=1,function(o){(function(d,m,x){o.exports?o.exports=x():d[m]=x()})(_3,"subtag",function(){var d="",m=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function x(B){return B.match(m)||[]}function C(B){return x(B).filter(function(V,X){return V&&X})}function k(B){return B=x(B),{language:B[1]||d,extlang:B[2]||d,script:B[3]||d,region:B[4]||d}}function E(B,V,X){Object.defineProperty(B,V,{value:X,enumerable:!0})}function l(B,V,X){function ne(re){return x(re)[B]||d}E(ne,"pattern",V),E(k,X,ne)}return l(1,/^[a-zA-Z]{2,3}$/,"language"),l(2,/^[a-zA-Z]{3}$/,"extlang"),l(3,/^[a-zA-Z]{4}$/,"script"),l(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),E(k,"split",C),k})}(g0)),g0.exports}var x3=v3();const Fw=lf(x3);var G_={exports:{}},h1;function b3(){return h1||(h1=1,function(o,d){var m=function(){var x={},C=Math.PI/180,k=180/Math.PI,E=6378137,l=20037508342789244e-9;function B(X){return Number(X)===X&&X%1!==0}function V(X){if(X=X||{},this.size=X.size||256,this.expansion=X.antimeridian===!0?2:1,!x[this.size]){var ne=this.size,re=x[this.size]={};re.Bc=[],re.Cc=[],re.zc=[],re.Ac=[];for(var ee=0;ee<30;ee++)re.Bc.push(ne/360),re.Cc.push(ne/(2*Math.PI)),re.zc.push(ne/2),re.Ac.push(ne),ne*=2}this.Bc=x[this.size].Bc,this.Cc=x[this.size].Cc,this.zc=x[this.size].zc,this.Ac=x[this.size].Ac}return V.prototype.px=function(X,ne){if(B(ne)){var re=this.size*Math.pow(2,ne),ee=re/2,te=re/360,be=re/(2*Math.PI),Ee=re,Ae=Math.min(Math.max(Math.sin(C*X[1]),-.9999),.9999),Ie=ee+X[0]*te,tt=ee+.5*Math.log((1+Ae)/(1-Ae))*-be;return Ie>Ee*this.expansion&&(Ie=Ee*this.expansion),tt>Ee&&(tt=Ee),[Ie,tt]}else{var ee=this.zc[ne],Ae=Math.min(Math.max(Math.sin(C*X[1]),-.9999),.9999),Ie=Math.round(ee+X[0]*this.Bc[ne]),tt=Math.round(ee+.5*Math.log((1+Ae)/(1-Ae))*-this.Cc[ne]);return Ie>this.Ac[ne]*this.expansion&&(Ie=this.Ac[ne]*this.expansion),tt>this.Ac[ne]&&(tt=this.Ac[ne]),[Ie,tt]}},V.prototype.ll=function(X,ne){if(B(ne)){var re=this.size*Math.pow(2,ne),ee=re/360,te=re/(2*Math.PI),be=re/2,Ee=(X[1]-be)/-te,Ae=(X[0]-be)/ee,Ie=k*(2*Math.atan(Math.exp(Ee))-.5*Math.PI);return[Ae,Ie]}else{var Ee=(X[1]-this.zc[ne])/-this.Cc[ne],Ae=(X[0]-this.zc[ne])/this.Bc[ne],Ie=k*(2*Math.atan(Math.exp(Ee))-.5*Math.PI);return[Ae,Ie]}},V.prototype.bbox=function(X,ne,re,ee,te){ee&&(ne=Math.pow(2,re)-1-ne);var be=[X*this.size,(+ne+1)*this.size],Ee=[(+X+1)*this.size,ne*this.size],Ae=this.ll(be,re).concat(this.ll(Ee,re));return te==="900913"?this.convert(Ae,"900913"):Ae},V.prototype.xyz=function(X,ne,re,ee){ee==="900913"&&(X=this.convert(X,"WGS84"));var te=[X[0],X[1]],be=[X[2],X[3]],Ee=this.px(te,ne),Ae=this.px(be,ne),Ie=[Math.floor(Ee[0]/this.size),Math.floor((Ae[0]-1)/this.size)],tt=[Math.floor(Ae[1]/this.size),Math.floor((Ee[1]-1)/this.size)],vt={minX:Math.min.apply(Math,Ie)<0?0:Math.min.apply(Math,Ie),minY:Math.min.apply(Math,tt)<0?0:Math.min.apply(Math,tt),maxX:Math.max.apply(Math,Ie),maxY:Math.max.apply(Math,tt)};if(re){var nt={minY:Math.pow(2,ne)-1-vt.maxY,maxY:Math.pow(2,ne)-1-vt.minY};vt.minY=nt.minY,vt.maxY=nt.maxY}return vt},V.prototype.convert=function(X,ne){return ne==="900913"?this.forward(X.slice(0,2)).concat(this.forward(X.slice(2,4))):this.inverse(X.slice(0,2)).concat(this.inverse(X.slice(2,4)))},V.prototype.forward=function(X){var ne=[E*X[0]*C,E*Math.log(Math.tan(Math.PI*.25+.5*X[1]*C))];return ne[0]>l&&(ne[0]=l),ne[0]<-20037508342789244e-9&&(ne[0]=-20037508342789244e-9),ne[1]>l&&(ne[1]=l),ne[1]<-20037508342789244e-9&&(ne[1]=-20037508342789244e-9),ne},V.prototype.inverse=function(X){return[X[0]*k/E,(Math.PI*.5-2*Math.atan(Math.exp(-X[1]/E)))*k]},V}();o.exports=m}(G_)),G_.exports}var w3=b3();const S3=lf(w3);var T3=Object.defineProperty,M3=Object.defineProperties,E3=Object.getOwnPropertyDescriptors,d1=Object.getOwnPropertySymbols,C3=Object.prototype.hasOwnProperty,A3=Object.prototype.propertyIsEnumerable,f1=(o,d,m)=>d in o?T3(o,d,{enumerable:!0,configurable:!0,writable:!0,value:m}):o[d]=m,Ir=(o,d)=>{for(var m in d||(d={}))C3.call(d,m)&&f1(o,m,d[m]);if(d1)for(var m of d1(d))A3.call(d,m)&&f1(o,m,d[m]);return o},Zs=(o,d)=>M3(o,E3(d)),xx=(o,d,m)=>{if(!d.has(o))throw TypeError("Cannot "+m)},O=(o,d,m)=>(xx(o,d,"read from private field"),m?m.call(o):d.get(o)),Be=(o,d,m)=>{if(d.has(o))throw TypeError("Cannot add the same private member more than once");d instanceof WeakSet?d.add(o):d.set(o,m)},At=(o,d,m,x)=>(xx(o,d,"write to private field"),d.set(o,m),m),_g=(o,d,m)=>(xx(o,d,"access private method"),m),Lp=(o,d,m)=>new Promise((x,C)=>{var k=B=>{try{l(m.next(B))}catch(V){C(V)}},E=B=>{try{l(m.throw(B))}catch(V){C(V)}},l=B=>B.done?x(B.value):Promise.resolve(B.value).then(k,E);l((m=m.apply(o,d)).next())}),p1=document.implementation.createHTMLDocument();function cf(o,d){const m={};for(const[x,C]of Object.entries(d))m[x]=o.querySelector(C);return m}function k3(o){return Array.from(o.childNodes||[]).filter(d=>d.nodeType===Node.ELEMENT_NODE)}function $s(o){const d=document.createElement("template");return d.innerHTML=o,d.content.firstElementChild}function P3(o){const d=p1.createElement("style");return d.textContent=o,p1.head.appendChild(d),d.sheet}function j3(o){return window.getComputedStyle(o).display!=="none"}function wc(o,d){if(!o)return;Object.getOwnPropertyDescriptor(o.constructor.prototype,"value").set.call(o,d);const x=o;x._valueTracker&&x._valueTracker.setValue("");const C=new Event("input",{bubbles:!0});C.simulated=!0,o.dispatchEvent(C);const k=new Event("change",{bubbles:!0});k.simulated=!0,o.dispatchEvent(k)}function Uw(o,d=!1){let m,x;const C=o.getBoundingClientRect();if(o.style.display==="none"||C.height===0&&C.width===0){const k=o.cloneNode(d);o.parentElement.appendChild(k),k.style.setProperty("display","block","important");const E=k.getBoundingClientRect();m=E.width,x=E.height,k.style.setProperty("display","none"),k.remove()}else m=C.width,x=C.height;return{height:Math.floor(x),width:Math.floor(m)}}function z3(o){const d=document.createElement("style");d.innerHTML=o,document.head.appendChild(d)}var I3=new RegExp("[_a-zA-Z]+[_a-zA-Z0-9-]*","g"),R3=new RegExp(`\\.${I3.source}`,"g"),D3=new RegExp("^\\s*(@(?:media|supports)[^{]*){(.*)}\\s*$");function y0(o,d){return o.replace(R3,m=>"."+d(m.slice(1)))}function Vw(o,d){const x=P3(o).cssRules;function C(E){if(E instanceof CSSStyleRule)return`${y0(E.selectorText,d)} { ${E.style.cssText} }`;const l=D3.exec(E.cssText.split(`
`).join(""));if(l&&l.length>2){const B=l[1],V=l[2];return`${B} { ${Vw(V,d)} }`}return E.cssText}let k="";for(const E of Array.from(x))k+=C(E)+`

`;return k.trim()}function m1(o,d){const m=Array.from(o.querySelectorAll("[class]"));m.push(o);for(const x of m){const{classList:C}=x;for(const k of Array.from(C))C.remove(k),C.add(d(k))}return o}var bx=1.4;function qw(o,d,m=.5){const{center:x,zoom:C}=o.cameraForBounds(d),k=Math.max(C-m,0);return{center:x,zoom:k,speed:bx}}function Zw(o){switch(o){case"street":return 15;case"neighborhood":case"postcode":case"locality":case"oaza":return 14;case"place":case"city":return 13;case"district":return 9;case"region":case"prefecture":return 6;case"country":return 4;default:return 16}}function $w(o,d){return`https://api.mapbox.com/styles/v1/${o}/${d}/static/`}var wx='<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.8 3.8a1 1 0 0 1 1.4 0L9 7.58l3.8-3.8a1 1 0 1 1 1.4 1.42L10.42 9l3.8 3.8a1 1 0 0 1-1.42 1.4L9 10.42l-3.8 3.8a1 1 0 0 1-1.4-1.42L7.58 9l-3.8-3.8a1 1 0 0 1 0-1.4Z" fill="currentColor"/></svg>',Gw='<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/></svg>',N3=$w("mapbox","satellite-streets-v11"),L3="20d01",O3=["mapbox.com","mapbox.cn","tilestream.net"],B3=$s(`
<template>
  <div class="MapboxSearch">
    <div class="Label" role="label" aria-live="polite" aria-atomic="true">
    </div>
    <div class="Results" aria-hidden="true">
      <div class="ResultsList" role="listbox">
      </div>
      <div class="ResultsAttribution" aria-hidden="true">
        <a href="https://www.mapbox.com/search-service" target="_blank" tabindex="-1">
          Powered by Mapbox
        </a>
      </div>
    </div>
  </div>
</template>
`),F3=$s(`
<template>
  <div class="Suggestion" role="option" tabindex="-1">
    <div class="SuggestionIcon" aria-hidden="true"></div>
    <div class="SuggestionText">
      <div class="SuggestionName"></div>
      <div class="SuggestionDesc"></div>
    </div>
  </div>
</template>
`),U3=$s(`
<template>
  <div class="SearchBox">
    <div class="SearchIcon"></div>
    <input class="Input" type="text" />
    <div class="ActionIcon">
      <button aria-label="Clear" class="ClearBtn" type="button">${wx}</button>
      <div class="LoadingIcon">${Gw}</div>
    </div>
  </div>
</template>
`),V3=$s(`
<template>
  <div class="Geocoder">
    <div class="SearchIcon"></div>
    <input class="Input" type="text" />
    <div class="ActionIcon">
      <button aria-label="Clear" class="ClearBtn" type="button">${wx}</button>
      <div class="LoadingIcon">${Gw}</div>
    </div>
  </div>
</template>
`);function af(){return"mbx"+new To().id.slice(0,8)}function Op(o){try{return JSON.parse(o)}catch{return null}}function Sx(o,d){if(o==null||d==null||typeof o!="object"||typeof d!="object")return o===d;const m=Object.keys(o),x=Object.keys(d);if(m.length!==x.length)return!1;for(const C of m)if(!Sx(o[C],d[C]))return!1;return!0}function g1(o,d){const m=Math.pow(10,d);return Math.round(o*m)/m}function q3(o){return!!o.match(/localhost|[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}|::1|\.local|^$/gi)}function Z3(o){return!!O3.some(d=>o.includes(d))}var Ym,mp,gp,Vh=class extends HTMLElement{constructor(){super(...arguments),Be(this,Ym,af()),Be(this,mp,void 0),Be(this,gp,o=>`${O(this,Ym)}--${o}`)}get template(){return null}get templateStyle(){return null}get templateUserStyle(){return null}clonedCallback(o,d){const m=k=>k.replace(o,d);m1(this,m);const x=Array.from(this.querySelectorAll("style"));for(const k of x)k.textContent=y0(k.textContent,m);x.length&&At(this,mp,x[x.length-1]);const C=Array.from(this.querySelectorAll(`[id^="${o}"]`));for(const k of C)k.id=k.id.replace(o,d)}connectedCallback(){if(this.childElementCount>0){const x=this.dataset.seed,C=O(this,Ym);x&&x!==C&&(this.clonedCallback(x,C),this.dataset.seed=C);return}this.dataset.seed=O(this,Ym);const o=this.template;if(o){const x=this.prepareTemplate(o);this.appendChild(x)}const d=this.templateStyle;if(d){const x=document.createElement("style");x.textContent=this.prepareCSS(d),this.appendChild(x)}const m=document.createElement("style");this.templateUserStyle&&(m.textContent=this.prepareCSS(this.templateUserStyle)),this.appendChild(m),At(this,mp,m)}prepareTemplate(o){const d=o.content.firstElementChild;return m1(d.cloneNode(!0),O(this,gp))}prepareCSS(o){return Vw(o,O(this,gp))}updateTemplateUserStyle(o){O(this,mp)&&(O(this,mp).textContent=this.prepareCSS(o))}querySelector(o){return super.querySelector(y0(o,O(this,gp)))}querySelectorAll(o){return super.querySelectorAll(y0(o,O(this,gp)))}addEventListener(o,d,m){super.addEventListener(o,d,m)}removeEventListener(o,d,m){super.removeEventListener(o,d,m)}dispatchEvent(o){return super.dispatchEvent(o)}};Ym=new WeakMap;mp=new WeakMap;gp=new WeakMap;var $3='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9 16A7 7 0 1 0 9 2a7 7 0 0 0 0 14ZM6.88 4.88a2.58 2.58 0 0 1 1.83-.75h1.08a2.58 2.58 0 0 1 2.59 2.58v.16c0 1-.53 1.94-1.4 2.46l-.56.34c-.27.16-.45.42-.52.71-.03.14-.14.25-.28.25H8.38a.23.23 0 0 1-.24-.25c.08-.91.59-1.74 1.38-2.21l.56-.34c.34-.2.54-.57.54-.96V6.7a.83.83 0 0 0-.83-.83H8.71a.83.83 0 0 0-.84.83v.18a.87.87 0 1 1-1.75 0V6.7c0-.69.28-1.34.76-1.83ZM10 13a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z" fill="currentColor"/></svg>',G3='<svg width="48" height="56" fill="none" xmlns="http://www.w3.org/2000/svg"><g filter="url(#a)"><path d="m24 50.4 13.79-14.12a18.82 18.82 0 0 0 4.23-20.86 19.23 19.23 0 0 0-7.19-8.6 19.76 19.76 0 0 0-21.66 0c-3.21 2.11-5.71 5.1-7.19 8.6a18.82 18.82 0 0 0 4.23 20.86L24 50.4Z" fill="currentColor"/><path d="M37.26 35.75 24 49.34 10.75 35.76l-.01-.01A18.07 18.07 0 0 1 6.68 15.7a18.48 18.48 0 0 1 6.9-8.26 19 19 0 0 1 20.84 0 18.48 18.48 0 0 1 6.9 8.26 18.07 18.07 0 0 1-4.06 20.04Z" stroke="#fff" stroke-width="1.5"/></g><circle cx="24" cy="22.45" fill="#fff" r="5.85"/><defs><filter id="a" x=".5" y=".6" width="47" height="54.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="1"/><feGaussianBlur stdDeviation="2"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_17_871"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_17_871" result="shape"/></filter></defs></svg>',H3=`<svg width="24" height="24" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M1.08 14.94 5.625 3.06h1.17l-3.42 11.88H1.08Zm15.885 0L12.42 3.06h-1.17l3.42 11.88h2.295Zm-6.86-1.44H7.946l.128-2.61h1.912l.119 2.61Zm-.217-4.77H8.181l.088-1.8h1.537l.082 1.8ZM9.74 5.49h-1.4l.049-.99h1.306l.045.99Z" fill="currentColor" />
</svg>`,W3=`<!-- TODO: I'm not sure if the way I added the circle will "scale" properly, need to check that -->
<svg width="24" height="24" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
  <path fill="none" stroke="currentColor" stroke-width="1.5" d="M4 7a5 5 0 1 1 10 0c0 3.025-3.28 6.713-5 9-1.72-2.287-5-5.975-5-9z"></path>
    <circle cx="9" cy="7" r="2" fill="currentColor"></circle>
</svg>`,X3=`<svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
  <path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>
</svg>`,Y3="@mapbox/search-js-web",p_="1.0.0",K3=`https://api.mapbox.com/search-js/v${p_}/img/style-toggle-satellite.jpg`,Q3=`https://api.mapbox.com/search-js/v${p_}/img/style-toggle-default.jpg`,J3=767,eA=`@media only screen and (max-width: ${J3}px)`,Tx={variables:{unit:["mobile","16px","14px"],unitHeader:["mobile","24px","18px"],minWidth:"min(300px, 100vw)",spacing:"0.75em",padding:"0.5em 0.75em",paddingFooterLabel:"0.5em 0.75em",paddingModal:"1.25em",colorText:"rgba(0, 0, 0, 0.75)",colorPrimary:"#4264FB",colorSecondary:"#667F91",colorBackground:"#fff",colorBackgroundHover:"#f5f5f5",colorBackgroundActive:"#f0f0f0",colorBackdrop:"rgba(102, 127, 145, 0.3)",border:"none",borderRadius:"4px",boxShadow:`
      0 0 10px 2px rgba(0, 0, 0, 0.05),
      0 0 6px 1px rgba(0, 0, 0, 0.1),
      0 0 0 1px rgba(0, 0, 0, 0.1)
    `,lineHeight:"1.2em",fontFamily:`
      -apple-system, BlinkMacSystemFont,
      avenir next, avenir,
      segoe ui,
      helvetica neue, helvetica,
      Ubuntu, roboto, noto, arial, sans-serif
    `,fontWeight:"normal",fontWeightSemibold:"600",fontWeightBold:"bold",duration:"150ms",curve:"ease-out"},icons:{close:wx,question:$3,marker:G3,street:H3,addressMarker:W3,search:X3},images:{styleToggleDefault:Q3,styleToggleSatellite:K3}};function bs(o,d={}){const m=Ir(Ir({},Tx.variables),d.variables||{});let x=d.cssText||"",C="";for(const[k,E]of Object.entries(m)){if(!Array.isArray(E)){C+=`--${k}: ${E};`;continue}if(E[0]!=="mobile"){const V=JSON.stringify(E);throw new Error(`Unsupported expression in theme variables: ${k} ${V}`)}const[,l,B]=E;x+=`${eA} { ${o} { --${k}: ${l} !important; } }`,C+=`--${k}: ${B};`}return x+`${o} { ${C} }`}function wo(o,d={}){return Ir(Ir({},Tx.icons),d.icons||{})[o]}function tA(o,d={}){return Ir(Ir({},Tx.images),d.images||{})[o]}var yp,Sv,y1=class{constructor(o,d,m){Be(this,yp,void 0),Be(this,Sv,{placement:"bottom-start",flip:!1,offset:10}),this.update=()=>Lp(this,null,function*(){const x={placement:this.options.placement,middleware:[ZC(this.options.offset),this.options.flip&&qC()].filter(Boolean)},{x:C,y:k}=yield YC(this.referenceEl,this.floatingEl,x);Object.assign(this.floatingEl.style,{left:`${C}px`,top:`${k}px`})}),this.referenceEl=o,this.floatingEl=d,At(this,yp,Ir(Ir({},O(this,Sv)),m)),this.destroy=XC(this.referenceEl,this.floatingEl,this.update)}get options(){return O(this,yp)}set options(o){At(this,yp,Ir(Ir({},O(this,yp)),o))}};yp=new WeakMap;Sv=new WeakMap;var uf="*{box-sizing:border-box!important}[role=button]{cursor:pointer}.MapboxSearch{--width:0;display:none}.Results{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);min-width:var(--minWidth);overflow-y:auto;position:absolute;transform:translateZ(0);transition:visibility var(--duration);width:var(--width);z-index:1000}.Results:not([aria-hidden=true]){visibility:visible}.Results[aria-hidden=true]{animation:fadein var(--duration) var(--curve) reverse forwards;visibility:hidden}.Suggestion{align-items:center;display:flex;padding:var(--padding)}.Suggestion:hover{cursor:pointer}.Suggestion[aria-selected=true]{background-color:var(--colorBackgroundHover)}.Suggestion:active{background-color:var(--colorBackgroundActive)}.SuggestionName{font-weight:var(--fontWeightBold)}.SuggestionIcon{margin-right:6px}.SuggestionIcon[aria-hidden=true]{display:none}.ResultsAttribution{padding:var(--paddingFooterLabel)}.ResultsAttribution a{color:var(--colorSecondary)}.ResultsAttribution a:not(:hover){text-decoration:none}.ResultsList{list-style:none;margin:0;padding:0}.Label{display:none}.Geocoder,.SearchBox{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);padding:var(--padding);padding-bottom:0;padding-top:0;position:relative;width:100%}.SearchIcon{fill:#757575;left:.5em}.ActionIcon,.SearchIcon{bottom:0;height:20px;margin:auto 0;position:absolute;top:0;width:20px}.ActionIcon{right:.5em}.ActionIcon>button{background:none;border:none;color:inherit;cursor:pointer;font:inherit;height:100%;outline:inherit;padding:0;width:100%}.ActionIcon>button:hover{background:none!important}.ClearBtn{display:none}.ClearBtn:hover{color:#909090}.LoadingIcon{-moz-animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;-webkit-animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;animation:rotate .8s cubic-bezier(.45,.05,.55,.95) infinite;display:none;height:100%}@-webkit-keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.Input{background-color:transparent;border:0;color:#404040;color:rgba(0,0,0,.75);font:inherit;height:36px;margin:0;overflow:hidden;padding:0 40px;text-overflow:ellipsis;white-space:nowrap;width:100%}.Input::-ms-clear{display:none}.Input:focus{border:thin dotted;border-radius:var(--borderRadius);box-shadow:none;color:#404040;color:rgba(0,0,0,.75);outline:0}mapbox-address-confirmation-feature[aria-hidden=true],mapbox-address-confirmation-no-feature[aria-hidden=true]{display:none}.MapboxAddressConfirmation{align-items:center;background-color:var(--colorBackdrop);bottom:0;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;transform:translateZ(0);z-index:1000}.MapboxAddressConfirmation:not([aria-hidden=true]){animation:fadein var(--duration) var(--curve) forwards;visibility:visible}.MapboxAddressConfirmation[aria-hidden=true]{visibility:hidden}.ContentFeature,.ContentNoFeature{width:var(--minWidth)}.Modal{background-color:var(--colorBackground);border:var(--border);border-radius:var(--borderRadius);box-shadow:var(--boxShadow);color:var(--colorText);font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight);padding:var(--paddingModal);width:100%}@media screen and (max-width:480px){.MapboxAddressConfirmation{align-items:flex-end}.ContentFeature,.ContentNoFeature{width:100%}.Modal{border-bottom-left-radius:0;border-bottom-right-radius:0}}.ModalHeader{align-items:center;color:var(--colorPrimary);display:flex;font-size:var(--unitHeader);font-weight:var(--fontWeightBold);margin-bottom:var(--spacing);user-select:none;width:100%}.ModalMap{height:calc(var(--minWidth)*9/16);margin-left:calc(var(--paddingModal)*-1);width:calc(100% + var(--paddingModal)*2)}.ModalMap[aria-hidden=true]{display:none}.Icon{height:var(--unitHeader);width:var(--unitHeader)}.Icon.IconClose{color:var(--colorSecondary)}.ModalHeaderTitle{flex:1;margin-left:.25em}.ModalFooter{color:var(--colorSecondary);margin-top:var(--spacing);text-align:center}.ModalFooter[aria-hidden=true]{display:none}.ModalSubheader{font-weight:var(--fontWeightBold);user-select:none}.ModalDescription{color:var(--colorPrimary)}.ModalAddress,.ModalSubheader{margin-bottom:var(--spacing)}.ModalAddress.ModalAddressApprove{color:var(--colorPrimary)}.Button{border-radius:var(--borderRadius);cursor:pointer;font-weight:var(--fontWeightSemibold);margin-top:var(--spacing);padding:var(--padding);text-align:center;user-select:none;width:100%}.Button[aria-hidden=true]{display:none}.Button.ButtonPrimary{background-color:var(--colorPrimary);color:var(--colorBackground)}.Button.ButtonSecondary{border:1px solid var(--colorSecondary);color:var(--colorSecondary)}@keyframes fadein{0%{opacity:0}to{opacity:1}}.MapboxAddressMinimap{font-family:var(--fontFamily);font-size:var(--unit);font-weight:var(--fontWeight);line-height:var(--lineHeight)}.MapboxAddressMinimap[aria-hidden=true]{display:none}.MinimapImageContainer{border-radius:var(--borderRadius);overflow:hidden}.MinimapImage{height:unset;max-height:unset;max-width:unset;position:relative;width:unset}.MinimapInnerFrame{border:var(--border);border-radius:inherit;height:inherit;left:0;overflow:hidden;position:absolute;top:0;width:inherit}.MinimapMarker{left:50%;position:absolute;top:50%}.MinimapMarker>svg{color:var(--colorPrimary);display:block!important}.MinimapAttributionLogo{bottom:0;left:0;margin:0 0 6px 6px;position:absolute}.MinimapAttributionLogo a{cursor:pointer;display:block;height:23px;width:88px}.MinimapAttributionText{background-color:hsla(0,0%,100%,.65);bottom:0;font:11px/16px Helvetica Neue,Arial,Helvetica,sans-serif;padding:0 5px;position:absolute;right:0}.MinimapAttributionText a{color:rgba(0,0,0,.75);text-decoration:none}.MinimapAttributionText a:hover{color:inherit;text-decoration:underline}.MinimapAttributionText a:not(:first-child){margin-left:3px}.MinimapStyleToggle{background-position:0;background-repeat:no-repeat;background-size:contain;border:2px solid #fff;border-radius:3px;box-shadow:var(--boxShadow);cursor:pointer;height:2em;position:absolute;right:var(--spacing);top:var(--spacing);width:2em}.MinimapFooter{color:var(--colorSecondary);font-family:var(--fontFamily);font-size:var(--unit);margin-top:var(--spacing)}.MinimapFooter[aria-hidden=true]{display:none}.MinimapEditButtons{bottom:26px;display:flex;font-family:var(--fontFamily);position:absolute;right:var(--spacing)}.MinimapEditButtons .Button{box-shadow:var(--boxShadow)}.MinimapButtonCancel{background-color:var(--colorBackground);margin-left:var(--spacing)}.draggable{cursor:move;cursor:grab}.draggable:active{cursor:grabbing}",Ti=class extends CustomEvent{constructor(o,d){super(o,{composed:!0,detail:d})}clone(o){const d=new Ti(this.type,this.detail);return o&&Object.defineProperty(d,"target",{value:o}),d}},rA="Type in 2 or more characters for results.",iA="When autocomplete results are available use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.",aA="No search results.",nA=(o,d,m)=>`${d} ${d===1?"result is":"results are"} available. ${o}. ${m} of ${d} is selected.`,sA=o=>`${o} ${o===1?"result is":"results are"} available. Use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.`;function Hw(o){const d=o.currentTarget;(o.key===" "||o.key==="Enter")&&(o.preventDefault(),o.stopPropagation(),d.dispatchEvent(new MouseEvent("click",{bubbles:!0,composed:!0})))}var Ww="search-listbox__description",Mx=o=>{const d=document.createElement("div");d.setAttribute("aria-live","polite"),d.setAttribute("aria-atomic","true"),d.setAttribute("role","status"),d.setAttribute("style","border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;margin-bottom: -1px;margin-right: -1px;overflow: hidden;padding: 0px;position: absolute;white-space: nowrap;width: 1px;");const m=document.createElement("div");return m.setAttribute("id",`${o}--${Ww}`),d.appendChild(m),d},_1=(o,d)=>{var m;const x=(m=document.body.querySelector(`[id="${d}--${Ww}"]`))!=null?m:null;x&&(x.textContent=o)},oA=o=>{o.name=o.name+" address-search",o.setAttribute("data-lpignore","true")},lA=(o,d,m)=>{let x=null;const C=!d||d.length===0;if((o==null?void 0:o.length)<2)x=rA+" "+iA;else if(C)x=aA;else if(m!==void 0){const k=d[m],E=k.name||k.feature_name||k.properties.name;x=nA(E,d.length,m+1)}else x=sA(d.length);return x},Tv=(o,d)=>{switch(d){case 0:return o.matching_name||o.feature_name||o.address_line1;case 2:return o.name;case 1:return o.properties.name;default:return""}},cA=(o,d)=>{switch(d){case 0:return o.description;case 2:return o.feature_type==="poi"?o.full_address:o.place_formatted;case 1:return o.properties.place_formatted;default:return""}};function H_(o,d){return`${o}-${d}`}var Cn,Wn,Km,wu,Qm,_0,Jm,v0,Mv,Ev,Xw,x0,b0,w0,vg,eg,_p,S0,Eg=class extends Vh{constructor(){super(...arguments),Be(this,v0),Be(this,Ev),this.suggestions=null,Be(this,Cn,null),Be(this,Wn,void 0),Be(this,Km,void 0),Be(this,wu,void 0),Be(this,Qm,void 0),Be(this,_0,null),Be(this,Jm,void 0),Be(this,x0,{}),Be(this,b0,{}),Be(this,w0,o=>{const{Results:d}=O(this,Wn),m=o.target;if(m.dataset.mapboxSuccess){delete m.dataset.mapboxSuccess;return}const x=m.value;this.renderAriaMessage(),d.setAttribute("aria-busy","true"),this.dispatchEvent(new Ti("input",{lastInput:o.data,inputText:x}))}),this.renderAriaMessage=()=>{var o;const d=lA((o=this.input)==null?void 0:o.value,this.suggestions,this.selectedIndex);_1(d,this.dataset.seed)},this.clearAriaMessage=()=>{_1("",this.dataset.seed)},this.handleSuggest=o=>{if(this.suggestions=o,(!o||o.length===0)&&this.renderAriaMessage(),!o){this.hideResults();return}_g(this,Ev,Xw).call(this),o.length&&_g(this,v0,Mv).call(this);const{Results:d}=O(this,Wn);d.setAttribute("aria-busy","false")},this.handleError=()=>{const{Results:o}=O(this,Wn);o.setAttribute("aria-busy","false"),this.hideResults()},Be(this,vg,(o,d)=>Lp(this,null,function*(){const m=this.input;m&&(m.dataset.mapboxSuccess="true");const x={suggestion:o,selectedIndex:d};this.dispatchEvent(new Ti("select",x)),this.hideResults()})),Be(this,eg,()=>{const o=this.input;delete o.dataset.mapboxSuccess,this.dispatchEvent(new Ti("focus")),this.renderAriaMessage(),_g(this,v0,Mv).call(this)}),Be(this,_p,()=>{document.activeElement!==this.input&&(this.dispatchEvent(new Ti("blur")),this.clearAriaMessage(),this.hideResults())}),this.handleArrowUp=()=>{this.selectedIndex===void 0?this.selectedIndex=this.suggestions.length-1:this.selectedIndex===0?this.selectedIndex=void 0:this.selectedIndex=Math.max(0,this.selectedIndex-1)},this.handleArrowDown=()=>{this.selectedIndex===void 0?this.selectedIndex=0:this.selectedIndex===this.suggestions.length-1?this.selectedIndex=void 0:this.selectedIndex=Math.min(this.selectedIndex+1,this.suggestions.length-1)},Be(this,S0,o=>{var d;if((d=this.suggestions)!=null&&d.length){if(o.key==="ArrowDown"){o.preventDefault(),this.handleArrowDown();return}if(o.key==="ArrowUp"){o.preventDefault(),this.handleArrowUp();return}if(o.key==="Escape"){this.hideResults();return}if(this.selectedIndex!==void 0){if(o.key==="Tab"){O(this,vg).call(this,this.suggestions[this.selectedIndex],this.selectedIndex);return}if(o.key==="Enter"){o.preventDefault(),O(this,vg).call(this,this.suggestions[this.selectedIndex],this.selectedIndex);return}}}})}get template(){return B3}get templateStyle(){return uf}get templateUserStyle(){return bs(".MapboxSearch",this.theme)}get input(){return O(this,Qm)}set input(o){const d=O(this,Qm);d&&(d.removeEventListener("input",O(this,w0)),d.removeEventListener("focus",O(this,eg)),d.removeEventListener("blur",O(this,_p)),d.removeEventListener("keydown",O(this,S0)),O(this,Cn)&&O(this,Cn).destroy()),o&&(o.addEventListener("input",O(this,w0)),o.addEventListener("focus",O(this,eg)),o.addEventListener("blur",O(this,_p)),o.addEventListener("keydown",O(this,S0)),o.setAttribute("role","combobox"),o.setAttribute("aria-autocomplete","list"),o.setAttribute("aria-controls",O(this,wu)),this.isConnected&&At(this,Cn,new y1(o,O(this,Wn).Results,this.popoverOptions))),At(this,Qm,o)}get searchService(){return O(this,_0)}set searchService(o){At(this,_0,o)}get selectedIndex(){return O(this,Jm)}set selectedIndex(o){const d=O(this,Jm);At(this,Jm,o);const{ResultsList:m}=O(this,Wn),x=H_(O(this,wu),o);if(o!==void 0?(this.input.setAttribute("aria-activedescendant",x),m.setAttribute("aria-activedescendant",x)):(this.input.removeAttribute("aria-activedescendant"),m.removeAttribute("aria-activedescendant")),d!==o){const C=H_(O(this,wu),d),k=m.querySelector(`#${C}`);if(k==null||k.removeAttribute("aria-selected"),k==null||k.setAttribute("tabindex","-1"),o!==void 0){const E=m.querySelector(`#${x}`);E==null||E.setAttribute("aria-selected","true"),E==null||E.setAttribute("tabindex","0")}}this.renderAriaMessage()}hideResults(){const{Results:o,ResultsList:d}=O(this,Wn);o.setAttribute("aria-hidden","true"),this.input.setAttribute("aria-expanded","false"),d.removeAttribute("aria-activedescendant"),this.input.removeAttribute("aria-activedescendant")}renderItem(o){const d=this.prepareTemplate(F3);return d.id=H_(O(this,wu),o),d}fillItem(o,d,m,x){const C=o.querySelector('[class$="SuggestionIcon"]'),k=o.querySelector('[class$="SuggestionName"]'),E=o.querySelector('[class$="SuggestionDesc"]');this.searchService===0?(C.innerHTML=wo(d.accuracy==="street"?"street":"addressMarker",this.theme),C.removeAttribute("aria-hidden")):C.setAttribute("aria-hidden","true"),k.textContent=E.textContent="",k.textContent=Tv(d,this.searchService),E.textContent=cA(d,this.searchService),m===this.selectedIndex?o.setAttribute("aria-selected","true"):o.removeAttribute("aria-selected"),o.setAttribute("aria-posinset",(m+1).toString()),o.setAttribute("aria-setsize",x.toString())}get theme(){return O(this,x0)}set theme(o){At(this,x0,o),!(!O(this,Wn)||!o)&&this.updateTemplateUserStyle(bs(".MapboxSearch",o))}get popoverOptions(){return O(this,b0)}set popoverOptions(o){At(this,b0,o),O(this,Cn)&&(O(this,Cn).options=o,O(this,Cn).update())}connectedCallback(){super.connectedCallback(),this.dataSeed=this.dataset.seed,At(this,Km,this.dataset.seed+"-Label"),At(this,wu,this.dataset.seed+"-ResultsList"),this.input&&this.input.setAttribute("aria-controls",O(this,wu)),At(this,Wn,cf(this,{MapboxSearch:".MapboxSearch",Results:".Results",ResultsList:".ResultsList",Label:".Label"}));const{Results:o,ResultsList:d,Label:m}=O(this,Wn);m.id=O(this,Km),d.id=O(this,wu),d.setAttribute("aria-labelledby",O(this,Km)),o.addEventListener("blur",O(this,_p)),!O(this,Cn)&&this.input&&At(this,Cn,new y1(this.input,O(this,Wn).Results,this.popoverOptions)),requestAnimationFrame(()=>{O(this,Cn)&&O(this,Cn).update()})}disconnectedCallback(){this.input=null;const{Results:o}=O(this,Wn);o.removeEventListener("blur",O(this,_p)),O(this,Cn)&&O(this,Cn).destroy()}focus(){document.activeElement===this.input?O(this,eg).call(this):this.input.focus()}blur(){this.input.blur()}updatePopover(){O(this,Cn)&&O(this,Cn).update()}};Cn=new WeakMap;Wn=new WeakMap;Km=new WeakMap;wu=new WeakMap;Qm=new WeakMap;_0=new WeakMap;Jm=new WeakMap;v0=new WeakSet;Mv=function(){if(!this.suggestions||!this.suggestions.length)return;const{Results:o,MapboxSearch:d}=O(this,Wn),m=this.input.getBoundingClientRect();d.style.setProperty("--width",`${m.width}px`),d.style.setProperty("display","block"),this.input.setAttribute("aria-expanded","true"),o.removeAttribute("aria-hidden"),this.selectedIndex=void 0};Ev=new WeakSet;Xw=function(){const{ResultsList:o}=O(this,Wn);if(!this.suggestions||!this.suggestions.length){o.innerHTML="",this.hideResults();return}const d=k3(o);if(this.suggestions.length>d.length)for(let m=d.length;m<this.suggestions.length;m++){const x=this.renderItem(m);d.push(x),x.onmouseenter=()=>{this.selectedIndex=m},x.onmouseleave=()=>{this.selectedIndex=void 0},o.appendChild(x)}if(this.suggestions.length<d.length)for(let m=this.suggestions.length;m<d.length;m++)d[m].remove();for(let m=0;m<this.suggestions.length;m++){const x=this.suggestions[m],C=d[m];this.fillItem(C,x,m,this.suggestions.length),C.onclick=()=>{O(this,vg).call(this,x,m)}}};x0=new WeakMap;b0=new WeakMap;w0=new WeakMap;vg=new WeakMap;eg=new WeakMap;_p=new WeakMap;S0=new WeakMap;window.MapboxSearchListbox=Eg;window.customElements.get("mapbox-search-listbox")||customElements.define("mapbox-search-listbox",Eg);var uA=new Set(["street-address","address-line1","address-line2","address-line3","address-level4","address-level3","address-level2","address-level1","country","country-name","postal-code"]),hA=new Set(["off","on","true","false"]);function Yw(o){let d=o.parentNode;for(;d;){if(d instanceof HTMLFormElement)return d;d=d.parentNode}return null}function dA(o){const d=o||document;return Array.from(d.querySelectorAll('input[autocomplete~="address-line1"], input[autocomplete~="street-address"]'))}var fA="section-",pA="section-default",mA="section-shipping",gA="section-billing";function Ex(o){const d=Array.from(o.querySelectorAll("[autocomplete]")).filter(x=>{const C=x.tagName.toLowerCase();return C==="input"||C==="select"||C==="textarea"}),m=[];for(const x of d){if(!j3(x))continue;const C=x.getAttribute("autocomplete")||"";if(!C||hA.has(C))continue;const k=C.toLowerCase().split(" ");if(k.length>3)continue;const E=k[k.length-1];if(!uA.has(E))continue;k.pop();let l=pA;if(k.length){const B=k[k.length-1];B==="shipping"&&(l=mA,k.pop()),B==="billing"&&(l=gA,k.pop())}if(k.length){const B=k[k.length-1];B.startsWith(fA)&&(l=B)}m.push({input:x,section:l,field:E})}return m}function Cg(o,d){const m=[],x=[],C=Ex(o);let k=null;for(const{input:E,section:l,field:B}of C){let V=m.length-1,X=!1;if(m.length?(x[V]!==l||m[V][B])&&(X=!0):X=!0,X){if(k)break;m.push({[B]:E}),x.push(l),V++}else m[V][B]=E;E===d&&(k=m[V])}return k??{}}function Kw(o,d,m){var x;const C=Cg(o,d),k=[m.address_line1,m.address_line2,m.address_line3].filter(l=>!!l).join(", ");wc(C["street-address"],C["address-line2"]?m.address_line1||"":k),wc(C["address-line1"],m.address_line1||""),wc(C["address-line2"],m.address_line2||""),wc(C["address-level1"],m.address_level1||""),wc(C["address-level2"],m.address_level2||""),wc(C["address-level3"],m.address_level3||"");const E=m.country_code||((x=m.metadata)==null?void 0:x.iso_3166_1)||"";if(C.country&&C.country instanceof HTMLSelectElement){let l=C.country.querySelector("option").value;l===""&&(l=C.country.querySelectorAll("option")[1].value);const B=l===l.toUpperCase();wc(C.country,B?E.toUpperCase():E)}else wc(C.country,E);wc(C["country-name"],m.country||""),wc(C["postal-code"],m.postcode||"")}function yA(o,d){const m=Cg(o,d),x={};for(const[C,k]of Object.entries(m))k!=null&&k.value&&(x[C]=k.value);return x}function Qw(o){const d=[];return o["street-address"]?d.push(o["street-address"]):d.push(o["address-line1"]||""),d.push(o["address-line2"]||""),d.push(o["address-line3"]||""),d.push(o["address-level3"]||""),d.push(o["address-level2"]||""),d.push(o["address-level1"]||""),d.push(o["postal-code"]||""),o["country-name"]?d.push(o["country-name"]):d.push(o.country||""),d.filter(m=>!!m).map(m=>m.trim()).join(", ")}function Jw(o,d){const m=Yw(d);if(!m)return;const x=gx(o);Kw(m,d,x);const C=Cg(m,d);C["address-line2"]&&!x.address_line2&&C["address-line2"].focus()}function _A(o){var d;const m={},x=[o.properties.address_line1,o.properties.address_line2,o.properties.address_line3].filter(C=>!!C).join(", ");return m["street-address"]=x,m["address-line1"]=o.properties.address_line1,m["address-line2"]=o.properties.address_line2,m["address-line3"]=o.properties.address_line3,m["address-level1"]=o.properties.address_level1,m["address-level2"]=o.properties.address_level2,m["address-level3"]=o.properties.address_level3,m.country=(d=o.properties.metadata)==null?void 0:d.iso_3166_1,m["country-name"]=o.properties.country,m["postal-code"]=o.properties.postcode,m}function vA(o,d){for(const[m,x]of Object.entries(o))if(d[m]!==x)return!0;return!1}var xA=o=>o.filter((d,m,x)=>{const C=Tv(d,0);return d.accuracy!=="street"||x.findIndex(k=>C===Tv(k,0))===m}),Ip=(o,d,m)=>{const k=m?d||"address-line1":"new-password";o&&(o.autocomplete=k)},bA=(o,d,m)=>{if(!o||!m)return;Ip(o,d,!0);const x={properties:Zs(Ir({},m),{address_line1:m.address_line1+" ",postcode:null})};Jw(x,o),Ip(o,d,!1),o==null||o.focus()},wA=class{constructor(){this.feedbackEnabled=!0,this.autofillSessionToken=new To,this.autofillSessionEnabled=!1,this.detectBrowserAutofillEnabled=!1}},Al=new wA;Object.defineProperty(Al,"autofillSessionToken",{configurable:!1,writable:!1});var SA=$s(`
<template>
  <div class="MapboxAddressConfirmation" aria-hidden="true">
    <mapbox-address-confirmation-feature class="ContentFeature"></mapbox-address-confirmation-feature>
    <mapbox-address-confirmation-no-feature class="ContentNoFeature"></mapbox-address-confirmation-no-feature>
  </div>
</template>
`),T0,bo,vp,M0,Cx=class extends Vh{constructor(){super(...arguments),Be(this,T0,!1),Be(this,bo,void 0),Be(this,vp,void 0),Be(this,M0,{})}get template(){return SA}get templateStyle(){return uf}get templateUserStyle(){return bs(".MapboxAddressConfirmation",this.theme)}get theme(){return O(this,M0)}set theme(o){if(At(this,M0,o),!O(this,bo)||!o)return;this.updateTemplateUserStyle(bs(".MapboxAddressConfirmation",o));const{ContentFeature:d,ContentNoFeature:m}=O(this,bo);d.theme=o,m.theme=o}connectedCallback(){super.connectedCallback(),At(this,bo,cf(this,{MapboxAddressConfirmation:".MapboxAddressConfirmation",ContentFeature:".ContentFeature",ContentNoFeature:".ContentNoFeature"}));const{MapboxAddressConfirmation:o}=O(this,bo);o.setAttribute("aria-hidden","true");const d=this.theme;if(d){const{ContentFeature:m,ContentNoFeature:x}=O(this,bo);m.theme=d,x.theme=d}}disconnectedCallback(){At(this,vp,null)}hide(){var o;if(At(this,T0,!1),!O(this,bo))return;const{MapboxAddressConfirmation:d}=O(this,bo);d.setAttribute("aria-hidden","true"),(o=O(this,vp))==null||o.deactivate(),i1.off()}show(o,d,m){return Lp(this,null,function*(){var x;if(!O(this,bo))return{type:"cancel"};const{MapboxAddressConfirmation:C,ContentFeature:k,ContentNoFeature:E}=O(this,bo),{accessToken:l,minimap:B=!1,theme:V,footer:X}=d;this.theme=V,m?(k.removeAttribute("aria-hidden"),E.setAttribute("aria-hidden","true"),k.minimap=B,k.accessToken=l,k.footer=X,k.update(m,o)):(k.setAttribute("aria-hidden","true"),E.removeAttribute("aria-hidden"),E.update(o)),At(this,T0,!0),C.removeAttribute("aria-hidden"),i1.on();const ne=m?k:E;return At(this,vp,y3(C,{fallbackFocus:ne,escapeDeactivates:()=>(this.hide(),!0)})),(x=O(this,vp))==null||x.activate(),new Promise(re=>{const ee=ne,te=be=>{ee.removeEventListener("result",te);const Ee=be.detail;this.hide(),re(Ee==="change"?{type:"change",feature:m}:{type:Ee})};ee.addEventListener("result",te)})})}tryShow(o,d){return Lp(this,null,function*(){if(!O(this,bo))return{type:"cancel"};const{accessToken:m,options:x={}}=d,C=new Sw(Ir({accessToken:m},x)),k=Qw(o),l=(yield C.validate(k,{sessionToken:Al.autofillSessionToken})).features[0];if(l){const B=X=>X.properties.match_code.confidence===Mw.exact,{skipConfirmModal:V=B}=d;if(V(l))return{type:"nochange"}}return yield this.show(o,d,l)})}};T0=new WeakMap;bo=new WeakMap;vp=new WeakMap;M0=new WeakMap;window.MapboxAddressConfirmation=Cx;window.customElements.get("mapbox-address-confirmation")||customElements.define("mapbox-address-confirmation",Cx);var W_=new Cx;function TA(o){return Lp(this,arguments,function*(d,m={}){var x;const{sections:C=[]}=m;W_.parentNode||document.body.appendChild(W_);let k={type:"nochange"};const E=dA(d),l=Ex(d),B=Array.from(document.querySelectorAll("mapbox-search-listbox"));for(const V of E){if(C.length){const be=l.find(Ee=>Ee.input===V);if(!be||!C.includes(be.section))continue}const X=yA(d,V),ne=B.find(be=>be.input===V),re=ne==null?void 0:ne.autofillHost;if(re){const be=re.retrieveFeature;if(be){const Ee=_A(be);if(!vA(X,Ee))continue}}const ee=m.accessToken||Al.accessToken,te=yield W_.tryShow(X,Zs(Ir({},m),{accessToken:ee}));if(te.type==="change"){const be=Cg(d,V);if((x=be["address-line2"])!=null&&x.value&&(te.feature.properties.address_line2=be["address-line2"].value),ne)re.simulateRetrieve(te.feature);else{V.dataset.mapboxSuccess="true";const Ee=gx(te.feature);Kw(d,V,Ee)}}te.type==="change"&&k.type!=="cancel"&&(k=te),te.type==="cancel"&&(k=te)}return k})}function e2(o,d,m,x,C){if(d){const k=$s(`
        <span>
          <span></span>
          <br />
          <span></span>
        </span>
      `),[E,l]=Array.from(k.querySelectorAll("span > span"));if(m&&x)E.textContent=m,l.textContent=x;else{const B=d.split(",");E.textContent=B[0].trim(),l.textContent=B.slice(1).join(",").trim()}if(!C){if(o["address-line2"]){const B=document.createElement("span");B.textContent=o["address-line2"],k.insertBefore(B,l),k.insertBefore(document.createElement("br"),l)}if(o["address-line3"]){const B=document.createElement("span");B.textContent=o["address-line3"],k.insertBefore(B,l),k.insertBefore(document.createElement("br"),l)}}return k}else{const k=o["street-address"]||o["address-line1"]||"",E=o["address-line2"],l=o["address-line3"],B=[o["address-level4"]||"",o["address-level3"]||"",o["address-level2"]||"",`${o["address-level1"]||""} ${o["postal-code"]||""}`,o.country||o["country-name"]||""].filter(Boolean).join(", "),X=[k,E,l,B].filter(Boolean).map(re=>`<span>${re}</span>`).join("<br />");return $s(`
        <span>${X}</span>
      `)}}function MA(o,d,m,x){return Lp(this,null,function*(){if(!m)return;const C=Yw(o),k=Object.values(Cg(C,o));if(!d.detail.elements.some(re=>k.includes(re)))return;const E=Ex(C),B=E.find(re=>re.input===o).section,V=Array.from(new Set(E.filter(re=>d.detail.elements.includes(re.input)).map(re=>re.section)));if(!V.includes(B))return;const X=typeof m=="object"&&m.sections||[];if(X.length&&!X.some(re=>V.includes(re)))return;let ne=typeof m=="object"?m:{};ne=Zs(Ir({},ne),{accessToken:x,sections:[B]}),yield TA(C,ne)})}var EA="https://contribute-api.mapbox.com/v1",CA="https://contribute-api-staging.tilestream.net/v1",AA="edit-suggestion";function t2(o,d){if(!Al.feedbackEnabled)return;const m=window.location.hostname,C=`${q3(m)||Z3(m)?CA:EA}/${AA}/address?access_token=${o}`,{originalCoordinate:k,originalAddress:E,changes:l}=d,B={action:"update",reason:"incorrect_address",location:{longitude:k[0],latitude:k[1]},userEmail:"no-reply-autofill@mapbox.com",changes:l,placeName:E};fetch(C,{method:"POST",headers:new Headers({"User-Agent":`mapbox-search-js.${p_}.${navigator.userAgent}`,"Content-Type":"application/json"}),body:JSON.stringify(B)})}var kA=$s(`
<template>
  <div class="MapboxAddressConfirmationFeature">
    <div class="Modal" aria-modal="true" role="dialog">
      <div class="ModalHeader">
        <svg viewBox="0 0 18 18" class="Icon IconQuestion"></svg>
        <div class="ModalHeaderTitle">Did you mean?</div>
        <svg
          viewBox="0 0 18 18"
          class="Icon IconClose"
          tabindex="0"
          role="button"
          title="Close"
          aria-label="Close"
          aria-expanded="true"
        ></svg>
      </div>

      <div class="ModalAddress ModalAddressApprove"></div>
            
      <div class="ModalMap">
        <mapbox-address-minimap class="Minimap"></mapbox-address-minimap>
      </div>

      <div
        class="Button ButtonPrimary ButtonApprove"
        tabindex="0"
        role="button"
        aria-label="Yes"
      >
        Yes
      </div>
      
      <div
        class="Button ButtonSecondary ButtonReject"
        tabindex="0"
        role="button"
        aria-label="No, use the address I provided"
      >
        No, use the address I provided
      </div>

      <div class="ModalFooter">
          Your confirmation helps improve address data accuracy.
      </div>
    </div>
  </div>
</template>
`),Su,E0,tg,C0,A0,k0,P0,j0,r2=class extends Vh{constructor(){super(...arguments),Be(this,Su,void 0),Be(this,E0,{}),this.minimap=!1,Be(this,tg,void 0),Be(this,C0,void 0),this.update=(o,d)=>{var m;At(this,tg,o),At(this,C0,d);const{ModalMap:x,Minimap:C,ModalAddressApprove:k}=O(this,Su);if(this.minimap){if(x.removeAttribute("aria-hidden"),C.accessToken=this.accessToken,typeof this.minimap=="object"){const{defaultMapStyle:l,theme:B,mapStyleMode:V,satelliteToggle:X}=this.minimap;l&&(C.defaultMapStyle=this.minimap.defaultMapStyle),B&&(C.theme=this.minimap.theme),V&&(C.mapStyleMode=V),X!==void 0&&(C.satelliteToggle=X)}C.feature=o}else x.setAttribute("aria-hidden","true");const E=o.properties.place_name||o.properties.full_address||o.properties.address;k.innerHTML="",k.appendChild(e2(d,E,o.properties.feature_name,o.properties.description,((m=o.properties.place_type)==null?void 0:m[0])==="secondary_address"))},Be(this,A0,()=>{this.dispatchEvent(new Ti("result","cancel"))}),this.approve=()=>{this.dispatchEvent(new Ti("result","change"))},this.reject=()=>{this.dispatchEvent(new Ti("result","nochange")),t2(this.accessToken,{originalCoordinate:O(this,tg).geometry.coordinates,originalAddress:O(this,tg).properties.full_address,changes:{address:Qw(O(this,C0))}})},Be(this,k0,af()),Be(this,P0,af()),Be(this,j0,af())}get template(){return kA}get templateStyle(){return uf}get templateUserStyle(){return bs(".MapboxAddressConfirmationFeature",this.theme)}get theme(){return O(this,E0)}set theme(o){if(At(this,E0,o),!O(this,Su)||!o)return;this.updateTemplateUserStyle(bs(".MapboxAddressConfirmationFeature",o));const{IconQuestion:d,IconClose:m}=O(this,Su);d.innerHTML=wo("question",o),m.innerHTML=wo("close",o)}set footer(o){if(o===void 0)return;const d=this.querySelector(".ModalFooter");typeof o=="string"?(d.textContent=o,d.removeAttribute("aria-hidden")):o?d.removeAttribute("aria-hidden"):d.setAttribute("aria-hidden","true")}connectedCallback(){super.connectedCallback(),At(this,Su,cf(this,{MapboxAddressConfirmationFeature:".MapboxAddressConfirmationFeature",Modal:".Modal",ModalHeaderTitle:".ModalHeaderTitle",ModalMap:".ModalMap",Minimap:".Minimap",IconQuestion:".IconQuestion",IconClose:".IconClose",ButtonApprove:".ButtonApprove",ButtonReject:".ButtonReject",ModalAddressApprove:".ModalAddressApprove"}));const{Modal:o,ModalHeaderTitle:d,IconClose:m,ButtonApprove:x,ButtonReject:C,ModalAddressApprove:k}=O(this,Su);o.setAttribute("aria-labelledby",O(this,P0)),o.setAttribute("aria-describedby",O(this,j0)),m.setAttribute("aria-controls",O(this,k0)),o.id=O(this,k0),d.id=O(this,P0),k.id=O(this,j0);const E=Array.from(this.querySelectorAll('[role="button"]'));for(const B of E)B.addEventListener("keydown",Hw);m.addEventListener("click",O(this,A0)),x.addEventListener("click",this.approve),C.addEventListener("click",this.reject);const l=this.theme;if(l){const{IconQuestion:B,IconClose:V}=O(this,Su);B.innerHTML=wo("question",l),V.innerHTML=wo("close",l)}}disconnectedCallback(){const{IconClose:o,ButtonApprove:d}=O(this,Su);o.removeEventListener("click",O(this,A0)),d.removeEventListener("click",this.approve)}};Su=new WeakMap;E0=new WeakMap;tg=new WeakMap;C0=new WeakMap;A0=new WeakMap;k0=new WeakMap;P0=new WeakMap;j0=new WeakMap;window.MapboxAddressConfirmationFeature=r2;window.customElements.get("mapbox-address-confirmation-feature")||customElements.define("mapbox-address-confirmation-feature",r2);var PA=$s(`
<template>
  <div class="MapboxAddressConfirmationNoFeature">
    <div class="Modal" aria-modal="true" role="dialog">
      <div class="ModalHeader">
        <svg viewBox="0 0 18 18" class="Icon IconQuestion"></svg>
        <div class="ModalHeaderTitle">Confirm address</div>
        <svg
          viewBox="0 0 18 18"
          class="Icon IconClose"
          tabindex="0"
          role="button"
          title="Close"
          aria-label="Close"
          aria-expanded="true"
        ></svg>
      </div>
      <div class="ModalDescription">
        We couldn't verify this address. Please check that your information is correct before continuing.
      </div>
      <br />
      <div class="ModalSubheader">
        You entered
      </div>
      <div class="ModalAddress"></div>
      <div
        class="Button ButtonPrimary"
        tabindex="0"
        role="button"
        aria-label="Use the address I provided"
      >
        Use the address I provided
      </div>
    </div>
  </div>
</template>
`),Tu,z0,I0,R0,D0,N0,i2=class extends Vh{constructor(){super(...arguments),Be(this,Tu,void 0),Be(this,z0,{}),this.update=o=>{const{ModalAddress:d}=O(this,Tu);d.innerHTML="",d.appendChild(e2(o))},Be(this,I0,()=>{this.dispatchEvent(new Ti("result","cancel"))}),this.reject=()=>{this.dispatchEvent(new Ti("result","nochange"))},Be(this,R0,af()),Be(this,D0,af()),Be(this,N0,af())}get template(){return PA}get templateStyle(){return uf}get templateUserStyle(){return bs(".MapboxAddressConfirmationNoFeature",this.theme)}get theme(){return O(this,z0)}set theme(o){if(At(this,z0,o),!O(this,Tu)||!o)return;this.updateTemplateUserStyle(bs(".MapboxAddressConfirmationNoFeature",o));const{IconQuestion:d,IconClose:m}=O(this,Tu);d.innerHTML=wo("question",o),m.innerHTML=wo("close",o)}connectedCallback(){super.connectedCallback(),At(this,Tu,cf(this,{Modal:".Modal",ModalHeaderTitle:".ModalHeaderTitle",IconQuestion:".IconQuestion",IconClose:".IconClose",ModalAddress:".ModalAddress",ButtonReject:".Button"}));const{Modal:o,ModalHeaderTitle:d,IconClose:m,ModalAddress:x,ButtonReject:C}=O(this,Tu);o.setAttribute("aria-labelledby",O(this,D0)),o.setAttribute("aria-describedby",O(this,N0)),m.setAttribute("aria-controls",O(this,R0)),o.id=O(this,R0),d.id=O(this,D0),x.id=O(this,N0);const k=Array.from(this.querySelectorAll('[role="button"]'));for(const l of k)l.addEventListener("keydown",Hw);m.addEventListener("click",O(this,I0)),C.addEventListener("click",this.reject);const E=this.theme;if(E){const{IconQuestion:l,IconClose:B}=O(this,Tu);l.innerHTML=wo("question",E),B.innerHTML=wo("close",E)}}disconnectedCallback(){const{IconClose:o,ButtonReject:d}=O(this,Tu);o.removeEventListener("click",O(this,I0)),d.removeEventListener("click",this.reject)}};Tu=new WeakMap;z0=new WeakMap;I0=new WeakMap;R0=new WeakMap;D0=new WeakMap;N0=new WeakMap;window.MapboxAddressConfirmationNoFeature=i2;window.customElements.get("mapbox-address-confirmation-no-feature")||customElements.define("mapbox-address-confirmation-no-feature",i2);var jA='input:-webkit-autofill,select:-webkit-autofill,textarea:-webkit-autofill{animation-name:onbrowserautofillstart}input:not(:-webkit-autofill),select:not(:-webkit-autofill),textarea:not(:-webkit-autofill){animation-name:onbrowserautofillcancel}@keyframes onbrowserautofillstart{0%{animation-name:"onbrowserautofillstart"}to{animation-name:"onbrowserautofillstart"}}@keyframes onbrowserautofillcancel{0%{animation-name:"onbrowserautofillcancel"}to{animation-name:"onbrowserautofillcancel"}}',t_="browser-autofilled",Cv=[];function zA(){window.dispatchEvent(new window.CustomEvent("browserautofill",{bubbles:!0,cancelable:!0,detail:{elements:Cv}})),Cv=[]}var IA=Ew(zA,5);function a2(o){o.hasAttribute(t_)||(o.setAttribute(t_,""),Cv.push(o),IA())}function n2(o){o.hasAttribute(t_)&&o.removeAttribute(t_)}function RA(o){o.animationName==="onbrowserautofillstart"?a2(o.target):n2(o.target)}function DA(o){const d=o.target;d.nodeName.toLowerCase()!=="select"&&!o.simulated&&!(o instanceof Ti)&&(o.inputType==="insertReplacementText"||!("data"in o))?a2(d):n2(d)}function NA(){Al.detectBrowserAutofillEnabled||(Al.detectBrowserAutofillEnabled=!0,z3(jA),document.addEventListener("animationstart",RA,!0),document.addEventListener("input",DA,!0))}var Ax=(o,d)=>{if(typeof o=="string")if(o==="ip"){const m=d==null?void 0:d.get("ip-proximity");return m&&typeof m=="string"?m.split(",").map(parseFloat):[999,999]}else return o.split(",").map(Number);else return sa.convert(o).toArray()},LA=o=>{const d={};return o.bbox&&(typeof o.bbox=="string"?d.bbox=o.bbox.split(",").map(Number):d.bbox=Vs.convert(o.bbox).toFlatArray()),o.proximity&&(d.proximity=Ax(o.proximity)),o.country&&(d.country=o.country.split(",")),o.language&&(d.language=o.language.split(",")),o.types&&(typeof o.types=="string"?d.types=o.types.split(","):d.types=Array.from(o.types)),o.limit&&(typeof o.limit=="string"?d.limit=parseInt(o.limit):d.limit=o.limit),d},OA=(o,d)=>{const m={};return o.bbox&&(typeof o.bbox=="string"?m.bbox=o.bbox.split(",").map(Number):m.bbox=Vs.convert(o.bbox).toFlatArray()),o.proximity&&(m.proximity=Ax(o.proximity,d)),o.country&&(m.country=o.country.split(",")),o.language&&(m.language=o.language.split(",")),o.types&&(typeof o.types=="string"?m.types=o.types.split(","):m.types=Array.from(o.types)),o.limit&&(typeof o.limit=="string"?m.limit=parseInt(o.limit):m.limit=o.limit),typeof o.autocomplete=="boolean"&&(m.autocomplete=o.autocomplete),o.worldview&&(m.worldview=o.worldview),o.permanent&&(m.permanent=o.permanent),m},BA=(o,d)=>{const m={};return o.bbox&&(typeof o.bbox=="string"?m.bbox=o.bbox.split(",").map(Number):m.bbox=Vs.convert(o.bbox).toFlatArray()),o.proximity&&(m.proximity=Ax(o.proximity,d)),o.country&&(m.country=o.country.split(",")),o.language&&(m.language=o.language.split(",")),o.limit&&(typeof o.limit=="string"?m.limit=parseInt(o.limit):m.limit=o.limit),o.streets!==void 0&&o.streets!==null&&(typeof o.streets=="string"?m.streets=o.streets==="true":m.streets=o.streets),m},FA=(o,d,m)=>{switch(d){case 2:return LA(o);case 1:return OA(o,m);case 0:return BA(o,m)}},UA=o=>({suggestionIds:o.map(d=>d.mapbox_id||""),suggestionNames:o.map(d=>d.feature_type==="poi"?[d.name,d.full_address].filter(Boolean).join(", "):d.full_address?d.full_address:d.name),suggestionTypes:o.map(d=>d.feature_type||""),suggestionSources:o.map(()=>"mapbox")}),VA=o=>({suggestionIds:o.map(d=>d.properties.mapbox_id||d.id||""),suggestionNames:o.map(d=>d.properties.full_address||""),suggestionTypes:o.map(d=>d.properties.feature_type||""),suggestionSources:o.map(()=>"mapbox")}),qA=o=>({suggestionIds:o.map(d=>d.mapbox_id||""),suggestionNames:o.map(d=>d.full_address||""),suggestionTypes:o.map(d=>{var m;return((m=d.place_type)==null?void 0:m[0])||""}),suggestionSources:o.map(()=>"mapbox")}),ZA=(o,d)=>{switch(d){case 2:return UA(o);case 1:return VA(o);case 0:return qA(o)}},v1=(o,d)=>{switch(o){case 2:return"search/searchbox/v1/suggest";case 1:return`search/geocode/v6/${/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/.test(d)?"reverse":"forward"}`;case 0:return"autofill/v1/suggest"}},Av,kv,Yd,L0,Pv,Kd,rg,ig,ag,ng,jv,xp,Mu,zv,Iv,Rv,sg,Dv,Nv,Lv,Ov,Bv,Fv,og,Qd,lg,kx=class{constructor(o){Be(this,Av,"https://api.mapbox.com"),Be(this,kv,"events/v2"),Be(this,Yd,void 0),Be(this,L0,void 0),Be(this,Pv,navigator.language||null),Be(this,Kd,[]),Be(this,rg,""),Be(this,ig,0),Be(this,ag,!0),Be(this,ng,1e3),Be(this,jv,100),Be(this,xp,void 0),Be(this,Mu,void 0),this.start=(d,m,x,C)=>{At(this,Yd,m.accessToken);const k=O(this,sg).call(this,"search.start",{queryString:d,options:m,map:x,responseHeaders:C});k&&O(this,lg).call(this,k)},this.input=(d,m,x,C,k)=>{if(At(this,Yd,x.accessToken),O(this,ag)&&(this.start(d,x,C,k),At(this,ag,!1)),!m)return;const E=O(this,sg).call(this,"search.keystroke",{lastInput:m,queryString:d,options:x,map:C,responseHeaders:k});E&&O(this,lg).call(this,E)},this.select=(d,m,x,C,k,E)=>{At(this,Yd,C.accessToken);const l=O(this,sg).call(this,"search.select",{queryString:d,selectedIndex:m,suggestions:x,options:C,map:k,responseHeaders:E});l&&(l.resultIndex===O(this,ig)&&l.queryString===O(this,rg)||l.resultIndex===-1||(At(this,ig,l.resultIndex),At(this,rg,l.queryString),O(this,lg).call(this,l)))},this.clear=()=>{At(this,ag,!0),At(this,rg,""),At(this,ig,0),O(this,Qd).call(this)},Be(this,zv,d=>{const m=`${O(this,Av)}/${O(this,kv)}?access_token=${O(this,Yd)}`,x=O(this,Iv).call(this,d);try{fetch(m,x)}catch(C){O(this,Rv).call(this,C)}}),Be(this,Iv,d=>(Array.isArray(d)||(d=[d]),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})),Be(this,Rv,d=>{console.log(d)}),Be(this,sg,(d,m)=>{if(d==="search.select"&&!(typeof m.selectedIndex=="number"||m.suggestions)||d==="search.keystroke"&&!m.lastInput)return null;const x=FA(m.options,O(this,Mu),m.responseHeaders),C=O(this,Dv).call(this,d,m,x);return d==="search.keystroke"?O(this,Nv).call(this,C,m,x):d==="search.select"&&O(this,Lv).call(this,C,m,x),O(this,Fv).call(this,C)?C:null}),Be(this,Dv,(d,m,x)=>{let C={event:d,version:O(this,Bv).call(this,d),created:+new Date,sessionIdentifier:m.options.sessionToken,userAgent:O(this,L0),keyboardLocale:O(this,Pv),queryString:m.queryString};if(x&&(C=Ir(Ir({},C),x)),d==="search.start")for(const k of["streets","permanent"])delete C[k];if(m.map){const k=m.map.getZoom()||void 0,E=m.map.getCenter();C=Zs(Ir({},C),{mapZoom:k,mapCenterLat:E.lat,mapCenterLng:E.lng})}return C}),Be(this,Nv,(d,m,x)=>{switch(O(this,Mu)){case 0:x.streets&&(d.streets=x.streets);break;case 1:x.permanent&&(d.permanent=x.permanent);break}d.path=v1(O(this,Mu),m.queryString),d.lastAction=m.lastInput}),Be(this,Lv,(d,m,x)=>{switch(O(this,Mu)){case 0:x.streets&&(d.streets=x.streets);break;case 1:x.permanent&&(d.permanent=x.permanent);break}d.path=v1(O(this,Mu),m.queryString);const{selectedIndex:C,suggestions:k}=m;if(k&&k.length>0){const E=ZA(k,O(this,Mu));d.resultIndex=C,d.resultPlaceName=E.suggestionNames[C],d.resultId=E.suggestionIds[C],d.resultId.startsWith("dXJuOm1ie")&&(d.resultMapboxId=d.resultId),d.suggestionIds=E.suggestionIds,d.suggestionNames=E.suggestionNames,d.suggestionTypes=E.suggestionTypes,d.suggestionSources=E.suggestionSources}}),Be(this,Ov,()=>`mapbox.${Y3.split("/")[1]}.${p_}.${navigator.userAgent}`),Be(this,Bv,d=>["search.keystroke","search.select"].includes(d)?"2.2":"2.0"),Be(this,Fv,d=>{if(!d||!d.event)return!1;const m=["event","created","sessionIdentifier","queryString"],x=["event","created","sessionIdentifier","queryString","lastAction"],C=["event","created","sessionIdentifier","queryString","resultIndex","path","suggestionIds"],k=d.event;return k==="search.start"?O(this,og).call(this,d,m):k==="search.keystroke"?O(this,og).call(this,d,x):k==="search.select"?O(this,og).call(this,d,C):!0}),Be(this,og,(d,m)=>m.every(x=>x==="queryString"?typeof d[x]=="string"&&d[x].length>0:d[x]!==void 0)),Be(this,Qd,()=>{O(this,Kd).length>0&&O(this,Yd)&&(O(this,zv).call(this,O(this,Kd)),At(this,Kd,[])),O(this,xp)&&clearTimeout(O(this,xp)),O(this,ng)&&At(this,xp,setTimeout(O(this,Qd),O(this,ng)))}),Be(this,lg,(d,m)=>{O(this,Kd).push(d),(O(this,Kd).length>=O(this,jv)||m)&&O(this,Qd).call(this)}),this.remove=()=>{O(this,Qd).call(this)},At(this,Mu,o),At(this,L0,O(this,Ov).call(this)),At(this,xp,setTimeout(O(this,Qd),O(this,ng)))}};Av=new WeakMap;kv=new WeakMap;Yd=new WeakMap;L0=new WeakMap;Pv=new WeakMap;Kd=new WeakMap;rg=new WeakMap;ig=new WeakMap;ag=new WeakMap;ng=new WeakMap;jv=new WeakMap;xp=new WeakMap;Mu=new WeakMap;zv=new WeakMap;Iv=new WeakMap;Rv=new WeakMap;sg=new WeakMap;Dv=new WeakMap;Nv=new WeakMap;Lv=new WeakMap;Ov=new WeakMap;Bv=new WeakMap;Fv=new WeakMap;og=new WeakMap;Qd=new WeakMap;lg=new WeakMap;var jh,gs,ys,ui,bp,zh,cg,O0,B0,ug,F0,U0,V0,q0,Z0,$0,G0,Uv,Px=class extends Vh{constructor(){super(...arguments),Be(this,jh,new _w),Be(this,gs,new mx(O(this,jh))),Be(this,ys,void 0),Be(this,ui,new Eg),Be(this,bp,new kx(0)),Be(this,zh,void 0),this.options={},this.confirmOnBrowserAutofill=!1,Be(this,cg,!1),Be(this,O0,o=>{const d=o!=null&&o.suggestions?xA(o.suggestions):null;O(this,ui).handleSuggest(d),this.dispatchEvent(new Ti("suggest",o))}),Be(this,B0,o=>{O(this,ui).handleError(),this.dispatchEvent(new Ti("suggesterror",o))}),Be(this,ug,o=>{var d;if(this.dispatchEvent(new Ti("retrieve",o)),this.retrieveFeature=(d=o.features)==null?void 0:d[0],!O(this,ys))return;const m=o;!m||!m.features||!m.features.length||Jw(m.features[0],O(this,ys))}),Be(this,F0,()=>{var o;try{const d=(o=this.querySelector("input"))!=null?o:null;At(this,ys,d),O(this,ui).input=d}catch(d){At(this,ys,null),O(this,ui).input=null,console.error(d.message||d)}}),Be(this,U0,new MutationObserver(O(this,F0))),Be(this,V0,o=>{O(this,ui).blur(),MA(O(this,ys),o,this.confirmOnBrowserAutofill,this.accessToken)}),this.retrieveFeature=null,this.interceptSearch=null,Be(this,q0,o=>{this.dispatchEvent(new Ti("input",o.detail.inputText));const{lastInput:d,inputText:m}=o.detail,x=this.browserAutofillEnabled===!0&&(m==null?void 0:m.length)<=2;if(Ip(O(this,ys),O(this,zh),x),!m){O(this,Uv).call(this);return}const C=this.interceptSearch&&this.interceptSearch(m),k=this.interceptSearch?C:m;if(this.interceptSearch&&!C||(k==null?void 0:k.length)<=2){O(this,ui).handleSuggest(null);return}O(this,gs).suggest(k,this.options),O(this,bp).input(k,d,Zs(Ir({},this.options),{sessionToken:O(this,gs).sessionToken,accessToken:this.accessToken}),null,O(this,jh).responseHeaders)}),Be(this,Z0,o=>{const{suggestion:d,selectedIndex:m}=o.detail;d.accuracy!=="street"?(Ip(O(this,ys),O(this,zh),!0),O(this,gs).retrieve(d,this.options),O(this,bp).select(this.input.value,m,O(this,ui).suggestions,Zs(Ir({},this.options),{sessionToken:O(this,gs).sessionToken,accessToken:this.accessToken}),null,O(this,jh).responseHeaders)):bA(O(this,ys),O(this,zh),d)}),Be(this,$0,()=>{Ip(O(this,ys),O(this,zh),!0),O(this,gs).abort()}),Be(this,G0,()=>{var o;const d=this.browserAutofillEnabled===!0&&((o=O(this,ys).value)==null?void 0:o.length)<=2;Ip(O(this,ys),O(this,zh),d)}),Be(this,Uv,()=>{O(this,ui).handleSuggest(null),O(this,bp).clear()})}get accessToken(){return O(this,jh).accessToken}set accessToken(o){O(this,jh).accessToken=o}get input(){return O(this,ys)}get theme(){return O(this,ui).theme}set theme(o){O(this,ui).theme=o}get popoverOptions(){return O(this,ui).popoverOptions}set popoverOptions(o){O(this,ui).popoverOptions=o}get browserAutofillEnabled(){return O(this,cg)}set browserAutofillEnabled(o){At(this,cg,o)}connectedCallback(){var o;super.connectedCallback(),Al.autofillSessionEnabled=!0,O(this,gs).sessionToken=Al.autofillSessionToken.id,O(this,ui).autofillHost=this,O(this,ui).searchService=0;const d=(o=this.querySelector("input"))!=null?o:null;O(this,U0).observe(this,{subtree:!0,childList:!0}),O(this,F0).call(this),O(this,ui).addEventListener("input",O(this,q0)),O(this,ui).addEventListener("select",O(this,Z0)),O(this,ui).addEventListener("blur",O(this,$0)),O(this,ui).addEventListener("focus",O(this,G0)),O(this,gs).addEventListener("suggest",O(this,O0)),O(this,gs).addEventListener("suggesterror",O(this,B0)),O(this,gs).addEventListener("retrieve",O(this,ug)),document.body.appendChild(O(this,ui)),d&&(d.insertAdjacentElement("beforebegin",Mx(O(this,ui).dataSeed)),oA(d),At(this,zh,d.autocomplete)),NA(),window.addEventListener("browserautofill",O(this,V0))}disconnectedCallback(){O(this,ui).remove(),O(this,ui).removeEventListener("input",O(this,q0)),O(this,ui).removeEventListener("select",O(this,Z0)),O(this,ui).removeEventListener("blur",O(this,$0)),O(this,ui).removeEventListener("focus",O(this,G0)),O(this,gs).removeEventListener("suggest",O(this,O0)),O(this,gs).removeEventListener("suggesterror",O(this,B0)),O(this,gs).removeEventListener("retrieve",O(this,ug)),O(this,bp).remove(),O(this,U0).disconnect(),window.removeEventListener("browserautofill",O(this,V0))}attributeChangedCallback(o,d,m){if(o==="access-token"){O(this,jh).accessToken=m;return}if(o==="browser-autofill-enabled"){At(this,cg,!!m);return}if(o==="theme"){this.theme=Op(m);return}if(o==="popover-options"){this.popoverOptions=Op(m);return}const x=o.split("-").join("_");m||delete this.options[x],this.options[x]=m}focus(){O(this,ui).focus()}simulateRetrieve(o){const d=this.input;d&&(d.dataset.mapboxSuccess="true"),O(this,ui).hideResults();const m={type:"FeatureCollection",features:[o],url:""};O(this,ug).call(this,m)}};jh=new WeakMap;gs=new WeakMap;ys=new WeakMap;ui=new WeakMap;bp=new WeakMap;zh=new WeakMap;cg=new WeakMap;O0=new WeakMap;B0=new WeakMap;ug=new WeakMap;F0=new WeakMap;U0=new WeakMap;V0=new WeakMap;q0=new WeakMap;Z0=new WeakMap;$0=new WeakMap;G0=new WeakMap;Uv=new WeakMap;Px.observedAttributes=["access-token","browser-autofill-enabled","theme","popover-options","css-text","language","country","bbox","limit","proximity","streets"];window.MapboxAddressAutofill=Px;window.customElements.get("mapbox-address-autofill")||customElements.define("mapbox-address-autofill",Px);var $A={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"לחפש",ja:"サーチ",lv:"Meklēt",pt:"Procurar",sr:"Претрага",zh:"搜索",cs:"Vyhledávání",hu:"Keresés",ka:"ძიება",nb:"Søke",sk:"Vyhľadávanie",th:"ค้นหา",fi:"Hae",is:"Leita",ko:"수색",pl:"Szukaj",sl:"Iskanje",fa:"جستجو",ru:"Поиск"},s2={placeholder:$A},GA=9,Tc,wp,_s,Ml,Mc,ji,Sp,Vv,o2,Tp,H0,W0,X0,Jd,Y0,K0,hg,Q0,J0,Ih,ey,ty,jx=class extends Vh{constructor(){super(...arguments),Be(this,Vv),Be(this,Tc,void 0),Be(this,wp,new xw({})),Be(this,_s,new mx(O(this,wp))),Be(this,Ml,null),Be(this,Mc,void 0),Be(this,ji,new Eg),Be(this,Sp,new kx(2)),this.options={},Be(this,Tp,void 0),Be(this,H0,o=>{O(this,Ih).call(this),O(this,ji).handleSuggest((o==null?void 0:o.suggestions)||null),this.dispatchEvent(new Ti("suggest",o))}),Be(this,W0,o=>{O(this,Ih).call(this),O(this,ji).handleError(),this.dispatchEvent(new Ti("suggesterror",o))}),Be(this,X0,o=>{O(this,Ih).call(this),this.dispatchEvent(new Ti("retrieve",o));const d=o;if(!d||!d.features.length)return;const m=gx(d.features[0]);O(this,Mc).value=m.name;const x=O(this,Ml);if(!x)return;const C=d.features[0];if(!C)return;const k=C.properties.feature_type,E=C.properties.bbox;if(E)x.flyTo(qw(x,Vs.convert(E).toFlatArray()));else{const l=C.geometry.coordinates,B=Zw(k);x.flyTo({center:l,zoom:B,speed:bx})}this.marker&&this.mapboxgl&&O(this,K0).call(this,C)}),Be(this,Jd,void 0),Be(this,Y0,()=>{O(this,Jd)&&(O(this,Jd).remove(),At(this,Jd,null))}),Be(this,K0,o=>{if(!O(this,Ml)||(O(this,Y0).call(this),!o))return;const m=Ir(Ir({},{color:"#4668F2"}),typeof this.marker=="object"&&this.marker);At(this,Jd,new this.mapboxgl.Marker(m)),o.geometry&&o.geometry.type&&o.geometry.type==="Point"&&o.geometry.coordinates&&O(this,Jd).setLngLat(o.geometry.coordinates).addTo(O(this,Ml))}),this.interceptSearch=null,Be(this,hg,o=>{this.dispatchEvent(new Ti("input",o.detail.inputText));const{lastInput:d,inputText:m}=o.detail;if(!m){O(this,ey).call(this);return}const x=this.interceptSearch&&this.interceptSearch(m),C=this.interceptSearch?x:m;if(this.interceptSearch&&!x){O(this,ji).hideResults();return}O(this,_s).suggest(C,this.options),O(this,Sp).input(C,d,Zs(Ir({},this.options),{sessionToken:O(this,_s).sessionToken,accessToken:this.accessToken}),O(this,Ml)),O(this,Ih).call(this,!0)}),Be(this,Q0,o=>{const{suggestion:d,selectedIndex:m}=o.detail;O(this,_s).retrieve(d,this.options),O(this,Sp).select(this.value,m,O(this,ji).suggestions,Zs(Ir({},this.options),{sessionToken:O(this,_s).sessionToken,accessToken:this.accessToken}),O(this,Ml)),O(this,Ih).call(this,!0)}),Be(this,J0,()=>{O(this,_s).abort()}),Be(this,Ih,(o=!1)=>{o?(O(this,Tc).ClearBtn.style.display="none",O(this,Tc).LoadingIcon.style.display="block"):(O(this,Tc).LoadingIcon.style.display="none",O(this,Tc).ClearBtn.style.display=this.value?"block":"none")}),Be(this,ey,()=>{this.value="",O(this,Ih).call(this),O(this,K0).call(this,null),O(this,ji).handleSuggest(null),O(this,Sp).clear(),O(this,_s).incrementSession(),this.dispatchEvent(new Ti("clear"))}),this.marker=!0,Be(this,ty,()=>{const o=O(this,Ml),d=Ir({},this.options);if(o.getZoom()<=GA){delete d.proximity,this.options=d;return}const m=o.getCenter();this.options=Zs(Ir({},d),{proximity:m})})}get accessToken(){return O(this,wp).accessToken}set accessToken(o){O(this,wp).accessToken=o}get value(){return O(this,Mc).value}set value(o){O(this,Mc).value=o||""}get input(){return O(this,Mc)}get template(){return U3}get templateStyle(){return uf}get templateUserStyle(){return bs(".SearchBox",O(this,ji).theme)}get theme(){return O(this,ji).theme}set theme(o){if(O(this,ji).theme=o,!O(this,Tc)||!o)return;this.updateTemplateUserStyle(bs(".SearchBox",o)),O(this,ji).updatePopover();const{SearchIcon:d}=O(this,Tc);d.innerHTML=wo("search",o)}get popoverOptions(){return O(this,ji).popoverOptions}set popoverOptions(o){O(this,ji).popoverOptions=o}get placeholder(){return O(this,Tp)||_g(this,Vv,o2).call(this)}set placeholder(o){At(this,Tp,o),O(this,Mc)&&(O(this,Mc).placeholder=this.placeholder,O(this,Mc).setAttribute("aria-label",this.placeholder))}connectedCallback(){super.connectedCallback(),At(this,Tc,cf(this,{SearchBox:".SearchBox",SearchIcon:".SearchIcon",Input:".Input",ClearBtn:".ClearBtn",LoadingIcon:".LoadingIcon"})),this.theme=Ir({},this.theme);const{Input:o,ClearBtn:d}=O(this,Tc);At(this,Mc,o),O(this,ji).input=o,O(this,ji).searchService=2,O(this,ji).addEventListener("input",O(this,hg)),O(this,ji).addEventListener("select",O(this,Q0)),O(this,ji).addEventListener("blur",O(this,J0)),O(this,_s).addEventListener("suggest",O(this,H0)),O(this,_s).addEventListener("suggesterror",O(this,W0)),O(this,_s).addEventListener("retrieve",O(this,X0)),d.addEventListener("click",O(this,ey)),this.placeholder=O(this,Tp),this.parentElement.appendChild(O(this,ji)),o&&(o.previousElementSibling.hasAttribute("aria-live")&&o.previousElementSibling.remove(),o.insertAdjacentElement("beforebegin",Mx(O(this,ji).dataSeed)))}disconnectedCallback(){O(this,ji).remove(),O(this,ji).input=null,O(this,ji).removeEventListener("input",O(this,hg)),O(this,ji).removeEventListener("select",O(this,Q0)),O(this,ji).removeEventListener("blur",O(this,J0)),O(this,_s).removeEventListener("suggest",O(this,H0)),O(this,_s).removeEventListener("suggesterror",O(this,W0)),O(this,_s).removeEventListener("retrieve",O(this,X0)),O(this,Sp).remove()}attributeChangedCallback(o,d,m){if(o==="access-token"){O(this,wp).accessToken=m;return}if(o==="theme"){this.theme=Op(m);return}if(o==="popover-options"){this.popoverOptions=Op(m);return}if(o==="placeholder"){this.placeholder=m;return}const x=o.split("-").join("_");m||delete this.options[x],this.options[x]=m,x==="language"&&(this.placeholder=O(this,Tp))}focus(){O(this,ji).focus()}search(o){this.value=o;const d={lastInput:o,inputText:o};O(this,hg).call(this,new Ti("input",d))}bindMap(o){O(this,Ml)&&O(this,Ml).off("moveend",O(this,ty)),o&&o.on("moveend",O(this,ty)),At(this,Ml,o)}unbindMap(){this.bindMap(null)}onAdd(o){this.bindMap(o),this.remove();const d=document.createElement("div");return d.className="mapboxgl-ctrl",d.style.width="300px",d.appendChild(this),d}onRemove(){this.remove(),this.unbindMap(),O(this,Y0).call(this)}getDefaultPosition(){return"top-right"}};Tc=new WeakMap;wp=new WeakMap;_s=new WeakMap;Ml=new WeakMap;Mc=new WeakMap;ji=new WeakMap;Sp=new WeakMap;Vv=new WeakSet;o2=function(){if(this.options.language){const o=this.options.language.split(",")[0],d=Fw.language(o),m=s2.placeholder[d];if(m)return m}return"Search"};Tp=new WeakMap;H0=new WeakMap;W0=new WeakMap;X0=new WeakMap;Jd=new WeakMap;Y0=new WeakMap;K0=new WeakMap;hg=new WeakMap;Q0=new WeakMap;J0=new WeakMap;Ih=new WeakMap;ey=new WeakMap;ty=new WeakMap;jx.observedAttributes=["access-token","theme","popover-options","placeholder","language","country","bbox","limit","navigation-profile","origin","proximity","eta-type","types"];window.MapboxSearchBox=jx;window.customElements.get("mapbox-search-box")||customElements.define("mapbox-search-box",jx);var HA=9,Ec,Rh,vs,El,Cc,zi,Mp,qv,l2,Ep,ry,iy,ay,ef,ny,sy,dg,oy,ly,Dh,cy,uy,zx=class extends Vh{constructor(){super(...arguments),Be(this,qv),Be(this,Ec,void 0),Be(this,Rh,new RC({})),Be(this,vs,new mx(O(this,Rh))),Be(this,El,null),Be(this,Cc,void 0),Be(this,zi,new Eg),Be(this,Mp,new kx(1)),this.options={},Be(this,Ep,void 0),Be(this,ry,o=>{O(this,Dh).call(this),O(this,zi).handleSuggest((o==null?void 0:o.features)||null),this.dispatchEvent(new Ti("suggest",o))}),Be(this,iy,o=>{O(this,Dh).call(this),O(this,zi).handleError(),this.dispatchEvent(new Ti("suggesterror",o))}),Be(this,ay,o=>{O(this,Dh).call(this),this.dispatchEvent(new Ti("retrieve",o));const d=o;if(!d)return;O(this,Cc).value=d.properties.full_address;const m=O(this,El);if(!m)return;const x=d.properties.feature_type,C=d.properties.bbox;if(C)m.flyTo(qw(m,Vs.convert(C).toFlatArray()));else{const k=d.geometry.coordinates,E=Zw(x);m.flyTo({center:k,zoom:E,speed:bx})}this.marker&&this.mapboxgl&&O(this,sy).call(this,d)}),Be(this,ef,void 0),Be(this,ny,()=>{O(this,ef)&&(O(this,ef).remove(),At(this,ef,null))}),Be(this,sy,o=>{if(!O(this,El)||(O(this,ny).call(this),!o))return;const m=Ir(Ir({},{color:"#4668F2"}),typeof this.marker=="object"&&this.marker);At(this,ef,new this.mapboxgl.Marker(m)),o.geometry&&o.geometry.type&&o.geometry.type==="Point"&&o.geometry.coordinates&&O(this,ef).setLngLat(o.geometry.coordinates).addTo(O(this,El))}),this.interceptSearch=null,Be(this,dg,o=>{this.dispatchEvent(new Ti("input",o.detail.inputText));const{lastInput:d,inputText:m}=o.detail;if(!m){O(this,cy).call(this);return}const x=this.interceptSearch&&this.interceptSearch(m),C=this.interceptSearch?x:m;if(this.interceptSearch&&!x){O(this,zi).hideResults();return}O(this,vs).suggest(C,this.options),O(this,Mp).input(C,d,Zs(Ir({},this.options),{sessionToken:O(this,vs).sessionToken,accessToken:this.accessToken}),O(this,El),O(this,Rh).responseHeaders),O(this,Dh).call(this,!0)}),Be(this,oy,o=>{const{suggestion:d,selectedIndex:m}=o.detail;O(this,vs).retrieve(d,this.options),O(this,Mp).select(this.value,m,O(this,zi).suggestions,Zs(Ir({},this.options),{sessionToken:O(this,vs).sessionToken,accessToken:this.accessToken}),O(this,El),O(this,Rh).responseHeaders),O(this,Dh).call(this,!0)}),Be(this,ly,()=>{O(this,vs).abort()}),Be(this,Dh,(o=!1)=>{o?(O(this,Ec).ClearBtn.style.display="none",O(this,Ec).LoadingIcon.style.display="block"):(O(this,Ec).LoadingIcon.style.display="none",O(this,Ec).ClearBtn.style.display=this.value?"block":"none")}),Be(this,cy,()=>{this.value="",O(this,Dh).call(this),O(this,sy).call(this,null),O(this,zi).handleSuggest(null),O(this,Mp).clear(),O(this,vs).incrementSession(),this.dispatchEvent(new Ti("clear"))}),this.marker=!0,Be(this,uy,()=>{const o=O(this,El),d=Ir({},this.options);if(o.getZoom()<=HA){delete d.proximity,this.options=d;return}const m=o.getCenter();this.options=Zs(Ir({},d),{proximity:m})})}get accessToken(){return O(this,Rh).accessToken}set accessToken(o){O(this,Rh).accessToken=o}get value(){return O(this,Cc).value}set value(o){O(this,Cc).value=o||""}get input(){return O(this,Cc)}get template(){return V3}get templateStyle(){return uf}get templateUserStyle(){return bs(".Geocoder",O(this,zi).theme)}get theme(){return O(this,zi).theme}set theme(o){if(O(this,zi).theme=o,!O(this,Ec)||!o)return;this.updateTemplateUserStyle(bs(".Geocoder",o)),O(this,zi).updatePopover();const{SearchIcon:d}=O(this,Ec);d.innerHTML=wo("search",o)}get popoverOptions(){return O(this,zi).popoverOptions}set popoverOptions(o){O(this,zi).popoverOptions=o}get placeholder(){return O(this,Ep)||_g(this,qv,l2).call(this)}set placeholder(o){At(this,Ep,o),O(this,Cc)&&(O(this,Cc).placeholder=this.placeholder,O(this,Cc).setAttribute("aria-label",this.placeholder))}connectedCallback(){super.connectedCallback(),At(this,Ec,cf(this,{Geocoder:".Geocoder",SearchIcon:".SearchIcon",Input:".Input",ClearBtn:".ClearBtn",LoadingIcon:".LoadingIcon"})),this.theme=Ir({},this.theme);const{Input:o,ClearBtn:d}=O(this,Ec);At(this,Cc,o),O(this,zi).input=o,O(this,zi).searchService=1,O(this,zi).addEventListener("input",O(this,dg)),O(this,zi).addEventListener("select",O(this,oy)),O(this,zi).addEventListener("blur",O(this,ly)),O(this,vs).addEventListener("suggest",O(this,ry)),O(this,vs).addEventListener("suggesterror",O(this,iy)),O(this,vs).addEventListener("retrieve",O(this,ay)),d.addEventListener("click",O(this,cy)),this.placeholder=O(this,Ep),this.parentElement.appendChild(O(this,zi)),o&&(o.previousElementSibling.hasAttribute("aria-live")&&o.previousElementSibling.remove(),o.insertAdjacentElement("beforebegin",Mx(O(this,zi).dataSeed)))}disconnectedCallback(){O(this,zi).remove(),O(this,zi).input=null,O(this,zi).removeEventListener("input",O(this,dg)),O(this,zi).removeEventListener("select",O(this,oy)),O(this,zi).removeEventListener("blur",O(this,ly)),O(this,vs).removeEventListener("suggest",O(this,ry)),O(this,vs).removeEventListener("suggesterror",O(this,iy)),O(this,vs).removeEventListener("retrieve",O(this,ay)),O(this,Mp).remove()}attributeChangedCallback(o,d,m){if(o==="access-token"){O(this,Rh).accessToken=m;return}if(o==="theme"){this.theme=Op(m);return}if(o==="popover-options"){this.popoverOptions=Op(m);return}if(o==="placeholder"){this.placeholder=m;return}const x=o.split("-").join("_");m||delete this.options[x],this.options[x]=m,x==="language"&&(this.placeholder=O(this,Ep))}focus(){O(this,zi).focus()}search(o){this.value=o;const d={lastInput:o,inputText:o};O(this,dg).call(this,new Ti("input",d))}bindMap(o){O(this,El)&&O(this,El).off("moveend",O(this,uy)),o&&o.on("moveend",O(this,uy)),At(this,El,o)}unbindMap(){this.bindMap(null)}onAdd(o){this.bindMap(o),this.remove();const d=document.createElement("div");return d.className="mapboxgl-ctrl",d.style.width="300px",d.appendChild(this),d}onRemove(){this.remove(),this.unbindMap(),O(this,ny).call(this)}getDefaultPosition(){return"top-right"}};Ec=new WeakMap;Rh=new WeakMap;vs=new WeakMap;El=new WeakMap;Cc=new WeakMap;zi=new WeakMap;Mp=new WeakMap;qv=new WeakSet;l2=function(){if(this.options.language){const o=this.options.language.split(",")[0],d=Fw.language(o),m=s2.placeholder[d];if(m)return m}return"Search"};Ep=new WeakMap;ry=new WeakMap;iy=new WeakMap;ay=new WeakMap;ef=new WeakMap;ny=new WeakMap;sy=new WeakMap;dg=new WeakMap;oy=new WeakMap;ly=new WeakMap;Dh=new WeakMap;cy=new WeakMap;uy=new WeakMap;zx.observedAttributes=["access-token","theme","popover-options","placeholder","autocomplete","language","country","bbox","limit","proximity","types","worldview","permanent"];window.MapboxGeocoder=zx;window.customElements.get("mapbox-geocoder")||customElements.define("mapbox-geocoder",zx);var x1=new S3({size:512,antimeridian:!0}),dp=1280;function b1(o,d){const{width:m,height:x}=Uw(o,!0);switch(d){case"center":return[0,0];case"top":return[0,x/2];case"bottom":return[0,-1*x/2];case"left":return[m/2,0];case"right":return[-1*m/2,0];case"top-left":return[m/2,x/2];case"top-right":return[-1*m/2,x/2];case"bottom-left":return[m/2,-1*x/2];case"bottom-right":return[-1*m/2,-1*x/2]}}var hy,Zv,Cp,dy,fy,$v,py,my,Gv,gy,yy,Ap,Hv,_y,WA=class{constructor(o,d,m,x,C,k){Be(this,hy,void 0),Be(this,Zv,()=>{[this.anchorOffsetX,this.anchorOffsetY]=b1(this.markerElement,this.anchor),this.markerTransform={anchorX:this.anchorOffsetX,anchorY:this.anchorOffsetY}}),Be(this,Cp,{anchorX:0,anchorY:0,globalX:0,globalY:0,correctionX:0,correctionY:0}),Be(this,dy,!1),Be(this,fy,void 0),Be(this,$v,l=>{this.isActive&&(l.preventDefault(),l.stopPropagation(),O(this,Ap).call(this,l),window.addEventListener("pointermove",O(this,my)),window.addEventListener("pointerup",O(this,py)))}),Be(this,py,()=>{window.removeEventListener("pointermove",O(this,my)),window.removeEventListener("pointerup",O(this,py))}),Be(this,my,l=>{l.preventDefault(),l.stopPropagation();const B=this.curPointerXPos-l.pageX,V=this.curPointerYPos-l.pageY;this.markerDeltaX+=B,this.markerDeltaY-=V,this.markerDeltaX=Math.max(Math.min(this.imgElement.width/2,this.markerDeltaX),this.imgElement.width/2*-1),this.markerDeltaY=Math.max(Math.min(this.imgElement.height/2,this.markerDeltaY),this.imgElement.height/2*-1);const X=this.imgCenterPx[0]-this.imgCenterAdjustedPx[0],ne=this.imgCenterPx[1]-this.imgCenterAdjustedPx[1],re=this.markerDeltaX-X,ee=this.markerDeltaY+ne;this.markerTransform={globalX:re,globalY:ee},O(this,Ap).call(this,l)}),Be(this,Gv,l=>{this.isActive&&(l.preventDefault(),l.stopPropagation(),O(this,Ap).call(this,l),window.addEventListener("pointermove",O(this,yy)),window.addEventListener("pointerup",O(this,gy)))}),Be(this,gy,()=>{window.removeEventListener("pointermove",O(this,yy)),window.removeEventListener("pointerup",O(this,gy))}),Be(this,yy,l=>{l.preventDefault();let B=Math.round(this.imgContainerElement.scrollTop+(this.curPointerYPos-l.pageY));B=Math.max(Math.min(this.imgElement.height-this.imgContainerElement.clientHeight,B),0);let V=Math.round(this.imgContainerElement.scrollLeft+(this.curPointerXPos-l.pageX));V=Math.max(Math.min(this.imgElement.width-this.imgContainerElement.clientWidth,V),0),this.imgContainerElement.scrollTop=B,this.imgContainerElement.scrollLeft=V;const X=Math.round(V-(this.imgElement.width-this.imgContainerElement.clientWidth)/2),ne=Math.round((this.imgElement.height-this.imgContainerElement.clientHeight)/2-B);if(this.imgCenterAdjustedPx=[this.imgCenterPx[0]+X,this.imgCenterPx[1]-ne],!this.keepMarkerCentered){const re=this.markerDeltaX+X,ee=this.markerDeltaY+ne;this.markerTransform={globalX:re,globalY:ee}}O(this,_y).call(this,V,B),O(this,Ap).call(this,l)}),Be(this,Ap,l=>{this.curPointerXPos=l.pageX,this.curPointerYPos=l.pageY}),Be(this,Hv,()=>{const{anchorX:l,anchorY:B,globalX:V,globalY:X,correctionX:ne,correctionY:re}=O(this,Cp),ee=l-V+ne,te=B+X+re;this.markerElement.style.transform=`translate(calc(-50% + ${ee}px), calc(-50% + ${te}px))`}),this.reCenter=()=>{const l=(this.imgElement.height-this.imgContainerElement.clientHeight)/2,B=(this.imgElement.width-this.imgContainerElement.clientWidth)/2;this.imgContainerElement.scrollTop=l,this.imgContainerElement.scrollLeft=B,this.imgCenterAdjustedPx=this.imgCenterPx,this.markerDeltaX=this.markerDeltaY=0,this.markerTransform={globalX:0,globalY:0,correctionX:0,correctionY:0}},this.handleMinimapResize=()=>{if(!this.imgElement.height||!this.imgElement.width)return;const l=this.imgCenterOffset.x,B=this.imgCenterOffset.y,V=this.imgElement.width/2-l-this.imgContainerElement.clientWidth/2,X=this.imgElement.height/2-B-this.imgContainerElement.clientHeight/2;this.imgContainerElement.scrollLeft=V,this.imgContainerElement.scrollTop=X,O(this,_y).call(this,V,X)},Be(this,_y,(l,B)=>{const V=this.imgCenterOffset.x,X=this.imgCenterOffset.y,{correctionX:ne,correctionY:re}=this.markerTransform,ee={};if(l/2<V*-1){const te=V*-1-l/2;ee.correctionX=te*2}else l<0?ee.correctionX=l:ne!==0&&(ee.correctionX=0);if(B/2<X*-1){const te=X*-1-B/2;ee.correctionY=te*2}else B<0?ee.correctionY=B:re!==0&&(ee.correctionY=0);this.markerTransform=ee}),this.markerElement=m,this.imgContainerElement=o,this.imgElement=d,this.keepMarkerCentered=x,this.zoom=C,this.anchor=k,this.curPointerXPos=0,this.curPointerYPos=0,this.markerDeltaX=0,this.markerDeltaY=0,this.imgContainerElement.addEventListener("pointerdown",O(this,Gv)),this.keepMarkerCentered||this.markerElement.addEventListener("pointerdown",O(this,$v)),new ResizeObserver(O(this,Zv)).observe(this.markerElement)}get anchor(){return O(this,hy)}set anchor(o){At(this,hy,o),[this.anchorOffsetX,this.anchorOffsetY]=b1(this.markerElement,o),this.markerTransform={anchorX:this.anchorOffsetX,anchorY:this.anchorOffsetY}}get markerTransform(){return O(this,Cp)}set markerTransform(o){At(this,Cp,Ir(Ir({},O(this,Cp)),o)),O(this,Hv).call(this)}get isActive(){return O(this,dy)}set isActive(o){this.imgContainerElement.style.touchAction=o?"none":"",At(this,dy,o)}get coordinate(){const o=this.keepMarkerCentered?this.imgCenterAdjustedPx:[this.imgCenterPx[0]-this.markerDeltaX,this.imgCenterPx[1]+this.markerDeltaY];if(Sx(o,this.imgCenterPx))return O(this,fy);{const d=x1.ll(o,this.zoom);return[g1(d[0],6),g1(d[1],6)]}}set coordinate(o){At(this,fy,o),this.imgCenterPx=this.imgCenterAdjustedPx=x1.px(o,this.zoom)}get imgCenterOffset(){return{x:this.imgCenterPx[0]-this.imgCenterAdjustedPx[0],y:this.imgCenterPx[1]-this.imgCenterAdjustedPx[1]}}};hy=new WeakMap;Zv=new WeakMap;Cp=new WeakMap;dy=new WeakMap;fy=new WeakMap;$v=new WeakMap;py=new WeakMap;my=new WeakMap;Gv=new WeakMap;gy=new WeakMap;yy=new WeakMap;Ap=new WeakMap;Hv=new WeakMap;_y=new WeakMap;var XA='<svg width="88" height="23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill-rule="evenodd"><defs><path id="g" d="M11.5 2.25a9.25 9.25 0 1 1 0 18.5 9.25 9.25 0 0 1 0-18.5zM7 15.98c-.05-.33-.83-5.8 2.23-8.87a4.4 4.4 0 0 1 3.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39a4.4 4.4 0 0 1-1.28 3.13C12.72 16.93 7 16 7 16v-.02zm8.3-5.48-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z"/><path id="b" d="M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19A3.77 3.77 0 0 1 50.86 15v3.77c0 .13-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01.01-.01c.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V15a3.7 3.7 0 0 1-2.73 1.19c-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.38-.19a4.24 4.24 0 0 0-4.16 3.29 4.07 4.07 0 0 0 0 1.77 4.23 4.23 0 0 0 4.17 3.3 4.22 4.22 0 0 0 4.26-4.19 4.2 4.2 0 0 0-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18a4 4 0 0 1 3.84 3.28c.13.59.13 1.2 0 1.8a4 4 0 0 1-3.84 3.29A3.77 3.77 0 0 1 60.86 15v.77c0 .12-.1.23-.23.23h-1.4a.23.23 0 0 1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4a.23.23 0 0 1-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55a2.73 2.73 0 0 1 2.44-1.56c1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41a.23.23 0 0 1-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41a.23.23 0 0 1-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.62 0h-1.61a.27.27 0 0 1-.12-.03c-.1-.06-.13-.19-.06-.28l2.43-3.71-2.4-3.65a.21.21 0 0 1-.02-.12.2.2 0 0 1 .2-.21h1.61c.13 0 .24.06.3.17L82 10.54l1.4-2.37a.34.34 0 0 1 .3-.17h1.6l.12.03c.1.06.13.19.06.28l-2.37 3.65 2.43 3.7.01.13a.2.2 0 0 1-.2.21h-1.61a.33.33 0 0 1-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 0 1-.3.17zm-7.12-1.49A2.47 2.47 0 0 1 70.7 12a2.47 2.47 0 0 1 2.42-2.52 2.47 2.47 0 0 1 2.42 2.51 2.48 2.48 0 0 1-2.42 2.52zm-19.87 0a2.48 2.48 0 0 1-2.42-2.48v-.07a2.47 2.47 0 0 1 2.4-2.49 2.47 2.47 0 0 1 2.41 2.51 2.47 2.47 0 0 1-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51a2.47 2.47 0 0 1 2.4-2.52 2.46 2.46 0 0 1 2.41 2.48l.02.08zm18.12 2.47a2.47 2.47 0 0 1-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51a2.47 2.47 0 0 1-2.42 2.51z"/></defs><mask id="c"><rect width="100%" height="100%" fill="#fff"/><use xlink:href="#g"/><use xlink:href="#b"/></mask><g opacity=".3" stroke="#000" stroke-width="3"><circle mask="url(#c)" cx="11.5" cy="11.5" r="9.25"/><use xlink:href="#b" mask="url(#c)"/></g><g opacity=".9" fill="#fff"><use xlink:href="#g"/><use xlink:href="#b"/></g></svg>',w1=16,YA=$s(`
<template>
  <div class="MapboxAddressMinimap" aria-hidden="true">
    <div class="MinimapImageContainer">
      <img class="MinimapImage" draggable="false"></img>
      <div class="MinimapInnerFrame">
        <div class="MinimapMarker"></div>
        <div class="MinimapAttribution">
          <div class="MinimapAttributionLogo">
            <a target="_blank" rel="noopener nofollow" href="https://www.mapbox.com/" aria-label="Mapbox logo">
              ${XA}
            </a>
          </div>
          <div class="MinimapAttributionText">
            <a target="_blank" href='https://www.mapbox.com/about/maps/'>© Mapbox</a><a target="_blank" href='http://www.openstreetmap.org/copyright'>© OpenStreetMap</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
`),KA=$s(`
<template>
  <button type="button" class="MinimapStyleToggle"></button>
</template>
`),QA=$s(`
<template>
  <div class="MinimapFooter">Adjust the marker on the map if it doesn't precisely match your location. This helps improve address data quality.</div>
</template>
`),Wv="Adjust pin",Xv="Save",Yv="Cancel",JA=$s(`
<template>
  <div class="MinimapEditButtons">
    <div class="Button ButtonPrimary MinimapButtonAdjust">${Wv}</div>
    <div class="Button ButtonPrimary MinimapButtonSave" aria-hidden="true">${Xv}</div>
    <div class="Button MinimapButtonCancel" aria-hidden="true">${Yv}</div>
  </div>
</template>
`),vy,kp,fg,Eu,tf,Ac,kc,Ii,Za,xy,by,wy,Pp,Sy,Ty,My,Ey,Cy,Ay,pg,ky,Py,jy,zy,Kv,Qv,Iy,mg,gg,Ry,Dy,Jv,Ny,ex,Ix=class extends Vh{constructor(){super(...arguments),Be(this,vy,!1),this.keepMarkerCentered=!1,this.markerAnchor="bottom",Be(this,kp,!1),Be(this,fg,!1),Be(this,Eu,void 0),Be(this,tf,""),Be(this,Ac,void 0),Be(this,kc,void 0),Be(this,Ii,void 0),Be(this,Za,void 0),Be(this,xy,void 0),Be(this,by,{}),Be(this,wy,!1),Be(this,Pp,"default"),Be(this,Sy,void 0),Be(this,Ty,void 0),Be(this,My,void 0),Be(this,Ey,["mapbox","streets-v11"]),Be(this,Cy,void 0),Be(this,Ay,void 0),Be(this,pg,()=>{const{ImageContainer:o,ButtonAdjust:d,ButtonSave:m,ButtonCancel:x}=O(this,Ii);O(this,kp)?(o.classList.add(`${this.dataset.seed}--draggable`),O(this,Za).isActive=!0,d.setAttribute("aria-hidden","true"),m.removeAttribute("aria-hidden"),x.removeAttribute("aria-hidden")):(o.classList.remove(`${this.dataset.seed}--draggable`),O(this,Za).isActive=!1,d.removeAttribute("aria-hidden"),m.setAttribute("aria-hidden","true"),x.setAttribute("aria-hidden","true"))}),Be(this,ky,()=>{At(this,kp,!0),O(this,pg).call(this)}),Be(this,Py,()=>{if(this.feature.properties.full_address&&!Sx(this.feature.geometry.coordinates,O(this,Za).coordinate)){const[o,d]=O(this,Za).coordinate;t2(this.accessToken,{originalCoordinate:this.feature.geometry.coordinates,originalAddress:this.feature.properties.full_address,changes:{location:{longitude:o,latitude:d}}})}this.onSaveMarkerLocation&&this.onSaveMarkerLocation(O(this,Za).coordinate),At(this,kp,!1),O(this,pg).call(this)}),Be(this,jy,()=>{O(this,Za).reCenter(),At(this,kp,!1),O(this,pg).call(this)}),Be(this,zy,()=>{this.mapStyleMode=this.mapStyleMode==="default"?"satellite":"default"}),Be(this,Kv,()=>{O(this,fg)||O(this,Za).reCenter(),At(this,fg,!0),O(this,Za)&&O(this,Za).handleMinimapResize()}),Be(this,Qv,()=>{At(this,fg,!1)}),Be(this,Iy,o=>{if(O(this,Ac)===0||O(this,kc)===0)return"";const[d,m]=this.defaultMapStyle,x=$w(d,m),C=this.mapStyleMode==="default"?x:N3,k=L3+Al.autofillSessionToken.toString();let E=C+sa.convert(o).toArray().join(",")+","+w1+",0/"+Math.min(O(this,Ac)*2,dp)+"x"+Math.min(O(this,kc)*2,dp)+"?access_token="+this.accessToken+"&attribution=false&logo=false";return Al.autofillSessionEnabled&&(E+=`&sku=${k}`),E}),Be(this,mg,()=>{if(O(this,Eu)){const o=O(this,Eu).geometry.coordinates;At(this,tf,O(this,Iy).call(this,o));const{Image:d}=O(this,Ii);d.src=O(this,tf)}}),Be(this,gg,o=>`url("${tA(o==="default"?"styleToggleDefault":"styleToggleSatellite",this.theme)}")`),Be(this,Ry,()=>{const{MapboxAddressMinimap:o,ImageContainer:d,Image:m}=O(this,Ii),{width:x,height:C}=Uw(this.container),[k,E]=[O(this,Ac),O(this,kc)];At(this,Ac,Math.min(x,dp)),At(this,kc,Math.min(C,dp)),o.style.setProperty("width",`${O(this,Ac)}px`),o.style.setProperty("height",`${O(this,kc)}px`),d.style.setProperty("height",`${O(this,kc)}px`),d.style.setProperty("width",`${O(this,Ac)}px`);const[l,B]=[m.width,m.height];O(this,Ac)>k&&O(this,Ac)>l/2&&l<dp||O(this,kc)>E&&O(this,kc)>B/2&&B<dp?O(this,mg).call(this):O(this,Za)&&O(this,Za).handleMinimapResize()}),Be(this,Dy,()=>{if(this.querySelector(".MinimapFooter"))return;const d=this.prepareTemplate(QA),m=this.querySelector(".MapboxAddressMinimap");if(!m||(m.appendChild(d),this.querySelector(".MinimapEditButtons")))return;const C=this.prepareTemplate(JA);this.querySelector(".MinimapInnerFrame").appendChild(C),At(this,Ii,Zs(Ir({},O(this,Ii)),{EditButtons:this.querySelector(".MinimapEditButtons"),ButtonAdjust:this.querySelector(".MinimapButtonAdjust"),ButtonSave:this.querySelector(".MinimapButtonSave"),ButtonCancel:this.querySelector(".MinimapButtonCancel")}));const{ButtonAdjust:E,ButtonSave:l,ButtonCancel:B}=O(this,Ii);E.addEventListener("click",O(this,ky)),l.addEventListener("click",O(this,Py)),B.addEventListener("click",O(this,jy))}),Be(this,Jv,()=>{if(!O(this,Ii))return;const{EditButtons:o,ButtonAdjust:d,ButtonSave:m,ButtonCancel:x}=O(this,Ii),C=this.querySelector(".MinimapFooter");C==null||C.remove(),o==null||o.remove(),d&&(d.remove(),d.removeEventListener("click",O(this,ky))),m&&(m.remove(),m.removeEventListener("click",O(this,Py))),x&&(x.remove(),x.removeEventListener("click",O(this,jy))),delete O(this,Ii).EditButtons,delete O(this,Ii).ButtonAdjust,delete O(this,Ii).ButtonSave,delete O(this,Ii).ButtonCancel}),Be(this,Ny,()=>{if(this.querySelector(".MinimapStyleToggle"))return;const d=this.prepareTemplate(KA),m=this.querySelector(".MinimapInnerFrame");m&&(m.appendChild(d),O(this,Ii).MapStyleToggle=d,d.addEventListener("click",O(this,zy)),d.style.backgroundImage=O(this,gg).call(this,this.mapStyleMode==="default"?"satellite":"default"),d.setAttribute("title",`Switch to ${this.mapStyleMode==="default"?"Satellite":"Default"}`))}),Be(this,ex,()=>{if(!O(this,Ii))return;const{MapStyleToggle:o}=O(this,Ii);o&&(o.remove(),o.removeEventListener("click",O(this,zy)),delete O(this,Ii).MapStyleToggle)})}get canAdjustMarker(){return O(this,vy)}set canAdjustMarker(o){At(this,vy,o),o?O(this,Dy).call(this):O(this,Jv).call(this)}get accessToken(){return O(this,xy)||Al.accessToken}set accessToken(o){At(this,xy,o)}get feature(){return O(this,Eu)}set feature(o){At(this,Eu,o),o?this.show():this.hide()}get template(){return YA}get templateStyle(){return uf}get templateUserStyle(){return bs(".MapboxAddressMinimap",this.theme)}get satelliteToggle(){return O(this,wy)}set satelliteToggle(o){At(this,wy,o),o?O(this,Ny).call(this):O(this,ex).call(this)}get theme(){return O(this,by)}set theme(o){if(At(this,by,o),!O(this,Ii)||!o)return;this.updateTemplateUserStyle(bs(".MapboxAddressMinimap",o));const{Marker:d,MapStyleToggle:m}=O(this,Ii);d.innerHTML=wo("marker",o),m&&(m.style.backgroundImage=O(this,gg).call(this,this.mapStyleMode==="default"?"satellite":"default"))}get adjustBtnText(){return O(this,Sy)||Wv}set adjustBtnText(o){At(this,Sy,o);const d=this.querySelector(".MinimapButtonAdjust");d.textContent=o||Wv}get saveBtnText(){return O(this,Ty)||Xv}set saveBtnText(o){At(this,Ty,o);const d=this.querySelector(".MinimapButtonSave");d.textContent=o||Xv}get cancelBtnText(){return O(this,My)||Yv}set cancelBtnText(o){At(this,My,o);const d=this.querySelector(".MinimapButtonCancel");d.textContent=o||Yv}get mapStyleMode(){return O(this,Pp)}set mapStyleMode(o){const d=O(this,Pp);if(d===o||(At(this,Pp,o),!O(this,Ii)))return;const{MapStyleToggle:m}=O(this,Ii);m&&(m.style.backgroundImage=O(this,gg).call(this,d),m.setAttribute("title",`Switch to ${d==="satellite"?"Satellite":"Default"}`),O(this,mg).call(this))}get defaultMapStyle(){return O(this,Ey)}set defaultMapStyle(o){At(this,Ey,o),O(this,mg).call(this)}get footer(){return O(this,Cy)}set footer(o){At(this,Cy,o);const d=this.querySelector(".MinimapFooter");d&&(typeof o=="string"?(d.textContent=o,d.removeAttribute("aria-hidden")):o?d.removeAttribute("aria-hidden"):d.setAttribute("aria-hidden","true"))}get container(){return O(this,Ay)}set container(o){o&&(o.style.position="relative",At(this,Ay,o))}show(){if(!O(this,Eu))return;const o=O(this,Eu).geometry.coordinates;O(this,Za).coordinate=o,At(this,tf,O(this,Iy).call(this,o));const{MapboxAddressMinimap:d,Image:m}=O(this,Ii);m.src=O(this,tf),d.removeAttribute("aria-hidden")}hide(){const{MapboxAddressMinimap:o}=O(this,Ii);o.setAttribute("aria-hidden","true")}connectedCallback(){super.connectedCallback(),At(this,Ii,cf(this,{MapboxAddressMinimap:".MapboxAddressMinimap",ImageContainer:".MinimapImageContainer",Image:".MinimapImage",Marker:".MinimapMarker",MapStyleToggle:".MinimapStyleToggle",EditButtons:".MinimapEditButtons",ButtonAdjust:".MinimapButtonAdjust",ButtonSave:".MinimapButtonSave",ButtonCancel:".MinimapButtonCancel"})),this.mapStyleMode=O(this,Pp),this.theme=Ir({},this.theme),this.canAdjustMarker&&O(this,Dy).call(this),this.satelliteToggle&&O(this,Ny).call(this),this.container=this.parentElement,new ResizeObserver(O(this,Ry)).observe(this.container),O(this,Ry).call(this);const{MapboxAddressMinimap:d,ImageContainer:m,Image:x,Marker:C}=O(this,Ii);At(this,Za,new WA(m,x,C,this.keepMarkerCentered,w1,this.markerAnchor)),O(this,Za).reCenter(),x.onload=O(this,Kv),x.onerror=O(this,Qv),x.src=O(this,tf),O(this,Eu)?d.removeAttribute("aria-hidden"):d.setAttribute("aria-hidden","true")}attributeChangedCallback(o,d,m){if(o==="access-token")this.accessToken=m;else if(o==="can-adjust-marker")this.canAdjustMarker=m==="true";else if(o==="keep-marker-centered")this.keepMarkerCentered=m==="true";else if(o==="marker-anchor"){const x=m;this.markerAnchor=x,O(this,Za)&&(O(this,Za).anchor=x)}else o==="satellite-toggle"&&(this.satelliteToggle=m==="true")}};vy=new WeakMap;kp=new WeakMap;fg=new WeakMap;Eu=new WeakMap;tf=new WeakMap;Ac=new WeakMap;kc=new WeakMap;Ii=new WeakMap;Za=new WeakMap;xy=new WeakMap;by=new WeakMap;wy=new WeakMap;Pp=new WeakMap;Sy=new WeakMap;Ty=new WeakMap;My=new WeakMap;Ey=new WeakMap;Cy=new WeakMap;Ay=new WeakMap;pg=new WeakMap;ky=new WeakMap;Py=new WeakMap;jy=new WeakMap;zy=new WeakMap;Kv=new WeakMap;Qv=new WeakMap;Iy=new WeakMap;mg=new WeakMap;gg=new WeakMap;Ry=new WeakMap;Dy=new WeakMap;Jv=new WeakMap;Ny=new WeakMap;ex=new WeakMap;Ix.observedAttributes=["access-token","can-adjust-marker","keep-marker-centered","marker-anchor","satellite-toggle"];window.MapboxAddressMinimap=Ix;window.customElements.get("mapbox-address-minimap")||customElements.define("mapbox-address-minimap",Ix);const e4=({setCoordinates:o})=>(he.useEffect(()=>{const d=document.querySelector("mapbox-search-box");d&&d.addEventListener("retrieve",m=>{var C;const x=m.detail;if(((C=x==null?void 0:x.features)==null?void 0:C.length)>0){const{geometry:k}=x.features[0];console.log("Centro:",k),o({lat:k.coordinates[1],lng:k.coordinates[0]})}})},[o]),w.jsxs("div",{className:"w-full",children:[w.jsx("p",{className:"mb-2 text-sm font-medium text-gray-900",children:"Dirección:  "}),w.jsx("mapbox-search-box",{"access-token":"pk.eyJ1IjoiYmJyMDdkZXYiLCJhIjoiY204d3M3Z2t1MTRwczJtc2VhOWU2ZDF6bSJ9.wK5waD3h8L_bB2s4nTiJ1A",proximity:"0,0","aria-hidden":"false"})]}));function t4(o){return Yr({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M13 17.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm-.25-8.25a.75.75 0 0 0-1.5 0v4.5a.75.75 0 0 0 1.5 0v-4.5Z"},child:[]},{tag:"path",attr:{d:"M9.836 3.244c.963-1.665 3.365-1.665 4.328 0l8.967 15.504c.963 1.667-.24 3.752-2.165 3.752H3.034c-1.926 0-3.128-2.085-2.165-3.752Zm3.03.751a1.002 1.002 0 0 0-1.732 0L2.168 19.499A1.002 1.002 0 0 0 3.034 21h17.932a1.002 1.002 0 0 0 .866-1.5L12.866 3.994Z"},child:[]}]})(o)}const c2=({coordinates:o})=>{if(!o)return null;const d=o[1],m=o[0],[x,C]=he.useState(null),[k,E]=he.useState(null),[l,B]=he.useState(null);he.useEffect(()=>{V(),X()},[]);const V=async()=>{try{const re=await(await fetch(Wt.url+`mapbox/static-image?lat=${d}&lng=${m}`,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();re.status==="success"?C(re.mapUrl):(B("Servicio no disponible"),C("No se ha podido obtener la imagen"))}catch(ne){console.error("No se ha podido obtener la imagen estatica del mapa: ",ne)}},X=async()=>{try{const re=await(await fetch(Wt.url+`mapbox/geocode?lat=${d}&lng=${m}`,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();re.status==="success"?E(re.geocodingUrl):E("No se ha encontrado la dirección")}catch{E("No se ha encontrado la dirección")}};return w.jsxs("div",{className:"w-full flex flex-col justify-center items-center space-y-2",children:[k&&w.jsx("div",{className:"bg-white p-2 rounded-lg shadow-md text-gray-800 text-center",children:w.jsx("p",{className:"font-semibold",children:k})}),l?w.jsxs("div",{className:"bg-amber-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg flex items-center space-x-2",children:[w.jsx(t4,{className:"w-5 h-5"}),w.jsx("p",{className:"font-semibold text-black",children:"Servicio no disponible"})]}):w.jsx("img",{src:x,alt:"Mapa estático",className:"rounded-lg shadow-md"})]})},r4=({isOpen:o,onClose:d})=>{const{auth:m,setAuth:x}=Ri(),{validateUpdate:C,errors:k}=cx(),[E,l]=he.useState("not-saved"),[B,V]=he.useState("not-saved"),[X,ne]=he.useState(null),re=async ee=>{ee.preventDefault();let te=a_(ee.target);if(console.log(te),X&&(te.location={type:"Point",coordinates:[X.lng,X.lat]}),!!C(te))try{const Ae=await(await fetch(Wt.url+"users/update/"+m.id,{method:"PUT",body:JSON.stringify(te),headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}})).json();Ae.status==="success"?(l("saved"),V(Ae.message),x(Ae.user),console.log(Ae.user),setTimeout(()=>{d()},1800)):(l("error"),V(Ae.message))}catch{l("error"),V(data.message)}};return o&&w.jsx("div",{className:"fixed inset-0 flex justify-center items-center sm:flex-row bg-gray-900/30 backdrop-blur-md transition-all duration-300 z-50 ",children:w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-4xl w-full h-full md:max-h-[98vh] relative overflow-auto",children:[w.jsx(Rl,{size:30,className:"absolute top-2 right-2 text-gray-600 cursor-pointer hover:text-gray-800",onClick:d}),w.jsx("h1",{className:"text-3xl text-center",children:"Editar Usuario"}),w.jsxs("form",{className:"space-y-6 mt-8",onSubmit:re,children:[w.jsx("div",{className:"flex flex-col md:flex-row md:space-x-6",children:w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-900",children:"Username"}),w.jsxs("div",{className:"mt-2",children:[w.jsx("input",{type:"text",name:"username",defaultValue:m.username,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),k.username&&w.jsx("div",{className:"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:w.jsx("strong",{className:"font-bold",children:k.username})})]})]})}),w.jsxs("div",{children:[w.jsx("div",{className:"flex items-center justify-between",children:w.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-900",children:"Biografía"})}),w.jsx("div",{className:"mt-2",children:w.jsx("textarea",{name:"bio",rows:"10",cols:"50",defaultValue:m.bio,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),m.role!=="user"&&m.role!=="barista"&&w.jsxs("div",{children:[w.jsx("div",{className:"flex justify-center mb-8 gap-6 flex-col sm:flex-row",children:w.jsx(rC,{})}),w.jsxs("div",{className:"flex justify-around mb-8 gap-6 flex-col sm:flex-row",children:[w.jsx(iC,{}),w.jsx(nC,{})]}),w.jsxs("div",{className:"flex justify-around mb-8 gap-6 flex-col sm:flex-row",children:[w.jsx(sC,{}),w.jsx(aC,{})]}),w.jsx("div",{className:"w-full",children:w.jsx(e4,{setCoordinates:ne})}),w.jsx("div",{className:"mt-6",children:m.location&&w.jsx(c2,{coordinates:m.location.coordinates})})]}),w.jsx("div",{className:"flex justify-center",children:w.jsx("button",{type:"submit",className:"flex justify-center rounded-full bg-amber-700 border border-transparent px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800",children:"Actualizar"})}),w.jsx("strong",{children:E==="saved"?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",B," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""}),w.jsx("strong",{children:E=="error"?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",B," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""})]})]})})},i4=({isOpen:o,onClose:d,numberFollows:m,user:x,permited:C})=>{if(typeof m!="function"){console.error("setFollowings no es una función");return}const{auth:k}=Ri(),[E,l]=he.useState({}),[B,V]=he.useState([]),X=zl();he.useEffect(()=>{ne()},[k]);const ne=async()=>{const te=k._id,be=x._id;if(!(!te||!be))try{const Ae=await(await fetch(Wt.url+"followers/"+be,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();if(Ae.status!=="success")return;l(Ae.follows),console.log(Ae);const tt=await(await fetch(Wt.url+"followings/"+be,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();if(tt.total===0)return;Ae.users_follow_me.some(nt=>tt.users_folowing.includes(nt))&&V(Ae.users_follow_me)}catch(Ee){console.log(Ee)}},re=async te=>{let be=te;try{const Ae=await(await fetch(Wt.url+"/unfollow/"+be,{method:"DELETE",headers:{Authorization:localStorage.getItem("token")}})).json();if(Ae.status!=="success")return;if(B.includes(Ae.followed)){const Ie=B.indexOf(Ae.followed);if(Ie===-1)return;const tt=[...B];tt.splice(Ie,1),V(tt),m(vt=>vt-1)}}catch(Ee){console.log(Ee)}},ee=async te=>{const be=te;try{const Ae=await(await fetch(Wt.url+"follow",{method:"POST",body:JSON.stringify({followed:be}),headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}})).json();V(Ie=>[...Ie,Ae.follow.followed]),m(Ie=>Ie+1)}catch(Ee){console.log(Ee)}};return o&&w.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-900/30 backdrop-blur-md transition-all duration-300 z-50 overflow-auto",children:w.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg relative max-w-full w-[90%] sm:w-[60%] md:w-[40%] lg:w-[30%] xl:w-[20%]",children:[w.jsx(Rl,{size:30,className:"absolute top-2 right-2 text-gray-600 cursor-pointer hover:text-gray-800",onClick:d}),w.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Personas que te siguen"}),E.length>0?w.jsx("div",{className:"p-4 max-h-60 overflow-auto",children:E.map((te,be)=>w.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[w.jsx("img",{src:te.user.avatar?te.user.avatar:Uh,alt:"Avatar",className:"w-10 h-10 rounded-full object-cover"}),w.jsx("div",{children:w.jsx("h3",{onClick:()=>{X("/private/profile/",{state:{user:te.user._id}}),d()},className:"font-semibold cursor-pointer",children:te.user.username})}),C&&B.includes(te.user._id)&&w.jsx("div",{className:"ml-10 flex justify-center",children:w.jsx("button",{onClick:()=>re(te.user._id),type:"submit",className:"flex justify-center rounded-full bg-amber-700 border border-transparent px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800 transition-all duration-200 ease-in-out",children:"Siguiendo"})}),C&&!B.includes(te.user._id)&&w.jsx("div",{className:"ml-10 flex justify-center",children:w.jsx("button",{onClick:()=>ee(te.user._id),type:"submit",className:"flex justify-center bg-amber-700 text-white rounded-full border border-transparent px-3 py-2 text-sm font-semibold text-black shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800 transition-all duration-200 ease-in-out",children:"Seguir"})})]},be))}):w.jsx("p",{className:"text-center text-gray-600",children:"No sigues a nadie aún."})]})})},a4=({isOpen:o,onClose:d,setFollowings:m,user:x,permited:C})=>{const{auth:k}=Ri(),[E,l]=he.useState({}),[B,V]=he.useState([]),X=zl();he.useEffect(()=>{ne()},[k]);const ne=async()=>{const te=k._id,be=x._id;if(!(!te||!be))try{const Ae=await(await fetch(Wt.url+"followings/"+be,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();if(Ae.status!=="success")return;V(Ae.users_folowing),l(Ae.follows),console.log(Ae)}catch(Ee){console.log(Ee)}},re=async te=>{const be=te;try{const Ae=await(await fetch(Wt.url+"follow",{method:"POST",body:JSON.stringify({followed:be}),headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}})).json();V(Ie=>[...Ie,Ae.follow.followed]),m(Ie=>parseInt(Ie)+1)}catch(Ee){console.log(Ee)}},ee=async te=>{let be=te;try{const Ae=await(await fetch(Wt.url+"/unfollow/"+be,{method:"DELETE",headers:{Authorization:localStorage.getItem("token")}})).json();if(Ae.status!=="success")return;if(B.includes(Ae.followed)){const Ie=B.indexOf(Ae.followed);if(Ie===-1)return;const tt=[...B];tt.splice(Ie,1),V(tt),m(vt=>vt-1)}}catch(Ee){console.log(Ee)}};return o&&w.jsxs("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-900/30 backdrop-blur-md transition-all duration-300 z-50 overflow-auto",children:[w.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg relative max-w-full w-[90%] sm:w-[60%] md:w-[40%] lg:w-[30%] xl:w-[20%]",children:[w.jsx(Rl,{size:30,className:"absolute top-2 right-2 text-gray-600 cursor-pointer hover:text-gray-800",onClick:d}),w.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Personas que sigues"}),E.length>0?w.jsx("div",{className:"p-4 max-h-80 overflow-auto",children:E.map((te,be)=>w.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[w.jsx("img",{src:te.followed.avatar?te.followed.avatar:Uh,alt:"Avatar",className:"w-10 h-10 rounded-full object-cover"}),w.jsx("div",{children:w.jsx("h3",{onClick:()=>{X("/private/profile/",{state:{user:te.followed._id}}),d()},className:"font-semibold cursor-pointer",children:te.followed.username})}),C&&B.includes(te.followed._id)&&w.jsx("div",{className:"ml-10 flex justify-center",children:w.jsx("button",{onClick:()=>ee(te.followed._id),type:"submit",className:"flex justify-center rounded-full bg-amber-700 border border-transparent px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800",children:"Siguiendo"})}),C&&!B.includes(te.followed._id)&&w.jsx("div",{className:"ml-10 flex justify-center",children:w.jsx("button",{onClick:()=>re(te.followed._id),type:"submit",className:"flex justify-center rounded-full bg-amber-700 border border-transparent px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800",children:"Seguir"})})]},be))}):w.jsx("p",{className:"text-center text-gray-600",children:"No sigues a nadie aún."})]}),w.jsx("div",{})]})},n4=({isOpen:o,onClose:d})=>{const{changed:m,form:x,setForm:C}=Il(),[k,E]=he.useState("not-loaded"),[l,B]=he.useState(""),[V,X]=he.useState("not-loaded");he.useEffect(()=>{},[k,d]);const ne=async re=>{E("charging"),re.preventDefault();const ee=new FormData;ee.append("coffeeName",x.coffeeName),ee.append("origin",x.origin),ee.append("varietal",x.varietal),ee.append("process",x.process),ee.append("high",x.high),ee.append("roaster",x.roaster),ee.append("tastingNotes",x.tastingNotes),ee.append("score",parseFloat(x.score)),ee.append("brewMethod",x.brewMethod),ee.append("notes",x.notes),x.file0&&ee.append("file0",x.file0);try{const be=await(await fetch(Wt.url+"coffeelog",{method:"POST",body:ee,headers:{Authorization:localStorage.getItem("token")}})).json();console.log(be),be.status==="success"?(E("charged"),X("saved"),B(be.message),setTimeout(()=>{d()},500)):(E("charged"),X("error"),B(be.message))}catch(te){console.log(te),E("charged"),X("error"),B(te.message)}};return o&&w.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-900/30 backdrop-blur-md transition-all duration-300 z-50 mt-20 md:mt-0 mb-8 md:mb-0",children:w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-4xl w-full max-h-[98vh] relative overflow-auto md:max-w-4xl sm:max-w-xl",children:[w.jsx(Rl,{size:30,className:"absolute top-2 right-2 text-gray-600 cursor-pointer hover:text-gray-800",onClick:d}),w.jsx("h2",{className:"mt-6 text-lg font-semibold mb-4",children:"Agregar Café"}),w.jsxs("form",{className:"space-y-6 mt-8",onSubmit:ne,children:[w.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"coffeeName",className:"block text-sm font-medium text-gray-900",children:"Nombre"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{onChange:m,type:"text",name:"coffeeName",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1 mt-6 md:mt-0",children:[w.jsx("label",{htmlFor:"roaster",className:"block text-sm font-medium text-gray-900",children:"Roaster"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{onChange:m,type:"text",name:"roaster",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1 md:flex-[0.5] mt-6 md:mt-0",children:[w.jsx("label",{htmlFor:"score",className:"block text-sm font-medium text-gray-900",children:"Puntuación SCA"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{onChange:m,type:"text",name:"score",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]})]}),w.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"origin",className:"block text-sm font-medium text-gray-900",children:"Origen"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{onChange:m,type:"text",name:"origin",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1 mt-6 md:mt-0",children:[w.jsx("label",{htmlFor:"high",className:"block text-sm font-medium text-gray-900",children:"Altura"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{onChange:m,type:"text",name:"high",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1 mt-6 md:mt-0",children:[w.jsx("label",{htmlFor:"varietal",className:"block text-sm font-medium text-gray-900",children:"Varietal"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{onChange:m,type:"text",name:"varietal",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"process",className:"block text-sm font-medium text-gray-900",children:"Proceso"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{onChange:m,type:"text",name:"process",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]})]}),w.jsx("div",{className:"flex flex-col md:flex-row md:space-x-6",children:w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"tastingNotes",className:"block text-sm font-medium text-gray-900",children:"Notas de cata"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{onChange:m,type:"text",name:"tastingNotes",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]})}),w.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"brewMethod",className:"block text-sm font-medium text-gray-900",children:"Método de extracción recomendado"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{onChange:m,type:"text",name:"brewMethod",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1 mt-6 md:mt-0",children:[w.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-900",children:"Notas"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{onChange:m,type:"text",name:"notes",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]})]}),w.jsxs("div",{children:[w.jsx("label",{htmlFor:"file0",className:"block text-sm font-medium text-gray-900",children:"Imagen o Multimedia"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{onChange:re=>C({...x,file0:re.target.files[0]}),type:"file",name:"file0",accept:"image/*",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-amber-700 file:text-white hover:file:bg-amber-800 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsx("div",{className:"flex justify-center",children:w.jsx("button",{type:"submit",className:"flex justify-center rounded-full bg-amber-700 border border-transparent px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800",children:"Agregar"})}),k==="charging"&&w.jsxs("div",{className:"flex justify-center items-center mt-4",children:[w.jsxs("svg",{className:"animate-spin h-6 w-6 text-amber-600 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 11-8 8z"})]}),w.jsx("p",{className:"text-amber-600 font-medium",children:"Creando registro..."})]}),w.jsx("strong",{children:V==="saved"?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",l," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""}),w.jsx("strong",{children:V=="error"?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",l," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""})]})]})})},s4=({isOpen:o,onClose:d,coffeToUpdate:m})=>{const[x,C]=he.useState(""),[k,E]=he.useState("not-loaded"),l=he.useRef(null),[B,V]=he.useState("not-loaded"),[X,ne]=he.useState(m);he.useEffect(()=>{console.log(m)},[]);const re=async be=>{be.preventDefault(),console.log(X);let Ee=a_(be.target);try{const Ie=await(await fetch(Wt.url+"coffeelog/update/"+m.id,{method:"PUT",body:JSON.stringify(Ee),headers:{"Content-type":"application/json",Authorization:localStorage.getItem("token")}})).json();Ie.status==="success"?(ne(Ie.coffe),E("saved"),C(Ie.message)):(E("error"),C(Ie.message))}catch(Ae){console.log(Ae),C(data.message),E("error")}},ee=async()=>{V("charging");let be=document.querySelector("#file");if(be.files[0]){const Ee=new FormData;Ee.append("file0",be.files[0]);try{const Ie=await(await fetch(Wt.url+"coffeelog/media/"+m.id,{method:"PUT",body:Ee,headers:{Authorization:localStorage.getItem("token")}})).json();Ie.status==="success"?(ne(Ie.updatedCoffee),V("charged"),E("saved"),C(Ie.message)):(V("charged"),E("error"),C(Ie.message))}catch(Ae){console.log(Ae),V("charged"),E("error"),C(Ae.message)}}},te=async be=>{const Ee=X.media[be];try{const Ie=await(await fetch(Wt.url+"coffeelog/media/"+X.id,{method:"DELETE",body:JSON.stringify({urlImage:Ee}),headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}})).json();console.log(Ie),Ie.status==="success"?(V("charged"),E("saved"),C(Ie.message),ne(Ie.coffe)):(V("charged"),E("error"),C(Ie.message))}catch(Ae){console.log(Ae),V("charged"),E("error"),C(Ae.message)}};return o&&w.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-900/30 backdrop-blur-md transition-all duration-300 z-50",children:w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-4xl w-full max-h-[98vh] relative overflow-auto md:max-w-4xl sm:max-w-xl",children:[w.jsx(Rl,{size:30,className:"absolute top-2 right-2 text-gray-600 cursor-pointer hover:text-gray-800",onClick:d}),w.jsx("h2",{className:"mt-6 text-lg font-semibold mb-4",children:"Editar Café"}),w.jsxs("form",{className:"space-y-6 mt-8",onSubmit:re,children:[w.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"coffeeName",className:"block text-sm font-medium text-gray-900",children:"Nombre"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{defaultValue:X.coffeName!=="undefined"?X.coffeName:"",type:"text",name:"coffeeName",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1 mt-6 md:mt-0",children:[w.jsx("label",{htmlFor:"roaster",className:"block text-sm font-medium text-gray-900",children:"Roaster"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{defaultValue:X.roaster!=="undefined"?X.roaster:"",type:"text",name:"roaster",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1 md:flex-[0.5] mt-6 md:mt-0",children:[w.jsx("label",{htmlFor:"score",className:"block text-sm font-medium text-gray-900",children:"Puntuación SCA"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{defaultValue:X.score!=="undefined"?X.score:"",type:"text",name:"score",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]})]}),w.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"origin",className:"block text-sm font-medium text-gray-900",children:"Origen"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{defaultValue:X.origin!=="undefined"?X.origin:"",type:"text",name:"origin",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1 mt-6 md:mt-0",children:[w.jsx("label",{htmlFor:"high",className:"block text-sm font-medium text-gray-900",children:"Altura"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{defaultValue:X.high!=="undefined"?X.high:"",type:"text",name:"high",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1 mt-6 md:mt-0",children:[w.jsx("label",{htmlFor:"varietal",className:"block text-sm font-medium text-gray-900",children:"Varietal"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{defaultValue:X.varietal!=="undefined"?X.varietal:"",type:"text",name:"varietal",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"process",className:"block text-sm font-medium text-gray-900",children:"Proceso"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{defaultValue:X.process!=="undefined"?X.process:"",type:"text",name:"process",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]})]}),w.jsx("div",{className:"flex flex-col md:flex-row md:space-x-6",children:w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"tastingNotes",className:"block text-sm font-medium text-gray-900",children:"Notas de cata"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{defaultValue:X.tastingNotes[0]!=="undefined"?X.tastingNotes:"",type:"text",name:"tastingNotes",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]})}),w.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("label",{htmlFor:"brewMethod",className:"block text-sm font-medium text-gray-900",children:"Método de extracción recomendado"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{defaultValue:X.brewMethod!=="undefined"?X.brewMethod:"",type:"text",name:"brewMethod",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsxs("div",{className:"flex-1 mt-6 md:mt-0",children:[w.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-900",children:"Notas"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{defaultValue:X.notes!=="undefined"?X.notes:"",type:"text",name:"notes",className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]})]}),w.jsx("div",{className:"flex justify-center flex-wrap gap-1",children:w.jsx("div",{className:"flex",children:Array.isArray(X.media)&&X.media.length>1?X.media.map((be,Ee)=>w.jsxs("div",{className:"relative m-4",children:[w.jsx("img",{className:"w-[80%] object-cover border rounded-xl mt-2",src:be,alt:`Preview ${Ee}`}),w.jsx(Pl,{onClick:()=>te(Ee),className:"absolute top-0 right-[20%] text-gray-900 bg-white rounded-full cursor-pointer shadow-md hover:text-red-600",size:25})]},Ee)):w.jsxs("div",{className:"relative m-4",children:[w.jsx("img",{className:"w-[30%] object-cover border rounded-xl mt-2",src:X.media,alt:"Preview"}),w.jsx(Pl,{onClick:()=>te(index),className:"absolute top-0 right-[70%] text-gray-900 bg-white rounded-full cursor-pointer shadow-md hover:text-red-600",size:25})]})})}),w.jsxs("div",{onClick:()=>l.current.click(),className:"border-2 border-dashed border-gray-300 p-4 rounded-lg text-center cursor-pointer hover:bg-gray-100",children:[w.jsx(dw,{className:"mx-auto text-gray-500",size:40}),w.jsx("p",{className:"text-sm text-gray-500",children:"Haz clic para agregar otra imagen"})]}),w.jsx("input",{type:"file",name:"file0",className:"hidden",id:"file",ref:l,onChange:ee}),B==="charging"&&w.jsxs("div",{className:"flex justify-center items-center mt-4",children:[w.jsxs("svg",{className:"animate-spin h-6 w-6 text-amber-600 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 11-8 8z"})]}),w.jsx("p",{className:"text-amber-600 font-medium",children:"Subiendo imagen..."})]}),w.jsx("div",{className:"flex justify-center",children:w.jsx("button",{type:"submit",className:"flex justify-center rounded-full bg-amber-700 border border-transparent px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800",children:"Actualizar"})}),w.jsx("strong",{children:k==="saved"?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",x," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""}),w.jsx("strong",{children:k=="error"?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",x," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""})]})]})})},u2=({user:o,permited:d})=>{const[m,x]=he.useState([]),[C,k]=he.useState(!1),[E,l]=he.useState(!1),[B,V]=he.useState(!1),[X,ne]=he.useState({}),[re,ee]=he.useState({}),[te,be]=he.useState("grid"),[Ee,Ae]=he.useState(1),[Ie,tt]=he.useState(null),[vt,nt]=he.useState(null),[Ye,st]=he.useState(1),[ot,at]=he.useState({coffeeName:"",origin:"",varietal:"",process:"",score:""}),[xt,zt]=he.useState(null),{changed:Ht,form:Yt,setForm:er}=Il();he.useEffect(()=>{Rr()},[C,E,Ee]);const Rr=async()=>{try{const Pt=await(await fetch(Wt.url+`coffeelog/${o.id}/${Ee}`,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();Pt.status==="success"&&(x(Pt.coffeLogs),Pt.hasNextPage&&tt(Pt.hasNextPage),Pt.hasPrevPage&&nt(Pt.hasPrevPage),Pt.pages&&st(Pt.pages))}catch(Je){console.log(Je.message)}},Mt=async Je=>{let Pt=Je;try{(await(await fetch(Wt.url+"coffeelog/"+Pt,{method:"DELETE",headers:{Authorization:localStorage.getItem("token")}})).json()).status==="success"&&Rr()}catch(Se){console.log(Se)}},yt=async()=>{try{const Je=new URLSearchParams(Yt).toString(),Se=await(await fetch(Wt.url+`coffeelog/search/${o._id}?${Je}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}})).json();Se.status==="success"&&x(Se.coffeeLog.docs)}catch(Je){console.log(Je)}};return w.jsxs("div",{className:"mt-20 relative max-w-4xl mx-auto bg-white shadow-md rounded-lg overflow-hidden mt-6 p-6",children:[w.jsx(kT,{onClick:()=>be(te==="grid"?"list":"grid"),title:"Cambiar vista",className:"absolute top-1 right-4 text-gray-600 bg-white rounded-full p-1 cursor-pointer shadow-md hover:text-gray-800",size:30}),w.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-xl border border-gray-200",children:w.jsxs("div",{className:"flex flex-col gap-4",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Filtros"}),w.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(Yt).map(([Je,Pt])=>Pt&&w.jsxs("div",{className:"flex items-center bg-lime-400 text-white rounded-full px-3 py-1 shadow-sm",children:[w.jsxs("span",{className:"text-sm capitalize mr-2",children:[Je.replace(/([A-Z])/g," $1").trim(),":"]}),w.jsx("span",{className:"text-sm font-medium",children:Pt}),w.jsx(Pl,{onClick:()=>{er(Se=>({...Se,[Je]:""})),Rr()},className:"hover:text-red-600"})]},Je))}),w.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(ot).map(Je=>w.jsxs("button",{onClick:()=>{zt(xt===Je?null:Je)},className:`w-8 h-8 rounded-full flex items-center justify-center transition-all
        ${ot[Je]?"bg-lime-500 text-white":"bg-white text-gray-500"}
        border ${xt===Je?"border-lime-600 shadow-lg":"border-gray-300"}
        hover:shadow-md hover:border-lime-500`,title:Je.replace(/([A-Z])/g," $1").trim(),children:[Je==="coffeeName"&&"☕",Je==="origin"&&"🌍",Je==="varietal"&&"🌱",Je==="process"&&"⚙️",Je==="score"&&"⭐"]},Je))})]}),w.jsx("div",{children:xt&&w.jsx("div",{className:"max-w-full bg-white p-4 rounded-lg shadow-xl border border-gray-100",children:w.jsxs("div",{className:"flex flex-col gap-2",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("label",{className:"text-sm font-medium text-gray-700",children:xt.replace(/([A-Z])/g," $1").trim()}),w.jsx(Pl,{onClick:()=>zt(null),className:"hover:text-red-600"})]}),w.jsxs("div",{className:"flex gap-2 items-center",children:[w.jsx("input",{name:xt,type:"text",autoFocus:!0,className:"w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm",onChange:Ht}),w.jsx(ux,{onClick:yt,className:"mr-4 hover:text-green-600",size:17})]})]})})})]})}),w.jsx("div",{className:`mt-6 ${te==="grid"?"grid grid-cols-1 md:grid-cols-2 gap-6":"flex flex-col gap-4"} cursor-pointer`,children:m.length>0?m.map((Je,Pt)=>w.jsxs("div",{onClick:()=>{ee(Je),V(!0)},className:`relative bg-gray-50 rounded-lg shadow p-4 flex transition-all duration-300 hover:shadow-xl ${te==="grid"?"flex-col items-center text-center":"flex-row items-start"}`,children:[w.jsx("div",{className:"absolute top-1 right-4 flex gap-2",children:d&&w.jsxs(w.Fragment,{children:[w.jsx(s_,{onClick:Se=>{Se.stopPropagation(),Mt(Je.id)},className:"text-red-500 hover:text-red-700 cursor-pointer",size:20}),w.jsx(n_,{onClick:Se=>{Se.stopPropagation(),l(!0),ne(Je)},className:"text-amber-500 hover:text-amber-700 cursor-pointer",size:20})]})}),w.jsx("img",{className:"w-20 h-20 sm:w-20 sm:h-20 md:w-32 md:h-32 rounded-xl mt-2 object-cover",src:Je.media[0],alt:"Preview"}),w.jsxs("div",{className:`${te==="grid"?"mt-2":"ml-4"}`,children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:Je.coffeeName}),te==="list"&&w.jsxs(w.Fragment,{children:[w.jsx("p",{className:"text-gray-600",children:Je.origin}),w.jsx("p",{className:"text-gray-500",children:Je.varietal}),w.jsx("p",{className:"text-gray-500",children:Je.process}),w.jsx("p",{className:"text-gray-500",children:Je.high}),w.jsx("p",{className:"text-gray-500 font-semibold",children:Je.score})]})]})]},Pt)):w.jsx("p",{className:"text-center text-gray-600",children:"No hay registros de café."})}),w.jsx("div",{className:"mt-4 p-1 flex justify-center hover:text-lime-700",children:d&&w.jsx(zu,{onClick:()=>k(!0),size:30})}),Ye&&Ye>1&&w.jsxs("div",{className:"flex justify-between items-center mt-6",children:[w.jsx(o_,{className:"text-gray-600 bg-white rounded-full p-2 hover:text-gray-800 hover:rounded-full hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",onClick:()=>{vt&&Ae(Je=>Math.max(Je-1,1))},size:40}),w.jsxs("span",{className:"text-gray-700",children:["Página ",Ee," de ",Ye]}),w.jsx(l_,{className:"text-gray-600 bg-white rounded-full p-2 hover:text-gray-800 hover:rounded-full hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",size:40,onClick:()=>{Ie&&Ae(Je=>Math.min(Je+1,Ye))}})]}),C&&w.jsx(n4,{isOpen:C,onClose:()=>k(!1)}),E&&w.jsx(s4,{isOpen:E,onClose:()=>l(!1),coffeToUpdate:X}),B&&w.jsx($1,{isOpen:B,onClose:()=>V(!1),coffeToView:re})]})},o4=({isOpen:o,onClose:d})=>{const{auth:m}=Ri(),{changed:x,form:C}=Il(),[k,E]=he.useState([]),[l,B]=he.useState("not-loaded"),[V,X]=he.useState("not-loaded"),[ne,re]=he.useState(""),[ee,te]=he.useState([]);he.useEffect(()=>{Ee()},[]);const be=Ie=>{const tt=Array.from(Ie.target.files);if(tt.length+k.length>5){alert("Solo puedes subir hasta 5 imágenes.");return}E([...k,...tt])},Ee=async()=>{try{const tt=await(await fetch(Wt.url+"recipes/"+m._id,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();tt.status==="success"&&te(tt.recipes)}catch(Ie){console.log(Ie)}},Ae=async Ie=>{Ie.preventDefault(),B("charging"),console.log(C);const tt=new FormData;tt.append("text",C.text),tt.append("recipe",C.recipe),k.forEach((vt,nt)=>{tt.append("file0",vt)});try{const nt=await(await fetch(Wt.url+"posts",{method:"POST",body:tt,headers:{Authorization:localStorage.getItem("token")}})).json();nt.status==="success"&&(B("charged"),X("saved"),re(nt.message),setTimeout(()=>{d()},500))}catch(vt){B("charged"),X("error"),re(vt.message)}};return o&&w.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-900/30 backdrop-blur-md z-50",children:w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-4xl w-full max-h-[98vh] relative overflow-auto",children:[w.jsx(Rl,{size:30,className:"absolute top-2 right-2 text-gray-600 cursor-pointer hover:text-gray-800",onClick:d}),w.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Agregar Publicación"}),w.jsxs("form",{className:"space-y-6",onSubmit:Ae,children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Descripción"}),w.jsx("textarea",{type:"text",name:"text",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm h-40 min-h-40 resize-none"}),w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Recetas"}),w.jsxs("select",{name:"recipe",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm",children:[w.jsx("option",{value:"",children:"Selecciona una Receta"}),ee&&ee.map(Ie=>w.jsx("option",{value:Ie._id,children:Ie.title},Ie.id))]}),w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Imágenes (Máx. 5)"}),w.jsx("input",{type:"file",multiple:!0,accept:"image/*",name:"file0",onChange:be,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 file:py-2 file:px-4 file:bg-amber-700 file:text-white file:rounded-md hover:border-amber-500 focus:outline-none hover:file:bg-amber-800"}),w.jsx("div",{className:"flex flex-wrap gap-2 mt-2 justify-center",children:k.map((Ie,tt)=>w.jsxs("div",{className:"relative",children:[w.jsx("img",{src:URL.createObjectURL(Ie),alt:"Preview",className:"w-20 h-20 object-cover rounded-md"}),w.jsx("button",{type:"button",className:"absolute top-0 right-0 bg-red-500 text-white rounded-full",onClick:()=>removeImage(tt),children:"×"})]},tt))}),w.jsx("div",{className:"text-center",children:w.jsx("button",{type:"submit",className:"bg-amber-700 text-white py-2 px-4 rounded-full hover:bg-amber-800",children:"Agregar"})}),l==="charging"&&w.jsxs("div",{className:"flex justify-center items-center mt-4",children:[w.jsxs("svg",{className:"animate-spin h-6 w-6 text-amber-600 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 11-8 8z"})]}),w.jsx("p",{className:"text-amber-600 font-medium",children:"Creando registro..."})]}),w.jsx("strong",{children:V==="saved"?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",ne," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""}),w.jsx("strong",{children:V=="error"?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",ne," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""})]})]})})},l4=({onUpdate:o,user:d,permited:m})=>{const{auth:x}=Ri(),[C,k]=he.useState({}),[E,l]=he.useState({}),[B,V]=he.useState(!1),[X,ne]=he.useState(!1),[re,ee]=he.useState(1),[te,be]=he.useState(null),[Ee,Ae]=he.useState(null),[Ie,tt]=he.useState(1);he.useEffect(()=>{vt()},[B,X,re]);const vt=async()=>{try{const Ye=await(await fetch(Wt.url+`posts/${d._id}/${re}`,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();Ye.status==="success"&&(k(Ye.publications),Ye.hasNextPage&&be(Ye.hasNextPage),Ye.hasPrevPage&&Ae(Ye.hasPrevPage),Ye.pages&&tt(Ye.pages))}catch(nt){console.log(nt),l({})}};return w.jsxs("div",{className:"relative max-w-4xl xl:max-w-4xl md:max-w-2xl sm:max-w-xs mx-auto bg-white shadow-md rounded-lg overflow-hidden mt-6 p-6",children:[w.jsx("div",{className:"mt-6 grid grid-cols-2 xl:grid-cols-3 gap-4 md:grid-cols-2 cursor-pointer",children:C&&C.length>0?C.map((nt,Ye)=>w.jsx("div",{onClick:()=>{V(!0),l(nt)},className:"relative rounded-lg flex flex-col items-center text-center",children:w.jsx("img",{className:"rounded-xl object-cover w-64 h-64 md:w-64 md:h-64 hover:w-68 hover:h-68 transition-all 300ms",src:nt.media[0],alt:"Preview"})},Ye)):w.jsx("p",{className:"text-center text-gray-600",children:"No hay publicaciones"})}),w.jsx("div",{className:"mt-8 p-1 flex justify-center hover:text-lime-700",children:m===!0&&w.jsx(zu,{onClick:()=>ne(!0),size:30})}),Ie&&Ie>1&&w.jsxs("div",{className:"flex justify-between items-center mt-6",children:[w.jsx(o_,{className:"text-gray-600 bg-white rounded-full p-2 hover:text-gray-800 hover:rounded-full hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",onClick:()=>{Ee&&ee(nt=>Math.max(nt-1,1))},size:40}),w.jsxs("span",{className:"text-gray-700",children:["Página ",re," de ",Ie]}),w.jsx(l_,{className:"text-gray-600 bg-white rounded-full p-2 hover:text-gray-800 hover:rounded-full hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",size:40,onClick:()=>{te&&ee(nt=>Math.min(nt+1,Ie))}})]}),B&&w.jsx(hw,{isOpen:B,onClose:()=>{V(!1),o()},post:E}),X&&w.jsx(o4,{isOpen:X,onClose:()=>{ne(!1),o()}})]})},c4=({isOpen:o,onClose:d})=>{const{auth:m}=Ri(),{changed:x,form:C}=Il(),[k,E]=he.useState([]),[l,B]=he.useState(null),[V,X]=he.useState(null),[ne,re]=he.useState(null);he.useEffect(()=>{ee()},[]);const ee=async()=>{try{const Ee=await(await fetch(Wt.url+`coffeelog/${m._id}`,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();if(Ee.status!=="success")return;E(Ee.coffeLogs)}catch(be){console.log(be)}},te=async be=>{be.preventDefault();const Ee=C;try{const Ie=await(await fetch(Wt.url+"recipes/recipe",{method:"POST",body:JSON.stringify(Ee),headers:{"Content-type":"application/json",Authorization:localStorage.getItem("token")}})).json();Ie.status==="success"?(B(Ie.message),re("charged"),X("saved"),setTimeout(()=>{d()},200)):(B(Ie.message),X("error"),re("charged"))}catch(Ae){B(Ae.message),X("error"),re("charged")}};return o&&w.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-900/30 backdrop-blur-md transition-all duration-300 z-50",children:w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-4xl w-full h-full md:max-h-[70vh] relative overflow-auto",children:[w.jsx(Rl,{size:30,onClick:d,className:"absolute top-2 right-2 text-gray-600 cursor-pointer hover:text-gray-800"}),w.jsx("h2",{className:"text-lg font-semibold text-center mb-6",children:"Agregar Receta"}),w.jsxs("form",{className:"space-y-6",onSubmit:te,children:[w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Título"}),w.jsx("input",{type:"text",name:"title",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Café"}),w.jsxs("select",{name:"coffee",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm",children:[w.jsx("option",{value:"",children:"Selecciona un café"}),k.map(be=>w.jsx("option",{value:be.id,children:be.coffeeName},be.id))]})]})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Método"}),w.jsx("input",{type:"text",name:"method",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Peso (g)"}),w.jsx("input",{type:"text",name:"coffee_weight",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Tiempo extracción"}),w.jsx("input",{type:"text",name:"brew_time",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Temperatura (ºC)"}),w.jsx("input",{type:"text",name:"temperature",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Ratio"}),w.jsx("input",{type:"text",name:"ratio",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Tamaño molienda"}),w.jsx("input",{type:"text",name:"grind_size",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Preinfusión (s)"}),w.jsx("input",{type:"text",name:"preinfusion_time",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Descripción"}),w.jsx("textarea",{name:"description",onChange:x,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm h-40 min-h-40 resize-none"})]}),w.jsx("div",{className:"text-center",children:w.jsx("button",{type:"submit",className:"bg-amber-700 text-white py-2 px-4 rounded-full hover:bg-amber-800",children:"Agregar"})}),ne==="charging"&&w.jsxs("div",{className:"flex justify-center items-center mt-4",children:[w.jsxs("svg",{className:"animate-spin h-6 w-6 text-amber-600 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 11-8 8z"})]}),w.jsx("p",{className:"text-amber-600 font-medium",children:"Creando registro..."})]}),w.jsx("strong",{children:V==="saved"?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",l," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""}),w.jsx("strong",{children:V=="error"?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",l," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""})]})]})})},u4=({isOpen:o,onClose:d,recipe:m,onUpdate:x})=>{const{auth:C}=Ri(),[k,E]=he.useState([]),[l,B]=he.useState(null),[V,X]=he.useState(null),[ne,re]=he.useState(null);he.useEffect(()=>{ee()},[]);const ee=async()=>{try{const Ee=await(await fetch(Wt.url+`coffeelog/${C._id}`,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();if(Ee.status!=="success")return;E(Ee.coffeLogs)}catch(be){console.log(be)}},te=async be=>{re("charging"),be.preventDefault();const Ee=a_(be.target);try{const Ie=await(await fetch(Wt.url+"recipes/recipe/"+m._id,{method:"PUT",body:JSON.stringify(Ee),headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}})).json();Ie.status==="success"?(x(Ie.recipe),B(Ie.message),X("saved"),re("charged"),setTimeout(()=>{d()},200)):(B(Ie.message),X("error"),re("charged"))}catch(Ae){re("charged"),B(Ae.message),X("error")}};return o&&w.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-900/30 backdrop-blur-md transition-all duration-300 z-50",children:w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-4xl w-full max-h-[98vh] relative overflow-auto",children:[w.jsx(Rl,{size:30,onClick:d,className:"absolute top-2 right-2 text-gray-600 cursor-pointer hover:text-gray-800"}),w.jsx("h2",{className:"text-lg font-semibold text-center mb-6",children:"Editar Receta"}),w.jsxs("form",{className:"space-y-6",onSubmit:te,children:[w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Título"}),w.jsx("input",{type:"text",name:"title",defaultValue:m.title,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Café"}),w.jsx("select",{name:"coffee",defaultValue:m.coffee?m.coffee.coffeName:"",className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm",children:k.map(be=>w.jsx("option",{value:be.id,children:be.coffeName},be.id))})]})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Método"}),w.jsx("input",{type:"text",name:"method",defaultValue:m.method,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Peso (g)"}),w.jsx("input",{type:"text",name:"coffee_weight",defaultValue:m.coffee_weight,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Tiempo extracción"}),w.jsx("input",{type:"text",name:"brew_time",defaultValue:m.brew_time,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Temperatura (ºC)"}),w.jsx("input",{type:"text",name:"temperature",defaultValue:m.temperature,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]})]}),w.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Ratio"}),w.jsx("input",{type:"text",name:"ratio",defaultValue:m.ratio,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Tamaño molienda"}),w.jsx("input",{type:"text",name:"grind_size",defaultValue:m.grind_size,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Preinfusión (s)"}),w.jsx("input",{type:"text",name:"preinfusion_time",defaultValue:m.preinfusion_time,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Descripción"}),w.jsx("textarea",{name:"description",defaultValue:m.description,className:"mt-2 block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm h-40 min-h-40 resize-none"})]}),w.jsx("div",{className:"text-center",children:w.jsx("button",{type:"submit",className:"bg-amber-700 text-white py-2 px-4 rounded-full hover:bg-amber-800",children:"Agregar"})}),ne==="charging"&&w.jsxs("div",{className:"flex justify-center items-center mt-4",children:[w.jsxs("svg",{className:"animate-spin h-6 w-6 text-amber-600 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 11-8 8z"})]}),w.jsx("p",{className:"text-amber-600 font-medium",children:"Creando registro..."})]}),w.jsx("strong",{children:V==="saved"?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",l," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""}),w.jsx("strong",{children:V=="error"?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",l," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""})]})]})})},h4=({onUpdate:o,user:d,permited:m})=>{const{auth:x}=Ri(),[C,k]=he.useState([]),[E,l]=he.useState(!1),[B,V]=he.useState(!1),[X,ne]=he.useState(!1),[re,ee]=he.useState(!1),[te,be]=he.useState(1),[Ee,Ae]=he.useState(null),[Ie,tt]=he.useState(null),[vt,nt]=he.useState(1),[Ye,st]=he.useState({coffeeName:"",origin:"",varietal:"",process:"",method:""}),[ot,at]=he.useState(null),{changed:xt,form:zt,setForm:Ht}=Il();he.useEffect(()=>{er()},[E,B,te]);const Yt=()=>{er(),o&&o()},er=async()=>{const yt=d._id;try{const Pt=await(await fetch(Wt.url+`recipes/${yt}/${te}`,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();Pt.status==="success"&&(k(Pt.recipes),Pt.hasNextPage&&Ae(Pt.hasNextPage),Pt.hasPrevPage&&tt(Pt.hasPrevPage),Pt.pages&&nt(Pt.pages))}catch(Je){console.log(Je.message)}},Rr=async yt=>{const Je=yt._id;try{(await(await fetch(Wt.url+"recipes/recipe/"+Je,{method:"DELETE",headers:{Authorization:localStorage.getItem("token")}})).json()).status==="success"&&er()}catch(Pt){console.log(Pt)}},Mt=async()=>{try{const yt=new URLSearchParams(zt).toString(),Pt=await(await fetch(Wt.url+`recipes/search/${d._id}?${yt}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}})).json();Pt.status==="success"&&k(Pt.recipes.docs)}catch(yt){console.log(yt)}};return w.jsx("div",{className:"mt-20 relative max-w-4xl mx-auto bg-white shadow-md rounded-lg overflow-hidden mt-6 p-6",children:w.jsxs("div",{className:"mt -6 flex flex-col gap-4 cursor-pointer",children:[w.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-xl border border-gray-200",children:w.jsxs("div",{className:"flex flex-col gap-4",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Filtros"}),w.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(zt).map(([yt,Je])=>Je&&w.jsxs("div",{className:"flex items-center bg-lime-400 text-white rounded-full px-3 py-1 shadow-sm",children:[w.jsxs("span",{className:"text-sm capitalize mr-2",children:[yt.replace(/([A-Z])/g," $1").trim(),":"]}),w.jsx("span",{className:"text-sm font-medium",children:Je}),w.jsx(Pl,{onClick:()=>{Ht(Pt=>({...Pt,[yt]:""})),er()},className:"hover:text-red-600"})]},yt))}),w.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(Ye).map(yt=>w.jsxs("button",{onClick:()=>{at(ot===yt?null:yt)},className:`w-8 h-8 rounded-full flex items-center justify-center transition-all
        ${Ye[yt]?"bg-lime-500 text-white":"bg-white text-gray-500"}
        border ${ot===yt?"border-lime-600 shadow-lg":"border-gray-300"}
        hover:shadow-md hover:border-lime-500`,title:yt.replace(/([A-Z])/g," $1").trim(),children:[yt==="coffeeName"&&"☕",yt==="origin"&&"🌍",yt==="varietal"&&"🌱",yt==="process"&&"⚙️",yt==="method"&&"📋"]},yt))})]}),w.jsx("div",{children:ot&&w.jsx("div",{className:"max-w-full bg-white p-4 rounded-lg shadow-xl border border-gray-100",children:w.jsxs("div",{className:"flex flex-col gap-2",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("label",{className:"text-sm font-medium text-gray-700",children:ot.replace(/([A-Z])/g," $1").trim()}),w.jsx(Pl,{onClick:()=>at(null),className:"hover:text-red-600"})]}),w.jsxs("div",{className:"flex gap-2 items-center",children:[w.jsx("input",{name:ot,type:"text",autoFocus:!0,className:"w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm",onChange:xt}),w.jsx(ux,{onClick:Mt,className:"mr-4 hover:text-green-600",size:17})]})]})})})]})}),w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"min-w-full bg-white border border-gray-300 rounded-lg",children:[w.jsx("thead",{children:w.jsxs("tr",{className:"bg-gray-100 text-gray-700 uppercase text-sm leading-normal",children:[w.jsx("th",{className:"py-3 px-6 text-left",children:"Café"}),w.jsx("th",{className:"py-3 px-6 text-left",children:"Origen"}),w.jsx("th",{className:"py-3 px-6 text-left",children:"Varietal"}),w.jsx("th",{className:"py-3 px-6 text-left",children:"Método"}),m&&w.jsx("th",{className:"py-3 px-6 text-center",children:"Acciones"})]})}),w.jsx("tbody",{className:"text-gray-600 text-md font-light",children:C&&C.length>0?C.map((yt,Je)=>w.jsxs("tr",{onClick:()=>{V(!0),ee(yt)},className:"border-b border-gray-200 hover:bg-gray-50 transition",children:[w.jsx("td",{className:"py-4 px-6",children:w.jsx("div",{className:"bg-gray-50 rounded-lg shadow p-4",children:w.jsx("p",{className:"font-medium text-gray-800",children:yt.coffee?yt.coffee.coffeeName:""})})}),w.jsx("td",{className:"py-4 px-6",children:w.jsx("div",{className:"bg-gray-50 rounded-lg shadow p-4",children:w.jsx("p",{className:"text-gray-600",children:yt.coffee?yt.coffee.origin:""})})}),w.jsx("td",{className:"py-4 px-6",children:w.jsx("div",{className:"bg-gray-50 rounded-lg shadow p-4",children:w.jsx("p",{className:"text-gray-600",children:yt.coffee?yt.coffee.varietal:""})})}),w.jsx("td",{className:"py-4 px-6",children:w.jsx("div",{className:"bg-gray-50 rounded-lg shadow p-4",children:w.jsx("p",{className:"text-gray-600",children:yt.method})})}),m&&w.jsx("td",{className:"py-4 px-6 text-center",children:w.jsxs("div",{className:"flex justify-center gap-3",children:[w.jsx(s_,{onClick:Pt=>{Pt.stopPropagation(),Rr(yt),V(!1)},className:"text-red-500 hover:text-red-700 cursor-pointer z-50",size:20}),w.jsx(n_,{onClick:()=>{ne(!0),V(!1),ee(yt)},className:"text-amber-500 hover:text-amber-700 cursor-pointer",size:20})]})})]},Je)):w.jsx("tr",{children:w.jsx("td",{colSpan:"5",children:w.jsx("p",{className:"text-center text-gray-600",children:"No hay registros de recetas."})})})})]})}),w.jsx("div",{className:"mt-4 p-1 flex justify-center hover:text-lime-700",children:m&&w.jsx(zu,{onClick:()=>l(!0),size:30})}),vt&&vt>1&&w.jsxs("div",{className:"flex justify-between items-center mt-6",children:[w.jsx(o_,{className:"text-gray-600 bg-white rounded-full p-2 hover:text-gray-800 hover:rounded-full hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",onClick:()=>{Ie&&be(yt=>Math.max(yt-1,1))},size:40}),w.jsxs("span",{className:"text-gray-700",children:["Página ",te," de ",vt]}),w.jsx(l_,{className:"text-gray-600 bg-white rounded-full p-2 hover:text-gray-800 hover:rounded-full hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",size:40,onClick:()=>{Ee&&be(yt=>Math.min(yt+1,vt))}})]}),E&&w.jsx(c4,{isOpen:E,onClose:()=>l(!1)}),B&&w.jsx(hx,{isOpen:B,onClose:()=>V(!1),recipe:re}),X&&w.jsx(u4,{isOpen:X,onClose:()=>{ne(!1),V(!1)},onUpdate:Yt,recipe:re})]})})};function h2(o){return Yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M203.043 26.648c-8.893.062-17.672 1.326-26.193 3.873-8.454 2.53-16.242 6.197-23.31 10.867 7.722 19.622 27.435 44.53 50.27 65.793 23.842 22.202 51.18 41.065 68.835 49.572l.207.1.203.103c16.224 8.335 27.71 21.453 34.34 35.924 4.27 9.318 6.757 19.078 8.207 29 13-10.14 26.704-18.26 40.636-24.153-1.06-18.31-5.088-37.51-12.424-56.735-15.386-40.32-42.26-72.78-72.695-92.576-21.875-14.228-45.35-21.926-68.077-21.768zm-76.408 42.305c-5.113 7.934-9.306 16.78-12.492 26.387-10.64 32.074-9.777 72.308 5.61 112.63 9.312 24.403 22.837 45.92 38.81 63.5 15.736 4.708 31.3 11.982 45.92 21.852 11.296 7.627 21.362 16.357 30.085 25.852 2.847.692 5.695 1.282 8.54 1.746 5.42-14.138 12.455-28.204 21.124-41.85 5.353-8.424 11.116-16.354 17.21-23.757.072-5.192.03-10.223-.217-15.026-.67-12.99-2.75-24.1-6.56-32.414-3.808-8.314-8.77-14.122-18.06-18.894l.41.202c-22.878-11.025-51.447-31.172-77.74-55.655-20.9-19.46-40.288-41.258-52.64-64.574zm279.752 135.725c-13.507.11-27.796 3.247-42.252 9.248-30.84 12.802-61.806 38.75-84.71 74.797-11.717 18.442-20.137 37.67-25.372 56.523 20.55 34.478 25.597 74.082 10.793 107.342 2.417 3.444 5.08 6.657 7.986 9.613 21.644-18.674 46.588-34.143 64.316-50.028 9.69-8.68 17.027-17.275 21.104-25.46 4.077-8.187 5.48-15.697 3.36-25.923l-.124-.595-.082-.6c-8.053-58.294 6.075-92.552 26.664-113.51 16.556-16.85 33.036-25.725 44.405-37.442-8.214-2.73-16.972-4.04-26.088-3.965zm56.746 23.953c-16.63 20.67-37.133 30.217-49.383 42.686-14.076 14.328-23.793 31.575-16.715 83.104 3.408 17.52.413 34.346-6.558 48.342-7.097 14.247-17.71 25.832-29.305 36.222-17.613 15.782-37.93 29.296-54.926 42.48 19.275 5.007 41.22 2.584 63.565-6.693 30.84-12.8 61.808-38.75 84.71-74.797 22.905-36.048 33.24-75.107 31.728-108.463-1.156-25.51-9.035-47.368-23.115-62.88zm-66.098 125.79c-.06-.315-.108-.628-.174-.943l.208 1.193c-.01-.085-.02-.165-.033-.25zm-280.223-71.424c-18.383-.166-35.7 3.865-50.275 11.807.1.003.187.01.287.013 8.63.305 19.464-.713 31.938.99 12.473 1.704 27.085 7.368 38.154 19.893 11.07 12.524 18.66 30.28 23.947 55.78l.125.594.082.602c2.453 17.792 13.786 28.085 33.434 37.722 16.764 8.223 38.287 14.095 58.717 20.073 9.15-41-12.56-91.006-58.81-122.23-24.938-16.836-52.274-25.015-77.597-25.244zm-81.078 41.447c-25.27 43.53-5.004 107.405 50.106 144.612 54.225 36.61 119.786 32.276 151.34-5.7-18.436-5.254-39.336-11.22-58.53-20.634-24.75-12.14-48.34-32.54-53.1-64.222-4.533-21.7-10.59-33.28-15.61-38.96-5.04-5.707-8.97-7.095-16.05-8.06-7.08-.968-16.81-.277-28.333-.683-8.98-.316-19.516-1.605-29.823-6.352zm89.817 54.055c.022.1.044.192.065.293l-.207-1.196c.042.304.097.6.143.904z"},child:[]}]})(o)}const fp=({title:o,icon:d,children:m})=>{const[x,C]=he.useState(!1);return w.jsxs("div",{className:"border-b border-gray-200",children:[w.jsxs("button",{className:"flex items-center justify-between w-full p-4 text-left font-semibold text-gray-800 bg-gray-100 hover:bg-gray-200 transition-all",onClick:()=>C(!x),children:[w.jsxs("div",{className:"flex items-center",children:[d,w.jsx("span",{className:"ml-2",children:o})]}),w.jsx("span",{className:"text-gray-600",children:x?"▲":"▼"})]}),w.jsx("div",{className:`overflow-hidden transition-max-height duration-300 ${x?"max-h-96 p-4":"max-h-0"}`,children:m})]})},d4=({user:o})=>{var d,m,x,C;return w.jsxs("div",{className:"max-w-3xl mx-auto bg-white shadow-lg rounded-lg overflow-hidden mt-6",children:[((d=o.certifications)==null?void 0:d.length)>0&&w.jsx(fp,{title:"Certificaciones",icon:w.jsx(xT,{className:"text-amber-600"}),children:w.jsx("ul",{className:"list-disc pl-6 text-gray-700",children:o.certifications.map((k,E)=>w.jsx("li",{children:k},E))})}),((m=o.coffeeVarieties)==null?void 0:m.length)>0&&w.jsx(fp,{title:"Variedades de Café",icon:w.jsx(h2,{className:"text-amber-600"}),children:w.jsx("ul",{className:"list-disc pl-6 text-gray-700",children:o.coffeeVarieties.map((k,E)=>w.jsx("li",{children:k},E))})}),((x=o.menu)==null?void 0:x.length)>0&&w.jsx(fp,{title:"Menú",icon:w.jsx(ST,{className:"text-amber-600"}),children:w.jsx("ul",{className:"list-disc pl-6 text-gray-700",children:o.menu.map((k,E)=>w.jsx("li",{children:k},E))})}),((C=o.origin)==null?void 0:C.length)>0&&w.jsx(fp,{title:"Orígenes",icon:w.jsx(wT,{className:"text-amber-600"}),children:w.jsx("ul",{className:"list-disc pl-6 text-gray-700",children:o.origin.map((k,E)=>w.jsx("li",{children:k},E))})}),o.openingHours&&w.jsx(fp,{title:"Horario",icon:w.jsx(bT,{className:"text-amber-600"}),children:w.jsx("ul",{className:"text-gray-700",children:Object.entries(o.openingHours).map(([k,E])=>w.jsxs("li",{className:"mb-1",children:[w.jsxs("strong",{children:[k,":"]})," ",E]},k))})}),o.location&&w.jsx(fp,{title:"Ubicación",icon:w.jsx(K_,{className:"text-amber-600"}),children:w.jsx(c2,{coordinates:o.location.coordinates})})]})},f4=()=>{var _t,Ot;const{auth:o,setAuth:d}=Ri(),m=Iu();let x=(_t=m.state)==null?void 0:_t.user;x||(x=o._id);const[C,k]=he.useState(),[E,l]=he.useState(!0),[B,V]=he.useState(0),[X,ne]=he.useState(0),[re,ee]=he.useState(0),[te,be]=he.useState(!1),[Ee,Ae]=he.useState(!1),[Ie,tt]=he.useState(!1),[vt,nt]=he.useState(!1),[Ye,st]=he.useState(!1),[ot,at]=he.useState(!1),[xt,zt]=he.useState(!0),[Ht,Yt]=he.useState(!1),[er,Rr]=he.useState(!1),[Mt,yt]=he.useState(!1);he.useEffect(()=>{Je()},[]),he.useEffect(()=>{Je()},[o,xt,(Ot=m.state)==null?void 0:Ot.user,Mt]);const Je=async()=>{l(!0);try{const Et=await(await fetch(Wt.url+"users/"+x,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();Et.editionPermited===!0?be(!0):Pt();const rr=await(await fetch(Wt.url+"followers/"+x,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json(),qr=parseInt(rr.total);V(qr);const $r=await(await fetch(Wt.url+"/followings/"+x,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json(),Br=parseInt($r.total);ne(Br);const Hi=await(await fetch(Wt.url+"posts/"+x,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json(),hi=parseInt(Hi.total);ee(hi),l(!1),k(Et.user)}catch(It){console.error(It),l(!1)}},Pt=async()=>{try{if(!te&&x){const Et=await(await fetch(Wt.url+"/followings/"+o._id,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();if(Et.status==="success"){const Kt=Et.users_folowing.includes(x);yt(Kt)}else ne(!1)}}catch(It){console.error("Error al comprobar si sigues al usuario",It)}},Se=async()=>{try{if(Mt){const Et=await(await fetch(`${Wt.url}unfollow/${C._id}`,{method:"DELETE",headers:{Authorization:localStorage.getItem("token")}})).json();Et.status==="success"?yt(!1):console.error("Error al dejar de seguir al usuario: ",Et.message)}else{const Et=await(await fetch(`${Wt.url}follow`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")},body:JSON.stringify({followed:C._id})})).json();Et.status==="success"?yt(!0):console.error("Error al seguir al usuario: ",Et.message)}}catch(It){console.error("Error en la petición: ",It)}};return E?w.jsxs("div",{className:"flex justify-center items-center mt-4",children:[w.jsxs("svg",{className:"animate-spin h-6 w-6 text-amber-600 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 11-8 8z"})]}),w.jsx("p",{className:"text-amber-600 font-medium",children:"Cargando.."})]}):w.jsxs("div",{className:"w-full max-w-4xl sm:max-w-lg md:max-w-2xl lg:max-w-3xl xl:max-w-4xl mx-auto bg-white shadow-md rounded-lg overflow-hidden mt-[20%] sm:mt-[20%] md:mt-[10%] lg:mt-[7%] xl:mt-[7%] 2xl:mt-[5%] p-6",children:[w.jsxs("div",{className:"relative flex justify-around items-center mb-6",children:[w.jsxs("div",{className:"relative flex justify-center items-center",children:[w.jsx("img",{className:`w-45 h-30 md:w-40 md:h-40  lg:h-40 xl:w-40 lg:h-40 border-4 rounded-full object-cover ${C&&C.avatar?"border-gray-300":"border-amber-500"}`,src:(C==null?void 0:C.avatar)||Uh,alt:"Imagen"}),te&&w.jsxs(w.Fragment,{children:[w.jsx(TT,{title:"Cambiar Avatar",onClick:()=>Ae(!0),size:30,className:"absolute bottom-1 right-4 text-gray-600 bg-white rounded-full p-1 cursor-pointer shadow-md hover:text-gray-800"}),w.jsx(PT,{title:"Configurar",size:30,className:"absolute bottom-1 left-4 text-gray-600 bg-white rounded-full p-1 cursor-pointer shadow-md hover:text-gray-800",onClick:()=>tt(!0)})]})]}),w.jsxs("div",{className:"flex flex-col text-center items-center p-4",children:[w.jsxs("div",{children:[w.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:C.username}),w.jsx("p",{className:"mt-2 text-gray-600",children:C.bio})]}),te?"":w.jsx("button",{type:"button",onClick:Se,className:`text-white mt-4 ${Mt?"bg-gray-700 hover:bg-red-600":"bg-amber-700 hover:bg-amber-800"} focus:ring-4 focus:outline-none font-medium rounded-full text-sm px-4 py-2`,children:Mt?"Dejar de seguir":"Seguir"})]})]}),Ie&&w.jsx(r4,{isOpen:Ie,onClose:()=>tt(!1)}),Ee&&w.jsx(tC,{isOpen:Ee,onClose:()=>Ae(!1)}),w.jsx(d4,{user:C}),w.jsxs("div",{className:"flex flex-wrap justify-between mt-6 gap-4",children:[w.jsxs("button",{className:"flex-1 p-4 text-center bg-gray-50 rounded-md shadow-sm cursor-pointer hover:shadow-xl",children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Publicaciones"}),w.jsx("p",{className:"mt-2 text-gray-600",children:re})]}),w.jsxs("button",{className:"flex-1 p-4 text-center bg-gray-50 rounded-md shadow-sm cursor-pointer hover:shadow-xl",onClick:B>0?()=>nt(!0):void 0,children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Seguidores"}),w.jsx("p",{className:"mt-2 text-gray-600",children:B})]}),vt&&te!==void 0&&w.jsx(i4,{isOpen:vt,onClose:()=>nt(!1),numberFollows:ne,user:C,permited:te}),w.jsxs("button",{className:"flex-1 p-4 text-center bg-gray-50 rounded-md shadow-sm cursor-pointer hover:shadow-xl",onClick:X>0?()=>st(!0):void 0,children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Seguidos"}),w.jsx("p",{className:"mt-2 text-gray-600",children:X})]}),Ye&&te!==void 0&&w.jsx(a4,{isOpen:Ye,onClose:()=>st(!1),setFollowings:ne,user:C,permited:te})]}),w.jsxs("div",{className:"mt-10 pl-6 pr-6 flex justify-between ",children:[w.jsx(JE,{onClick:()=>{zt(!0),at(!1),Yt(!1)},className:"text-gray-600 bg-white rounded-full p-2 hover:text-gray-800 hover:rounded-full hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",size:40}),w.jsx(h2,{onClick:()=>{at(!0),zt(!1),Yt(!1)},className:"text-gray-600 bg-white rounded-full p-2 hover:text-gray-800 hover:rounded-full hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",size:40}),w.jsx(QE,{onClick:()=>{Yt(!0),at(!1),zt(!1)},className:"text-gray-600 bg-white rounded-full p-2 hover:text-gray-800 hover:rounded-full hover:shadow-md cursor-pointer transition-all duration-200 ease-in-out",size:40})]}),w.jsx("div",{className:"mt-2",children:ot&&te!==void 0&&w.jsx(u2,{user:C,permited:te})}),w.jsx("div",{className:"mt-2",children:xt&&te!==void 0&&w.jsx(l4,{onUpdate:()=>{Rr(It=>!It),ee(()=>Je())},user:C,permited:te})}),w.jsx("div",{className:"mt-2",children:Ht&&te!==void 0&&w.jsx(h4,{user:C,permited:te})})]})},p4=()=>{const{setAuth:o}=Ri(),d=zl();return he.useEffect(()=>{localStorage.clear(),o({}),d("/login")}),w.jsx("h1",{children:"Cerrando sesión..."})};var Ly={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.5.0/LICENSE.txt
 */var m4=Ly.exports,S1;function g4(){return S1||(S1=1,function(o,d){(function(m,x){o.exports=x()})(m4,function(){var m={},x={};function C(E,l,B){if(x[E]=B,E==="index"){var V="var sharedModule = {}; ("+x.shared+")(sharedModule); ("+x.worker+")(sharedModule);",X={};return x.shared(X),x.index(m,X),typeof window<"u"&&m.setWorkerUrl(window.URL.createObjectURL(new Blob([V],{type:"text/javascript"}))),m}}C("shared",["exports"],function(E){function l(n,t,a,c){return new(a||(a=Promise))(function(p,v){function b(I){try{P(c.next(I))}catch(D){v(D)}}function T(I){try{P(c.throw(I))}catch(D){v(D)}}function P(I){var D;I.done?p(I.value):(D=I.value,D instanceof a?D:new a(function(L){L(D)})).then(b,T)}P((c=c.apply(n,t||[])).next())})}function B(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var V,X;function ne(){if(X)return V;function n(t,a){this.x=t,this.y=a}return X=1,V=n,n.prototype={clone:function(){return new n(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,a){return this.clone()._rotateAround(t,a)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var a=t.x-this.x,c=t.y-this.y;return a*a+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,a){return Math.atan2(this.x*a-this.y*t,this.x*t+this.y*a)},_matMult:function(t){var a=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=a,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var a=Math.cos(t),c=Math.sin(t),p=c*this.x+a*this.y;return this.x=a*this.x-c*this.y,this.y=p,this},_rotateAround:function(t,a){var c=Math.cos(t),p=Math.sin(t),v=a.y+p*(this.x-a.x)+c*(this.y-a.y);return this.x=a.x+c*(this.x-a.x)-p*(this.y-a.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t},V}typeof SuppressedError=="function"&&SuppressedError;var re,ee,te=B(ne()),be=function(){if(ee)return re;function n(t,a,c,p){this.cx=3*t,this.bx=3*(c-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=c,this.p2y=p}return ee=1,re=n,n.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var c=t,p=0;p<8;p++){var v=this.sampleCurveX(c)-t;if(Math.abs(v)<a)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=v/b}var T=0,P=1;for(c=t,p=0;p<20&&(v=this.sampleCurveX(c),!(Math.abs(v-t)<a));p++)t>v?T=c:P=c,c=.5*(P-T)+T;return c},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},re}(),Ee=B(be);let Ae,Ie;function tt(){return Ae==null&&(Ae=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ae}function vt(){if(Ie==null&&(Ie=!1,tt())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let c=0;c<5*5;c++){const p=4*c;t.fillStyle=`rgb(${p},${p+1},${p+2})`,t.fillRect(c%5,Math.floor(c/5),1,1)}const a=t.getImageData(0,0,5,5).data;for(let c=0;c<5*5*4;c++)if(c%4!=3&&a[c]!==c){Ie=!0;break}}}return Ie||!1}var nt=1e-6,Ye=typeof Float32Array<"u"?Float32Array:Array;function st(){var n=new Ye(9);return Ye!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function ot(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function at(){var n=new Ye(3);return Ye!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function xt(n){return Math.hypot(n[0],n[1],n[2])}function zt(n,t,a){var c=new Ye(3);return c[0]=n,c[1]=t,c[2]=a,c}Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});var Ht,Yt=xt;function er(n,t,a){var c=t[0],p=t[1],v=t[2],b=t[3];return n[0]=a[0]*c+a[4]*p+a[8]*v+a[12]*b,n[1]=a[1]*c+a[5]*p+a[9]*v+a[13]*b,n[2]=a[2]*c+a[6]*p+a[10]*v+a[14]*b,n[3]=a[3]*c+a[7]*p+a[11]*v+a[15]*b,n}function Rr(){var n=new Ye(4);return Ye!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function Mt(){var n=new Ye(2);return Ye!=Float32Array&&(n[0]=0,n[1]=0),n}function yt(n,t){var a=new Ye(2);return a[0]=n,a[1]=t,a}at(),Ht=new Ye(4),Ye!=Float32Array&&(Ht[0]=0,Ht[1]=0,Ht[2]=0,Ht[3]=0),at(),zt(1,0,0),zt(0,1,0),Rr(),Rr(),st(),Mt();const Je=8192;function Pt(n,t,a){return t*(Je/(n.tileSize*Math.pow(2,a-n.tileID.overscaledZ)))}function Se(n,t){return(n%t+t)%t}function _t(n,t,a){return n*(1-a)+t*a}function Ot(n){if(n<=0)return 0;if(n>=1)return 1;const t=n*n,a=t*n;return 4*(n<.5?a:3*(n-t)+a-.75)}function It(n,t,a,c){const p=new Ee(n,t,a,c);return v=>p.solve(v)}const Et=It(.25,.1,.25,1);function Kt(n,t,a){return Math.min(a,Math.max(t,n))}function rr(n,t,a){const c=a-t,p=((n-t)%c+c)%c+t;return p===t?a:p}function qr(n,...t){for(const a of t)for(const c in a)n[c]=a[c];return n}let wr=1;function $r(n,t,a){const c={};for(const p in n)c[p]=t.call(this,n[p],p,n);return c}function Br(n,t,a){const c={};for(const p in n)t.call(this,n[p],p,n)&&(c[p]=n[p]);return c}function vi(n){return Array.isArray(n)?n.map(vi):typeof n=="object"&&n?$r(n,vi):n}const Hi={};function hi(n){Hi[n]||(typeof console<"u"&&console.warn(n),Hi[n]=!0)}function Fr(n,t,a){return(a.y-n.y)*(t.x-n.x)>(t.y-n.y)*(a.x-n.x)}function $a(n){return typeof WorkerGlobalScope<"u"&&n!==void 0&&n instanceof WorkerGlobalScope}let Ga=null;function za(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const Gs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Eo(n,t,a,c,p){return l(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const v=new VideoFrame(n,{timestamp:0});try{const b=v==null?void 0:v.format;if(!b||!b.startsWith("BGR")&&!b.startsWith("RGB"))throw new Error(`Unrecognized format ${b}`);const T=b.startsWith("BGR"),P=new Uint8ClampedArray(c*p*4);if(yield v.copyTo(P,function(I,D,L,q,G){const H=4*Math.max(1,0),K=(Math.max(0,L)-L)*q*4+H,se=4*q,fe=Math.max(0,D),Me=Math.max(0,L);return{rect:{x:fe,y:Me,width:Math.min(I.width,D+q)-fe,height:Math.min(I.height,L+G)-Me},layout:[{offset:K,stride:se}]}}(n,t,a,c,p)),T)for(let I=0;I<P.length;I+=4){const D=P[I];P[I]=P[I+2],P[I+2]=D}return P}finally{v.close()}})}let Sa,ln;function Co(n,t,a,c){return n.addEventListener(t,a,c),{unsubscribe:()=>{n.removeEventListener(t,a,c)}}}function Ao(n){return n*Math.PI/180}function Ji(n){return n/Math.PI*180}const Dl={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ko={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Po="AbortError";function cn(){return new Error(Po)}const ws={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ss(n){return ws.REGISTERED_PROTOCOLS[n.substring(0,n.indexOf("://"))]}const Nl="global-dispatcher";class un extends Error{constructor(t,a,c,p){super(`AJAXError: ${a} (${t}): ${c}`),this.status=t,this.statusText=a,this.url=c,this.body=p}}const ea=()=>$a(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Mi=function(n,t){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){const c=Ss(n.url);if(c)return c(n,t);if($a(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,targetMapId:Nl},t)}if(!(/^file:/.test(a=n.url)||/^file:/.test(ea())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(c,p){return l(this,void 0,void 0,function*(){const v=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:ea(),signal:p.signal});let b,T;c.type!=="json"||v.headers.has("Accept")||v.headers.set("Accept","application/json");try{b=yield fetch(v)}catch(I){throw new un(0,I.message,c.url,new Blob)}if(!b.ok){const I=yield b.blob();throw new un(b.status,b.statusText,c.url,I)}T=c.type==="arrayBuffer"||c.type==="image"?b.arrayBuffer():c.type==="json"?b.json():b.text();const P=yield T;if(p.signal.aborted)throw cn();return{data:P,cacheControl:b.headers.get("Cache-Control"),expires:b.headers.get("Expires")}})}(n,t);if($a(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,mustQueue:!0,targetMapId:Nl},t)}var a;return function(c,p){return new Promise((v,b)=>{var T;const P=new XMLHttpRequest;P.open(c.method||"GET",c.url,!0),c.type!=="arrayBuffer"&&c.type!=="image"||(P.responseType="arraybuffer");for(const I in c.headers)P.setRequestHeader(I,c.headers[I]);c.type==="json"&&(P.responseType="text",!((T=c.headers)===null||T===void 0)&&T.Accept||P.setRequestHeader("Accept","application/json")),P.withCredentials=c.credentials==="include",P.onerror=()=>{b(new Error(P.statusText))},P.onload=()=>{if(!p.signal.aborted)if((P.status>=200&&P.status<300||P.status===0)&&P.response!==null){let I=P.response;if(c.type==="json")try{I=JSON.parse(P.response)}catch(D){return void b(D)}v({data:I,cacheControl:P.getResponseHeader("Cache-Control"),expires:P.getResponseHeader("Expires")})}else{const I=new Blob([P.response],{type:P.getResponseHeader("Content-Type")});b(new un(P.status,P.statusText,c.url,I))}},p.signal.addEventListener("abort",()=>{P.abort(),b(cn())}),P.send(c.body)})}(n,t)};function Re(n){if(!n||n.indexOf("://")<=0||n.indexOf("data:image/")===0||n.indexOf("blob:")===0)return!0;const t=new URL(n),a=window.location;return t.protocol===a.protocol&&t.host===a.host}function Q(n,t,a){a[n]&&a[n].indexOf(t)!==-1||(a[n]=a[n]||[],a[n].push(t))}function J(n,t,a){if(a&&a[n]){const c=a[n].indexOf(t);c!==-1&&a[n].splice(c,1)}}class le{constructor(t,a={}){qr(this,a),this.type=t}}class ye extends le{constructor(t,a={}){super("error",qr({error:t},a))}}class Ce{on(t,a){return this._listeners=this._listeners||{},Q(t,a,this._listeners),{unsubscribe:()=>{this.off(t,a)}}}off(t,a){return J(t,a,this._listeners),J(t,a,this._oneTimeListeners),this}once(t,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Q(t,a,this._oneTimeListeners),this):new Promise(c=>this.once(t,c))}fire(t,a){typeof t=="string"&&(t=new le(t,a||{}));const c=t.type;if(this.listens(c)){t.target=this;const p=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const T of p)T.call(this,t);const v=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const T of v)J(c,T,this._oneTimeListeners),T.call(this,t);const b=this._eventedParent;b&&(qr(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(t))}else t instanceof ye&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var oe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ue=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Pe(n,t){const a={};for(const c in n)c!=="ref"&&(a[c]=n[c]);return Ue.forEach(c=>{c in t&&(a[c]=t[c])}),a}function Le(n,t){if(Array.isArray(n)){if(!Array.isArray(t)||n.length!==t.length)return!1;for(let a=0;a<n.length;a++)if(!Le(n[a],t[a]))return!1;return!0}if(typeof n=="object"&&n!==null&&t!==null){if(typeof t!="object"||Object.keys(n).length!==Object.keys(t).length)return!1;for(const a in n)if(!Le(n[a],t[a]))return!1;return!0}return n===t}function Ze(n,t){n.push(t)}function Ne(n,t,a){Ze(a,{command:"addSource",args:[n,t[n]]})}function ht(n,t,a){Ze(t,{command:"removeSource",args:[n]}),a[n]=!0}function Tt(n,t,a,c){ht(n,a,c),Ne(n,t,a)}function Ct(n,t,a){let c;for(c in n[a])if(Object.prototype.hasOwnProperty.call(n[a],c)&&c!=="data"&&!Le(n[a][c],t[a][c]))return!1;for(c in t[a])if(Object.prototype.hasOwnProperty.call(t[a],c)&&c!=="data"&&!Le(n[a][c],t[a][c]))return!1;return!0}function Bt(n,t,a,c,p,v){n=n||{},t=t||{};for(const b in n)Object.prototype.hasOwnProperty.call(n,b)&&(Le(n[b],t[b])||a.push({command:v,args:[c,b,t[b],p]}));for(const b in t)Object.prototype.hasOwnProperty.call(t,b)&&!Object.prototype.hasOwnProperty.call(n,b)&&(Le(n[b],t[b])||a.push({command:v,args:[c,b,t[b],p]}))}function ar(n){return n.id}function Xt(n,t){return n[t.id]=t,n}class Qe{constructor(t,a,c,p){this.message=(t?`${t}: `:"")+c,p&&(this.identifier=p),a!=null&&a.__line__&&(this.line=a.__line__)}}function jr(n,...t){for(const a of t)for(const c in a)n[c]=a[c];return n}class fr extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}class Ar{constructor(t,a=[]){this.parent=t,this.bindings={};for(const[c,p]of a)this.bindings[c]=p}concat(t){return new Ar(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Zt={kind:"null"},rt={kind:"number"},Rt={kind:"string"},Qt={kind:"boolean"},ii={kind:"color"},xi={kind:"projectionDefinition"},Ia={kind:"object"},nr={kind:"value"},Xn={kind:"collator"},jo={kind:"formatted"},Ha={kind:"padding"},Yn={kind:"colorArray"},Wa={kind:"numberArray"},hn={kind:"resolvedImage"},_r={kind:"variableAnchorOffsetCollection"};function Ra(n,t){return{kind:"array",itemType:n,N:t}}function Kr(n){if(n.kind==="array"){const t=Kr(n.itemType);return typeof n.N=="number"?`array<${t}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${t}>`}return n.kind}const An=[Zt,rt,Rt,Qt,ii,xi,jo,Ia,Ra(nr),Ha,Wa,Yn,hn,_r];function kn(n,t){if(t.kind==="error")return null;if(n.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!kn(n.itemType,t.itemType))&&(typeof n.N!="number"||n.N===t.N))return null}else{if(n.kind===t.kind)return null;if(n.kind==="value"){for(const a of An)if(!kn(a,t))return null}}return`Expected ${Kr(n)} but found ${Kr(t)} instead.`}function Pn(n,t){return t.some(a=>a.kind===n.kind)}function zo(n,t){return t.some(a=>a==="null"?n===null:a==="array"?Array.isArray(n):a==="object"?n&&!Array.isArray(n)&&typeof n=="object":a===typeof n)}function Kn(n,t){return n.kind==="array"&&t.kind==="array"?n.itemType.kind===t.itemType.kind&&typeof n.N=="number":n.kind===t.kind}const qh=.96422,Zh=.82521,Rc=4/29,Ts=6/29,Qn=3*Ts*Ts,dn=Ts*Ts*Ts,hf=Math.PI/180,Vp=180/Math.PI;function Dc(n){return(n%=360)<0&&(n+=360),n}function Du([n,t,a,c]){let p,v;const b=$h((.2225045*(n=Jn(n))+.7168786*(t=Jn(t))+.0606169*(a=Jn(a)))/1);n===t&&t===a?p=v=b:(p=$h((.4360747*n+.3850649*t+.1430804*a)/qh),v=$h((.0139322*n+.0971045*t+.7141733*a)/Zh));const T=116*b-16;return[T<0?0:T,500*(p-b),200*(b-v),c]}function Jn(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function $h(n){return n>dn?Math.pow(n,1/3):n/Qn+Rc}function Xa([n,t,a,c]){let p=(n+16)/116,v=isNaN(t)?p:p+t/500,b=isNaN(a)?p:p-a/200;return p=1*Nu(p),v=qh*Nu(v),b=Zh*Nu(b),[Ms(3.1338561*v-1.6168667*p-.4906146*b),Ms(-.9787684*v+1.9161415*p+.033454*b),Ms(.0719453*v-.2289914*p+1.4052427*b),c]}function Ms(n){return(n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055)<0?0:n>1?1:n}function Nu(n){return n>Ts?n*n*n:Qn*(n-Rc)}const Gh=Object.hasOwn||function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};function es(n,t){return Gh(n,t)?n[t]:void 0}function Ll(n){return parseInt(n.padEnd(2,n),16)/255}function Lu(n,t){return Ui(t?n/100:n,0,1)}function Ui(n,t,a){return Math.min(Math.max(t,n),a)}function Sr(n){return!n.some(Number.isNaN)}const Io={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function fa(n,t,a){return n+a*(t-n)}function Es(n,t,a){return n.map((c,p)=>fa(c,t[p],a))}class vr{constructor(t,a,c,p=1,v=!0){this.r=t,this.g=a,this.b=c,this.a=p,v||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[t,a,c,p]))}static parse(t){if(t instanceof vr)return t;if(typeof t!="string")return;const a=function(c){if((c=c.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=es(Io,c);if(p){const[b,T,P]=p;return[b/255,T/255,P/255,1]}if(c.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(c)){const b=c.length<6?1:2;let T=1;return[Ll(c.slice(T,T+=b)),Ll(c.slice(T,T+=b)),Ll(c.slice(T,T+=b)),Ll(c.slice(T,T+b)||"ff")]}if(c.startsWith("rgb")){const b=c.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[T,P,I,D,L,q,G,H,K,se,fe,Me]=b,me=[D||" ",G||" ",se].join("");if(me==="  "||me==="  /"||me===",,"||me===",,,"){const $=[I,q,K].join(""),ae=$==="%%%"?100:$===""?255:0;if(ae){const _e=[Ui(+P/ae,0,1),Ui(+L/ae,0,1),Ui(+H/ae,0,1),fe?Lu(+fe,Me):1];if(Sr(_e))return _e}}return}}const v=c.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[b,T,P,I,D,L,q,G,H]=v,K=[P||" ",D||" ",q].join("");if(K==="  "||K==="  /"||K===",,"||K===",,,"){const se=[+T,Ui(+I,0,100),Ui(+L,0,100),G?Lu(+G,H):1];if(Sr(se))return function([fe,Me,me,$]){function ae(_e){const Fe=(_e+fe/30)%12,ut=Me*Math.min(me,1-me);return me-ut*Math.max(-1,Math.min(Fe-3,9-Fe,1))}return fe=Dc(fe),Me/=100,me/=100,[ae(0),ae(8),ae(4),$]}(se)}}}(t);return a?new vr(...a,!1):void 0}get rgb(){const{r:t,g:a,b:c,a:p}=this,v=p||1/0;return this.overwriteGetter("rgb",[t/v,a/v,c/v,p])}get hcl(){return this.overwriteGetter("hcl",function(t){const[a,c,p,v]=Du(t),b=Math.sqrt(c*c+p*p);return[Math.round(1e4*b)?Dc(Math.atan2(p,c)*Vp):NaN,b,a,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Du(this.rgb))}overwriteGetter(t,a){return Object.defineProperty(this,t,{value:a}),a}toString(){const[t,a,c,p]=this.rgb;return`rgba(${[t,a,c].map(v=>Math.round(255*v)).join(",")},${p})`}static interpolate(t,a,c,p="rgb"){switch(p){case"rgb":{const[v,b,T,P]=Es(t.rgb,a.rgb,c);return new vr(v,b,T,P,!1)}case"hcl":{const[v,b,T,P]=t.hcl,[I,D,L,q]=a.hcl;let G,H;if(isNaN(v)||isNaN(I))isNaN(v)?isNaN(I)?G=NaN:(G=I,T!==1&&T!==0||(H=D)):(G=v,L!==1&&L!==0||(H=b));else{let me=I-v;I>v&&me>180?me-=360:I<v&&v-I>180&&(me+=360),G=v+c*me}const[K,se,fe,Me]=function([me,$,ae,_e]){return me=isNaN(me)?0:me*hf,Xa([ae,Math.cos(me)*$,Math.sin(me)*$,_e])}([G,H??fa(b,D,c),fa(T,L,c),fa(P,q,c)]);return new vr(K,se,fe,Me,!1)}case"lab":{const[v,b,T,P]=Xa(Es(t.lab,a.lab,c));return new vr(v,b,T,P,!1)}}}}vr.black=new vr(0,0,0,1),vr.white=new vr(1,1,1,1),vr.transparent=new vr(0,0,0,0),vr.red=new vr(1,0,0,1);class Nc{constructor(t,a,c){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Hs=["bottom","center","top"];class Ws{constructor(t,a,c,p,v,b){this.text=t,this.image=a,this.scale=c,this.fontStack=p,this.textColor=v,this.verticalAlign=b}}class pa{constructor(t){this.sections=t}static fromString(t){return new pa([new Ws(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof pa?t:pa.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Ei{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ei)return t;if(typeof t=="number")return new Ei([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const a of t)if(typeof a!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Ei(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,c){return new Ei(Es(t.values,a.values,c))}}class Qr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Qr)return t;if(typeof t=="number")return new Qr([t]);if(Array.isArray(t)){for(const a of t)if(typeof a!="number")return;return new Qr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,c){return new Qr(Es(t.values,a.values,c))}}class ta{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ta)return t;if(typeof t=="string"){const c=vr.parse(t);return c?new ta([c]):void 0}if(!Array.isArray(t))return;const a=[];for(const c of t){if(typeof c!="string")return;const p=vr.parse(c);if(!p)return;a.push(p)}return new ta(a)}toString(){return JSON.stringify(this.values)}static interpolate(t,a,c,p="rgb"){const v=[];if(t.values.length!=a.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${a.values.length}), cannot interpolate.`);for(let b=0;b<t.values.length;b++)v.push(vr.interpolate(t.values[b],a.values[b],c,p));return new ta(v)}}class Gr extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const Ro=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Wi{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Wi)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let a=0;a<t.length;a+=2){const c=t[a],p=t[a+1];if(typeof c!="string"||!Ro.has(c)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new Wi(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,a,c){const p=t.values,v=a.values;if(p.length!==v.length)throw new Gr(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${a.toString()}`);const b=[];for(let T=0;T<p.length;T+=2){if(p[T]!==v[T])throw new Gr(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${p[T]}, to[${T}]: ${v[T]}`);b.push(p[T]);const[P,I]=p[T+1],[D,L]=v[T+1];b.push([fa(P,D,c),fa(I,L,c)])}return new Wi(b)}}class Ta{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Ta({name:t,available:!1}):null}}class ra{constructor(t,a,c){this.from=t,this.to=a,this.transition=c}static interpolate(t,a,c){return new ra(t,a,c)}static parse(t){return t instanceof ra?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new ra(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new ra(t.from,t.to,t.transition):typeof t=="string"?new ra(t,t,1):void 0}}function fn(n,t,a,c){return typeof n=="number"&&n>=0&&n<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[n,t,a,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[n,t,a,c]:[n,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Dr(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof ra||n instanceof vr||n instanceof Nc||n instanceof pa||n instanceof Ei||n instanceof Qr||n instanceof ta||n instanceof Wi||n instanceof Ta)return!0;if(Array.isArray(n)){for(const t of n)if(!Dr(t))return!1;return!0}if(typeof n=="object"){for(const t in n)if(!Dr(n[t]))return!1;return!0}return!1}function Jr(n){if(n===null)return Zt;if(typeof n=="string")return Rt;if(typeof n=="boolean")return Qt;if(typeof n=="number")return rt;if(n instanceof vr)return ii;if(n instanceof ra)return xi;if(n instanceof Nc)return Xn;if(n instanceof pa)return jo;if(n instanceof Ei)return Ha;if(n instanceof Qr)return Wa;if(n instanceof ta)return Yn;if(n instanceof Wi)return _r;if(n instanceof Ta)return hn;if(Array.isArray(n)){const t=n.length;let a;for(const c of n){const p=Jr(c);if(a){if(a===p)continue;a=nr;break}a=p}return Ra(a||nr,t)}return Ia}function pr(n){const t=typeof n;return n===null?"":t==="string"||t==="number"||t==="boolean"?String(n):n instanceof vr||n instanceof ra||n instanceof pa||n instanceof Ei||n instanceof Qr||n instanceof ta||n instanceof Wi||n instanceof Ta?n.toString():JSON.stringify(n)}class Jt{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Dr(t[1]))return a.error("invalid value");const c=t[1];let p=Jr(c);const v=a.expectedType;return p.kind!=="array"||p.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(p=v),new Jt(p,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Cs={string:Rt,number:rt,boolean:Qt,object:Ia};class sr{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let c,p=1;const v=t[0];if(v==="array"){let T,P;if(t.length>2){const I=t[1];if(typeof I!="string"||!(I in Cs)||I==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);T=Cs[I],p++}else T=nr;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);P=t[2],p++}c=Ra(T,P)}else{if(!Cs[v])throw new Error(`Types doesn't contain name = ${v}`);c=Cs[v]}const b=[];for(;p<t.length;p++){const T=a.parse(t[p],p,nr);if(!T)return null;b.push(T)}return new sr(c,b)}evaluate(t){for(let a=0;a<this.args.length;a++){const c=this.args[a].evaluate(t);if(!kn(this.type,Jr(c)))return c;if(a===this.args.length-1)throw new Gr(`Expected value to be of type ${Kr(this.type)}, but found ${Kr(Jr(c))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const oa={"to-boolean":Qt,"to-color":ii,"to-number":rt,"to-string":Rt};class Ci{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const c=t[0];if(!oa[c])throw new Error(`Can't parse ${c} as it is not part of the known types`);if((c==="to-boolean"||c==="to-string")&&t.length!==2)return a.error("Expected one argument.");const p=oa[c],v=[];for(let b=1;b<t.length;b++){const T=a.parse(t[b],b,nr);if(!T)return null;v.push(T)}return new Ci(p,v)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let a,c;for(const p of this.args){if(a=p.evaluate(t),c=null,a instanceof vr)return a;if(typeof a=="string"){const v=t.parseColor(a);if(v)return v}else if(Array.isArray(a)&&(c=a.length<3||a.length>4?`Invalid rgba value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:fn(a[0],a[1],a[2],a[3]),!c))return new vr(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Gr(c||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const c of this.args){a=c.evaluate(t);const p=Ei.parse(a);if(p)return p}throw new Gr(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"numberArray":{let a;for(const c of this.args){a=c.evaluate(t);const p=Qr.parse(a);if(p)return p}throw new Gr(`Could not parse numberArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"colorArray":{let a;for(const c of this.args){a=c.evaluate(t);const p=ta.parse(a);if(p)return p}throw new Gr(`Could not parse colorArray from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const c of this.args){a=c.evaluate(t);const p=Wi.parse(a);if(p)return p}throw new Gr(`Could not parse variableAnchorOffsetCollection from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const c of this.args){if(a=c.evaluate(t),a===null)return 0;const p=Number(a);if(!isNaN(p))return p}throw new Gr(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return pa.fromString(pr(this.args[0].evaluate(t)));case"resolvedImage":return Ta.fromString(pr(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return pr(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Ol=["Unknown","Point","LineString","Polygon"];class Do{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ol[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let a=this._parseColorCache.get(t);return a||(a=vr.parse(t),this._parseColorCache.set(t,a)),a}}class Lc{constructor(t,a,c=[],p,v=new Ar,b=[]){this.registry=t,this.path=c,this.key=c.map(T=>`[${T}]`).join(""),this.scope=v,this.errors=b,this.expectedType=p,this._isConstant=a}parse(t,a,c,p,v={}){return a?this.concat(a,c,p)._parse(t,v):this._parse(t,v)}_parse(t,a){function c(p,v,b){return b==="assert"?new sr(v,[p]):b==="coerce"?new Ci(v,[p]):p}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=t[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[p];if(v){let b=v.parse(t,this);if(!b)return null;if(this.expectedType){const T=this.expectedType,P=b.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||P.kind!=="value"){if(T.kind==="projectionDefinition"&&["string","array"].includes(P.kind)||["color","formatted","resolvedImage"].includes(T.kind)&&["value","string"].includes(P.kind)||["padding","numberArray"].includes(T.kind)&&["value","number","array"].includes(P.kind)||T.kind==="colorArray"&&["value","string","array"].includes(P.kind)||T.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(P.kind))b=c(b,T,a.typeAnnotation||"coerce");else if(this.checkSubtype(T,P))return null}else b=c(b,T,a.typeAnnotation||"assert")}if(!(b instanceof Jt)&&b.type.kind!=="resolvedImage"&&this._isConstant(b)){const T=new Do;try{b=new Jt(b.type,b.evaluate(T))}catch(P){return this.error(P.message),null}}return b}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,c){const p=typeof t=="number"?this.path.concat(t):this.path,v=c?this.scope.concat(c):this.scope;return new Lc(this.registry,this._isConstant,p,a||null,v,this.errors)}error(t,...a){const c=`${this.key}${a.map(p=>`[${p}]`).join("")}`;this.errors.push(new fr(c,t))}checkSubtype(t,a){const c=kn(t,a);return c&&this.error(c),c}}class Xs{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const c=[];for(let v=1;v<t.length-1;v+=2){const b=t[v];if(typeof b!="string")return a.error(`Expected string, but found ${typeof b} instead.`,v);if(/[^a-zA-Z0-9_]/.test(b))return a.error("Variable names must contain only alphanumeric characters or '_'.",v);const T=a.parse(t[v+1],v+1);if(!T)return null;c.push([b,T])}const p=a.parse(t[t.length-1],t.length-1,a.expectedType,c);return p?new Xs(c,p):null}outputDefined(){return this.result.outputDefined()}}class No{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const c=t[1];return a.scope.has(c)?new No(c,a.scope.get(c)):a.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Lo{constructor(t,a,c){this.type=t,this.index=a,this.input=c}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=a.parse(t[1],1,rt),p=a.parse(t[2],2,Ra(a.expectedType||nr));return c&&p?new Lo(p.type.itemType,c,p):null}evaluate(t){const a=this.index.evaluate(t),c=this.input.evaluate(t);if(a<0)throw new Gr(`Array index out of bounds: ${a} < 0.`);if(a>=c.length)throw new Gr(`Array index out of bounds: ${a} > ${c.length-1}.`);if(a!==Math.floor(a))throw new Gr(`Array index must be an integer, but found ${a} instead.`);return c[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Oo{constructor(t,a){this.type=Qt,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=a.parse(t[1],1,nr),p=a.parse(t[2],2,nr);return c&&p?Pn(c.type,[Qt,Rt,rt,Zt,nr])?new Oo(c,p):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Kr(c.type)} instead`):null}evaluate(t){const a=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!c)return!1;if(!zo(a,["boolean","string","number","null"]))throw new Gr(`Expected first argument to be of type boolean, string, number or null, but found ${Kr(Jr(a))} instead.`);if(!zo(c,["string","array"]))throw new Gr(`Expected second argument to be of type array or string, but found ${Kr(Jr(c))} instead.`);return c.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Bl{constructor(t,a,c){this.type=rt,this.needle=t,this.haystack=a,this.fromIndex=c}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=a.parse(t[1],1,nr),p=a.parse(t[2],2,nr);if(!c||!p)return null;if(!Pn(c.type,[Qt,Rt,rt,Zt,nr]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Kr(c.type)} instead`);if(t.length===4){const v=a.parse(t[3],3,rt);return v?new Bl(c,p,v):null}return new Bl(c,p)}evaluate(t){const a=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!zo(a,["boolean","string","number","null"]))throw new Gr(`Expected first argument to be of type boolean, string, number or null, but found ${Kr(Jr(a))} instead.`);let p;if(this.fromIndex&&(p=this.fromIndex.evaluate(t)),zo(c,["string"])){const v=c.indexOf(a,p);return v===-1?-1:[...c.slice(0,v)].length}if(zo(c,["array"]))return c.indexOf(a,p);throw new Gr(`Expected second argument to be of type array or string, but found ${Kr(Jr(c))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Bo{constructor(t,a,c,p,v,b){this.inputType=t,this.type=a,this.input=c,this.cases=p,this.outputs=v,this.otherwise=b}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let c,p;a.expectedType&&a.expectedType.kind!=="value"&&(p=a.expectedType);const v={},b=[];for(let I=2;I<t.length-1;I+=2){let D=t[I];const L=t[I+1];Array.isArray(D)||(D=[D]);const q=a.concat(I);if(D.length===0)return q.error("Expected at least one branch label.");for(const H of D){if(typeof H!="number"&&typeof H!="string")return q.error("Branch labels must be numbers or strings.");if(typeof H=="number"&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof H=="number"&&Math.floor(H)!==H)return q.error("Numeric branch labels must be integer values.");if(c){if(q.checkSubtype(c,Jr(H)))return null}else c=Jr(H);if(v[String(H)]!==void 0)return q.error("Branch labels must be unique.");v[String(H)]=b.length}const G=a.parse(L,I,p);if(!G)return null;p=p||G.type,b.push(G)}const T=a.parse(t[1],1,nr);if(!T)return null;const P=a.parse(t[t.length-1],t.length-1,p);return P?T.type.kind!=="value"&&a.concat(1).checkSubtype(c,T.type)?null:new Bo(c,p,T,v,b,P):null}evaluate(t){const a=this.input.evaluate(t);return(Jr(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class ia{constructor(t,a,c){this.type=t,this.branches=a,this.otherwise=c}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let c;a.expectedType&&a.expectedType.kind!=="value"&&(c=a.expectedType);const p=[];for(let b=1;b<t.length-1;b+=2){const T=a.parse(t[b],b,Qt);if(!T)return null;const P=a.parse(t[b+1],b+1,c);if(!P)return null;p.push([T,P]),c=c||P.type}const v=a.parse(t[t.length-1],t.length-1,c);if(!v)return null;if(!c)throw new Error("Can't infer output type");return new ia(c,p,v)}evaluate(t){for(const[a,c]of this.branches)if(a.evaluate(t))return c.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[a,c]of this.branches)t(a),t(c);t(this.otherwise)}outputDefined(){return this.branches.every(([t,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class Fo{constructor(t,a,c,p){this.type=t,this.input=a,this.beginIndex=c,this.endIndex=p}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=a.parse(t[1],1,nr),p=a.parse(t[2],2,rt);if(!c||!p)return null;if(!Pn(c.type,[Ra(nr),Rt,nr]))return a.error(`Expected first argument to be of type array or string, but found ${Kr(c.type)} instead`);if(t.length===4){const v=a.parse(t[3],3,rt);return v?new Fo(c.type,c,p,v):null}return new Fo(c.type,c,p)}evaluate(t){const a=this.input.evaluate(t),c=this.beginIndex.evaluate(t);let p;if(this.endIndex&&(p=this.endIndex.evaluate(t)),zo(a,["string"]))return[...a].slice(c,p).join("");if(zo(a,["array"]))return a.slice(c,p);throw new Gr(`Expected first argument to be of type array or string, but found ${Kr(Jr(a))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Uo(n,t){const a=n.length-1;let c,p,v=0,b=a,T=0;for(;v<=b;)if(T=Math.floor((v+b)/2),c=n[T],p=n[T+1],c<=t){if(T===a||t<p)return T;v=T+1}else{if(!(c>t))throw new Gr("Input is not a number.");b=T-1}return 0}class Ys{constructor(t,a,c){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(const[p,v]of c)this.labels.push(p),this.outputs.push(v)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");const c=a.parse(t[1],1,rt);if(!c)return null;const p=[];let v=null;a.expectedType&&a.expectedType.kind!=="value"&&(v=a.expectedType);for(let b=1;b<t.length;b+=2){const T=b===1?-1/0:t[b],P=t[b+1],I=b,D=b+1;if(typeof T!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(p.length&&p[p.length-1][0]>=T)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const L=a.parse(P,D,v);if(!L)return null;v=v||L.type,p.push([T,L])}return new Ys(v,c,p)}evaluate(t){const a=this.labels,c=this.outputs;if(a.length===1)return c[0].evaluate(t);const p=this.input.evaluate(t);if(p<=a[0])return c[0].evaluate(t);const v=a.length;return p>=a[v-1]?c[v-1].evaluate(t):c[Uo(a,p)].evaluate(t)}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function aa(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ou,Bu,df=function(){if(Bu)return Ou;function n(t,a,c,p){this.cx=3*t,this.bx=3*(c-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=c,this.p2y=p}return Bu=1,Ou=n,n.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,a){if(a===void 0&&(a=1e-6),t<0)return 0;if(t>1)return 1;for(var c=t,p=0;p<8;p++){var v=this.sampleCurveX(c)-t;if(Math.abs(v)<a)return c;var b=this.sampleCurveDerivativeX(c);if(Math.abs(b)<1e-6)break;c-=v/b}var T=0,P=1;for(c=t,p=0;p<20&&(v=this.sampleCurveX(c),!(Math.abs(v-t)<a));p++)t>v?T=c:P=c,c=.5*(P-T)+T;return c},solve:function(t,a){return this.sampleCurveY(this.solveCurveX(t,a))}},Ou}(),ff=aa(df);class ma{constructor(t,a,c,p,v){this.type=t,this.operator=a,this.interpolation=c,this.input=p,this.labels=[],this.outputs=[];for(const[b,T]of v)this.labels.push(b),this.outputs.push(T)}static interpolationFactor(t,a,c,p){let v=0;if(t.name==="exponential")v=Oc(a,t.base,c,p);else if(t.name==="linear")v=Oc(a,1,c,p);else if(t.name==="cubic-bezier"){const b=t.controlPoints;v=new ff(b[0],b[1],b[2],b[3]).solve(Oc(a,1,c,p))}return v}static parse(t,a){let[c,p,v,...b]=t;if(!Array.isArray(p)||p.length===0)return a.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const I=p[1];if(typeof I!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:I}}else{if(p[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const I=p.slice(1);if(I.length!==4||I.some(D=>typeof D!="number"||D<0||D>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:I}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(v=a.parse(v,2,rt),!v)return null;const T=[];let P=null;c!=="interpolate-hcl"&&c!=="interpolate-lab"||a.expectedType==Yn?a.expectedType&&a.expectedType.kind!=="value"&&(P=a.expectedType):P=ii;for(let I=0;I<b.length;I+=2){const D=b[I],L=b[I+1],q=I+3,G=I+4;if(typeof D!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(T.length&&T[T.length-1][0]>=D)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const H=a.parse(L,G,P);if(!H)return null;P=P||H.type,T.push([D,H])}return Kn(P,rt)||Kn(P,xi)||Kn(P,ii)||Kn(P,Ha)||Kn(P,Wa)||Kn(P,Yn)||Kn(P,_r)||Kn(P,Ra(rt))?new ma(P,c,p,v,T):a.error(`Type ${Kr(P)} is not interpolatable.`)}evaluate(t){const a=this.labels,c=this.outputs;if(a.length===1)return c[0].evaluate(t);const p=this.input.evaluate(t);if(p<=a[0])return c[0].evaluate(t);const v=a.length;if(p>=a[v-1])return c[v-1].evaluate(t);const b=Uo(a,p),T=ma.interpolationFactor(this.interpolation,p,a[b],a[b+1]),P=c[b].evaluate(t),I=c[b+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return fa(P,I,T);case"color":return vr.interpolate(P,I,T);case"padding":return Ei.interpolate(P,I,T);case"colorArray":return ta.interpolate(P,I,T);case"numberArray":return Qr.interpolate(P,I,T);case"variableAnchorOffsetCollection":return Wi.interpolate(P,I,T);case"array":return Es(P,I,T);case"projectionDefinition":return ra.interpolate(P,I,T)}case"interpolate-hcl":switch(this.type.kind){case"color":return vr.interpolate(P,I,T,"hcl");case"colorArray":return ta.interpolate(P,I,T,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return vr.interpolate(P,I,T,"lab");case"colorArray":return ta.interpolate(P,I,T,"lab")}}}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Oc(n,t,a,c){const p=c-a,v=n-a;return p===0?0:t===1?v/p:(Math.pow(t,v)-1)/(Math.pow(t,p)-1)}const ts={color:vr.interpolate,number:fa,padding:Ei.interpolate,numberArray:Qr.interpolate,colorArray:ta.interpolate,variableAnchorOffsetCollection:Wi.interpolate,array:Es};class Vo{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let c=null;const p=a.expectedType;p&&p.kind!=="value"&&(c=p);const v=[];for(const T of t.slice(1)){const P=a.parse(T,1+v.length,c,void 0,{typeAnnotation:"omit"});if(!P)return null;c=c||P.type,v.push(P)}if(!c)throw new Error("No output type");const b=p&&v.some(T=>kn(p,T.type));return new Vo(b?nr:c,v)}evaluate(t){let a,c=null,p=0;for(const v of this.args)if(p++,c=v.evaluate(t),c&&c instanceof Ta&&!c.available&&(a||(a=c.name),c=null,p===this.args.length&&(c=a)),c!==null)break;return c}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function qo(n,t){return n==="=="||n==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function pn(n,t,a,c){return c.compare(t,a)===0}function Zo(n,t,a){const c=n!=="=="&&n!=="!=";return class d2{constructor(v,b,T){this.type=Qt,this.lhs=v,this.rhs=b,this.collator=T,this.hasUntypedArgument=v.type.kind==="value"||b.type.kind==="value"}static parse(v,b){if(v.length!==3&&v.length!==4)return b.error("Expected two or three arguments.");const T=v[0];let P=b.parse(v[1],1,nr);if(!P)return null;if(!qo(T,P.type))return b.concat(1).error(`"${T}" comparisons are not supported for type '${Kr(P.type)}'.`);let I=b.parse(v[2],2,nr);if(!I)return null;if(!qo(T,I.type))return b.concat(2).error(`"${T}" comparisons are not supported for type '${Kr(I.type)}'.`);if(P.type.kind!==I.type.kind&&P.type.kind!=="value"&&I.type.kind!=="value")return b.error(`Cannot compare types '${Kr(P.type)}' and '${Kr(I.type)}'.`);c&&(P.type.kind==="value"&&I.type.kind!=="value"?P=new sr(I.type,[P]):P.type.kind!=="value"&&I.type.kind==="value"&&(I=new sr(P.type,[I])));let D=null;if(v.length===4){if(P.type.kind!=="string"&&I.type.kind!=="string"&&P.type.kind!=="value"&&I.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(D=b.parse(v[3],3,Xn),!D)return null}return new d2(P,I,D)}evaluate(v){const b=this.lhs.evaluate(v),T=this.rhs.evaluate(v);if(c&&this.hasUntypedArgument){const P=Jr(b),I=Jr(T);if(P.kind!==I.kind||P.kind!=="string"&&P.kind!=="number")throw new Gr(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${P.kind}, ${I.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const P=Jr(b),I=Jr(T);if(P.kind!=="string"||I.kind!=="string")return t(v,b,T)}return this.collator?a(v,b,T,this.collator.evaluate(v)):t(v,b,T)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const Fu=Zo("==",function(n,t,a){return t===a},pn),pf=Zo("!=",function(n,t,a){return t!==a},function(n,t,a,c){return!pn(0,t,a,c)}),Hh=Zo("<",function(n,t,a){return t<a},function(n,t,a,c){return c.compare(t,a)<0}),qp=Zo(">",function(n,t,a){return t>a},function(n,t,a,c){return c.compare(t,a)>0}),Zp=Zo("<=",function(n,t,a){return t<=a},function(n,t,a,c){return c.compare(t,a)<=0}),$p=Zo(">=",function(n,t,a){return t>=a},function(n,t,a,c){return c.compare(t,a)>=0});class Uu{constructor(t,a,c){this.type=Xn,this.locale=c,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");const c=t[1];if(typeof c!="object"||Array.isArray(c))return a.error("Collator options argument must be an object.");const p=a.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Qt);if(!p)return null;const v=a.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Qt);if(!v)return null;let b=null;return c.locale&&(b=a.parse(c.locale,1,Rt),!b)?null:new Uu(p,v,b)}evaluate(t){return new Nc(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Fl{constructor(t,a,c,p,v){this.type=Rt,this.number=t,this.locale=a,this.currency=c,this.minFractionDigits=p,this.maxFractionDigits=v}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");const c=a.parse(t[1],1,rt);if(!c)return null;const p=t[2];if(typeof p!="object"||Array.isArray(p))return a.error("NumberFormat options argument must be an object.");let v=null;if(p.locale&&(v=a.parse(p.locale,1,Rt),!v))return null;let b=null;if(p.currency&&(b=a.parse(p.currency,1,Rt),!b))return null;let T=null;if(p["min-fraction-digits"]&&(T=a.parse(p["min-fraction-digits"],1,rt),!T))return null;let P=null;return p["max-fraction-digits"]&&(P=a.parse(p["max-fraction-digits"],1,rt),!P)?null:new Fl(c,v,b,T,P)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Vu{constructor(t){this.type=jo,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const c=t[1];if(!Array.isArray(c)&&typeof c=="object")return a.error("First argument must be an image or text section.");const p=[];let v=!1;for(let b=1;b<=t.length-1;++b){const T=t[b];if(v&&typeof T=="object"&&!Array.isArray(T)){v=!1;let P=null;if(T["font-scale"]&&(P=a.parse(T["font-scale"],1,rt),!P))return null;let I=null;if(T["text-font"]&&(I=a.parse(T["text-font"],1,Ra(Rt)),!I))return null;let D=null;if(T["text-color"]&&(D=a.parse(T["text-color"],1,ii),!D))return null;let L=null;if(T["vertical-align"]){if(typeof T["vertical-align"]=="string"&&!Hs.includes(T["vertical-align"]))return a.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${T["vertical-align"]}' instead.`);if(L=a.parse(T["vertical-align"],1,Rt),!L)return null}const q=p[p.length-1];q.scale=P,q.font=I,q.textColor=D,q.verticalAlign=L}else{const P=a.parse(t[b],1,nr);if(!P)return null;const I=P.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,p.push({content:P,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Vu(p)}evaluate(t){return new pa(this.sections.map(a=>{const c=a.content.evaluate(t);return Jr(c)===hn?new Ws("",c,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(t):null):new Ws(pr(c),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null,a.verticalAlign?a.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor),a.verticalAlign&&t(a.verticalAlign)}outputDefined(){return!1}}class qu{constructor(t){this.type=hn,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");const c=a.parse(t[1],1,Rt);return c?new qu(c):a.error("No image name provided.")}evaluate(t){const a=this.input.evaluate(t),c=Ta.fromString(a);return c&&t.availableImages&&(c.available=t.availableImages.indexOf(a)>-1),c}eachChild(t){t(this.input)}outputDefined(){return!1}}class Zu{constructor(t){this.type=rt,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=a.parse(t[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${Kr(c.type)} instead.`):new Zu(c):null}evaluate(t){const a=this.input.evaluate(t);if(typeof a=="string")return[...a].length;if(Array.isArray(a))return a.length;throw new Gr(`Expected value to be of type string or array, but found ${Kr(Jr(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const mn=8192;function Ul(n,t){const a=(180+n[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,p=Math.pow(2,t.z);return[Math.round(a*p*mn),Math.round(c*p*mn)]}function Wh(n,t){const a=Math.pow(2,t.z);return[(p=(n[0]/mn+t.x)/a,360*p-180),(c=(n[1]/mn+t.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90)];var c,p}function Vl(n,t){n[0]=Math.min(n[0],t[0]),n[1]=Math.min(n[1],t[1]),n[2]=Math.max(n[2],t[0]),n[3]=Math.max(n[3],t[1])}function ql(n,t){return!(n[0]<=t[0]||n[2]>=t[2]||n[1]<=t[1]||n[3]>=t[3])}function mf(n,t,a){const c=n[0]-t[0],p=n[1]-t[1],v=n[0]-a[0],b=n[1]-a[1];return c*b-v*p==0&&c*v<=0&&p*b<=0}function Bc(n,t,a,c){return(p=[c[0]-a[0],c[1]-a[1]])[0]*(v=[t[0]-n[0],t[1]-n[1]])[1]-p[1]*v[0]!=0&&!(!Yh(n,t,a,c)||!Yh(a,c,n,t));var p,v}function Xh(n,t,a){for(const c of a)for(let p=0;p<c.length-1;++p)if(Bc(n,t,c[p],c[p+1]))return!0;return!1}function gn(n,t,a=!1){let c=!1;for(const T of t)for(let P=0;P<T.length-1;P++){if(mf(n,T[P],T[P+1]))return a;(v=T[P])[1]>(p=n)[1]!=(b=T[P+1])[1]>p[1]&&p[0]<(b[0]-v[0])*(p[1]-v[1])/(b[1]-v[1])+v[0]&&(c=!c)}var p,v,b;return c}function gf(n,t){for(const a of t)if(gn(n,a))return!0;return!1}function yf(n,t){for(const a of n)if(!gn(a,t))return!1;for(let a=0;a<n.length-1;++a)if(Xh(n[a],n[a+1],t))return!1;return!0}function Gp(n,t){for(const a of t)if(yf(n,a))return!0;return!1}function Yh(n,t,a,c){const p=c[0]-a[0],v=c[1]-a[1],b=(n[0]-a[0])*v-p*(n[1]-a[1]),T=(t[0]-a[0])*v-p*(t[1]-a[1]);return b>0&&T<0||b<0&&T>0}function Zl(n,t,a){const c=[];for(let p=0;p<n.length;p++){const v=[];for(let b=0;b<n[p].length;b++){const T=Ul(n[p][b],a);Vl(t,T),v.push(T)}c.push(v)}return c}function $l(n,t,a){const c=[];for(let p=0;p<n.length;p++){const v=Zl(n[p],t,a);c.push(v)}return c}function Gl(n,t,a,c){if(n[0]<a[0]||n[0]>a[2]){const p=.5*c;let v=n[0]-a[0]>p?-c:a[0]-n[0]>p?c:0;v===0&&(v=n[0]-a[2]>p?-c:a[2]-n[0]>p?c:0),n[0]+=v}Vl(t,n)}function _f(n,t,a,c){const p=Math.pow(2,c.z)*mn,v=[c.x*mn,c.y*mn],b=[];for(const T of n)for(const P of T){const I=[P.x+v[0],P.y+v[1]];Gl(I,t,a,p),b.push(I)}return b}function Hl(n,t,a,c){const p=Math.pow(2,c.z)*mn,v=[c.x*mn,c.y*mn],b=[];for(const P of n){const I=[];for(const D of P){const L=[D.x+v[0],D.y+v[1]];Vl(t,L),I.push(L)}b.push(I)}if(t[2]-t[0]<=p/2){(T=t)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const P of b)for(const I of P)Gl(I,t,a,p)}var T;return b}class As{constructor(t,a){this.type=Qt,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Dr(t[1])){const c=t[1];if(c.type==="FeatureCollection"){const p=[];for(const v of c.features){const{type:b,coordinates:T}=v.geometry;b==="Polygon"&&p.push(T),b==="MultiPolygon"&&p.push(...T)}if(p.length)return new As(c,{type:"MultiPolygon",coordinates:p})}else if(c.type==="Feature"){const p=c.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new As(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new As(c,c)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,c){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],b=a.canonicalID();if(c.type==="Polygon"){const T=Zl(c.coordinates,v,b),P=_f(a.geometry(),p,v,b);if(!ql(p,v))return!1;for(const I of P)if(!gn(I,T))return!1}if(c.type==="MultiPolygon"){const T=$l(c.coordinates,v,b),P=_f(a.geometry(),p,v,b);if(!ql(p,v))return!1;for(const I of P)if(!gf(I,T))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,c){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],b=a.canonicalID();if(c.type==="Polygon"){const T=Zl(c.coordinates,v,b),P=Hl(a.geometry(),p,v,b);if(!ql(p,v))return!1;for(const I of P)if(!yf(I,T))return!1}if(c.type==="MultiPolygon"){const T=$l(c.coordinates,v,b),P=Hl(a.geometry(),p,v,b);if(!ql(p,v))return!1;for(const I of P)if(!Gp(I,T))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Kh=class{constructor(n=[],t=(a,c)=>a<c?-1:a>c?1:0){if(this.data=n,this.length=this.data.length,this.compare=t,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:t,compare:a}=this,c=t[n];for(;n>0;){const p=n-1>>1,v=t[p];if(a(c,v)>=0)break;t[n]=v,n=p}t[n]=c}_down(n){const{data:t,compare:a}=this,c=this.length>>1,p=t[n];for(;n<c;){let v=1+(n<<1);const b=v+1;if(b<this.length&&a(t[b],t[v])<0&&(v=b),a(t[v],p)>=0)break;t[n]=t[v],n=v}t[n]=p}};function $u(n,t,a=0,c=n.length-1,p=Qh){for(;c>a;){if(c-a>600){const P=c-a+1,I=t-a+1,D=Math.log(P),L=.5*Math.exp(2*D/3),q=.5*Math.sqrt(D*L*(P-L)/P)*(I-P/2<0?-1:1);$u(n,t,Math.max(a,Math.floor(t-I*L/P+q)),Math.min(c,Math.floor(t+(P-I)*L/P+q)),p)}const v=n[t];let b=a,T=c;for(Ks(n,a,t),p(n[c],v)>0&&Ks(n,a,c);b<T;){for(Ks(n,b,T),b++,T--;p(n[b],v)<0;)b++;for(;p(n[T],v)>0;)T--}p(n[a],v)===0?Ks(n,a,T):(T++,Ks(n,T,c)),T<=t&&(a=T+1),t<=T&&(c=T-1)}}function Ks(n,t,a){const c=n[t];n[t]=n[a],n[a]=c}function Qh(n,t){return n<t?-1:n>t?1:0}function Fc(n,t){if(n.length<=1)return[n];const a=[];let c,p;for(const v of n){const b=Hp(v);b!==0&&(v.area=Math.abs(b),p===void 0&&(p=b<0),p===b<0?(c&&a.push(c),c=[v]):c.push(v))}if(c&&a.push(c),t>1)for(let v=0;v<a.length;v++)a[v].length<=t||($u(a[v],t,1,a[v].length-1,vf),a[v]=a[v].slice(0,t));return a}function vf(n,t){return t.area-n.area}function Hp(n){let t=0;for(let a,c,p=0,v=n.length,b=v-1;p<v;b=p++)a=n[p],c=n[b],t+=(c.x-a.x)*(a.y+c.y);return t}const Jh=1/298.257223563,xf=Jh*(2-Jh),bf=Math.PI/180;class ed{constructor(t){const a=6378.137*bf*1e3,c=Math.cos(t*bf),p=1/(1-xf*(1-c*c)),v=Math.sqrt(p);this.kx=a*v*c,this.ky=a*v*p*(1-xf)}distance(t,a){const c=this.wrap(t[0]-a[0])*this.kx,p=(t[1]-a[1])*this.ky;return Math.sqrt(c*c+p*p)}pointOnLine(t,a){let c,p,v,b,T=1/0;for(let P=0;P<t.length-1;P++){let I=t[P][0],D=t[P][1],L=this.wrap(t[P+1][0]-I)*this.kx,q=(t[P+1][1]-D)*this.ky,G=0;L===0&&q===0||(G=(this.wrap(a[0]-I)*this.kx*L+(a[1]-D)*this.ky*q)/(L*L+q*q),G>1?(I=t[P+1][0],D=t[P+1][1]):G>0&&(I+=L/this.kx*G,D+=q/this.ky*G)),L=this.wrap(a[0]-I)*this.kx,q=(a[1]-D)*this.ky;const H=L*L+q*q;H<T&&(T=H,c=I,p=D,v=P,b=G)}return{point:[c,p],index:v,t:Math.max(0,Math.min(1,b))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Da(n,t){return t[0]-n[0]}function mr(n){return n[1]-n[0]+1}function rs(n,t){return n[1]>=n[0]&&n[1]<t}function Gu(n,t){if(n[0]>n[1])return[null,null];const a=mr(n);if(t){if(a===2)return[n,null];const p=Math.floor(a/2);return[[n[0],n[0]+p],[n[0]+p,n[1]]]}if(a===1)return[n,null];const c=Math.floor(a/2)-1;return[[n[0],n[0]+c],[n[0]+c+1,n[1]]]}function Hu(n,t){if(!rs(t,n.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let c=t[0];c<=t[1];++c)Vl(a,n[c]);return a}function Wu(n){const t=[1/0,1/0,-1/0,-1/0];for(const a of n)for(const c of a)Vl(t,c);return t}function Xu(n){return n[0]!==-1/0&&n[1]!==-1/0&&n[2]!==1/0&&n[3]!==1/0}function td(n,t,a){if(!Xu(n)||!Xu(t))return NaN;let c=0,p=0;return n[2]<t[0]&&(c=t[0]-n[2]),n[0]>t[2]&&(c=n[0]-t[2]),n[1]>t[3]&&(p=n[1]-t[3]),n[3]<t[1]&&(p=t[1]-n[3]),a.distance([0,0],[c,p])}function $o(n,t,a){const c=a.pointOnLine(t,n);return a.distance(n,c.point)}function Qs(n,t,a,c,p){const v=Math.min($o(n,[a,c],p),$o(t,[a,c],p)),b=Math.min($o(a,[n,t],p),$o(c,[n,t],p));return Math.min(v,b)}function rd(n,t,a,c,p){if(!rs(t,n.length)||!rs(c,a.length))return 1/0;let v=1/0;for(let b=t[0];b<t[1];++b){const T=n[b],P=n[b+1];for(let I=c[0];I<c[1];++I){const D=a[I],L=a[I+1];if(Bc(T,P,D,L))return 0;v=Math.min(v,Qs(T,P,D,L,p))}}return v}function Uc(n,t,a,c,p){if(!rs(t,n.length)||!rs(c,a.length))return NaN;let v=1/0;for(let b=t[0];b<=t[1];++b)for(let T=c[0];T<=c[1];++T)if(v=Math.min(v,p.distance(n[b],a[T])),v===0)return v;return v}function id(n,t,a){if(gn(n,t,!0))return 0;let c=1/0;for(const p of t){const v=p[0],b=p[p.length-1];if(v!==b&&(c=Math.min(c,$o(n,[b,v],a)),c===0))return c;const T=a.pointOnLine(p,n);if(c=Math.min(c,a.distance(n,T.point)),c===0)return c}return c}function wf(n,t,a,c){if(!rs(t,n.length))return NaN;for(let v=t[0];v<=t[1];++v)if(gn(n[v],a,!0))return 0;let p=1/0;for(let v=t[0];v<t[1];++v){const b=n[v],T=n[v+1];for(const P of a)for(let I=0,D=P.length,L=D-1;I<D;L=I++){const q=P[L],G=P[I];if(Bc(b,T,q,G))return 0;p=Math.min(p,Qs(b,T,q,G,c))}}return p}function Js(n,t){for(const a of n)for(const c of a)if(gn(c,t,!0))return!0;return!1}function Wl(n,t,a,c=1/0){const p=Wu(n),v=Wu(t);if(c!==1/0&&td(p,v,a)>=c)return c;if(ql(p,v)){if(Js(n,t))return 0}else if(Js(t,n))return 0;let b=1/0;for(const T of n)for(let P=0,I=T.length,D=I-1;P<I;D=P++){const L=T[D],q=T[P];for(const G of t)for(let H=0,K=G.length,se=K-1;H<K;se=H++){const fe=G[se],Me=G[H];if(Bc(L,q,fe,Me))return 0;b=Math.min(b,Qs(L,q,fe,Me,a))}}return b}function Yu(n,t,a,c,p,v){if(!v)return;const b=td(Hu(c,v),p,a);b<t&&n.push([b,v,[0,0]])}function Vc(n,t,a,c,p,v,b){if(!v||!b)return;const T=td(Hu(c,v),Hu(p,b),a);T<t&&n.push([T,v,b])}function is(n,t,a,c,p=1/0){let v=Math.min(c.distance(n[0],a[0][0]),p);if(v===0)return v;const b=new Kh([[0,[0,n.length-1],[0,0]]],Da),T=Wu(a);for(;b.length>0;){const P=b.pop();if(P[0]>=v)continue;const I=P[1],D=t?50:100;if(mr(I)<=D){if(!rs(I,n.length))return NaN;if(t){const L=wf(n,I,a,c);if(isNaN(L)||L===0)return L;v=Math.min(v,L)}else for(let L=I[0];L<=I[1];++L){const q=id(n[L],a,c);if(v=Math.min(v,q),v===0)return 0}}else{const L=Gu(I,t);Yu(b,v,c,n,T,L[0]),Yu(b,v,c,n,T,L[1])}}return v}function qc(n,t,a,c,p,v=1/0){let b=Math.min(v,p.distance(n[0],a[0]));if(b===0)return b;const T=new Kh([[0,[0,n.length-1],[0,a.length-1]]],Da);for(;T.length>0;){const P=T.pop();if(P[0]>=b)continue;const I=P[1],D=P[2],L=t?50:100,q=c?50:100;if(mr(I)<=L&&mr(D)<=q){if(!rs(I,n.length)&&rs(D,a.length))return NaN;let G;if(t&&c)G=rd(n,I,a,D,p),b=Math.min(b,G);else if(t&&!c){const H=n.slice(I[0],I[1]+1);for(let K=D[0];K<=D[1];++K)if(G=$o(a[K],H,p),b=Math.min(b,G),b===0)return b}else if(!t&&c){const H=a.slice(D[0],D[1]+1);for(let K=I[0];K<=I[1];++K)if(G=$o(n[K],H,p),b=Math.min(b,G),b===0)return b}else G=Uc(n,I,a,D,p),b=Math.min(b,G)}else{const G=Gu(I,t),H=Gu(D,c);Vc(T,b,p,n,a,G[0],H[0]),Vc(T,b,p,n,a,G[0],H[1]),Vc(T,b,p,n,a,G[1],H[0]),Vc(T,b,p,n,a,G[1],H[1])}}return b}function Ku(n){return n.type==="MultiPolygon"?n.coordinates.map(t=>({type:"Polygon",coordinates:t})):n.type==="MultiLineString"?n.coordinates.map(t=>({type:"LineString",coordinates:t})):n.type==="MultiPoint"?n.coordinates.map(t=>({type:"Point",coordinates:t})):[n]}class eo{constructor(t,a){this.type=rt,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Dr(t[1])){const c=t[1];if(c.type==="FeatureCollection")return new eo(c,c.features.map(p=>Ku(p.geometry)).flat());if(c.type==="Feature")return new eo(c,Ku(c.geometry));if("type"in c&&"coordinates"in c)return new eo(c,Ku(c))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,c){const p=a.geometry(),v=p.flat().map(P=>Wh([P.x,P.y],a.canonical));if(p.length===0)return NaN;const b=new ed(v[0][1]);let T=1/0;for(const P of c){switch(P.type){case"Point":T=Math.min(T,qc(v,!1,[P.coordinates],!1,b,T));break;case"LineString":T=Math.min(T,qc(v,!1,P.coordinates,!0,b,T));break;case"Polygon":T=Math.min(T,is(v,!1,P.coordinates,b,T))}if(T===0)return T}return T}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,c){const p=a.geometry(),v=p.flat().map(P=>Wh([P.x,P.y],a.canonical));if(p.length===0)return NaN;const b=new ed(v[0][1]);let T=1/0;for(const P of c){switch(P.type){case"Point":T=Math.min(T,qc(v,!0,[P.coordinates],!1,b,T));break;case"LineString":T=Math.min(T,qc(v,!0,P.coordinates,!0,b,T));break;case"Polygon":T=Math.min(T,is(v,!0,P.coordinates,b,T))}if(T===0)return T}return T}(t,this.geometries);if(t.geometryType()==="Polygon")return function(a,c){const p=a.geometry();if(p.length===0||p[0].length===0)return NaN;const v=Fc(p,0).map(P=>P.map(I=>I.map(D=>Wh([D.x,D.y],a.canonical)))),b=new ed(v[0][0][0][1]);let T=1/0;for(const P of c)for(const I of v){switch(P.type){case"Point":T=Math.min(T,is([P.coordinates],!1,I,b,T));break;case"LineString":T=Math.min(T,is(P.coordinates,!0,I,b,T));break;case"Polygon":T=Math.min(T,Wl(I,P.coordinates,b,T))}if(T===0)return T}return T}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Qu{constructor(t){this.type=nr,this.key=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=t[1];return c==null?a.error("Global state property must be defined."):typeof c!="string"?a.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new Qu(c)}evaluate(t){var a;const c=(a=t.globals)===null||a===void 0?void 0:a.globalState;return c&&Object.keys(c).length!==0?es(c,this.key):null}eachChild(){}outputDefined(){return!1}}const Xl={"==":Fu,"!=":pf,">":qp,"<":Hh,">=":$p,"<=":Zp,array:sr,at:Lo,boolean:sr,case:ia,coalesce:Vo,collator:Uu,format:Vu,image:qu,in:Oo,"index-of":Bl,interpolate:ma,"interpolate-hcl":ma,"interpolate-lab":ma,length:Zu,let:Xs,literal:Jt,match:Bo,number:sr,"number-format":Fl,object:sr,slice:Fo,step:Ys,string:sr,"to-boolean":Ci,"to-color":Ci,"to-number":Ci,"to-string":Ci,var:No,within:As,distance:eo,"global-state":Qu};class yn{constructor(t,a,c,p){this.name=t,this.type=a,this._evaluate=c,this.args=p}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,a){const c=t[0],p=yn.definitions[c];if(!p)return a.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(p)?p[0]:p.type,b=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,T=b.filter(([I])=>!Array.isArray(I)||I.length===t.length-1);let P=null;for(const[I,D]of T){P=new Lc(a.registry,Ma,a.path,null,a.scope);const L=[];let q=!1;for(let G=1;G<t.length;G++){const H=t[G],K=Array.isArray(I)?I[G-1]:I.type,se=P.parse(H,1+L.length,K);if(!se){q=!0;break}L.push(se)}if(!q)if(Array.isArray(I)&&I.length!==L.length)P.error(`Expected ${I.length} arguments, but found ${L.length} instead.`);else{for(let G=0;G<L.length;G++){const H=Array.isArray(I)?I[G]:I.type,K=L[G];P.concat(G+1).checkSubtype(H,K.type)}if(P.errors.length===0)return new yn(c,v,D,L)}}if(T.length===1)a.errors.push(...P.errors);else{const I=(T.length?T:b).map(([L])=>{return q=L,Array.isArray(q)?`(${q.map(Kr).join(", ")})`:`(${Kr(q.type)}...)`;var q}).join(" | "),D=[];for(let L=1;L<t.length;L++){const q=a.parse(t[L],1+D.length);if(!q)return null;D.push(Kr(q.type))}a.error(`Expected arguments of type ${I}, but found (${D.join(", ")}) instead.`)}return null}static register(t,a){yn.definitions=a;for(const c in a)t[c]=yn}}function ad(n,[t,a,c,p]){t=t.evaluate(n),a=a.evaluate(n),c=c.evaluate(n);const v=p?p.evaluate(n):1,b=fn(t,a,c,v);if(b)throw new Gr(b);return new vr(t/255,a/255,c/255,v,!1)}function nd(n,t){return n in t}function Ju(n,t){const a=t[n];return a===void 0?null:a}function la(n){return{type:n}}function Ma(n){if(n instanceof No)return Ma(n.boundExpression);if(n instanceof yn&&n.name==="error"||n instanceof Uu||n instanceof As||n instanceof eo||n instanceof Qu)return!1;const t=n instanceof Ci||n instanceof sr;let a=!0;return n.eachChild(c=>{a=t?a&&Ma(c):a&&c instanceof Jt}),!!a&&ks(n)&&Ho(n,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ks(n){if(n instanceof yn&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof As||n instanceof eo)return!1;let t=!0;return n.eachChild(a=>{t&&!ks(a)&&(t=!1)}),t}function Go(n){if(n instanceof yn&&n.name==="feature-state")return!1;let t=!0;return n.eachChild(a=>{t&&!Go(a)&&(t=!1)}),t}function Ho(n,t){if(n instanceof yn&&t.indexOf(n.name)>=0)return!1;let a=!0;return n.eachChild(c=>{a&&!Ho(c,t)&&(a=!1)}),a}function Wo(n){return{result:"success",value:n}}function to(n){return{result:"error",value:n}}function Ya(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function sd(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function Xo(n){return!!n.expression&&n.expression.interpolated}function or(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Zc(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&Jr(n)===Ia}function Ea(n){return n}function ro(n,t){const a=n.stops&&typeof n.stops[0][0]=="object",c=a||!(a||n.property!==void 0),p=n.type||(Xo(t)?"exponential":"interval"),v=function(D){switch(D.type){case"color":return vr.parse;case"padding":return Ei.parse;case"numberArray":return Qr.parse;case"colorArray":return ta.parse;default:return null}}(t);if(v&&((n=jr({},n)).stops&&(n.stops=n.stops.map(D=>[D[0],v(D[1])])),n.default=v(n.default?n.default:t.default)),n.colorSpace&&(b=n.colorSpace)!=="rgb"&&b!=="hcl"&&b!=="lab")throw new Error(`Unknown color space: "${n.colorSpace}"`);var b;const T=function(D){switch(D){case"exponential":return Ka;case"interval":return th;case"categorical":return eh;case"identity":return _n;default:throw new Error(`Unknown function type "${D}"`)}}(p);let P,I;if(p==="categorical"){P=Object.create(null);for(const D of n.stops)P[D[0]]=D[1];I=typeof n.stops[0][0]}if(a){const D={},L=[];for(let H=0;H<n.stops.length;H++){const K=n.stops[H],se=K[0].zoom;D[se]===void 0&&(D[se]={zoom:se,type:n.type,property:n.property,default:n.default,stops:[]},L.push(se)),D[se].stops.push([K[0].value,K[1]])}const q=[];for(const H of L)q.push([D[H].zoom,ro(D[H],t)]);const G={name:"linear"};return{kind:"composite",interpolationType:G,interpolationFactor:ma.interpolationFactor.bind(void 0,G),zoomStops:q.map(H=>H[0]),evaluate:({zoom:H},K)=>Ka({stops:q,base:n.base},t,H).evaluate(H,K)}}if(c){const D=p==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:ma.interpolationFactor.bind(void 0,D),zoomStops:n.stops.map(L=>L[0]),evaluate:({zoom:L})=>T(n,t,L,P,I)}}return{kind:"source",evaluate(D,L){const q=L&&L.properties?L.properties[n.property]:void 0;return q===void 0?as(n.default,t.default):T(n,t,q,P,I)}}}function as(n,t,a){return n!==void 0?n:t!==void 0?t:a!==void 0?a:void 0}function eh(n,t,a,c,p){return as(typeof a===p?c[a]:void 0,n.default,t.default)}function th(n,t,a){if(or(a)!=="number")return as(n.default,t.default);const c=n.stops.length;if(c===1||a<=n.stops[0][0])return n.stops[0][1];if(a>=n.stops[c-1][0])return n.stops[c-1][1];const p=Uo(n.stops.map(v=>v[0]),a);return n.stops[p][1]}function Ka(n,t,a){const c=n.base!==void 0?n.base:1;if(or(a)!=="number")return as(n.default,t.default);const p=n.stops.length;if(p===1||a<=n.stops[0][0])return n.stops[0][1];if(a>=n.stops[p-1][0])return n.stops[p-1][1];const v=Uo(n.stops.map(D=>D[0]),a),b=function(D,L,q,G){const H=G-q,K=D-q;return H===0?0:L===1?K/H:(Math.pow(L,K)-1)/(Math.pow(L,H)-1)}(a,c,n.stops[v][0],n.stops[v+1][0]),T=n.stops[v][1],P=n.stops[v+1][1],I=ts[t.type]||Ea;return typeof T.evaluate=="function"?{evaluate(...D){const L=T.evaluate.apply(void 0,D),q=P.evaluate.apply(void 0,D);if(L!==void 0&&q!==void 0)return I(L,q,b,n.colorSpace)}}:I(T,P,b,n.colorSpace)}function _n(n,t,a){switch(t.type){case"color":a=vr.parse(a);break;case"formatted":a=pa.fromString(a.toString());break;case"resolvedImage":a=Ta.fromString(a.toString());break;case"padding":a=Ei.parse(a);break;case"colorArray":a=ta.parse(a);break;case"numberArray":a=Qr.parse(a);break;default:or(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0)}return as(a,n.default,t.default)}yn.register(Xl,{error:[{kind:"error"},[Rt],(n,[t])=>{throw new Gr(t.evaluate(n))}],typeof:[Rt,[nr],(n,[t])=>Kr(Jr(t.evaluate(n)))],"to-rgba":[Ra(rt,4),[ii],(n,[t])=>{const[a,c,p,v]=t.evaluate(n).rgb;return[255*a,255*c,255*p,v]}],rgb:[ii,[rt,rt,rt],ad],rgba:[ii,[rt,rt,rt,rt],ad],has:{type:Qt,overloads:[[[Rt],(n,[t])=>nd(t.evaluate(n),n.properties())],[[Rt,Ia],(n,[t,a])=>nd(t.evaluate(n),a.evaluate(n))]]},get:{type:nr,overloads:[[[Rt],(n,[t])=>Ju(t.evaluate(n),n.properties())],[[Rt,Ia],(n,[t,a])=>Ju(t.evaluate(n),a.evaluate(n))]]},"feature-state":[nr,[Rt],(n,[t])=>Ju(t.evaluate(n),n.featureState||{})],properties:[Ia,[],n=>n.properties()],"geometry-type":[Rt,[],n=>n.geometryType()],id:[nr,[],n=>n.id()],zoom:[rt,[],n=>n.globals.zoom],"heatmap-density":[rt,[],n=>n.globals.heatmapDensity||0],"line-progress":[rt,[],n=>n.globals.lineProgress||0],accumulated:[nr,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[rt,la(rt),(n,t)=>{let a=0;for(const c of t)a+=c.evaluate(n);return a}],"*":[rt,la(rt),(n,t)=>{let a=1;for(const c of t)a*=c.evaluate(n);return a}],"-":{type:rt,overloads:[[[rt,rt],(n,[t,a])=>t.evaluate(n)-a.evaluate(n)],[[rt],(n,[t])=>-t.evaluate(n)]]},"/":[rt,[rt,rt],(n,[t,a])=>t.evaluate(n)/a.evaluate(n)],"%":[rt,[rt,rt],(n,[t,a])=>t.evaluate(n)%a.evaluate(n)],ln2:[rt,[],()=>Math.LN2],pi:[rt,[],()=>Math.PI],e:[rt,[],()=>Math.E],"^":[rt,[rt,rt],(n,[t,a])=>Math.pow(t.evaluate(n),a.evaluate(n))],sqrt:[rt,[rt],(n,[t])=>Math.sqrt(t.evaluate(n))],log10:[rt,[rt],(n,[t])=>Math.log(t.evaluate(n))/Math.LN10],ln:[rt,[rt],(n,[t])=>Math.log(t.evaluate(n))],log2:[rt,[rt],(n,[t])=>Math.log(t.evaluate(n))/Math.LN2],sin:[rt,[rt],(n,[t])=>Math.sin(t.evaluate(n))],cos:[rt,[rt],(n,[t])=>Math.cos(t.evaluate(n))],tan:[rt,[rt],(n,[t])=>Math.tan(t.evaluate(n))],asin:[rt,[rt],(n,[t])=>Math.asin(t.evaluate(n))],acos:[rt,[rt],(n,[t])=>Math.acos(t.evaluate(n))],atan:[rt,[rt],(n,[t])=>Math.atan(t.evaluate(n))],min:[rt,la(rt),(n,t)=>Math.min(...t.map(a=>a.evaluate(n)))],max:[rt,la(rt),(n,t)=>Math.max(...t.map(a=>a.evaluate(n)))],abs:[rt,[rt],(n,[t])=>Math.abs(t.evaluate(n))],round:[rt,[rt],(n,[t])=>{const a=t.evaluate(n);return a<0?-Math.round(-a):Math.round(a)}],floor:[rt,[rt],(n,[t])=>Math.floor(t.evaluate(n))],ceil:[rt,[rt],(n,[t])=>Math.ceil(t.evaluate(n))],"filter-==":[Qt,[Rt,nr],(n,[t,a])=>n.properties()[t.value]===a.value],"filter-id-==":[Qt,[nr],(n,[t])=>n.id()===t.value],"filter-type-==":[Qt,[Rt],(n,[t])=>n.geometryType()===t.value],"filter-<":[Qt,[Rt,nr],(n,[t,a])=>{const c=n.properties()[t.value],p=a.value;return typeof c==typeof p&&c<p}],"filter-id-<":[Qt,[nr],(n,[t])=>{const a=n.id(),c=t.value;return typeof a==typeof c&&a<c}],"filter->":[Qt,[Rt,nr],(n,[t,a])=>{const c=n.properties()[t.value],p=a.value;return typeof c==typeof p&&c>p}],"filter-id->":[Qt,[nr],(n,[t])=>{const a=n.id(),c=t.value;return typeof a==typeof c&&a>c}],"filter-<=":[Qt,[Rt,nr],(n,[t,a])=>{const c=n.properties()[t.value],p=a.value;return typeof c==typeof p&&c<=p}],"filter-id-<=":[Qt,[nr],(n,[t])=>{const a=n.id(),c=t.value;return typeof a==typeof c&&a<=c}],"filter->=":[Qt,[Rt,nr],(n,[t,a])=>{const c=n.properties()[t.value],p=a.value;return typeof c==typeof p&&c>=p}],"filter-id->=":[Qt,[nr],(n,[t])=>{const a=n.id(),c=t.value;return typeof a==typeof c&&a>=c}],"filter-has":[Qt,[nr],(n,[t])=>t.value in n.properties()],"filter-has-id":[Qt,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[Qt,[Ra(Rt)],(n,[t])=>t.value.indexOf(n.geometryType())>=0],"filter-id-in":[Qt,[Ra(nr)],(n,[t])=>t.value.indexOf(n.id())>=0],"filter-in-small":[Qt,[Rt,Ra(nr)],(n,[t,a])=>a.value.indexOf(n.properties()[t.value])>=0],"filter-in-large":[Qt,[Rt,Ra(nr)],(n,[t,a])=>function(c,p,v,b){for(;v<=b;){const T=v+b>>1;if(p[T]===c)return!0;p[T]>c?b=T-1:v=T+1}return!1}(n.properties()[t.value],a.value,0,a.value.length-1)],all:{type:Qt,overloads:[[[Qt,Qt],(n,[t,a])=>t.evaluate(n)&&a.evaluate(n)],[la(Qt),(n,t)=>{for(const a of t)if(!a.evaluate(n))return!1;return!0}]]},any:{type:Qt,overloads:[[[Qt,Qt],(n,[t,a])=>t.evaluate(n)||a.evaluate(n)],[la(Qt),(n,t)=>{for(const a of t)if(a.evaluate(n))return!0;return!1}]]},"!":[Qt,[Qt],(n,[t])=>!t.evaluate(n)],"is-supported-script":[Qt,[Rt],(n,[t])=>{const a=n.globals&&n.globals.isSupportedScript;return!a||a(t.evaluate(n))}],upcase:[Rt,[Rt],(n,[t])=>t.evaluate(n).toUpperCase()],downcase:[Rt,[Rt],(n,[t])=>t.evaluate(n).toLowerCase()],concat:[Rt,la(nr),(n,t)=>t.map(a=>pr(a.evaluate(n))).join("")],"resolved-locale":[Rt,[Xn],(n,[t])=>t.evaluate(n).resolvedLocale()]});class ns{constructor(t,a){this.expression=t,this._warningHistory={},this._evaluator=new Do,this._defaultValue=a?function(c){if(c.type==="color"&&Zc(c.default))return new vr(0,0,0,0);switch(c.type){case"color":return vr.parse(c.default)||null;case"padding":return Ei.parse(c.default)||null;case"numberArray":return Qr.parse(c.default)||null;case"colorArray":return ta.parse(c.default)||null;case"variableAnchorOffsetCollection":return Wi.parse(c.default)||null;case"projectionDefinition":return ra.parse(c.default)||null;default:return c.default===void 0?null:c.default}}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(t,a,c,p,v,b){return this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=c,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)}evaluate(t,a,c,p,v,b){this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=c||null,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=b||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Gr(`Expected value to be one of ${Object.keys(this._enumValues).map(P=>JSON.stringify(P)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Qa(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Xl}function vn(n,t){const a=new Lc(Xl,Ma,[],t?function(p){const v={color:ii,string:Rt,number:rt,enum:Rt,boolean:Qt,formatted:jo,padding:Ha,numberArray:Wa,colorArray:Yn,projectionDefinition:xi,resolvedImage:hn,variableAnchorOffsetCollection:_r};return p.type==="array"?Ra(v[p.value]||nr,p.length):v[p.type]}(t):void 0),c=a.parse(n,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?Wo(new ns(c,t)):to(a.errors)}class Ps{constructor(t,a){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!Go(a.expression)}evaluateWithoutErrorHandling(t,a,c,p,v,b){return this._styleExpression.evaluateWithoutErrorHandling(t,a,c,p,v,b)}evaluate(t,a,c,p,v,b){return this._styleExpression.evaluate(t,a,c,p,v,b)}}class $c{constructor(t,a,c,p){this.kind=t,this.zoomStops=c,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!Go(a.expression),this.interpolationType=p}evaluateWithoutErrorHandling(t,a,c,p,v,b){return this._styleExpression.evaluateWithoutErrorHandling(t,a,c,p,v,b)}evaluate(t,a,c,p,v,b){return this._styleExpression.evaluate(t,a,c,p,v,b)}interpolationFactor(t,a,c){return this.interpolationType?ma.interpolationFactor(this.interpolationType,t,a,c):0}}function Gc(n,t){const a=vn(n,t);if(a.result==="error")return a;const c=a.value.expression,p=ks(c);if(!p&&!Ya(t))return to([new fr("","data expressions not supported")]);const v=Ho(c,["zoom"]);if(!v&&!sd(t))return to([new fr("","zoom expressions not supported")]);const b=Xi(c);return b||v?b instanceof fr?to([b]):b instanceof ma&&!Xo(t)?to([new fr("",'"interpolate" expressions cannot be used with this property')]):Wo(b?new $c(p?"camera":"composite",a.value,b.labels,b instanceof ma?b.interpolation:void 0):new Ps(p?"constant":"source",a.value)):to([new fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Yo{constructor(t,a){this._parameters=t,this._specification=a,jr(this,ro(this._parameters,this._specification))}static deserialize(t){return new Yo(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Xi(n){let t=null;if(n instanceof Xs)t=Xi(n.result);else if(n instanceof Vo){for(const a of n.args)if(t=Xi(a),t)break}else(n instanceof Ys||n instanceof ma)&&n.input instanceof yn&&n.input.name==="zoom"&&(t=n);return t instanceof fr||n.eachChild(a=>{const c=Xi(a);c instanceof fr?t=c:!t&&c?t=new fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&c&&t!==c&&(t=new fr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Di(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const t of n.slice(1))if(!Di(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const kr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ca(n){if(n==null)return{filter:()=>!0,needGeometry:!1};Di(n)||(n=ss(n));const t=vn(n,kr);if(t.result==="error")throw new Error(t.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,c,p)=>t.value.evaluate(a,c,{},p),needGeometry:rh(n)}}function Ja(n,t){return n<t?-1:n>t?1:0}function rh(n){if(!Array.isArray(n))return!1;if(n[0]==="within"||n[0]==="distance")return!0;for(let t=1;t<n.length;t++)if(rh(n[t]))return!0;return!1}function ss(n){if(!n)return!0;const t=n[0];return n.length<=1?t!=="any":t==="=="?ih(n[1],n[2],"=="):t==="!="?io(ih(n[1],n[2],"==")):t==="<"||t===">"||t==="<="||t===">="?ih(n[1],n[2],t):t==="any"?(a=n.slice(1),["any"].concat(a.map(ss))):t==="all"?["all"].concat(n.slice(1).map(ss)):t==="none"?["all"].concat(n.slice(1).map(ss).map(io)):t==="in"?od(n[1],n.slice(2)):t==="!in"?io(od(n[1],n.slice(2))):t==="has"?Yl(n[1]):t!=="!has"||io(Yl(n[1]));var a}function ih(n,t,a){switch(n){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,n,t]}}function od(n,t){if(t.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(a=>typeof a!=typeof t[0])?["filter-in-large",n,["literal",t.sort(Ja)]]:["filter-in-small",n,["literal",t]]}}function Yl(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function io(n){return["!",n]}function ao(n){const t=typeof n;if(t==="number"||t==="boolean"||t==="string"||n==null)return JSON.stringify(n);if(Array.isArray(n)){let p="[";for(const v of n)p+=`${ao(v)},`;return`${p}]`}const a=Object.keys(n).sort();let c="{";for(let p=0;p<a.length;p++)c+=`${JSON.stringify(a[p])}:${ao(n[a[p]])},`;return`${c}}`}function Kl(n){let t="";for(const a of Ue)t+=`/${ao(n[a])}`;return t}function Ql(n){const t=n.value;return t?[new Qe(n.key,t,"constants have been deprecated as of v8")]:[]}function di(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function js(n){if(Array.isArray(n))return n.map(js);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const t={};for(const a in n)t[a]=js(n[a]);return t}return di(n)}function ga(n){const t=n.key,a=n.value,c=n.valueSpec||{},p=n.objectElementValidators||{},v=n.style,b=n.styleSpec,T=n.validateSpec;let P=[];const I=or(a);if(I!=="object")return[new Qe(t,a,`object expected, ${I} found`)];for(const D in a){const L=D.split(".")[0],q=es(c,L)||c["*"];let G;if(es(p,L))G=p[L];else if(es(c,L))G=T;else if(p["*"])G=p["*"];else{if(!c["*"]){P.push(new Qe(t,a[D],`unknown property "${D}"`));continue}G=T}P=P.concat(G({key:(t&&`${t}.`)+D,value:a[D],valueSpec:q,style:v,styleSpec:b,object:a,objectKey:D,validateSpec:T},a))}for(const D in c)p[D]||c[D].required&&c[D].default===void 0&&a[D]===void 0&&P.push(new Qe(t,a,`missing required property "${D}"`));return P}function ah(n){const t=n.value,a=n.valueSpec,c=n.style,p=n.styleSpec,v=n.key,b=n.arrayElementValidator||n.validateSpec;if(or(t)!=="array")return[new Qe(v,t,`array expected, ${or(t)} found`)];if(a.length&&t.length!==a.length)return[new Qe(v,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new Qe(v,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let T={type:a.value,values:a.values};p.$version<7&&(T.function=a.function),or(a.value)==="object"&&(T=a.value);let P=[];for(let I=0;I<t.length;I++)P=P.concat(b({array:t,arrayIndex:I,value:t[I],valueSpec:T,validateSpec:n.validateSpec,style:c,styleSpec:p,key:`${v}[${I}]`}));return P}function zs(n){const t=n.key,a=n.value,c=n.valueSpec;let p=or(a);return p==="number"&&a!=a&&(p="NaN"),p!=="number"?[new Qe(t,a,`number expected, ${p} found`)]:"minimum"in c&&a<c.minimum?[new Qe(t,a,`${a} is less than the minimum value ${c.minimum}`)]:"maximum"in c&&a>c.maximum?[new Qe(t,a,`${a} is greater than the maximum value ${c.maximum}`)]:[]}function nh(n){const t=n.valueSpec,a=di(n.value.type);let c,p,v,b={};const T=a!=="categorical"&&n.value.property===void 0,P=!T,I=or(n.value.stops)==="array"&&or(n.value.stops[0])==="array"&&or(n.value.stops[0][0])==="object",D=ga({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(G){if(a==="identity")return[new Qe(G.key,G.value,'identity function may not have a "stops" property')];let H=[];const K=G.value;return H=H.concat(ah({key:G.key,value:K,valueSpec:G.valueSpec,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:L})),or(K)==="array"&&K.length===0&&H.push(new Qe(G.key,K,"array must have at least one stop")),H},default:function(G){return G.validateSpec({key:G.key,value:G.value,valueSpec:t,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec})}}});return a==="identity"&&T&&D.push(new Qe(n.key,n.value,'missing required property "property"')),a==="identity"||n.value.stops||D.push(new Qe(n.key,n.value,'missing required property "stops"')),a==="exponential"&&n.valueSpec.expression&&!Xo(n.valueSpec)&&D.push(new Qe(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(P&&!Ya(n.valueSpec)?D.push(new Qe(n.key,n.value,"property functions not supported")):T&&!sd(n.valueSpec)&&D.push(new Qe(n.key,n.value,"zoom functions not supported"))),a!=="categorical"&&!I||n.value.property!==void 0||D.push(new Qe(n.key,n.value,'"property" property is required')),D;function L(G){let H=[];const K=G.value,se=G.key;if(or(K)!=="array")return[new Qe(se,K,`array expected, ${or(K)} found`)];if(K.length!==2)return[new Qe(se,K,`array length 2 expected, length ${K.length} found`)];if(I){if(or(K[0])!=="object")return[new Qe(se,K,`object expected, ${or(K[0])} found`)];if(K[0].zoom===void 0)return[new Qe(se,K,"object stop key must have zoom")];if(K[0].value===void 0)return[new Qe(se,K,"object stop key must have value")];if(v&&v>di(K[0].zoom))return[new Qe(se,K[0].zoom,"stop zoom values must appear in ascending order")];di(K[0].zoom)!==v&&(v=di(K[0].zoom),p=void 0,b={}),H=H.concat(ga({key:`${se}[0]`,value:K[0],valueSpec:{zoom:{}},validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:zs,value:q}}))}else H=H.concat(q({key:`${se}[0]`,value:K[0],validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec},K));return Qa(js(K[1]))?H.concat([new Qe(`${se}[1]`,K[1],"expressions are not allowed in function stops.")]):H.concat(G.validateSpec({key:`${se}[1]`,value:K[1],valueSpec:t,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec}))}function q(G,H){const K=or(G.value),se=di(G.value),fe=G.value!==null?G.value:H;if(c){if(K!==c)return[new Qe(G.key,fe,`${K} stop domain type must match previous stop domain type ${c}`)]}else c=K;if(K!=="number"&&K!=="string"&&K!=="boolean")return[new Qe(G.key,fe,"stop domain value must be a number, string, or boolean")];if(K!=="number"&&a!=="categorical"){let Me=`number expected, ${K} found`;return Ya(t)&&a===void 0&&(Me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Qe(G.key,fe,Me)]}return a!=="categorical"||K!=="number"||isFinite(se)&&Math.floor(se)===se?a!=="categorical"&&K==="number"&&p!==void 0&&se<p?[new Qe(G.key,fe,"stop domain values must appear in ascending order")]:(p=se,a==="categorical"&&se in b?[new Qe(G.key,fe,"stop domain values must be unique")]:(b[se]=!0,[])):[new Qe(G.key,fe,`integer expected, found ${se}`)]}}function Aa(n){const t=(n.expressionContext==="property"?Gc:vn)(js(n.value),n.valueSpec);if(t.result==="error")return t.value.map(c=>new Qe(`${n.key}${c.key}`,n.value,c.message));const a=t.value.expression||t.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!a.outputDefined())return[new Qe(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!Go(a))return[new Qe(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!Go(a))return[new Qe(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!Ho(a,["zoom","feature-state"]))return[new Qe(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!ks(a))return[new Qe(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ko(n){const t=n.key,a=n.value,c=or(a);return c!=="string"?[new Qe(t,a,`color expected, ${c} found`)]:vr.parse(String(a))?[]:[new Qe(t,a,`color expected, "${a}" found`)]}function no(n){const t=n.key,a=n.value,c=n.valueSpec,p=[];return Array.isArray(c.values)?c.values.indexOf(di(a))===-1&&p.push(new Qe(t,a,`expected one of [${c.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(c.values).indexOf(di(a))===-1&&p.push(new Qe(t,a,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(a)} found`)),p}function Qo(n){return Di(js(n.value))?Aa(jr({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Hc(n)}function Hc(n){const t=n.value,a=n.key;if(or(t)!=="array")return[new Qe(a,t,`array expected, ${or(t)} found`)];const c=n.styleSpec;let p,v=[];if(t.length<1)return[new Qe(a,t,"filter array must have at least 1 element")];switch(v=v.concat(no({key:`${a}[0]`,value:t[0],valueSpec:c.filter_operator,style:n.style,styleSpec:n.styleSpec})),di(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&di(t[1])==="$type"&&v.push(new Qe(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&v.push(new Qe(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(p=or(t[1]),p!=="string"&&v.push(new Qe(`${a}[1]`,t[1],`string expected, ${p} found`)));for(let b=2;b<t.length;b++)p=or(t[b]),di(t[1])==="$type"?v=v.concat(no({key:`${a}[${b}]`,value:t[b],valueSpec:c.geometry_type,style:n.style,styleSpec:n.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&v.push(new Qe(`${a}[${b}]`,t[b],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let b=1;b<t.length;b++)v=v.concat(Hc({key:`${a}[${b}]`,value:t[b],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":p=or(t[1]),t.length!==2?v.push(new Qe(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):p!=="string"&&v.push(new Qe(`${a}[1]`,t[1],`string expected, ${p} found`))}return v}function ld(n,t){const a=n.key,c=n.validateSpec,p=n.style,v=n.styleSpec,b=n.value,T=n.objectKey,P=v[`${t}_${n.layerType}`];if(!P)return[];const I=T.match(/^(.*)-transition$/);if(t==="paint"&&I&&P[I[1]]&&P[I[1]].transition)return c({key:a,value:b,valueSpec:v.transition,style:p,styleSpec:v});const D=n.valueSpec||P[T];if(!D)return[new Qe(a,b,`unknown property "${T}"`)];let L;if(or(b)==="string"&&Ya(D)&&!D.tokens&&(L=/^{([^}]+)}$/.exec(b)))return[new Qe(a,b,`"${T}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const q=[];return n.layerType==="symbol"&&(T==="text-field"&&p&&!p.glyphs&&q.push(new Qe(a,b,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&Zc(js(b))&&di(b.type)==="identity"&&q.push(new Qe(a,b,'"text-font" does not support identity functions'))),q.concat(c({key:n.key,value:b,valueSpec:D,style:p,styleSpec:v,expressionContext:"property",propertyType:t,propertyKey:T}))}function cd(n){return ld(n,"paint")}function xn(n){return ld(n,"layout")}function Jo(n){let t=[];const a=n.value,c=n.key,p=n.style,v=n.styleSpec;if(or(a)!=="object")return[new Qe(c,a,`object expected, ${or(a)} found`)];a.type||a.ref||t.push(new Qe(c,a,'either "type" or "ref" is required'));let b=di(a.type);const T=di(a.ref);if(a.id){const P=di(a.id);for(let I=0;I<n.arrayIndex;I++){const D=p.layers[I];di(D.id)===P&&t.push(new Qe(c,a.id,`duplicate layer id "${a.id}", previously used at line ${D.id.__line__}`))}}if("ref"in a){let P;["type","source","source-layer","filter","layout"].forEach(I=>{I in a&&t.push(new Qe(c,a[I],`"${I}" is prohibited for ref layers`))}),p.layers.forEach(I=>{di(I.id)===T&&(P=I)}),P?P.ref?t.push(new Qe(c,a.ref,"ref cannot reference another ref layer")):b=di(P.type):t.push(new Qe(c,a.ref,`ref layer "${T}" not found`))}else if(b!=="background")if(a.source){const P=p.sources&&p.sources[a.source],I=P&&di(P.type);P?I==="vector"&&b==="raster"?t.push(new Qe(c,a.source,`layer "${a.id}" requires a raster source`)):I!=="raster-dem"&&b==="hillshade"?t.push(new Qe(c,a.source,`layer "${a.id}" requires a raster-dem source`)):I==="raster"&&b!=="raster"?t.push(new Qe(c,a.source,`layer "${a.id}" requires a vector source`)):I!=="vector"||a["source-layer"]?I==="raster-dem"&&b!=="hillshade"?t.push(new Qe(c,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):b!=="line"||!a.paint||!a.paint["line-gradient"]||I==="geojson"&&P.lineMetrics||t.push(new Qe(c,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Qe(c,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new Qe(c,a.source,`source "${a.source}" not found`))}else t.push(new Qe(c,a,'missing required property "source"'));return t=t.concat(ga({key:c,value:a,valueSpec:v.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*":()=>[],type:()=>n.validateSpec({key:`${c}.type`,value:a.type,valueSpec:v.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:a,objectKey:"type"}),filter:Qo,layout:P=>ga({layer:a,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*":I=>xn(jr({layerType:b},I))}}),paint:P=>ga({layer:a,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*":I=>cd(jr({layerType:b},I))}})}})),t}function fi(n){const t=n.value,a=n.key,c=or(t);return c!=="string"?[new Qe(a,t,`string expected, ${c} found`)]:[]}const Is={promoteId:function({key:n,value:t}){if(or(t)==="string")return fi({key:n,value:t});{const a=[];for(const c in t)a.push(...fi({key:`${n}.${c}`,value:t[c]}));return a}}};function sh(n){const t=n.value,a=n.key,c=n.styleSpec,p=n.style,v=n.validateSpec;if(!t.type)return[new Qe(a,t,'"type" is required')];const b=di(t.type);let T;switch(b){case"vector":case"raster":return T=ga({key:a,value:t,valueSpec:c[`source_${b.replace("-","_")}`],style:n.style,styleSpec:c,objectElementValidators:Is,validateSpec:v}),T;case"raster-dem":return T=function(P){var I;const D=(I=P.sourceName)!==null&&I!==void 0?I:"",L=P.value,q=P.styleSpec,G=q.source_raster_dem,H=P.style;let K=[];const se=or(L);if(L===void 0)return K;if(se!=="object")return K.push(new Qe("source_raster_dem",L,`object expected, ${se} found`)),K;const fe=di(L.encoding)==="custom",Me=["redFactor","greenFactor","blueFactor","baseShift"],me=P.value.encoding?`"${P.value.encoding}"`:"Default";for(const $ in L)!fe&&Me.includes($)?K.push(new Qe($,L[$],`In "${D}": "${$}" is only valid when "encoding" is set to "custom". ${me} encoding found`)):G[$]?K=K.concat(P.validateSpec({key:$,value:L[$],valueSpec:G[$],validateSpec:P.validateSpec,style:H,styleSpec:q})):K.push(new Qe($,L[$],`unknown property "${$}"`));return K}({sourceName:a,value:t,style:n.style,styleSpec:c,validateSpec:v}),T;case"geojson":if(T=ga({key:a,value:t,valueSpec:c.source_geojson,style:p,styleSpec:c,validateSpec:v,objectElementValidators:Is}),t.cluster)for(const P in t.clusterProperties){const[I,D]=t.clusterProperties[P],L=typeof I=="string"?[I,["accumulated"],["get",P]]:I;T.push(...Aa({key:`${a}.${P}.map`,value:D,expressionContext:"cluster-map"})),T.push(...Aa({key:`${a}.${P}.reduce`,value:L,expressionContext:"cluster-reduce"}))}return T;case"video":return ga({key:a,value:t,valueSpec:c.source_video,style:p,validateSpec:v,styleSpec:c});case"image":return ga({key:a,value:t,valueSpec:c.source_image,style:p,validateSpec:v,styleSpec:c});case"canvas":return[new Qe(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return no({key:`${a}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function oh(n){const t=n.value,a=n.styleSpec,c=a.light,p=n.style;let v=[];const b=or(t);if(t===void 0)return v;if(b!=="object")return v=v.concat([new Qe("light",t,`object expected, ${b} found`)]),v;for(const T in t){const P=T.match(/^(.*)-transition$/);v=v.concat(P&&c[P[1]]&&c[P[1]].transition?n.validateSpec({key:T,value:t[T],valueSpec:a.transition,validateSpec:n.validateSpec,style:p,styleSpec:a}):c[T]?n.validateSpec({key:T,value:t[T],valueSpec:c[T],validateSpec:n.validateSpec,style:p,styleSpec:a}):[new Qe(T,t[T],`unknown property "${T}"`)])}return v}function lh(n){const t=n.value,a=n.styleSpec,c=a.sky,p=n.style,v=or(t);if(t===void 0)return[];if(v!=="object")return[new Qe("sky",t,`object expected, ${v} found`)];let b=[];for(const T in t)b=b.concat(c[T]?n.validateSpec({key:T,value:t[T],valueSpec:c[T],style:p,styleSpec:a}):[new Qe(T,t[T],`unknown property "${T}"`)]);return b}function ca(n){const t=n.value,a=n.styleSpec,c=a.terrain,p=n.style;let v=[];const b=or(t);if(t===void 0)return v;if(b!=="object")return v=v.concat([new Qe("terrain",t,`object expected, ${b} found`)]),v;for(const T in t)v=v.concat(c[T]?n.validateSpec({key:T,value:t[T],valueSpec:c[T],validateSpec:n.validateSpec,style:p,styleSpec:a}):[new Qe(T,t[T],`unknown property "${T}"`)]);return v}function bn(n){let t=[];const a=n.value,c=n.key;if(Array.isArray(a)){const p=[],v=[];for(const b in a)a[b].id&&p.includes(a[b].id)&&t.push(new Qe(c,a,`all the sprites' ids must be unique, but ${a[b].id} is duplicated`)),p.push(a[b].id),a[b].url&&v.includes(a[b].url)&&t.push(new Qe(c,a,`all the sprites' URLs must be unique, but ${a[b].url} is duplicated`)),v.push(a[b].url),t=t.concat(ga({key:`${c}[${b}]`,value:a[b],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:n.validateSpec}));return t}return fi({key:c,value:a})}function jn(n){return t=n.value,t&&t.constructor===Object?[]:[new Qe(n.key,n.value,`object expected, ${or(n.value)} found`)];var t}const ud={"*":()=>[],array:ah,boolean:function(n){const t=n.value,a=n.key,c=or(t);return c!=="boolean"?[new Qe(a,t,`boolean expected, ${c} found`)]:[]},number:zs,color:Ko,constants:Ql,enum:no,filter:Qo,function:nh,layer:Jo,object:ga,source:sh,light:oh,sky:lh,terrain:ca,projection:function(n){const t=n.value,a=n.styleSpec,c=a.projection,p=n.style,v=or(t);if(t===void 0)return[];if(v!=="object")return[new Qe("projection",t,`object expected, ${v} found`)];let b=[];for(const T in t)b=b.concat(c[T]?n.validateSpec({key:T,value:t[T],valueSpec:c[T],style:p,styleSpec:a}):[new Qe(T,t[T],`unknown property "${T}"`)]);return b},projectionDefinition:function(n){const t=n.key;let a=n.value;a=a instanceof String?a.valueOf():a;const c=or(a);return c!=="array"||function(p){return Array.isArray(p)&&p.length===3&&typeof p[0]=="string"&&typeof p[1]=="string"&&typeof p[2]=="number"}(a)||function(p){return!!["interpolate","step","literal"].includes(p[0])}(a)?["array","string"].includes(c)?[]:[new Qe(t,a,`projection expected, invalid type "${c}" found`)]:[new Qe(t,a,`projection expected, invalid array ${JSON.stringify(a)} found`)]},string:fi,formatted:function(n){return fi(n).length===0?[]:Aa(n)},resolvedImage:function(n){return fi(n).length===0?[]:Aa(n)},padding:function(n){const t=n.key,a=n.value;if(or(a)==="array"){if(a.length<1||a.length>4)return[new Qe(t,a,`padding requires 1 to 4 values; ${a.length} values found`)];const c={type:"number"};let p=[];for(let v=0;v<a.length;v++)p=p.concat(n.validateSpec({key:`${t}[${v}]`,value:a[v],validateSpec:n.validateSpec,valueSpec:c}));return p}return zs({key:t,value:a,valueSpec:{}})},numberArray:function(n){const t=n.key,a=n.value;if(or(a)==="array"){const c={type:"number"};if(a.length<1)return[new Qe(t,a,"array length at least 1 expected, length 0 found")];let p=[];for(let v=0;v<a.length;v++)p=p.concat(n.validateSpec({key:`${t}[${v}]`,value:a[v],validateSpec:n.validateSpec,valueSpec:c}));return p}return zs({key:t,value:a,valueSpec:{}})},colorArray:function(n){const t=n.key,a=n.value;if(or(a)==="array"){if(a.length<1)return[new Qe(t,a,"array length at least 1 expected, length 0 found")];let c=[];for(let p=0;p<a.length;p++)c=c.concat(Ko({key:`${t}[${p}]`,value:a[p]}));return c}return Ko({key:t,value:a})},variableAnchorOffsetCollection:function(n){const t=n.key,a=n.value,c=or(a),p=n.styleSpec;if(c!=="array"||a.length<1||a.length%2!=0)return[new Qe(t,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let b=0;b<a.length;b+=2)v=v.concat(no({key:`${t}[${b}]`,value:a[b],valueSpec:p.layout_symbol["text-anchor"]})),v=v.concat(ah({key:`${t}[${b+1}]`,value:a[b+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:p}));return v},sprite:bn,state:jn};function en(n){const t=n.value,a=n.valueSpec,c=n.styleSpec;return n.validateSpec=en,a.expression&&Zc(di(t))?nh(n):a.expression&&Qa(js(t))?Aa(n):a.type&&ud[a.type]?ud[a.type](n):ga(jr({},n,{valueSpec:a.type?c[a.type]:a}))}function os(n){const t=n.value,a=n.key,c=fi(n);return c.length||(t.indexOf("{fontstack}")===-1&&c.push(new Qe(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&c.push(new Qe(a,t,'"glyphs" url must include a "{range}" token'))),c}function Pr(n,t=oe){let a=[];return a=a.concat(en({key:"",value:n,valueSpec:t.$root,styleSpec:t,style:n,validateSpec:en,objectElementValidators:{glyphs:os,"*":()=>[]}})),n.constants&&(a=a.concat(Ql({key:"constants",value:n.constants}))),Jl(a)}function Na(n){return function(t){return n({...t,validateSpec:en})}}function Jl(n){return[].concat(n).sort((t,a)=>t.line-a.line)}function zn(n){return function(...t){return Jl(n.apply(this,t))}}Pr.source=zn(Na(sh)),Pr.sprite=zn(Na(bn)),Pr.glyphs=zn(Na(os)),Pr.light=zn(Na(oh)),Pr.sky=zn(Na(lh)),Pr.terrain=zn(Na(ca)),Pr.state=zn(Na(jn)),Pr.layer=zn(Na(Jo)),Pr.filter=zn(Na(Qo)),Pr.paintProperty=zn(Na(cd)),Pr.layoutProperty=zn(Na(xn));const ec=Pr,Ai=ec.light,hd=ec.sky,el=ec.paintProperty,so=ec.layoutProperty;function Wc(n,t){let a=!1;if(t&&t.length)for(const c of t)n.fire(new ye(new Error(c.message))),a=!0;return a}class In{constructor(t,a,c){const p=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const b=new Int32Array(this.arrayBuffer);t=b[0],this.d=(a=b[1])+2*(c=b[2]);for(let P=0;P<this.d*this.d;P++){const I=b[3+P],D=b[3+P+1];p.push(I===D?null:b.subarray(I,D))}const T=b[3+p.length+1];this.keys=b.subarray(b[3+p.length],T),this.bboxes=b.subarray(T),this.insert=this._insertReadonly}else{this.d=a+2*c;for(let b=0;b<this.d*this.d;b++)p.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=t,this.padding=c,this.scale=a/t,this.uid=0;const v=c/a*t;this.min=-v,this.max=t+v}insert(t,a,c,p,v){this._forEachCell(a,c,p,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(a),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,a,c,p,v,b){this.cells[v].push(b)}query(t,a,c,p,v){const b=this.min,T=this.max;if(t<=b&&a<=b&&T<=c&&T<=p&&!v)return Array.prototype.slice.call(this.keys);{const P=[];return this._forEachCell(t,a,c,p,this._queryCell,P,{},v),P}}_queryCell(t,a,c,p,v,b,T,P){const I=this.cells[v];if(I!==null){const D=this.keys,L=this.bboxes;for(let q=0;q<I.length;q++){const G=I[q];if(T[G]===void 0){const H=4*G;(P?P(L[H+0],L[H+1],L[H+2],L[H+3]):t<=L[H+2]&&a<=L[H+3]&&c>=L[H+0]&&p>=L[H+1])?(T[G]=!0,b.push(D[G])):T[G]=!1}}}}_forEachCell(t,a,c,p,v,b,T,P){const I=this._convertToCellCoord(t),D=this._convertToCellCoord(a),L=this._convertToCellCoord(c),q=this._convertToCellCoord(p);for(let G=I;G<=L;G++)for(let H=D;H<=q;H++){const K=this.d*H+G;if((!P||P(this._convertFromCellCoord(G),this._convertFromCellCoord(H),this._convertFromCellCoord(G+1),this._convertFromCellCoord(H+1)))&&v.call(this,t,a,c,p,K,b,T,P))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,a=3+this.cells.length+1+1;let c=0;for(let b=0;b<this.cells.length;b++)c+=this.cells[b].length;const p=new Int32Array(a+c+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let v=a;for(let b=0;b<t.length;b++){const T=t[b];p[3+b]=v,p.set(T,v),v+=T.length}return p[3+t.length]=v,p.set(this.keys,v),v+=this.keys.length,p[3+t.length+1]=v,p.set(this.bboxes,v),v+=this.bboxes.length,p.buffer}static serialize(t,a){const c=t.toArrayBuffer();return a&&a.push(c),{buffer:c}}static deserialize(t){return new In(t.buffer)}}const ka={};function kt(n,t,a={}){if(ka[n])throw new Error(`${n} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:n,writeable:!1}),ka[n]={klass:t,omit:a.omit||[],shallow:a.shallow||[]}}kt("Object",Object),kt("TransferableGridIndex",In),kt("Color",vr),kt("Error",Error),kt("AJAXError",un),kt("ResolvedImage",Ta),kt("StylePropertyFunction",Yo),kt("StyleExpression",ns,{omit:["_evaluator"]}),kt("ZoomDependentExpression",$c),kt("ZoomConstantExpression",Ps),kt("CompoundExpression",yn,{omit:["_evaluate"]});for(const n in Xl)Xl[n]._classRegistryKey||kt(`Expression_${n}`,Xl[n]);function Xc(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function ch(n){return n.$name||n.constructor._classRegistryKey}function dd(n){return!function(t){if(t===null||typeof t!="object")return!1;const a=ch(t);return!(!a||a==="Object")}(n)&&(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||n instanceof Error||Xc(n)||za(n)||ArrayBuffer.isView(n)||n instanceof ImageData)}function wn(n,t){if(dd(n))return(Xc(n)||za(n))&&t&&t.push(n),ArrayBuffer.isView(n)&&t&&t.push(n.buffer),n instanceof ImageData&&t&&t.push(n.data.buffer),n;if(Array.isArray(n)){const v=[];for(const b of n)v.push(wn(b,t));return v}if(typeof n!="object")throw new Error("can't serialize object of type "+typeof n);const a=ch(n);if(!a)throw new Error(`can't serialize object of unregistered class ${n.constructor.name}`);if(!ka[a])throw new Error(`${a} is not registered.`);const{klass:c}=ka[a],p=c.serialize?c.serialize(n,t):{};if(c.serialize){if(t&&p===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in n){if(!n.hasOwnProperty(v)||ka[a].omit.indexOf(v)>=0)continue;const b=n[v];p[v]=ka[a].shallow.indexOf(v)>=0?b:wn(b,t)}n instanceof Error&&(p.message=n.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(p.$name=a),p}function tl(n){if(dd(n))return n;if(Array.isArray(n))return n.map(tl);if(typeof n!="object")throw new Error("can't deserialize object of type "+typeof n);const t=ch(n)||"Object";if(!ka[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:a}=ka[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(n);const c=Object.create(a.prototype);for(const p of Object.keys(n)){if(p==="$name")continue;const v=n[p];c[p]=ka[t].shallow.indexOf(p)>=0?v:tl(v)}return c}class tc{constructor(){this.first=!0}update(t,a){const c=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=a),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=c,!0))}}const dr={"Latin-1 Supplement":n=>n>=128&&n<=255,"Hangul Jamo":n=>n>=4352&&n<=4607,Khmer:n=>n>=6016&&n<=6143,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Hiragana:n=>n>=12352&&n<=12447,Katakana:n=>n>=12448&&n<=12543,Kanbun:n=>n>=12688&&n<=12703,"CJK Strokes":n=>n>=12736&&n<=12783,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"CJK Unified Ideographs":n=>n>=19968&&n<=40959,"Hangul Syllables":n=>n>=44032&&n<=55215,"Private Use Area":n=>n>=57344&&n<=63743,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519};function Rn(n){for(const t of n)if(ls(t.charCodeAt(0)))return!0;return!1}function gr(n){for(const t of n)if(!Yc(t.charCodeAt(0)))return!1;return!0}function Ur(n){const t=n.map(a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}}).filter(a=>a);return new RegExp(t.join("|"),"u")}const Ni=Ur(["Arab","Dupl","Mong","Ougr","Syrc"]);function Yc(n){return!Ni.test(String.fromCodePoint(n))}const oo=Ur(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function ls(n){return!(n!==746&&n!==747&&(n<4352||!(dr["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||dr["CJK Compatibility"](n)||dr["CJK Strokes"](n)||!(!dr["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||dr["Enclosed CJK Letters and Months"](n)||dr["Ideographic Description Characters"](n)||dr.Kanbun(n)||dr.Katakana(n)&&n!==12540||!(!dr["Halfwidth and Fullwidth Forms"](n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!dr["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||dr["Vertical Forms"](n)||dr["Yijing Hexagram Symbols"](n)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(n))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(n))||oo.test(String.fromCodePoint(n)))))}function lo(n){return!(ls(n)||function(t){return!!(dr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||dr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||dr["Letterlike Symbols"](t)||dr["Number Forms"](t)||dr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||dr["Control Pictures"](t)&&t!==9251||dr["Optical Character Recognition"](t)||dr["Enclosed Alphanumerics"](t)||dr["Geometric Shapes"](t)||dr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||dr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||dr["CJK Symbols and Punctuation"](t)||dr.Katakana(t)||dr["Private Use Area"](t)||dr["CJK Compatibility Forms"](t)||dr["Small Form Variants"](t)||dr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(n))}const Kc=Ur(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Rs(n){return Kc.test(String.fromCodePoint(n))}function Wp(n,t){return!(!t&&Rs(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||dr.Khmer(n))}function Li(n){for(const t of n)if(Rs(t.charCodeAt(0)))return!0;return!1}const Dn=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(n){this.pluginStatus=n.pluginStatus,this.pluginURL=n.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(n){if(Dn.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=n.applyArabicShaping,this.processBidirectionalText=n.processBidirectionalText,this.processStyledBidirectionalText=n.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(n,t){return l(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(n.pluginStatus!=="loading")return this.setState(n),n;const a=n.pluginURL,c=new Promise(v=>{this.loadScriptResolve=v});t(a);const p=new Promise(v=>setTimeout(()=>v(),this.TIMEOUT));if(yield Promise.race([c,p]),this.isParsed()){const v={pluginStatus:"loaded",pluginURL:a};return this.setState(v),v}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${a}`)})}};class Hr{constructor(t,a){this.zoom=t,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new tc,this.transition={})}isSupportedScript(t){return function(a,c){for(const p of a)if(!Wp(p.charCodeAt(0),c))return!1;return!0}(t,Dn.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,a=t-Math.floor(t),c=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*a}}}class rc{constructor(t,a){this.property=t,this.value=a,this.expression=function(c,p){if(Zc(c))return new Yo(c,p);if(Qa(c)){const v=Gc(c,p);if(v.result==="error")throw new Error(v.value.map(b=>`${b.key}: ${b.message}`).join(", "));return v.value}{let v=c;return p.type==="color"&&typeof c=="string"?v=vr.parse(c):p.type!=="padding"||typeof c!="number"&&!Array.isArray(c)?p.type!=="numberArray"||typeof c!="number"&&!Array.isArray(c)?p.type!=="colorArray"||typeof c!="string"&&!Array.isArray(c)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(c)?v=Wi.parse(c):p.type==="projectionDefinition"&&typeof c=="string"&&(v=ra.parse(c)):v=ta.parse(c):v=Qr.parse(c):v=Ei.parse(c),{kind:"constant",evaluate:()=>v}}}(a===void 0?t.specification.default:a,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,a,c){return this.property.possiblyEvaluate(this,t,a,c)}}class uh{constructor(t){this.property=t,this.value=new rc(t,void 0)}transitioned(t,a){return new hh(this.property,this.value,a,qr({},t.transition,this.transition),t.now)}untransitioned(){return new hh(this.property,this.value,null,{},0)}}class Sf{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return vi(this._values[t].value.value)}setValue(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new uh(this._values[t].property)),this._values[t].value=new rc(this._values[t].property,a===null?void 0:vi(a))}getTransition(t){return vi(this._values[t].transition)}setTransition(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new uh(this._values[t].property)),this._values[t].transition=vi(a)||void 0}serialize(){const t={};for(const a of Object.keys(this._values)){const c=this.getValue(a);c!==void 0&&(t[a]=c);const p=this.getTransition(a);p!==void 0&&(t[`${a}-transition`]=p)}return t}transitioned(t,a){const c=new dh(this._properties);for(const p of Object.keys(this._values))c._values[p]=this._values[p].transitioned(t,a._values[p]);return c}untransitioned(){const t=new dh(this._properties);for(const a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class hh{constructor(t,a,c,p,v){this.property=t,this.value=a,this.begin=v+p.delay||0,this.end=this.begin+p.duration||0,t.specification.transition&&(p.delay||p.duration)&&(this.prior=c)}possiblyEvaluate(t,a,c){const p=t.now||0,v=this.value.possiblyEvaluate(t,a,c),b=this.prior;if(b){if(p>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(p<this.begin)return b.possiblyEvaluate(t,a,c);{const T=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(t,a,c),v,Ot(T))}}return v}}class dh{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,c){const p=new bi(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(t,a,c);return p}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class fd{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return vi(this._values[t].value)}setValue(t,a){this._values[t]=new rc(this._values[t].property,a===null?void 0:vi(a))}serialize(){const t={};for(const a of Object.keys(this._values)){const c=this.getValue(a);c!==void 0&&(t[a]=c)}return t}possiblyEvaluate(t,a,c){const p=new bi(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(t,a,c);return p}}class Wr{constructor(t,a,c){this.property=t,this.value=a,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,c,p){return this.property.evaluate(this.value,this.parameters,t,a,c,p)}}class bi{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Dt{constructor(t){this.specification=t}possiblyEvaluate(t,a){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(a)}interpolate(t,a,c){const p=ts[this.specification.type];return p?p(t,a,c):t}}class $t{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,c,p){return new Wr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},c,p)}:t.expression,a)}interpolate(t,a,c){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new Wr(this,{kind:"constant",value:void 0},t.parameters);const p=ts[this.specification.type];if(p){const v=p(t.value.value,a.value.value,c);return new Wr(this,{kind:"constant",value:v},t.parameters)}return t}evaluate(t,a,c,p,v,b){return t.kind==="constant"?t.value:t.evaluate(a,c,p,v,b)}}class co extends $t{possiblyEvaluate(t,a,c,p){if(t.value===void 0)return new Wr(this,{kind:"constant",value:void 0},a);if(t.expression.kind==="constant"){const v=t.expression.evaluate(a,null,{},c,p),b=t.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,T=this._calculate(b,b,b,a);return new Wr(this,{kind:"constant",value:T},a)}if(t.expression.kind==="camera"){const v=this._calculate(t.expression.evaluate({zoom:a.zoom-1}),t.expression.evaluate({zoom:a.zoom}),t.expression.evaluate({zoom:a.zoom+1}),a);return new Wr(this,{kind:"constant",value:v},a)}return new Wr(this,t.expression,a)}evaluate(t,a,c,p,v,b){if(t.kind==="source"){const T=t.evaluate(a,c,p,v,b);return this._calculate(T,T,T,a)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(a.zoom)-1},c,p),t.evaluate({zoom:Math.floor(a.zoom)},c,p),t.evaluate({zoom:Math.floor(a.zoom)+1},c,p),a):t.value}_calculate(t,a,c,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:c,to:a}}interpolate(t){return t}}class Qc{constructor(t){this.specification=t}possiblyEvaluate(t,a,c,p){if(t.value!==void 0){if(t.expression.kind==="constant"){const v=t.expression.evaluate(a,null,{},c,p);return this._calculate(v,v,v,a)}return this._calculate(t.expression.evaluate(new Hr(Math.floor(a.zoom-1),a)),t.expression.evaluate(new Hr(Math.floor(a.zoom),a)),t.expression.evaluate(new Hr(Math.floor(a.zoom+1),a)),a)}}_calculate(t,a,c,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:c,to:a}}interpolate(t){return t}}class Nn{constructor(t){this.specification=t}possiblyEvaluate(t,a,c,p){return!!t.expression.evaluate(a,null,{},c,p)}interpolate(){return!1}}class wi{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in t){const c=t[a];c.specification.overridable&&this.overridableProperties.push(a);const p=this.defaultPropertyValues[a]=new rc(c,void 0),v=this.defaultTransitionablePropertyValues[a]=new uh(c);this.defaultTransitioningPropertyValues[a]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=p.possiblyEvaluate({})}}}kt("DataDrivenProperty",$t),kt("DataConstantProperty",Dt),kt("CrossFadedDataDrivenProperty",co),kt("CrossFadedProperty",Qc),kt("ColorRampProperty",Nn);const Jc="-transition";class La extends Ce{constructor(t,a){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),a.layout&&(this._unevaluatedLayout=new fd(a.layout)),a.paint)){this._transitionablePaint=new Sf(a.paint);for(const c in t.paint)this.setPaintProperty(c,t.paint[c],{validate:!1});for(const c in t.layout)this.setLayoutProperty(c,t.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new bi(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,a,c={}){a!=null&&this._validate(so,`layers.${this.id}.layout.${t}`,t,a,c)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return t.endsWith(Jc)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,c={}){if(a!=null&&this._validate(el,`layers.${this.id}.paint.${t}`,t,a,c))return!1;if(t.endsWith(Jc))return this._transitionablePaint.setTransition(t.slice(0,-11),a||void 0),!1;{const p=this._transitionablePaint._values[t],v=p.property.specification["property-type"]==="cross-faded-data-driven",b=p.value.isDataDriven(),T=p.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);const P=this._transitionablePaint._values[t].value;return P.isDataDriven()||b||v||this._handleOverridablePaintPropertyUpdate(t,T,P)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,a,c){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Br(t,(a,c)=>!(a===void 0||c==="layout"&&!Object.keys(a).length||c==="paint"&&!Object.keys(a).length))}_validate(t,a,c,p,v={}){return(!v||v.validate!==!1)&&Wc(this,t.call(ec,{key:a,layerType:this.type,objectKey:c,value:p,styleSpec:oe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const a=this.paint.get(t);if(a instanceof Wr&&Ya(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const pd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class uo{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class pi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ai(n,t=1){let a=0,c=0;return{members:n.map(p=>{const v=pd[p.type].BYTES_PER_ELEMENT,b=a=rl(a,Math.max(t,v)),T=p.components||1;return c=Math.max(c,v),a+=v*T,{name:p.name,type:p.type,components:T,offset:b}}),size:rl(a,Math.max(c,t)),alignment:t}}function rl(n,t){return Math.ceil(n/t)*t}class ic extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,a)}emplace(t,a,c){const p=2*t;return this.int16[p+0]=a,this.int16[p+1]=c,t}}ic.prototype.bytesPerElement=4,kt("StructArrayLayout2i4",ic);class il extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c){const p=this.length;return this.resize(p+1),this.emplace(p,t,a,c)}emplace(t,a,c,p){const v=3*t;return this.int16[v+0]=a,this.int16[v+1]=c,this.int16[v+2]=p,t}}il.prototype.bytesPerElement=6,kt("StructArrayLayout3i6",il);class ho extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c,p){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,c,p)}emplace(t,a,c,p,v){const b=4*t;return this.int16[b+0]=a,this.int16[b+1]=c,this.int16[b+2]=p,this.int16[b+3]=v,t}}ho.prototype.bytesPerElement=8,kt("StructArrayLayout4i8",ho);class md extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c,p,v,b){const T=this.length;return this.resize(T+1),this.emplace(T,t,a,c,p,v,b)}emplace(t,a,c,p,v,b,T){const P=6*t;return this.int16[P+0]=a,this.int16[P+1]=c,this.int16[P+2]=p,this.int16[P+3]=v,this.int16[P+4]=b,this.int16[P+5]=T,t}}md.prototype.bytesPerElement=12,kt("StructArrayLayout2i4i12",md);class fh extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c,p,v,b){const T=this.length;return this.resize(T+1),this.emplace(T,t,a,c,p,v,b)}emplace(t,a,c,p,v,b,T){const P=4*t,I=8*t;return this.int16[P+0]=a,this.int16[P+1]=c,this.uint8[I+4]=p,this.uint8[I+5]=v,this.uint8[I+6]=b,this.uint8[I+7]=T,t}}fh.prototype.bytesPerElement=8,kt("StructArrayLayout2i4ub8",fh);class al extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,a)}emplace(t,a,c){const p=2*t;return this.float32[p+0]=a,this.float32[p+1]=c,t}}al.prototype.bytesPerElement=8,kt("StructArrayLayout2f8",al);class ph extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,c,p,v,b,T,P,I,D){const L=this.length;return this.resize(L+1),this.emplace(L,t,a,c,p,v,b,T,P,I,D)}emplace(t,a,c,p,v,b,T,P,I,D,L){const q=10*t;return this.uint16[q+0]=a,this.uint16[q+1]=c,this.uint16[q+2]=p,this.uint16[q+3]=v,this.uint16[q+4]=b,this.uint16[q+5]=T,this.uint16[q+6]=P,this.uint16[q+7]=I,this.uint16[q+8]=D,this.uint16[q+9]=L,t}}ph.prototype.bytesPerElement=20,kt("StructArrayLayout10ui20",ph);class g extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,c,p,v,b,T,P,I,D,L,q){const G=this.length;return this.resize(G+1),this.emplace(G,t,a,c,p,v,b,T,P,I,D,L,q)}emplace(t,a,c,p,v,b,T,P,I,D,L,q,G){const H=12*t;return this.int16[H+0]=a,this.int16[H+1]=c,this.int16[H+2]=p,this.int16[H+3]=v,this.uint16[H+4]=b,this.uint16[H+5]=T,this.uint16[H+6]=P,this.uint16[H+7]=I,this.int16[H+8]=D,this.int16[H+9]=L,this.int16[H+10]=q,this.int16[H+11]=G,t}}g.prototype.bytesPerElement=24,kt("StructArrayLayout4i4ui4i24",g);class e extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c){const p=this.length;return this.resize(p+1),this.emplace(p,t,a,c)}emplace(t,a,c,p){const v=3*t;return this.float32[v+0]=a,this.float32[v+1]=c,this.float32[v+2]=p,t}}e.prototype.bytesPerElement=12,kt("StructArrayLayout3f12",e);class i extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}i.prototype.bytesPerElement=4,kt("StructArrayLayout1ul4",i);class u extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,c,p,v,b,T,P,I){const D=this.length;return this.resize(D+1),this.emplace(D,t,a,c,p,v,b,T,P,I)}emplace(t,a,c,p,v,b,T,P,I,D){const L=10*t,q=5*t;return this.int16[L+0]=a,this.int16[L+1]=c,this.int16[L+2]=p,this.int16[L+3]=v,this.int16[L+4]=b,this.int16[L+5]=T,this.uint32[q+3]=P,this.uint16[L+8]=I,this.uint16[L+9]=D,t}}u.prototype.bytesPerElement=20,kt("StructArrayLayout6i1ul2ui20",u);class f extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c,p,v,b){const T=this.length;return this.resize(T+1),this.emplace(T,t,a,c,p,v,b)}emplace(t,a,c,p,v,b,T){const P=6*t;return this.int16[P+0]=a,this.int16[P+1]=c,this.int16[P+2]=p,this.int16[P+3]=v,this.int16[P+4]=b,this.int16[P+5]=T,t}}f.prototype.bytesPerElement=12,kt("StructArrayLayout2i2i2i12",f);class _ extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c,p,v){const b=this.length;return this.resize(b+1),this.emplace(b,t,a,c,p,v)}emplace(t,a,c,p,v,b){const T=4*t,P=8*t;return this.float32[T+0]=a,this.float32[T+1]=c,this.float32[T+2]=p,this.int16[P+6]=v,this.int16[P+7]=b,t}}_.prototype.bytesPerElement=16,kt("StructArrayLayout2f1f2i16",_);class S extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c,p,v,b){const T=this.length;return this.resize(T+1),this.emplace(T,t,a,c,p,v,b)}emplace(t,a,c,p,v,b,T){const P=16*t,I=4*t,D=8*t;return this.uint8[P+0]=a,this.uint8[P+1]=c,this.float32[I+1]=p,this.float32[I+2]=v,this.int16[D+6]=b,this.int16[D+7]=T,t}}S.prototype.bytesPerElement=16,kt("StructArrayLayout2ub2f2i16",S);class A extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,c){const p=this.length;return this.resize(p+1),this.emplace(p,t,a,c)}emplace(t,a,c,p){const v=3*t;return this.uint16[v+0]=a,this.uint16[v+1]=c,this.uint16[v+2]=p,t}}A.prototype.bytesPerElement=6,kt("StructArrayLayout3ui6",A);class j extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c,p,v,b,T,P,I,D,L,q,G,H,K,se,fe){const Me=this.length;return this.resize(Me+1),this.emplace(Me,t,a,c,p,v,b,T,P,I,D,L,q,G,H,K,se,fe)}emplace(t,a,c,p,v,b,T,P,I,D,L,q,G,H,K,se,fe,Me){const me=24*t,$=12*t,ae=48*t;return this.int16[me+0]=a,this.int16[me+1]=c,this.uint16[me+2]=p,this.uint16[me+3]=v,this.uint32[$+2]=b,this.uint32[$+3]=T,this.uint32[$+4]=P,this.uint16[me+10]=I,this.uint16[me+11]=D,this.uint16[me+12]=L,this.float32[$+7]=q,this.float32[$+8]=G,this.uint8[ae+36]=H,this.uint8[ae+37]=K,this.uint8[ae+38]=se,this.uint32[$+10]=fe,this.int16[me+22]=Me,t}}j.prototype.bytesPerElement=48,kt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",j);class R extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c,p,v,b,T,P,I,D,L,q,G,H,K,se,fe,Me,me,$,ae,_e,Fe,ut,qe,Xe,mt,dt){const gt=this.length;return this.resize(gt+1),this.emplace(gt,t,a,c,p,v,b,T,P,I,D,L,q,G,H,K,se,fe,Me,me,$,ae,_e,Fe,ut,qe,Xe,mt,dt)}emplace(t,a,c,p,v,b,T,P,I,D,L,q,G,H,K,se,fe,Me,me,$,ae,_e,Fe,ut,qe,Xe,mt,dt,gt){const it=32*t,jt=16*t;return this.int16[it+0]=a,this.int16[it+1]=c,this.int16[it+2]=p,this.int16[it+3]=v,this.int16[it+4]=b,this.int16[it+5]=T,this.int16[it+6]=P,this.int16[it+7]=I,this.uint16[it+8]=D,this.uint16[it+9]=L,this.uint16[it+10]=q,this.uint16[it+11]=G,this.uint16[it+12]=H,this.uint16[it+13]=K,this.uint16[it+14]=se,this.uint16[it+15]=fe,this.uint16[it+16]=Me,this.uint16[it+17]=me,this.uint16[it+18]=$,this.uint16[it+19]=ae,this.uint16[it+20]=_e,this.uint16[it+21]=Fe,this.uint16[it+22]=ut,this.uint32[jt+12]=qe,this.float32[jt+13]=Xe,this.float32[jt+14]=mt,this.uint16[it+30]=dt,this.uint16[it+31]=gt,t}}R.prototype.bytesPerElement=64,kt("StructArrayLayout8i15ui1ul2f2ui64",R);class N extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}N.prototype.bytesPerElement=4,kt("StructArrayLayout1f4",N);class F extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c){const p=this.length;return this.resize(p+1),this.emplace(p,t,a,c)}emplace(t,a,c,p){const v=3*t;return this.uint16[6*t+0]=a,this.float32[v+1]=c,this.float32[v+2]=p,t}}F.prototype.bytesPerElement=12,kt("StructArrayLayout1ui2f12",F);class U extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,c){const p=this.length;return this.resize(p+1),this.emplace(p,t,a,c)}emplace(t,a,c,p){const v=4*t;return this.uint32[2*t+0]=a,this.uint16[v+2]=c,this.uint16[v+3]=p,t}}U.prototype.bytesPerElement=8,kt("StructArrayLayout1ul2ui8",U);class W extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,a)}emplace(t,a,c){const p=2*t;return this.uint16[p+0]=a,this.uint16[p+1]=c,t}}W.prototype.bytesPerElement=4,kt("StructArrayLayout2ui4",W);class Y extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}Y.prototype.bytesPerElement=2,kt("StructArrayLayout1ui2",Y);class ue extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c,p){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,c,p)}emplace(t,a,c,p,v){const b=4*t;return this.float32[b+0]=a,this.float32[b+1]=c,this.float32[b+2]=p,this.float32[b+3]=v,t}}ue.prototype.bytesPerElement=16,kt("StructArrayLayout4f16",ue);class ce extends uo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new te(this.anchorPointX,this.anchorPointY)}}ce.prototype.size=20;class de extends u{get(t){return new ce(this,t)}}kt("CollisionBoxArray",de);class pe extends uo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}pe.prototype.size=48;class xe extends j{get(t){return new pe(this,t)}}kt("PlacedSymbolArray",xe);class ve extends uo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ve.prototype.size=64;class we extends R{get(t){return new ve(this,t)}}kt("SymbolInstanceArray",we);class ke extends N{getoffsetX(t){return this.float32[1*t+0]}}kt("GlyphOffsetArray",ke);class Te extends il{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}kt("SymbolLineVertexArray",Te);class Ve extends uo{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ve.prototype.size=12;class et extends F{get(t){return new Ve(this,t)}}kt("TextAnchorOffsetArray",et);class Ge extends uo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ge.prototype.size=8;class He extends U{get(t){return new Ge(this,t)}}kt("FeatureIndexArray",He);class Ke extends ic{}class St extends ic{}class wt extends ic{}class ft extends md{}class Lt extends fh{}class lr extends al{}class ur extends ph{}class ei extends g{}class Nr extends e{}class ni extends i{}class si extends f{}class Tr extends S{}class yr extends A{}class ti extends W{}const mi=ai([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yi}=mi;class Er{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,a,c,p){const v=this.segments[this.segments.length-1];return t>Er.MAX_VERTEX_ARRAY_LENGTH&&hi(`Max vertices per segment is ${Er.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Er.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!v||v.vertexLength+t>Er.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==p?this.createNewSegment(a,c,p):v}createNewSegment(t,a,c){const p={vertexOffset:t.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0,vaos:{}};return c!==void 0&&(p.sortKey=c),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(p),p}getOrCreateLatestSegment(t,a,c){return this.prepareSegment(0,t,a,c)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,c,p){return new Er([{vertexOffset:t,primitiveOffset:a,vertexLength:c,primitiveLength:p,vaos:{},sortKey:0}])}}function Ds(n,t){return 256*(n=Kt(Math.floor(n),0,255))+Kt(Math.floor(t),0,255)}Er.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,kt("SegmentVector",Er);const Ln=ai([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Oa,cs,ac,Ns={exports:{}},fo={exports:{}},ya={exports:{}},Ls=function(){if(ac)return Ns.exports;ac=1;var n=(Oa||(Oa=1,fo.exports=function(a,c){var p,v,b,T,P,I,D,L;for(v=a.length-(p=3&a.length),b=c,P=3432918353,I=461845907,L=0;L<v;)D=255&a.charCodeAt(L)|(255&a.charCodeAt(++L))<<8|(255&a.charCodeAt(++L))<<16|(255&a.charCodeAt(++L))<<24,++L,b=27492+(65535&(T=5*(65535&(b=(b^=D=(65535&(D=(D=(65535&D)*P+(((D>>>16)*P&65535)<<16)&4294967295)<<15|D>>>17))*I+(((D>>>16)*I&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(D=0,p){case 3:D^=(255&a.charCodeAt(L+2))<<16;case 2:D^=(255&a.charCodeAt(L+1))<<8;case 1:b^=D=(65535&(D=(D=(65535&(D^=255&a.charCodeAt(L)))*P+(((D>>>16)*P&65535)<<16)&4294967295)<<15|D>>>17))*I+(((D>>>16)*I&65535)<<16)&4294967295}return b^=a.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}),fo.exports),t=(cs||(cs=1,ya.exports=function(a,c){for(var p,v=a.length,b=c^v,T=0;v>=4;)p=1540483477*(65535&(p=255&a.charCodeAt(T)|(255&a.charCodeAt(++T))<<8|(255&a.charCodeAt(++T))<<16|(255&a.charCodeAt(++T))<<24))+((1540483477*(p>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),v-=4,++T;switch(v){case 3:b^=(255&a.charCodeAt(T+2))<<16;case 2:b^=(255&a.charCodeAt(T+1))<<8;case 1:b=1540483477*(65535&(b^=255&a.charCodeAt(T)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}),ya.exports);return Ns.exports=n,Ns.exports.murmur3=n,Ns.exports.murmur2=t,Ns.exports}(),On=B(Ls);class Os{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,c,p){this.ids.push(Oi(t)),this.positions.push(a,c,p)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=Oi(t);let c=0,p=this.ids.length-1;for(;c<p;){const b=c+p>>1;this.ids[b]>=a?p=b:c=b+1}const v=[];for(;this.ids[c]===a;)v.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return v}static serialize(t,a){const c=new Float64Array(t.ids),p=new Uint32Array(t.positions);return Vi(c,p,0,c.length-1),a&&a.push(c.buffer,p.buffer),{ids:c,positions:p}}static deserialize(t){const a=new Os;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function Oi(n){const t=+n;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:On(String(n))}function Vi(n,t,a,c){for(;a<c;){const p=n[a+c>>1];let v=a-1,b=c+1;for(;;){do v++;while(n[v]<p);do b--;while(n[b]>p);if(v>=b)break;_a(n,v,b),_a(t,3*v,3*b),_a(t,3*v+1,3*b+1),_a(t,3*v+2,3*b+2)}b-a<c-b?(Vi(n,t,a,b),a=b+1):(Vi(n,t,b+1,c),c=b)}}function _a(n,t,a){const c=n[t];n[t]=n[a],n[a]=c}kt("FeaturePositionMap",Os);class cr{constructor(t,a){this.gl=t.gl,this.location=a}}class qi extends cr{constructor(t,a){super(t,a),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class gd extends cr{constructor(t,a){super(t,a),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class yd extends cr{constructor(t,a){super(t,a),this.current=vr.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Tf=new Float32Array(16);function mh(n){return[Ds(255*n.r,255*n.g),Ds(255*n.b,255*n.a)]}class nc{constructor(t,a,c){this.value=t,this.uniformNames=a.map(p=>`u_${p}`),this.type=c}setUniform(t,a,c){t.set(c.constantOr(this.value))}getBinding(t,a,c){return this.type==="color"?new yd(t,a):new qi(t,a)}}class va{constructor(t,a){this.uniformNames=a.map(c=>`u_${c}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=t.tlbr}setUniform(t,a,c,p){const v=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&t.set(v)}getBinding(t,a,c){return c.substr(0,9)==="u_pattern"?new gd(t,a):new qi(t,a)}}class Sn{constructor(t,a,c,p){this.expression=t,this.type=c,this.maxValue=0,this.paintVertexAttributes=a.map(v=>({name:`a_${v}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(t,a,c,p,v){const b=this.paintVertexArray.length,T=this.expression.evaluate(new Hr(0),a,{},p,[],v);this.paintVertexArray.resize(t),this._setPaintValue(b,t,T)}updatePaintArray(t,a,c,p){const v=this.expression.evaluate({zoom:0},c,p);this._setPaintValue(t,a,v)}_setPaintValue(t,a,c){if(this.type==="color"){const p=mh(c);for(let v=t;v<a;v++)this.paintVertexArray.emplace(v,p[0],p[1])}else{for(let p=t;p<a;p++)this.paintVertexArray.emplace(p,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class tn{constructor(t,a,c,p,v,b){this.expression=t,this.uniformNames=a.map(T=>`u_${T}_t`),this.type=c,this.useIntegerZoom=p,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=a.map(T=>({name:`a_${T}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(t,a,c,p,v){const b=this.expression.evaluate(new Hr(this.zoom),a,{},p,[],v),T=this.expression.evaluate(new Hr(this.zoom+1),a,{},p,[],v),P=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(P,t,b,T)}updatePaintArray(t,a,c,p){const v=this.expression.evaluate({zoom:this.zoom},c,p),b=this.expression.evaluate({zoom:this.zoom+1},c,p);this._setPaintValue(t,a,v,b)}_setPaintValue(t,a,c,p){if(this.type==="color"){const v=mh(c),b=mh(p);for(let T=t;T<a;T++)this.paintVertexArray.emplace(T,v[0],v[1],b[0],b[1])}else{for(let v=t;v<a;v++)this.paintVertexArray.emplace(v,c,p);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(p))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a){const c=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,p=Kt(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);t.set(p)}getBinding(t,a,c){return new qi(t,a)}}class us{constructor(t,a,c,p,v,b){this.expression=t,this.type=a,this.useIntegerZoom=c,this.zoom=p,this.layerId=b,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(t,a,c){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(p,t,a.patterns&&a.patterns[this.layerId],c)}updatePaintArray(t,a,c,p,v){this._setPaintValues(t,a,c.patterns&&c.patterns[this.layerId],v)}_setPaintValues(t,a,c,p){if(!p||!c)return;const{min:v,mid:b,max:T}=c,P=p[v],I=p[b],D=p[T];if(P&&I&&D)for(let L=t;L<a;L++)this.zoomInPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],I.pixelRatio,P.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],I.pixelRatio,D.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ln.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ln.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class eu{constructor(t,a,c){this.binders={},this._buffers=[];const p=[];for(const v in t.paint._values){if(!c(v))continue;const b=t.paint.get(v);if(!(b instanceof Wr&&Ya(b.property.specification)))continue;const T=tu(v,t.type),P=b.value,I=b.property.specification.type,D=b.property.useIntegerZoom,L=b.property.specification["property-type"],q=L==="cross-faded"||L==="cross-faded-data-driven";if(P.kind==="constant")this.binders[v]=q?new va(P.value,T):new nc(P.value,T,I),p.push(`/u_${v}`);else if(P.kind==="source"||q){const G=Mf(v,I,"source");this.binders[v]=q?new us(P,I,D,a,G,t.id):new Sn(P,T,I,G),p.push(`/a_${v}`)}else{const G=Mf(v,I,"composite");this.binders[v]=new tn(P,T,I,D,a,G),p.push(`/z_${v}`)}}this.cacheKey=p.sort().join("")}getMaxValue(t){const a=this.binders[t];return a instanceof Sn||a instanceof tn?a.maxValue:0}populatePaintArrays(t,a,c,p,v){for(const b in this.binders){const T=this.binders[b];(T instanceof Sn||T instanceof tn||T instanceof us)&&T.populatePaintArray(t,a,c,p,v)}}setConstantPatternPositions(t,a){for(const c in this.binders){const p=this.binders[c];p instanceof va&&p.setConstantPatternPositions(t,a)}}updatePaintArrays(t,a,c,p,v){let b=!1;for(const T in t){const P=a.getPositions(T);for(const I of P){const D=c.feature(I.index);for(const L in this.binders){const q=this.binders[L];if((q instanceof Sn||q instanceof tn||q instanceof us)&&q.expression.isStateDependent===!0){const G=p.paint.get(L);q.expression=G.value,q.updatePaintArray(I.start,I.end,D,t[T],v),b=!0}}}}return b}defines(){const t=[];for(const a in this.binders){const c=this.binders[a];(c instanceof nc||c instanceof va)&&t.push(...c.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return t}getBinderAttributes(){const t=[];for(const a in this.binders){const c=this.binders[a];if(c instanceof Sn||c instanceof tn)for(let p=0;p<c.paintVertexAttributes.length;p++)t.push(c.paintVertexAttributes[p].name);else if(c instanceof us)for(let p=0;p<Ln.members.length;p++)t.push(Ln.members[p].name)}return t}getBinderUniforms(){const t=[];for(const a in this.binders){const c=this.binders[a];if(c instanceof nc||c instanceof va||c instanceof tn)for(const p of c.uniformNames)t.push(p)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,a){const c=[];for(const p in this.binders){const v=this.binders[p];if(v instanceof nc||v instanceof va||v instanceof tn){for(const b of v.uniformNames)if(a[b]){const T=v.getBinding(t,a[b],b);c.push({name:b,property:p,binding:T})}}}return c}setUniforms(t,a,c,p){for(const{name:v,property:b,binding:T}of a)this.binders[b].setUniform(T,p,c.get(b),v)}updatePaintBuffers(t){this._buffers=[];for(const a in this.binders){const c=this.binders[a];if(t&&c instanceof us){const p=t.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(c instanceof Sn||c instanceof tn)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(t){for(const a in this.binders){const c=this.binders[a];(c instanceof Sn||c instanceof tn||c instanceof us)&&c.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const a=this.binders[t];(a instanceof Sn||a instanceof tn||a instanceof us)&&a.destroy()}}}class hs{constructor(t,a,c=()=>!0){this.programConfigurations={};for(const p of t)this.programConfigurations[p.id]=new eu(p,a,c);this.needsUpload=!1,this._featureMap=new Os,this._bufferOffset=0}populatePaintArrays(t,a,c,p,v,b){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(t,a,p,v,b);a.id!==void 0&&this._featureMap.add(a.id,c,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,c,p){for(const v of c)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(t,this._featureMap,a,v,p)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function tu(n,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${t}-`,"").replace(/-/g,"_")]}function Mf(n,t,a){const c={color:{source:al,composite:ue},number:{source:N,composite:al}},p=function(v){return{"line-pattern":{source:ur,composite:ur},"fill-pattern":{source:ur,composite:ur},"fill-extrusion-pattern":{source:ur,composite:ur}}[v]}(n);return p&&p[a]||c[t][a]}kt("ConstantBinder",nc),kt("CrossFadedConstantBinder",va),kt("SourceExpressionBinder",Sn),kt("CrossFadedCompositeBinder",us),kt("CompositeExpressionBinder",tn),kt("ProgramConfiguration",eu,{omit:["_buffers"]}),kt("ProgramConfigurationSet",hs);const Ef=Math.pow(2,14)-1,Cf=-Ef-1;function nl(n){const t=Je/n.extent,a=n.loadGeometry();for(let c=0;c<a.length;c++){const p=a[c];for(let v=0;v<p.length;v++){const b=p[v],T=Math.round(b.x*t),P=Math.round(b.y*t);b.x=Kt(T,Cf,Ef),b.y=Kt(P,Cf,Ef),(T<b.x||T>b.x+1||P<b.y||P>b.y+1)&&hi("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function sl(n,t){return{type:n.type,id:n.id,properties:n.properties,geometry:t?nl(n):[]}}const Xp=-32768;function Yp(n,t,a,c,p){n.emplaceBack(Xp+8*t+c,Xp+8*a+p)}class Af{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new St,this.indexArray=new yr,this.segments=new Er,this.programConfigurations=new hs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,c){const p=this.layers[0],v=[];let b=null,T=!1,P=p.type==="heatmap";if(p.type==="circle"){const D=p;b=D.layout.get("circle-sort-key"),T=!b.isConstant(),P=P||D.paint.get("circle-pitch-alignment")==="map"}const I=P?a.subdivisionGranularity.circle:1;for(const{feature:D,id:L,index:q,sourceLayerIndex:G}of t){const H=this.layers[0]._featureFilter.needGeometry,K=sl(D,H);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),K,c))continue;const se=T?b.evaluate(K,{},c):void 0,fe={id:L,properties:D.properties,type:D.type,sourceLayerIndex:G,index:q,geometry:H?K.geometry:nl(D),patterns:{},sortKey:se};v.push(fe)}T&&v.sort((D,L)=>D.sortKey-L.sortKey);for(const D of v){const{geometry:L,index:q,sourceLayerIndex:G}=D,H=t[q].feature;this.addFeature(D,L,q,c,I),a.featureIndex.insert(H,L,q,G,this.index)}}update(t,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Yi),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,c,p,v=1){let b;switch(v){case 1:b=[0,7];break;case 3:b=[0,2,5,7];break;case 5:b=[0,1,3,4,6,7];break;case 7:b=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${v}; valid values are 1, 3, 5, 7.`)}const T=b.length;for(const P of a)for(const I of P){const D=I.x,L=I.y;if(D<0||D>=Je||L<0||L>=Je)continue;const q=this.segments.prepareSegment(T*T,this.layoutVertexArray,this.indexArray,t.sortKey),G=q.vertexLength;for(let H=0;H<T;H++)for(let K=0;K<T;K++)Yp(this.layoutVertexArray,D,L,b[K],b[H]);for(let H=0;H<T-1;H++)for(let K=0;K<T-1;K++){const se=G+H*T+K,fe=G+(H+1)*T+K;this.indexArray.emplaceBack(se,fe+1,se+1),this.indexArray.emplaceBack(se,fe,fe+1)}q.vertexLength+=T*T,q.primitiveLength+=(T-1)*(T-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{},p)}}function po(n,t){for(let a=0;a<n.length;a++)if(ll(t,n[a]))return!0;for(let a=0;a<t.length;a++)if(ll(n,t[a]))return!0;return!!_d(n,t)}function Kp(n,t,a){return!!ll(n,t)||!!Bs(t,n,a)}function Ag(n,t){if(n.length===1)return mo(t,n[0]);for(let a=0;a<t.length;a++){const c=t[a];for(let p=0;p<c.length;p++)if(ll(n,c[p]))return!0}for(let a=0;a<n.length;a++)if(mo(t,n[a]))return!0;for(let a=0;a<t.length;a++)if(_d(n,t[a]))return!0;return!1}function kg(n,t,a){if(n.length>1){if(_d(n,t))return!0;for(let c=0;c<t.length;c++)if(Bs(t[c],n,a))return!0}for(let c=0;c<n.length;c++)if(Bs(n[c],t,a))return!0;return!1}function _d(n,t){if(n.length===0||t.length===0)return!1;for(let a=0;a<n.length-1;a++){const c=n[a],p=n[a+1];for(let v=0;v<t.length-1;v++)if(ru(c,p,t[v],t[v+1]))return!0}return!1}function ru(n,t,a,c){return Fr(n,a,c)!==Fr(t,a,c)&&Fr(n,t,a)!==Fr(n,t,c)}function Bs(n,t,a){const c=a*a;if(t.length===1)return n.distSqr(t[0])<c;for(let p=1;p<t.length;p++)if(ol(n,t[p-1],t[p])<c)return!0;return!1}function ol(n,t,a){const c=t.distSqr(a);if(c===0)return n.distSqr(t);const p=((n.x-t.x)*(a.x-t.x)+(n.y-t.y)*(a.y-t.y))/c;return n.distSqr(p<0?t:p>1?a:a.sub(t)._mult(p)._add(t))}function mo(n,t){for(let a=0;a<n.length;a++)if(ll(n[a],t))return!0;return!1}function ll(n,t){let a=!1;for(let c=0,p=n.length-1;c<n.length;p=c++){const v=n[c],b=n[p];v.y>t.y!=b.y>t.y&&t.x<(b.x-v.x)*(t.y-v.y)/(b.y-v.y)+v.x&&(a=!a)}return a}function Qp(n,t,a){const c=a[0],p=a[2];if(n.x<c.x&&t.x<c.x||n.x>p.x&&t.x>p.x||n.y<c.y&&t.y<c.y||n.y>p.y&&t.y>p.y)return!1;const v=Fr(n,t,a[0]);return v!==Fr(n,t,a[1])||v!==Fr(n,t,a[2])||v!==Fr(n,t,a[3])}function cl(n,t,a){const c=t.paint.get(n).value;return c.kind==="constant"?c.value:a.programConfigurations.get(t.id).getMaxValue(n)}function iu(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function go(n,t,a,c,p){if(!t[0]&&!t[1])return n;const v=te.convert(t)._mult(p);a==="viewport"&&v._rotate(-c);const b=[];for(let T=0;T<n.length;T++)b.push(n[T].sub(v));return b}let Pa,vd;kt("CircleBucket",Af,{omit:["layers"]});var Pg={get paint(){return vd=vd||new wi({"circle-radius":new $t(oe.paint_circle["circle-radius"]),"circle-color":new $t(oe.paint_circle["circle-color"]),"circle-blur":new $t(oe.paint_circle["circle-blur"]),"circle-opacity":new $t(oe.paint_circle["circle-opacity"]),"circle-translate":new Dt(oe.paint_circle["circle-translate"]),"circle-translate-anchor":new Dt(oe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Dt(oe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Dt(oe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new $t(oe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new $t(oe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new $t(oe.paint_circle["circle-stroke-opacity"])})},get layout(){return Pa=Pa||new wi({"circle-sort-key":new $t(oe.layout_circle["circle-sort-key"])})}};class sc extends La{constructor(t){super(t,Pg)}createBucket(t){return new Af(t)}queryRadius(t){const a=t;return cl("circle-radius",this,a)+cl("circle-stroke-width",this,a)+iu(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:c,geometry:p,transform:v,pixelsToTileUnits:b,unwrappedTileID:T,getElevation:P}){const I=go(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-v.bearingInRadians,b),D=this.paint.get("circle-radius").evaluate(a,c)+this.paint.get("circle-stroke-width").evaluate(a,c),L=this.paint.get("circle-pitch-alignment")==="map",q=L?I:function(H,K,se,fe){return H.map(Me=>kf(Me,K,se,fe))}(I,v,T,P),G=L?D*b:D;for(const H of p)for(const K of H){const se=L?K:kf(K,v,T,P);let fe=G;const Me=v.projectTileCoordinates(K.x,K.y,T,P).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?fe*=Me/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(fe*=v.cameraToCenterDistance/Me),Kp(q,se,fe))return!0}return!1}}function kf(n,t,a,c){const p=t.projectTileCoordinates(n.x,n.y,a,c).point;return new te((.5*p.x+.5)*t.width,(.5*-p.y+.5)*t.height)}class Pf extends Af{}let ul;kt("HeatmapBucket",Pf,{omit:["layers"]});var oc={get paint(){return ul=ul||new wi({"heatmap-radius":new $t(oe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new $t(oe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Dt(oe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Nn(oe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Dt(oe.paint_heatmap["heatmap-opacity"])})}};function au(n,{width:t,height:a},c,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==t*a*c)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${t*a*c}`)}else p=new Uint8Array(t*a*c);return n.width=t,n.height=a,n.data=p,n}function jf(n,{width:t,height:a},c){if(t===n.width&&a===n.height)return;const p=au({},{width:t,height:a},c);xd(n,p,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,t),height:Math.min(n.height,a)},c),n.width=t,n.height=a,n.data=p.data}function xd(n,t,a,c,p,v){if(p.width===0||p.height===0)return t;if(p.width>n.width||p.height>n.height||a.x>n.width-p.width||a.y>n.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>t.width||p.height>t.height||c.x>t.width-p.width||c.y>t.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const b=n.data,T=t.data;if(b===T)throw new Error("srcData equals dstData, so image is already copied");for(let P=0;P<p.height;P++){const I=((a.y+P)*n.width+a.x)*v,D=((c.y+P)*t.width+c.x)*v;for(let L=0;L<p.width*v;L++)T[D+L]=b[I+L]}return t}class hl{constructor(t,a){au(this,t,1,a)}resize(t){jf(this,t,1)}clone(){return new hl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,c,p,v){xd(t,a,c,p,v,1)}}class ja{constructor(t,a){au(this,t,4,a)}resize(t){jf(this,t,4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ja({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,c,p,v){xd(t,a,c,p,v,4)}}function Jp(n){const t={},a=n.resolution||256,c=n.clips?n.clips.length:1,p=n.image||new ja({width:a,height:c});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const v=(b,T,P)=>{t[n.evaluationKey]=P;const I=n.expression.evaluate(t);p.data[b+T+0]=Math.floor(255*I.r/I.a),p.data[b+T+1]=Math.floor(255*I.g/I.a),p.data[b+T+2]=Math.floor(255*I.b/I.a),p.data[b+T+3]=Math.floor(255*I.a)};if(n.clips)for(let b=0,T=0;b<c;++b,T+=4*a)for(let P=0,I=0;P<a;P++,I+=4){const D=P/(a-1),{start:L,end:q}=n.clips[b];v(T,I,L*(1-D)+q*D)}else for(let b=0,T=0;b<a;b++,T+=4)v(0,T,b/(a-1));return p}kt("AlphaImage",hl),kt("RGBAImage",ja);const zf="big-fb";class bd extends La{createBucket(t){return new Pf(t)}constructor(t){super(t,oc),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Jp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(zf)&&this.heatmapFbos.delete(zf)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let dl;var jg={get paint(){return dl=dl||new wi({"hillshade-illumination-direction":new Dt(oe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Dt(oe.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Dt(oe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Dt(oe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Dt(oe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Dt(oe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Dt(oe.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Dt(oe.paint_hillshade["hillshade-method"])})}};class zg extends La{constructor(t){super(t,jg),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,a=this.paint.get("hillshade-illumination-altitude").values,c=this.paint.get("hillshade-highlight-color").values,p=this.paint.get("hillshade-shadow-color").values;const v=Math.max(t.length,a.length,c.length,p.length);t=t.concat(Array(v-t.length).fill(t.at(-1))),a=a.concat(Array(v-a.length).fill(a.at(-1))),c=c.concat(Array(v-c.length).fill(c.at(-1))),p=p.concat(Array(v-p.length).fill(p.at(-1)));const b=a.map(Ao);return{directionRadians:t.map(Ao),altitudeRadians:b,shadowColor:p,highlightColor:c}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const nu=ai([{name:"a_pos",components:2,type:"Int16"}],4),{members:Bn}=nu;function If(n,t,a){const c=a.patternDependencies;let p=!1;for(const v of t){const b=v.paint.get(`${n}-pattern`);b.isConstant()||(p=!0);const T=b.constantOr(null);T&&(p=!0,c[T.to]=!0,c[T.from]=!0)}return p}function Rf(n,t,a,c,p){const v=p.patternDependencies;for(const b of t){const T=b.paint.get(`${n}-pattern`).value;if(T.kind!=="constant"){let P=T.evaluate({zoom:c-1},a,{},p.availableImages),I=T.evaluate({zoom:c},a,{},p.availableImages),D=T.evaluate({zoom:c+1},a,{},p.availableImages);P=P&&P.name?P.name:P,I=I&&I.name?I.name:I,D=D&&D.name?D.name:D,v[P]=!0,v[I]=!0,v[D]=!0,a.patterns[b.id]={min:P,mid:I,max:D}}}return a}function em(n,t,a,c,p){let v;if(p===function(b,T,P,I){let D=0;for(let L=T,q=P-I;L<P;L+=I)D+=(b[q]-b[L])*(b[L+1]+b[q+1]),q=L;return D}(n,t,a,c)>0)for(let b=t;b<a;b+=c)v=nm(b/c|0,n[b],n[b+1],v);else for(let b=a-c;b>=t;b-=c)v=nm(b/c|0,n[b],n[b+1],v);return v&&ou(v,v.next)&&(Fa(v),v=v.next),v}function fl(n,t){if(!n)return n;t||(t=n);let a,c=n;do if(a=!1,c.steiner||!ou(c,c.next)&&Zr(c.prev,c,c.next)!==0)c=c.next;else{if(Fa(c),c=t=c.prev,c===c.next)break;a=!0}while(a||c!==t);return t}function su(n,t,a,c,p,v,b){if(!n)return;!b&&v&&function(P,I,D,L){let q=P;do q.z===0&&(q.z=rm(q.x,q.y,I,D,L)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==P);q.prevZ.nextZ=null,q.prevZ=null,function(G){let H,K=1;do{let se,fe=G;G=null;let Me=null;for(H=0;fe;){H++;let me=fe,$=0;for(let _e=0;_e<K&&($++,me=me.nextZ,me);_e++);let ae=K;for(;$>0||ae>0&&me;)$!==0&&(ae===0||!me||fe.z<=me.z)?(se=fe,fe=fe.nextZ,$--):(se=me,me=me.nextZ,ae--),Me?Me.nextZ=se:G=se,se.prevZ=Me,Me=se;fe=me}Me.nextZ=null,K*=2}while(H>1)}(q)}(n,c,p,v);let T=n;for(;n.prev!==n.next;){const P=n.prev,I=n.next;if(v?pl(n,c,p,v):Df(n))t.push(P.i,n.i,I.i),Fa(n),n=I.next,T=I.next;else if((n=I)===T){b?b===1?su(n=Zi(fl(n),t),t,a,c,p,v,2):b===2&&tm(n,t,a,c,p,v):su(fl(n),t,a,c,p,v,1);break}}}function Df(n){const t=n.prev,a=n,c=n.next;if(Zr(t,a,c)>=0)return!1;const p=t.x,v=a.x,b=c.x,T=t.y,P=a.y,I=c.y,D=Math.min(p,v,b),L=Math.min(T,P,I),q=Math.max(p,v,b),G=Math.max(T,P,I);let H=c.next;for(;H!==t;){if(H.x>=D&&H.x<=q&&H.y>=L&&H.y<=G&&ki(p,T,v,P,b,I,H.x,H.y)&&Zr(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function pl(n,t,a,c){const p=n.prev,v=n,b=n.next;if(Zr(p,v,b)>=0)return!1;const T=p.x,P=v.x,I=b.x,D=p.y,L=v.y,q=b.y,G=Math.min(T,P,I),H=Math.min(D,L,q),K=Math.max(T,P,I),se=Math.max(D,L,q),fe=rm(G,H,t,a,c),Me=rm(K,se,t,a,c);let me=n.prevZ,$=n.nextZ;for(;me&&me.z>=fe&&$&&$.z<=Me;){if(me.x>=G&&me.x<=K&&me.y>=H&&me.y<=se&&me!==p&&me!==b&&ki(T,D,P,L,I,q,me.x,me.y)&&Zr(me.prev,me,me.next)>=0||(me=me.prevZ,$.x>=G&&$.x<=K&&$.y>=H&&$.y<=se&&$!==p&&$!==b&&ki(T,D,P,L,I,q,$.x,$.y)&&Zr($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;me&&me.z>=fe;){if(me.x>=G&&me.x<=K&&me.y>=H&&me.y<=se&&me!==p&&me!==b&&ki(T,D,P,L,I,q,me.x,me.y)&&Zr(me.prev,me,me.next)>=0)return!1;me=me.prevZ}for(;$&&$.z<=Me;){if($.x>=G&&$.x<=K&&$.y>=H&&$.y<=se&&$!==p&&$!==b&&ki(T,D,P,L,I,q,$.x,$.y)&&Zr($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function Zi(n,t){let a=n;do{const c=a.prev,p=a.next.next;!ou(c,p)&&am(c,a,a.next,p)&&Ba(c,p)&&Ba(p,c)&&(t.push(c.i,a.i,p.i),Fa(a),Fa(a.next),a=n=p),a=a.next}while(a!==n);return fl(a)}function tm(n,t,a,c,p,v){let b=n;do{let T=b.next.next;for(;T!==b.prev;){if(b.i!==T.i&&Fn(b,T)){let P=ds(b,T);return b=fl(b,b.next),P=fl(P,P.next),su(b,t,a,c,p,v,0),void su(P,t,a,c,p,v,0)}T=T.next}b=b.next}while(b!==n)}function Ig(n,t){let a=n.x-t.x;return a===0&&(a=n.y-t.y,a===0)&&(a=(n.next.y-n.y)/(n.next.x-n.x)-(t.next.y-t.y)/(t.next.x-t.x)),a}function xa(n,t){const a=function(p,v){let b=v;const T=p.x,P=p.y;let I,D=-1/0;if(ou(p,b))return b;do{if(ou(p,b.next))return b.next;if(P<=b.y&&P>=b.next.y&&b.next.y!==b.y){const K=b.x+(P-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(K<=T&&K>D&&(D=K,I=b.x<b.next.x?b:b.next,K===T))return I}b=b.next}while(b!==v);if(!I)return null;const L=I,q=I.x,G=I.y;let H=1/0;b=I;do{if(T>=b.x&&b.x>=q&&T!==b.x&&im(P<G?T:D,P,q,G,P<G?D:T,P,b.x,b.y)){const K=Math.abs(P-b.y)/(T-b.x);Ba(b,p)&&(K<H||K===H&&(b.x>I.x||b.x===I.x&&Rg(I,b)))&&(I=b,H=K)}b=b.next}while(b!==L);return I}(n,t);if(!a)return t;const c=ds(a,n);return fl(c,c.next),fl(a,a.next)}function Rg(n,t){return Zr(n.prev,n,t.prev)<0&&Zr(t.next,n,n.next)<0}function rm(n,t,a,c,p){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-a)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-c)*p|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Dg(n){let t=n,a=n;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==n);return a}function im(n,t,a,c,p,v,b,T){return(p-b)*(t-T)>=(n-b)*(v-T)&&(n-b)*(c-T)>=(a-b)*(t-T)&&(a-b)*(v-T)>=(p-b)*(c-T)}function ki(n,t,a,c,p,v,b,T){return!(n===b&&t===T)&&im(n,t,a,c,p,v,b,T)}function Fn(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!function(a,c){let p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==c.i&&p.next.i!==c.i&&am(p,p.next,a,c))return!0;p=p.next}while(p!==a);return!1}(n,t)&&(Ba(n,t)&&Ba(t,n)&&function(a,c){let p=a,v=!1;const b=(a.x+c.x)/2,T=(a.y+c.y)/2;do p.y>T!=p.next.y>T&&p.next.y!==p.y&&b<(p.next.x-p.x)*(T-p.y)/(p.next.y-p.y)+p.x&&(v=!v),p=p.next;while(p!==a);return v}(n,t)&&(Zr(n.prev,n,t.prev)||Zr(n,t.prev,t))||ou(n,t)&&Zr(n.prev,n,n.next)>0&&Zr(t.prev,t,t.next)>0)}function Zr(n,t,a){return(t.y-n.y)*(a.x-t.x)-(t.x-n.x)*(a.y-t.y)}function ou(n,t){return n.x===t.x&&n.y===t.y}function am(n,t,a,c){const p=gh(Zr(n,t,a)),v=gh(Zr(n,t,c)),b=gh(Zr(a,c,n)),T=gh(Zr(a,c,t));return p!==v&&b!==T||!(p!==0||!Nf(n,a,t))||!(v!==0||!Nf(n,c,t))||!(b!==0||!Nf(a,n,c))||!(T!==0||!Nf(a,t,c))}function Nf(n,t,a){return t.x<=Math.max(n.x,a.x)&&t.x>=Math.min(n.x,a.x)&&t.y<=Math.max(n.y,a.y)&&t.y>=Math.min(n.y,a.y)}function gh(n){return n>0?1:n<0?-1:0}function Ba(n,t){return Zr(n.prev,n,n.next)<0?Zr(n,t,n.next)>=0&&Zr(n,n.prev,t)>=0:Zr(n,t,n.prev)<0||Zr(n,n.next,t)<0}function ds(n,t){const a=Lf(n.i,n.x,n.y),c=Lf(t.i,t.x,t.y),p=n.next,v=t.prev;return n.next=t,t.prev=n,a.next=p,p.prev=a,c.next=a,a.prev=c,v.next=c,c.prev=v,c}function nm(n,t,a,c){const p=Lf(n,t,a);return c?(p.next=c.next,p.prev=c,c.next.prev=p,c.next=p):(p.prev=p,p.next=p),p}function Fa(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Lf(n,t,a){return{i:n,x:t,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Tn{constructor(t,a){if(a>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=a}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class ml{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}ml.noSubdivision=new ml({fill:new Tn(0,0),line:new Tn(0,0),tile:new Tn(0,0),stencil:new Tn(0,0),circle:1}),kt("SubdivisionGranularityExpression",Tn),kt("SubdivisionGranularitySetting",ml);const Un=-32768,lu=32767;class sm{constructor(t,a){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Je/t,this._canonical=a}_getKey(t,a){return(t+=32768)<<16|(a+=32768)<<0}_vertexToIndex(t,a){if(t<-32768||a<-32768||t>32767||a>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const c=0|Math.round(t),p=0|Math.round(a),v=this._getKey(c,p);if(this._vertexDictionary.has(v))return this._vertexDictionary.get(v);const b=this._vertexBuffer.length/2;return this._vertexDictionary.set(v,b),this._vertexBuffer.push(c,p),b}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(p,v){const b=[];for(let T=0;T<v.length;T+=3){const P=v[T],I=v[T+1],D=v[T+2],L=p[2*P],q=p[2*P+1];(p[2*I]-L)*(p[2*D+1]-q)-(p[2*I+1]-q)*(p[2*D]-L)>0?(b.push(P),b.push(D),b.push(I)):(b.push(P),b.push(I),b.push(D))}return b}(this._vertexBuffer,t);const a=[],c=t.length;for(let p=0;p<c;p+=3){const v=[t[p+0],t[p+1],t[p+2]],b=[this._vertexBuffer[2*t[p+0]+0],this._vertexBuffer[2*t[p+0]+1],this._vertexBuffer[2*t[p+1]+0],this._vertexBuffer[2*t[p+1]+1],this._vertexBuffer[2*t[p+2]+0],this._vertexBuffer[2*t[p+2]+1]];let T=1/0,P=1/0,I=-1/0,D=-1/0;for(let K=0;K<3;K++){const se=b[2*K],fe=b[2*K+1];T=Math.min(T,se),I=Math.max(I,se),P=Math.min(P,fe),D=Math.max(D,fe)}if(T===I||P===D)continue;const L=Math.floor(T/this._granularityCellSize),q=Math.ceil(I/this._granularityCellSize),G=Math.floor(P/this._granularityCellSize),H=Math.ceil(D/this._granularityCellSize);if(L!==q||G!==H)for(let K=G;K<H;K++){const se=this._scanlineGenerateVertexRingForCellRow(K,b,v);yh(this._vertexBuffer,se,a)}else a.push(...v)}return a}_scanlineGenerateVertexRingForCellRow(t,a,c){const p=t*this._granularityCellSize,v=p+this._granularityCellSize,b=[];for(let T=0;T<3;T++){const P=a[2*T],I=a[2*T+1],D=a[2*(T+1)%6],L=a[(2*(T+1)+1)%6],q=a[2*(T+2)%6],G=a[(2*(T+2)+1)%6],H=D-P,K=L-I,se=H===0,fe=K===0,Me=(p-I)/K,me=(v-I)/K,$=Math.min(Me,me),ae=Math.max(Me,me);if(!fe&&($>=1||ae<=0)||fe&&(I<p||I>v)){L>=p&&L<=v&&b.push(c[(T+1)%3]);continue}!fe&&$>0&&b.push(this._vertexToIndex(P+H*$,I+K*$));const _e=P+H*Math.max($,0),Fe=P+H*Math.min(ae,1);se||this._generateIntraEdgeVertices(b,P,I,D,L,_e,Fe),!fe&&ae<1&&b.push(this._vertexToIndex(P+H*ae,I+K*ae)),(fe||L>=p&&L<=v)&&b.push(c[(T+1)%3]),!fe&&(L<=p||L>=v)&&this._generateInterEdgeVertices(b,P,I,D,L,q,G,Fe,p,v)}return b}_generateIntraEdgeVertices(t,a,c,p,v,b,T){const P=p-a,I=v-c,D=I===0,L=D?Math.min(a,p):Math.min(b,T),q=D?Math.max(a,p):Math.max(b,T),G=Math.floor(L/this._granularityCellSize)+1,H=Math.ceil(q/this._granularityCellSize)-1;if(D?a<p:b<T)for(let K=G;K<=H;K++){const se=K*this._granularityCellSize;t.push(this._vertexToIndex(se,c+I*(se-a)/P))}else for(let K=H;K>=G;K--){const se=K*this._granularityCellSize;t.push(this._vertexToIndex(se,c+I*(se-a)/P))}}_generateInterEdgeVertices(t,a,c,p,v,b,T,P,I,D){const L=v-c,q=b-p,G=T-v,H=(I-v)/G,K=(D-v)/G,se=Math.min(H,K),fe=Math.max(H,K),Me=p+q*se;let me=Math.floor(Math.min(Me,P)/this._granularityCellSize)+1,$=Math.ceil(Math.max(Me,P)/this._granularityCellSize)-1,ae=P<Me;const _e=G===0;if(_e&&(T===I||T===D))return;if(_e||se>=1||fe<=0){const ut=c-T,qe=b+(a-b)*Math.min((I-T)/ut,(D-T)/ut);me=Math.floor(Math.min(qe,P)/this._granularityCellSize)+1,$=Math.ceil(Math.max(qe,P)/this._granularityCellSize)-1,ae=P<qe}const Fe=L>0?D:I;if(ae)for(let ut=me;ut<=$;ut++)t.push(this._vertexToIndex(ut*this._granularityCellSize,Fe));else for(let ut=$;ut>=me;ut--)t.push(this._vertexToIndex(ut*this._granularityCellSize,Fe))}_generateOutline(t){const a=[];for(const c of t){const p=lc(c,this._granularity,!0),v=this._pointArrayToIndices(p),b=[];for(let T=1;T<v.length;T++)b.push(v[T-1]),b.push(v[T]);a.push(b)}return a}_handlePoles(t){let a=!1,c=!1;this._canonical&&(this._canonical.y===0&&(a=!0),this._canonical.y===(1<<this._canonical.z)-1&&(c=!0)),(a||c)&&this._fillPoles(t,a,c)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let a=0;a<t.length;a+=2){const c=t[a+1];c===Un&&(t[a+1]=-32767),c===lu&&(t[a+1]=32766)}}_generatePoleQuad(t,a,c,p,v,b){p>v!=(b===Un)?(t.push(a),t.push(c),t.push(this._vertexToIndex(p,b)),t.push(c),t.push(this._vertexToIndex(v,b)),t.push(this._vertexToIndex(p,b))):(t.push(c),t.push(a),t.push(this._vertexToIndex(p,b)),t.push(this._vertexToIndex(v,b)),t.push(c),t.push(this._vertexToIndex(p,b)))}_fillPoles(t,a,c){const p=this._vertexBuffer,v=Je,b=t.length;for(let T=2;T<b;T+=3){const P=t[T-2],I=t[T-1],D=t[T],L=p[2*P],q=p[2*P+1],G=p[2*I],H=p[2*I+1],K=p[2*D],se=p[2*D+1];a&&(q===0&&H===0&&this._generatePoleQuad(t,P,I,L,G,Un),H===0&&se===0&&this._generatePoleQuad(t,I,D,G,K,Un),se===0&&q===0&&this._generatePoleQuad(t,D,P,K,L,Un)),c&&(q===v&&H===v&&this._generatePoleQuad(t,P,I,L,G,lu),H===v&&se===v&&this._generatePoleQuad(t,I,D,G,K,lu),se===v&&q===v&&this._generatePoleQuad(t,D,P,K,L,lu))}}_initializeVertices(t){for(let a=0;a<t.length;a+=2)this._vertexToIndex(t[a],t[a+1])}subdividePolygonInternal(t,a){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:c,holeIndices:p}=function(T){const P=[],I=[];for(const D of T)if(D.length!==0){D!==T[0]&&P.push(I.length/2);for(let L=0;L<D.length;L++)I.push(D[L].x),I.push(D[L].y)}return{flattened:I,holeIndices:P}}(t);let v;this._initializeVertices(c);try{const T=function(I,D,L=2){const q=D&&D.length,G=q?D[0]*L:I.length;let H=em(I,0,G,L,!0);const K=[];if(!H||H.next===H.prev)return K;let se,fe,Me;if(q&&(H=function(me,$,ae,_e){const Fe=[];for(let ut=0,qe=$.length;ut<qe;ut++){const Xe=em(me,$[ut]*_e,ut<qe-1?$[ut+1]*_e:me.length,_e,!1);Xe===Xe.next&&(Xe.steiner=!0),Fe.push(Dg(Xe))}Fe.sort(Ig);for(let ut=0;ut<Fe.length;ut++)ae=xa(Fe[ut],ae);return ae}(I,D,H,L)),I.length>80*L){se=1/0,fe=1/0;let me=-1/0,$=-1/0;for(let ae=L;ae<G;ae+=L){const _e=I[ae],Fe=I[ae+1];_e<se&&(se=_e),Fe<fe&&(fe=Fe),_e>me&&(me=_e),Fe>$&&($=Fe)}Me=Math.max(me-se,$-fe),Me=Me!==0?32767/Me:0}return su(H,K,L,se,fe,Me,0),K}(c,p),P=this._convertIndices(c,T);v=this._subdivideTrianglesScanline(P)}catch(T){console.error(T)}let b=[];return a&&(b=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(v),{verticesFlattened:this._vertexBuffer,indicesTriangles:v,indicesLineList:b}}_convertIndices(t,a){const c=[];for(let p=0;p<a.length;p++)c.push(this._vertexToIndex(t[2*a[p]],t[2*a[p]+1]));return c}_pointArrayToIndices(t){const a=[];for(let c=0;c<t.length;c++){const p=t[c];a.push(this._vertexToIndex(p.x,p.y))}return a}}function gl(n,t,a,c=!0){return new sm(a,t).subdividePolygonInternal(n,c)}function lc(n,t,a=!1){if(!n||n.length<1)return[];if(n.length<2)return[];const c=n[0],p=n[n.length-1],v=a&&(c.x!==p.x||c.y!==p.y);if(t<2)return v?[...n,n[0]]:[...n];const b=Math.floor(Je/t),T=[];T.push(new te(n[0].x,n[0].y));const P=n.length,I=v?P:P-1;for(let D=0;D<I;D++){const L=n[D],q=D<P-1?n[D+1]:n[0],G=L.x,H=L.y,K=q.x,se=q.y,fe=G!==K,Me=H!==se;if(!fe&&!Me)continue;const me=K-G,$=se-H,ae=Math.abs(me),_e=Math.abs($);let Fe=G,ut=H;for(;;){const Xe=me>0?(Math.floor(Fe/b)+1)*b:(Math.ceil(Fe/b)-1)*b,mt=$>0?(Math.floor(ut/b)+1)*b:(Math.ceil(ut/b)-1)*b,dt=Math.abs(Fe-Xe),gt=Math.abs(ut-mt),it=Math.abs(Fe-K),jt=Math.abs(ut-se),Ut=fe?dt/ae:Number.POSITIVE_INFINITY,Gt=Me?gt/_e:Number.POSITIVE_INFINITY;if((it<=dt||!fe)&&(jt<=gt||!Me))break;if(Ut<Gt&&fe||!Me){Fe=Xe,ut+=$*Ut;const Nt=new te(Fe,Math.round(ut));T[T.length-1].x===Nt.x&&T[T.length-1].y===Nt.y||T.push(Nt)}else{Fe+=me*Gt,ut=mt;const Nt=new te(Math.round(Fe),ut);T[T.length-1].x===Nt.x&&T[T.length-1].y===Nt.y||T.push(Nt)}}const qe=new te(K,se);T[T.length-1].x===qe.x&&T[T.length-1].y===qe.y||T.push(qe)}return T}function yh(n,t,a){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let c=0,p=n[2*t[0]];for(let P=1;P<t.length;P++){const I=n[2*t[P]];I<p&&(p=I,c=P)}const v=t.length;let b=c,T=(b+1)%v;for(;;){const P=b-1>=0?b-1:v-1,I=(T+1)%v,D=n[2*t[P]],L=n[2*t[I]],q=n[2*t[b]],G=n[2*t[b]+1],H=n[2*t[T]+1];let K=!1;if(D<L)K=!0;else if(D>L)K=!1;else{const se=H-G,fe=-(n[2*t[T]]-q),Me=G<H?1:-1;((D-q)*se+(n[2*t[P]+1]-G)*fe)*Me>((L-q)*se+(n[2*t[I]+1]-G)*fe)*Me&&(K=!0)}if(K){const se=t[P],fe=t[b],Me=t[T];se!==fe&&se!==Me&&fe!==Me&&a.push(Me,fe,se),b--,b<0&&(b=v-1)}else{const se=t[I],fe=t[b],Me=t[T];se!==fe&&se!==Me&&fe!==Me&&a.push(Me,fe,se),T++,T>=v&&(T=0)}if(P===I)break}}function _h(n,t,a,c,p,v,b,T,P){const I=p.length/2,D=b&&T&&P;if(I<Er.MAX_VERTEX_ARRAY_LENGTH){const L=t.prepareSegment(I,a,c),q=L.vertexLength;for(let K=0;K<v.length;K+=3)c.emplaceBack(q+v[K],q+v[K+1],q+v[K+2]);let G,H;L.vertexLength+=I,L.primitiveLength+=v.length/3,D&&(H=b.prepareSegment(I,a,T),G=H.vertexLength,H.vertexLength+=I);for(let K=0;K<p.length;K+=2)n(p[K],p[K+1]);if(D)for(let K=0;K<P.length;K++){const se=P[K];for(let fe=1;fe<se.length;fe+=2)T.emplaceBack(G+se[fe-1],G+se[fe]);H.primitiveLength+=se.length/2}}else(function(L,q,G,H,K,se){const fe=[];for(let _e=0;_e<H.length/2;_e++)fe.push(-1);const Me={count:0};let me=0,$=L.getOrCreateLatestSegment(q,G),ae=$.vertexLength;for(let _e=2;_e<K.length;_e+=3){const Fe=K[_e-2],ut=K[_e-1],qe=K[_e];let Xe=fe[Fe]<me,mt=fe[ut]<me,dt=fe[qe]<me;$.vertexLength+((Xe?1:0)+(mt?1:0)+(dt?1:0))>Er.MAX_VERTEX_ARRAY_LENGTH&&($=L.createNewSegment(q,G),me=Me.count,Xe=!0,mt=!0,dt=!0,ae=0);const gt=yl(fe,H,se,Me,Fe,Xe,$),it=yl(fe,H,se,Me,ut,mt,$),jt=yl(fe,H,se,Me,qe,dt,$);G.emplaceBack(ae+gt-me,ae+it-me,ae+jt-me),$.primitiveLength++}})(t,a,c,p,v,n),D&&function(L,q,G,H,K,se){const fe=[];for(let _e=0;_e<H.length/2;_e++)fe.push(-1);const Me={count:0};let me=0,$=L.getOrCreateLatestSegment(q,G),ae=$.vertexLength;for(let _e=0;_e<K.length;_e++){const Fe=K[_e];for(let ut=1;ut<K[_e].length;ut+=2){const qe=Fe[ut-1],Xe=Fe[ut];let mt=fe[qe]<me,dt=fe[Xe]<me;$.vertexLength+((mt?1:0)+(dt?1:0))>Er.MAX_VERTEX_ARRAY_LENGTH&&($=L.createNewSegment(q,G),me=Me.count,mt=!0,dt=!0,ae=0);const gt=yl(fe,H,se,Me,qe,mt,$),it=yl(fe,H,se,Me,Xe,dt,$);G.emplaceBack(ae+gt-me,ae+it-me),$.primitiveLength++}}}(b,a,T,p,P,n),t.forceNewSegmentOnNextPrepare(),b==null||b.forceNewSegmentOnNextPrepare()}function yl(n,t,a,c,p,v,b){if(v){const T=c.count;return a(t[2*p],t[2*p+1]),n[p]=c.count,c.count++,b.vertexLength++,T}return n[p]}class cc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new wt,this.indexArray=new yr,this.indexArray2=new ti,this.programConfigurations=new hs(t.layers,t.zoom),this.segments=new Er,this.segments2=new Er,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,c){this.hasPattern=If("fill",this.layers,a);const p=this.layers[0].layout.get("fill-sort-key"),v=!p.isConstant(),b=[];for(const{feature:T,id:P,index:I,sourceLayerIndex:D}of t){const L=this.layers[0]._featureFilter.needGeometry,q=sl(T,L);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),q,c))continue;const G=v?p.evaluate(q,{},c,a.availableImages):void 0,H={id:P,properties:T.properties,type:T.type,sourceLayerIndex:D,index:I,geometry:L?q.geometry:nl(T),patterns:{},sortKey:G};b.push(H)}v&&b.sort((T,P)=>T.sortKey-P.sortKey);for(const T of b){const{geometry:P,index:I,sourceLayerIndex:D}=T;if(this.hasPattern){const L=Rf("fill",this.layers,T,this.zoom,a);this.patternFeatures.push(L)}else this.addFeature(T,P,I,c,{},a.subdivisionGranularity);a.featureIndex.insert(t[I].feature,P,I,D,this.index)}}update(t,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,c)}addFeatures(t,a,c){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,a,c,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bn),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,c,p,v,b){for(const T of Fc(a,500)){const P=gl(T,p,b.fill.getGranularityForZoomLevel(p.z)),I=this.layoutVertexArray;_h((D,L)=>{I.emplaceBack(D,L)},this.segments,this.layoutVertexArray,this.indexArray,P.verticesFlattened,P.indicesTriangles,this.segments2,this.indexArray2,P.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,v,p)}}let om,lm;kt("FillBucket",cc,{omit:["layers","patternFeatures"]});var wd={get paint(){return lm=lm||new wi({"fill-antialias":new Dt(oe.paint_fill["fill-antialias"]),"fill-opacity":new $t(oe.paint_fill["fill-opacity"]),"fill-color":new $t(oe.paint_fill["fill-color"]),"fill-outline-color":new $t(oe.paint_fill["fill-outline-color"]),"fill-translate":new Dt(oe.paint_fill["fill-translate"]),"fill-translate-anchor":new Dt(oe.paint_fill["fill-translate-anchor"]),"fill-pattern":new co(oe.paint_fill["fill-pattern"])})},get layout(){return om=om||new wi({"fill-sort-key":new $t(oe.layout_fill["fill-sort-key"])})}};class Ng extends La{constructor(t){super(t,wd)}recalculate(t,a){super.recalculate(t,a);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new cc(t)}queryRadius(){return iu(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:a,transform:c,pixelsToTileUnits:p}){return Ag(go(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-c.bearingInRadians,p),a)}isTileClipped(){return!0}}const Of=ai([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Lg=ai([{name:"a_centroid",components:2,type:"Int16"}],4),{members:m_}=Of;var Mn,Bf,yo,cm,vh,uc,um,xh={};function Ff(){if(Bf)return Mn;Bf=1;var n=ne();function t(p,v,b,T,P){this.properties={},this.extent=b,this.type=0,this._pbf=p,this._geometry=-1,this._keys=T,this._values=P,p.readFields(a,this,v)}function a(p,v,b){p==1?v.id=b.readVarint():p==2?function(T,P){for(var I=T.readVarint()+T.pos;T.pos<I;){var D=P._keys[T.readVarint()],L=P._values[T.readVarint()];P.properties[D]=L}}(b,v):p==3?v.type=b.readVarint():p==4&&(v._geometry=b.pos)}function c(p){for(var v,b,T=0,P=0,I=p.length,D=I-1;P<I;D=P++)T+=((b=p[D]).x-(v=p[P]).x)*(v.y+b.y);return T}return Mn=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var p=this._pbf;p.pos=this._geometry;for(var v,b=p.readVarint()+p.pos,T=1,P=0,I=0,D=0,L=[];p.pos<b;){if(P<=0){var q=p.readVarint();T=7&q,P=q>>3}if(P--,T===1||T===2)I+=p.readSVarint(),D+=p.readSVarint(),T===1&&(v&&L.push(v),v=[]),v.push(new n(I,D));else{if(T!==7)throw new Error("unknown command "+T);v&&v.push(v[0].clone())}}return v&&L.push(v),L},t.prototype.bbox=function(){var p=this._pbf;p.pos=this._geometry;for(var v=p.readVarint()+p.pos,b=1,T=0,P=0,I=0,D=1/0,L=-1/0,q=1/0,G=-1/0;p.pos<v;){if(T<=0){var H=p.readVarint();b=7&H,T=H>>3}if(T--,b===1||b===2)(P+=p.readSVarint())<D&&(D=P),P>L&&(L=P),(I+=p.readSVarint())<q&&(q=I),I>G&&(G=I);else if(b!==7)throw new Error("unknown command "+b)}return[D,q,L,G]},t.prototype.toGeoJSON=function(p,v,b){var T,P,I=this.extent*Math.pow(2,b),D=this.extent*p,L=this.extent*v,q=this.loadGeometry(),G=t.types[this.type];function H(fe){for(var Me=0;Me<fe.length;Me++){var me=fe[Me];fe[Me]=[360*(me.x+D)/I-180,360/Math.PI*Math.atan(Math.exp((180-360*(me.y+L)/I)*Math.PI/180))-90]}}switch(this.type){case 1:var K=[];for(T=0;T<q.length;T++)K[T]=q[T][0];H(q=K);break;case 2:for(T=0;T<q.length;T++)H(q[T]);break;case 3:for(q=function(fe){var Me=fe.length;if(Me<=1)return[fe];for(var me,$,ae=[],_e=0;_e<Me;_e++){var Fe=c(fe[_e]);Fe!==0&&($===void 0&&($=Fe<0),$===Fe<0?(me&&ae.push(me),me=[fe[_e]]):me.push(fe[_e]))}return me&&ae.push(me),ae}(q),T=0;T<q.length;T++)for(P=0;P<q[T].length;P++)H(q[T][P])}q.length===1?q=q[0]:G="Multi"+G;var se={type:"Feature",geometry:{type:G,coordinates:q},properties:this.properties};return"id"in this&&(se.id=this.id),se},Mn}function _o(){if(cm)return yo;cm=1;var n=Ff();function t(c,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(a,this,p),this.length=this._features.length}function a(c,p,v){c===15?p.version=v.readVarint():c===1?p.name=v.readString():c===5?p.extent=v.readVarint():c===2?p._features.push(v.pos):c===3?p._keys.push(v.readString()):c===4&&p._values.push(function(b){for(var T=null,P=b.readVarint()+b.pos;b.pos<P;){var I=b.readVarint()>>3;T=I===1?b.readString():I===2?b.readFloat():I===3?b.readDouble():I===4?b.readVarint64():I===5?b.readVarint():I===6?b.readSVarint():I===7?b.readBoolean():null}return T}(v))}return yo=t,t.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var p=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,p,this.extent,this._keys,this._values)},yo}function hm(){return um||(um=1,xh.VectorTile=function(){if(uc)return vh;uc=1;var n=_o();function t(a,c,p){if(a===3){var v=new n(p,p.readVarint()+p.pos);v.length&&(c[v.name]=v)}}return vh=function(a,c){this.layers=a.readFields(t,{},c)},vh}(),xh.VectorTileFeature=Ff(),xh.VectorTileLayer=_o()),xh}var hc=B(hm());const Sd=hc.VectorTileFeature.types,Si=Math.pow(2,13);function Td(n,t,a,c,p,v,b,T){n.emplaceBack(t,a,2*Math.floor(c*Si)+b,p*Si*2,v*Si*2,Math.round(T))}class dm{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ft,this.centroidVertexArray=new Ke,this.indexArray=new yr,this.programConfigurations=new hs(t.layers,t.zoom),this.segments=new Er,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,c){this.features=[],this.hasPattern=If("fill-extrusion",this.layers,a);for(const{feature:p,id:v,index:b,sourceLayerIndex:T}of t){const P=this.layers[0]._featureFilter.needGeometry,I=sl(p,P);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),I,c))continue;const D={id:v,sourceLayerIndex:T,index:b,geometry:P?I.geometry:nl(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(Rf("fill-extrusion",this.layers,D,this.zoom,a)):this.addFeature(D,D.geometry,b,c,{},a.subdivisionGranularity),a.featureIndex.insert(p,D.geometry,b,T,this.index,!0)}}addFeatures(t,a,c){for(const p of this.features){const{geometry:v}=p;this.addFeature(p,v,p.index,a,c,t.subdivisionGranularity)}}update(t,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,m_),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Lg.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,a,c,p,v,b){for(const T of Fc(a,500)){const P={x:0,y:0,sampleCount:0},I=this.layoutVertexArray.length;this.processPolygon(P,p,t,T,b);const D=this.layoutVertexArray.length-I,L=Math.floor(P.x/P.sampleCount),q=Math.floor(P.y/P.sampleCount);for(let G=0;G<D;G++)this.centroidVertexArray.emplaceBack(L,q)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,v,p)}processPolygon(t,a,c,p,v){if(p.length<1||Bg(p[0]))return;for(const L of p)L.length!==0&&Og(t,L);const b={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},T=v.fill.getGranularityForZoomLevel(a.z),P=Sd[c.type]==="Polygon";for(const L of p){if(L.length===0||Bg(L))continue;const q=lc(L,T,P);this._generateSideFaces(q,b)}if(!P)return;const I=gl(p,a,T,!1),D=this.layoutVertexArray;_h((L,q)=>{Td(D,L,q,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles)}_generateSideFaces(t,a){let c=0;for(let p=1;p<t.length;p++){const v=t[p],b=t[p-1];if(g_(v,b))continue;a.segment.vertexLength+4>Er.MAX_VERTEX_ARRAY_LENGTH&&(a.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const T=v.sub(b)._perp()._unit(),P=b.dist(v);c+P>32768&&(c=0),Td(this.layoutVertexArray,v.x,v.y,T.x,T.y,0,0,c),Td(this.layoutVertexArray,v.x,v.y,T.x,T.y,0,1,c),c+=P,Td(this.layoutVertexArray,b.x,b.y,T.x,T.y,0,0,c),Td(this.layoutVertexArray,b.x,b.y,T.x,T.y,0,1,c);const I=a.segment.vertexLength;this.indexArray.emplaceBack(I,I+2,I+1),this.indexArray.emplaceBack(I+1,I+2,I+3),a.segment.vertexLength+=4,a.segment.primitiveLength+=2}}}function Og(n,t){for(let a=0;a<t.length;a++){const c=t[a];a===t.length-1&&t[0].x===c.x&&t[0].y===c.y||(n.x+=c.x,n.y+=c.y,n.sampleCount++)}}function g_(n,t){return n.x===t.x&&(n.x<0||n.x>Je)||n.y===t.y&&(n.y<0||n.y>Je)}function Bg(n){return n.every(t=>t.x<0)||n.every(t=>t.x>Je)||n.every(t=>t.y<0)||n.every(t=>t.y>Je)}let Pi;kt("FillExtrusionBucket",dm,{omit:["layers","features"]});var gi={get paint(){return Pi=Pi||new wi({"fill-extrusion-opacity":new Dt(oe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new $t(oe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Dt(oe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Dt(oe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new co(oe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new $t(oe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new $t(oe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Dt(oe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Cr extends La{constructor(t){super(t,gi)}createBucket(t){return new dm(t)}queryRadius(){return iu(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:c,geometry:p,transform:v,pixelsToTileUnits:b,pixelPosMatrix:T}){const P=go(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-v.bearingInRadians,b),I=this.paint.get("fill-extrusion-height").evaluate(a,c),D=this.paint.get("fill-extrusion-base").evaluate(a,c),L=function(G,H,K){const se=[];for(const fe of G){const Me=[fe.x,fe.y,0,1];er(Me,Me,H),se.push(new te(Me[0]/Me[3],Me[1]/Me[3]))}return se}(P,T),q=function(G,H,K,se){const fe=[],Me=[],me=se[8]*H,$=se[9]*H,ae=se[10]*H,_e=se[11]*H,Fe=se[8]*K,ut=se[9]*K,qe=se[10]*K,Xe=se[11]*K;for(const mt of G){const dt=[],gt=[];for(const it of mt){const jt=it.x,Ut=it.y,Gt=se[0]*jt+se[4]*Ut+se[12],Nt=se[1]*jt+se[5]*Ut+se[13],hr=se[2]*jt+se[6]*Ut+se[14],yi=se[3]*jt+se[7]*Ut+se[15],Ki=hr+ae,Qi=yi+_e,Va=Gt+Fe,qa=Nt+ut,Bi=hr+qe,ri=yi+Xe,Fi=new te((Gt+me)/Qi,(Nt+$)/Qi);Fi.z=Ki/Qi,dt.push(Fi);const na=new te(Va/ri,qa/ri);na.z=Bi/ri,gt.push(na)}fe.push(dt),Me.push(gt)}return[fe,Me]}(p,D,I,T);return function(G,H,K){let se=1/0;Ag(K,H)&&(se=oi(K,H[0]));for(let fe=0;fe<H.length;fe++){const Me=H[fe],me=G[fe];for(let $=0;$<Me.length-1;$++){const ae=Me[$],_e=[ae,Me[$+1],me[$+1],me[$],ae];po(K,_e)&&(se=Math.min(se,oi(K,_e)))}}return se!==1/0&&se}(q[0],q[1],L)}}function Mr(n,t){return n.x*t.x+n.y*t.y}function oi(n,t){if(n.length===1){let a=0;const c=t[a++];let p;for(;!p||c.equals(p);)if(p=t[a++],!p)return 1/0;for(;a<t.length;a++){const v=t[a],b=n[0],T=p.sub(c),P=v.sub(c),I=b.sub(c),D=Mr(T,T),L=Mr(T,P),q=Mr(P,P),G=Mr(I,T),H=Mr(I,P),K=D*q-L*L,se=(q*G-L*H)/K,fe=(D*H-L*G)/K,Me=c.z*(1-se-fe)+p.z*se+v.z*fe;if(isFinite(Me))return Me}return 1/0}{let a=1/0;for(const c of t)a=Math.min(a,c.z);return a}}const Vn=ai([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:_l}=Vn,bh=ai([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:fm}=bh,vl=hc.VectorTileFeature.types,$i=Math.cos(Math.PI/180*37.5),xl=Math.pow(2,14)/.5;class bl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Lt,this.layoutVertexArray2=new lr,this.indexArray=new yr,this.programConfigurations=new hs(t.layers,t.zoom),this.segments=new Er,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,c){this.hasPattern=If("line",this.layers,a);const p=this.layers[0].layout.get("line-sort-key"),v=!p.isConstant(),b=[];for(const{feature:T,id:P,index:I,sourceLayerIndex:D}of t){const L=this.layers[0]._featureFilter.needGeometry,q=sl(T,L);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),q,c))continue;const G=v?p.evaluate(q,{},c):void 0,H={id:P,properties:T.properties,type:T.type,sourceLayerIndex:D,index:I,geometry:L?q.geometry:nl(T),patterns:{},sortKey:G};b.push(H)}v&&b.sort((T,P)=>T.sortKey-P.sortKey);for(const T of b){const{geometry:P,index:I,sourceLayerIndex:D}=T;if(this.hasPattern){const L=Rf("line",this.layers,T,this.zoom,a);this.patternFeatures.push(L)}else this.addFeature(T,P,I,c,{},a.subdivisionGranularity);a.featureIndex.insert(t[I].feature,P,I,D,this.index)}}update(t,a,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,c)}addFeatures(t,a,c){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,a,c,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,fm)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,_l),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,c,p,v,b){const T=this.layers[0].layout,P=T.get("line-join").evaluate(t,{}),I=T.get("line-cap"),D=T.get("line-miter-limit"),L=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const q of a)this.addLine(q,t,P,I,D,L,p,b);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,v,p)}addLine(t,a,c,p,v,b,T,P){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=lc(t,T?P.line.getGranularityForZoomLevel(T.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let me=0;me<t.length-1;me++)this.totalDistance+=t[me].dist(t[me+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const I=vl[a.type]==="Polygon";let D=t.length;for(;D>=2&&t[D-1].equals(t[D-2]);)D--;let L=0;for(;L<D-1&&t[L].equals(t[L+1]);)L++;if(D<(I?3:2))return;c==="bevel"&&(v=1.05);const q=this.overscaling<=16?15*Je/(512*this.overscaling):0,G=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let H,K,se,fe,Me;this.e1=this.e2=-1,I&&(H=t[D-2],Me=t[L].sub(H)._unit()._perp());for(let me=L;me<D;me++){if(se=me===D-1?I?t[L+1]:void 0:t[me+1],se&&t[me].equals(se))continue;Me&&(fe=Me),H&&(K=H),H=t[me],Me=se?se.sub(H)._unit()._perp():fe,fe=fe||Me;let $=fe.add(Me);$.x===0&&$.y===0||$._unit();const ae=fe.x*Me.x+fe.y*Me.y,_e=$.x*Me.x+$.y*Me.y,Fe=_e!==0?1/_e:1/0,ut=2*Math.sqrt(2-2*_e),qe=_e<$i&&K&&se,Xe=fe.x*Me.y-fe.y*Me.x>0;if(qe&&me>L){const gt=H.dist(K);if(gt>2*q){const it=H.sub(H.sub(K)._mult(q/gt)._round());this.updateDistance(K,it),this.addCurrentVertex(it,fe,0,0,G),K=it}}const mt=K&&se;let dt=mt?c:I?"butt":p;if(mt&&dt==="round"&&(Fe<b?dt="miter":Fe<=2&&(dt="fakeround")),dt==="miter"&&Fe>v&&(dt="bevel"),dt==="bevel"&&(Fe>2&&(dt="flipbevel"),Fe<v&&(dt="miter")),K&&this.updateDistance(K,H),dt==="miter")$._mult(Fe),this.addCurrentVertex(H,$,0,0,G);else if(dt==="flipbevel"){if(Fe>100)$=Me.mult(-1);else{const gt=Fe*fe.add(Me).mag()/fe.sub(Me).mag();$._perp()._mult(gt*(Xe?-1:1))}this.addCurrentVertex(H,$,0,0,G),this.addCurrentVertex(H,$.mult(-1),0,0,G)}else if(dt==="bevel"||dt==="fakeround"){const gt=-Math.sqrt(Fe*Fe-1),it=Xe?gt:0,jt=Xe?0:gt;if(K&&this.addCurrentVertex(H,fe,it,jt,G),dt==="fakeround"){const Ut=Math.round(180*ut/Math.PI/20);for(let Gt=1;Gt<Ut;Gt++){let Nt=Gt/Ut;if(Nt!==.5){const yi=Nt-.5;Nt+=Nt*yi*(Nt-1)*((1.0904+ae*(ae*(3.55645-1.43519*ae)-3.2452))*yi*yi+(.848013+ae*(.215638*ae-1.06021)))}const hr=Me.sub(fe)._mult(Nt)._add(fe)._unit()._mult(Xe?-1:1);this.addHalfVertex(H,hr.x,hr.y,!1,Xe,0,G)}}se&&this.addCurrentVertex(H,Me,-it,-jt,G)}else if(dt==="butt")this.addCurrentVertex(H,$,0,0,G);else if(dt==="square"){const gt=K?1:-1;this.addCurrentVertex(H,$,gt,gt,G)}else dt==="round"&&(K&&(this.addCurrentVertex(H,fe,0,0,G),this.addCurrentVertex(H,fe,1,1,G,!0)),se&&(this.addCurrentVertex(H,Me,-1,-1,G,!0),this.addCurrentVertex(H,Me,0,0,G)));if(qe&&me<D-1){const gt=H.dist(se);if(gt>2*q){const it=H.add(se.sub(H)._mult(q/gt)._round());this.updateDistance(H,it),this.addCurrentVertex(it,Me,0,0,G),H=it}}}}addCurrentVertex(t,a,c,p,v,b=!1){const T=a.y*p-a.x,P=-a.y-a.x*p;this.addHalfVertex(t,a.x+a.y*c,a.y-a.x*c,b,!1,c,v),this.addHalfVertex(t,T,P,b,!0,-p,v),this.distance>xl/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,a,c,p,v,b))}addHalfVertex({x:t,y:a},c,p,v,b,T,P){const I=.5*(this.lineClips?this.scaledDistance*(xl-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(v?1:0),(a<<1)+(b?1:0),Math.round(63*c)+128,Math.round(63*p)+128,1+(T===0?0:T<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,D,this.e2),P.primitiveLength++),b?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}}let Uf,qn;kt("LineBucket",bl,{omit:["layers","patternFeatures"]});var cu={get paint(){return qn=qn||new wi({"line-opacity":new $t(oe.paint_line["line-opacity"]),"line-color":new $t(oe.paint_line["line-color"]),"line-translate":new Dt(oe.paint_line["line-translate"]),"line-translate-anchor":new Dt(oe.paint_line["line-translate-anchor"]),"line-width":new $t(oe.paint_line["line-width"]),"line-gap-width":new $t(oe.paint_line["line-gap-width"]),"line-offset":new $t(oe.paint_line["line-offset"]),"line-blur":new $t(oe.paint_line["line-blur"]),"line-dasharray":new Qc(oe.paint_line["line-dasharray"]),"line-pattern":new co(oe.paint_line["line-pattern"]),"line-gradient":new Nn(oe.paint_line["line-gradient"])})},get layout(){return Uf=Uf||new wi({"line-cap":new Dt(oe.layout_line["line-cap"]),"line-join":new $t(oe.layout_line["line-join"]),"line-miter-limit":new Dt(oe.layout_line["line-miter-limit"]),"line-round-limit":new Dt(oe.layout_line["line-round-limit"]),"line-sort-key":new $t(oe.layout_line["line-sort-key"])})}};class Md extends $t{possiblyEvaluate(t,a){return a=new Hr(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(t,a)}evaluate(t,a,c,p){return a=qr({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(t,a,c,p)}}let Zn;class pm extends La{constructor(t){super(t,cu),this.gradientVersion=0,Zn||(Zn=new Md(cu.paint.properties["line-width"].specification),Zn.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const a=this.gradientExpression();this.stepInterpolant=!!function(c){return c._styleExpression!==void 0}(a)&&a._styleExpression.expression instanceof Ys,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,a){super.recalculate(t,a),this.paint._values["line-floorwidth"]=Zn.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new bl(t)}queryRadius(t){const a=t,c=Vf(cl("line-width",this,a),cl("line-gap-width",this,a)),p=cl("line-offset",this,a);return c/2+Math.abs(p)+iu(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:a,featureState:c,geometry:p,transform:v,pixelsToTileUnits:b}){const T=go(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-v.bearingInRadians,b),P=b/2*Vf(this.paint.get("line-width").evaluate(a,c),this.paint.get("line-gap-width").evaluate(a,c)),I=this.paint.get("line-offset").evaluate(a,c);return I&&(p=function(D,L){const q=[];for(let G=0;G<D.length;G++){const H=D[G],K=[];for(let se=0;se<H.length;se++){const fe=H[se-1],Me=H[se],me=H[se+1],$=se===0?new te(0,0):Me.sub(fe)._unit()._perp(),ae=se===H.length-1?new te(0,0):me.sub(Me)._unit()._perp(),_e=$._add(ae)._unit(),Fe=_e.x*ae.x+_e.y*ae.y;Fe!==0&&_e._mult(1/Fe),K.push(_e._mult(L)._add(Me))}q.push(K)}return q}(p,I*b)),function(D,L,q){for(let G=0;G<L.length;G++){const H=L[G];if(D.length>=3){for(let K=0;K<H.length;K++)if(ll(D,H[K]))return!0}if(kg(D,H,q))return!0}return!1}(T,p,P)}isTileClipped(){return!0}}function Vf(n,t){return t>0?t+2*n:n}const qf=ai([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Zf=ai([{name:"a_projected_pos",components:3,type:"Float32"}],4);ai([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const dc=ai([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ai([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ed=ai([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),uu=ai([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Cd(n,t,a){return n.sections.forEach(c=>{c.text=function(p,v,b){const T=v.layout.get("text-transform").evaluate(b,{});return T==="uppercase"?p=p.toLocaleUpperCase():T==="lowercase"&&(p=p.toLocaleLowerCase()),Dn.applyArabicShaping&&(p=Dn.applyArabicShaping(p)),p}(c.text,t,a)}),n}ai([{name:"triangle",components:3,type:"Uint16"}]),ai([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ai([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ai([{type:"Float32",name:"offsetX"}]),ai([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ai([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const hu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var $f,du,Gf,Lr=24,Hf={};function rn(){return $f||($f=1,Hf.read=function(n,t,a,c,p){var v,b,T=8*p-c-1,P=(1<<T)-1,I=P>>1,D=-7,L=a?p-1:0,q=a?-1:1,G=n[t+L];for(L+=q,v=G&(1<<-D)-1,G>>=-D,D+=T;D>0;v=256*v+n[t+L],L+=q,D-=8);for(b=v&(1<<-D)-1,v>>=-D,D+=c;D>0;b=256*b+n[t+L],L+=q,D-=8);if(v===0)v=1-I;else{if(v===P)return b?NaN:1/0*(G?-1:1);b+=Math.pow(2,c),v-=I}return(G?-1:1)*b*Math.pow(2,v-c)},Hf.write=function(n,t,a,c,p,v){var b,T,P,I=8*v-p-1,D=(1<<I)-1,L=D>>1,q=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,G=c?0:v-1,H=c?1:-1,K=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(T=isNaN(t)?1:0,b=D):(b=Math.floor(Math.log(t)/Math.LN2),t*(P=Math.pow(2,-b))<1&&(b--,P*=2),(t+=b+L>=1?q/P:q*Math.pow(2,1-L))*P>=2&&(b++,P/=2),b+L>=D?(T=0,b=D):b+L>=1?(T=(t*P-1)*Math.pow(2,p),b+=L):(T=t*Math.pow(2,L-1)*Math.pow(2,p),b=0));p>=8;n[a+G]=255&T,G+=H,T/=256,p-=8);for(b=b<<p|T,I+=p;I>0;n[a+G]=255&b,G+=H,b/=256,I-=8);n[a+G-H]|=128*K}),Hf}function mm(){if(Gf)return du;Gf=1,du=t;var n=rn();function t($){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView($)?$:new Uint8Array($||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var a=4294967296,c=1/a,p=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function v($){return $.type===t.Bytes?$.readVarint()+$.pos:$.pos+1}function b($,ae,_e){return _e?4294967296*ae+($>>>0):4294967296*(ae>>>0)+($>>>0)}function T($,ae,_e){var Fe=ae<=16383?1:ae<=2097151?2:ae<=268435455?3:Math.floor(Math.log(ae)/(7*Math.LN2));_e.realloc(Fe);for(var ut=_e.pos-1;ut>=$;ut--)_e.buf[ut+Fe]=_e.buf[ut]}function P($,ae){for(var _e=0;_e<$.length;_e++)ae.writeVarint($[_e])}function I($,ae){for(var _e=0;_e<$.length;_e++)ae.writeSVarint($[_e])}function D($,ae){for(var _e=0;_e<$.length;_e++)ae.writeFloat($[_e])}function L($,ae){for(var _e=0;_e<$.length;_e++)ae.writeDouble($[_e])}function q($,ae){for(var _e=0;_e<$.length;_e++)ae.writeBoolean($[_e])}function G($,ae){for(var _e=0;_e<$.length;_e++)ae.writeFixed32($[_e])}function H($,ae){for(var _e=0;_e<$.length;_e++)ae.writeSFixed32($[_e])}function K($,ae){for(var _e=0;_e<$.length;_e++)ae.writeFixed64($[_e])}function se($,ae){for(var _e=0;_e<$.length;_e++)ae.writeSFixed64($[_e])}function fe($,ae){return($[ae]|$[ae+1]<<8|$[ae+2]<<16)+16777216*$[ae+3]}function Me($,ae,_e){$[_e]=ae,$[_e+1]=ae>>>8,$[_e+2]=ae>>>16,$[_e+3]=ae>>>24}function me($,ae){return($[ae]|$[ae+1]<<8|$[ae+2]<<16)+($[ae+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function($,ae,_e){for(_e=_e||this.length;this.pos<_e;){var Fe=this.readVarint(),ut=Fe>>3,qe=this.pos;this.type=7&Fe,$(ut,ae,this),this.pos===qe&&this.skip(Fe)}return ae},readMessage:function($,ae){return this.readFields($,ae,this.readVarint()+this.pos)},readFixed32:function(){var $=fe(this.buf,this.pos);return this.pos+=4,$},readSFixed32:function(){var $=me(this.buf,this.pos);return this.pos+=4,$},readFixed64:function(){var $=fe(this.buf,this.pos)+fe(this.buf,this.pos+4)*a;return this.pos+=8,$},readSFixed64:function(){var $=fe(this.buf,this.pos)+me(this.buf,this.pos+4)*a;return this.pos+=8,$},readFloat:function(){var $=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,$},readDouble:function(){var $=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,$},readVarint:function($){var ae,_e,Fe=this.buf;return ae=127&(_e=Fe[this.pos++]),_e<128?ae:(ae|=(127&(_e=Fe[this.pos++]))<<7,_e<128?ae:(ae|=(127&(_e=Fe[this.pos++]))<<14,_e<128?ae:(ae|=(127&(_e=Fe[this.pos++]))<<21,_e<128?ae:function(ut,qe,Xe){var mt,dt,gt=Xe.buf;if(mt=(112&(dt=gt[Xe.pos++]))>>4,dt<128||(mt|=(127&(dt=gt[Xe.pos++]))<<3,dt<128)||(mt|=(127&(dt=gt[Xe.pos++]))<<10,dt<128)||(mt|=(127&(dt=gt[Xe.pos++]))<<17,dt<128)||(mt|=(127&(dt=gt[Xe.pos++]))<<24,dt<128)||(mt|=(1&(dt=gt[Xe.pos++]))<<31,dt<128))return b(ut,mt,qe);throw new Error("Expected varint not more than 10 bytes")}(ae|=(15&(_e=Fe[this.pos]))<<28,$,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var $=this.readVarint();return $%2==1?($+1)/-2:$/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var $=this.readVarint()+this.pos,ae=this.pos;return this.pos=$,$-ae>=12&&p?function(_e,Fe,ut){return p.decode(_e.subarray(Fe,ut))}(this.buf,ae,$):function(_e,Fe,ut){for(var qe="",Xe=Fe;Xe<ut;){var mt,dt,gt,it=_e[Xe],jt=null,Ut=it>239?4:it>223?3:it>191?2:1;if(Xe+Ut>ut)break;Ut===1?it<128&&(jt=it):Ut===2?(192&(mt=_e[Xe+1]))==128&&(jt=(31&it)<<6|63&mt)<=127&&(jt=null):Ut===3?(dt=_e[Xe+2],(192&(mt=_e[Xe+1]))==128&&(192&dt)==128&&((jt=(15&it)<<12|(63&mt)<<6|63&dt)<=2047||jt>=55296&&jt<=57343)&&(jt=null)):Ut===4&&(dt=_e[Xe+2],gt=_e[Xe+3],(192&(mt=_e[Xe+1]))==128&&(192&dt)==128&&(192&gt)==128&&((jt=(15&it)<<18|(63&mt)<<12|(63&dt)<<6|63&gt)<=65535||jt>=1114112)&&(jt=null)),jt===null?(jt=65533,Ut=1):jt>65535&&(jt-=65536,qe+=String.fromCharCode(jt>>>10&1023|55296),jt=56320|1023&jt),qe+=String.fromCharCode(jt),Xe+=Ut}return qe}(this.buf,ae,$)},readBytes:function(){var $=this.readVarint()+this.pos,ae=this.buf.subarray(this.pos,$);return this.pos=$,ae},readPackedVarint:function($,ae){if(this.type!==t.Bytes)return $.push(this.readVarint(ae));var _e=v(this);for($=$||[];this.pos<_e;)$.push(this.readVarint(ae));return $},readPackedSVarint:function($){if(this.type!==t.Bytes)return $.push(this.readSVarint());var ae=v(this);for($=$||[];this.pos<ae;)$.push(this.readSVarint());return $},readPackedBoolean:function($){if(this.type!==t.Bytes)return $.push(this.readBoolean());var ae=v(this);for($=$||[];this.pos<ae;)$.push(this.readBoolean());return $},readPackedFloat:function($){if(this.type!==t.Bytes)return $.push(this.readFloat());var ae=v(this);for($=$||[];this.pos<ae;)$.push(this.readFloat());return $},readPackedDouble:function($){if(this.type!==t.Bytes)return $.push(this.readDouble());var ae=v(this);for($=$||[];this.pos<ae;)$.push(this.readDouble());return $},readPackedFixed32:function($){if(this.type!==t.Bytes)return $.push(this.readFixed32());var ae=v(this);for($=$||[];this.pos<ae;)$.push(this.readFixed32());return $},readPackedSFixed32:function($){if(this.type!==t.Bytes)return $.push(this.readSFixed32());var ae=v(this);for($=$||[];this.pos<ae;)$.push(this.readSFixed32());return $},readPackedFixed64:function($){if(this.type!==t.Bytes)return $.push(this.readFixed64());var ae=v(this);for($=$||[];this.pos<ae;)$.push(this.readFixed64());return $},readPackedSFixed64:function($){if(this.type!==t.Bytes)return $.push(this.readSFixed64());var ae=v(this);for($=$||[];this.pos<ae;)$.push(this.readSFixed64());return $},skip:function($){var ae=7&$;if(ae===t.Varint)for(;this.buf[this.pos++]>127;);else if(ae===t.Bytes)this.pos=this.readVarint()+this.pos;else if(ae===t.Fixed32)this.pos+=4;else{if(ae!==t.Fixed64)throw new Error("Unimplemented type: "+ae);this.pos+=8}},writeTag:function($,ae){this.writeVarint($<<3|ae)},realloc:function($){for(var ae=this.length||16;ae<this.pos+$;)ae*=2;if(ae!==this.length){var _e=new Uint8Array(ae);_e.set(this.buf),this.buf=_e,this.length=ae}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function($){this.realloc(4),Me(this.buf,$,this.pos),this.pos+=4},writeSFixed32:function($){this.realloc(4),Me(this.buf,$,this.pos),this.pos+=4},writeFixed64:function($){this.realloc(8),Me(this.buf,-1&$,this.pos),Me(this.buf,Math.floor($*c),this.pos+4),this.pos+=8},writeSFixed64:function($){this.realloc(8),Me(this.buf,-1&$,this.pos),Me(this.buf,Math.floor($*c),this.pos+4),this.pos+=8},writeVarint:function($){($=+$||0)>268435455||$<0?function(ae,_e){var Fe,ut;if(ae>=0?(Fe=ae%4294967296|0,ut=ae/4294967296|0):(ut=~(-ae/4294967296),4294967295^(Fe=~(-ae%4294967296))?Fe=Fe+1|0:(Fe=0,ut=ut+1|0)),ae>=18446744073709552e3||ae<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");_e.realloc(10),function(qe,Xe,mt){mt.buf[mt.pos++]=127&qe|128,qe>>>=7,mt.buf[mt.pos++]=127&qe|128,qe>>>=7,mt.buf[mt.pos++]=127&qe|128,qe>>>=7,mt.buf[mt.pos++]=127&qe|128,mt.buf[mt.pos]=127&(qe>>>=7)}(Fe,0,_e),function(qe,Xe){var mt=(7&qe)<<4;Xe.buf[Xe.pos++]|=mt|((qe>>>=3)?128:0),qe&&(Xe.buf[Xe.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(Xe.buf[Xe.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(Xe.buf[Xe.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(Xe.buf[Xe.pos++]=127&qe|((qe>>>=7)?128:0),qe&&(Xe.buf[Xe.pos++]=127&qe)))))}(ut,_e)}($,this):(this.realloc(4),this.buf[this.pos++]=127&$|($>127?128:0),$<=127||(this.buf[this.pos++]=127&($>>>=7)|($>127?128:0),$<=127||(this.buf[this.pos++]=127&($>>>=7)|($>127?128:0),$<=127||(this.buf[this.pos++]=$>>>7&127))))},writeSVarint:function($){this.writeVarint($<0?2*-$-1:2*$)},writeBoolean:function($){this.writeVarint(!!$)},writeString:function($){$=String($),this.realloc(4*$.length),this.pos++;var ae=this.pos;this.pos=function(Fe,ut,qe){for(var Xe,mt,dt=0;dt<ut.length;dt++){if((Xe=ut.charCodeAt(dt))>55295&&Xe<57344){if(!mt){Xe>56319||dt+1===ut.length?(Fe[qe++]=239,Fe[qe++]=191,Fe[qe++]=189):mt=Xe;continue}if(Xe<56320){Fe[qe++]=239,Fe[qe++]=191,Fe[qe++]=189,mt=Xe;continue}Xe=mt-55296<<10|Xe-56320|65536,mt=null}else mt&&(Fe[qe++]=239,Fe[qe++]=191,Fe[qe++]=189,mt=null);Xe<128?Fe[qe++]=Xe:(Xe<2048?Fe[qe++]=Xe>>6|192:(Xe<65536?Fe[qe++]=Xe>>12|224:(Fe[qe++]=Xe>>18|240,Fe[qe++]=Xe>>12&63|128),Fe[qe++]=Xe>>6&63|128),Fe[qe++]=63&Xe|128)}return qe}(this.buf,$,this.pos);var _e=this.pos-ae;_e>=128&&T(ae,_e,this),this.pos=ae-1,this.writeVarint(_e),this.pos+=_e},writeFloat:function($){this.realloc(4),n.write(this.buf,$,this.pos,!0,23,4),this.pos+=4},writeDouble:function($){this.realloc(8),n.write(this.buf,$,this.pos,!0,52,8),this.pos+=8},writeBytes:function($){var ae=$.length;this.writeVarint(ae),this.realloc(ae);for(var _e=0;_e<ae;_e++)this.buf[this.pos++]=$[_e]},writeRawMessage:function($,ae){this.pos++;var _e=this.pos;$(ae,this);var Fe=this.pos-_e;Fe>=128&&T(_e,Fe,this),this.pos=_e-1,this.writeVarint(Fe),this.pos+=Fe},writeMessage:function($,ae,_e){this.writeTag($,t.Bytes),this.writeRawMessage(ae,_e)},writePackedVarint:function($,ae){ae.length&&this.writeMessage($,P,ae)},writePackedSVarint:function($,ae){ae.length&&this.writeMessage($,I,ae)},writePackedBoolean:function($,ae){ae.length&&this.writeMessage($,q,ae)},writePackedFloat:function($,ae){ae.length&&this.writeMessage($,D,ae)},writePackedDouble:function($,ae){ae.length&&this.writeMessage($,L,ae)},writePackedFixed32:function($,ae){ae.length&&this.writeMessage($,G,ae)},writePackedSFixed32:function($,ae){ae.length&&this.writeMessage($,H,ae)},writePackedFixed64:function($,ae){ae.length&&this.writeMessage($,K,ae)},writePackedSFixed64:function($,ae){ae.length&&this.writeMessage($,se,ae)},writeBytesField:function($,ae){this.writeTag($,t.Bytes),this.writeBytes(ae)},writeFixed32Field:function($,ae){this.writeTag($,t.Fixed32),this.writeFixed32(ae)},writeSFixed32Field:function($,ae){this.writeTag($,t.Fixed32),this.writeSFixed32(ae)},writeFixed64Field:function($,ae){this.writeTag($,t.Fixed64),this.writeFixed64(ae)},writeSFixed64Field:function($,ae){this.writeTag($,t.Fixed64),this.writeSFixed64(ae)},writeVarintField:function($,ae){this.writeTag($,t.Varint),this.writeVarint(ae)},writeSVarintField:function($,ae){this.writeTag($,t.Varint),this.writeSVarint(ae)},writeStringField:function($,ae){this.writeTag($,t.Bytes),this.writeString(ae)},writeFloatField:function($,ae){this.writeTag($,t.Fixed32),this.writeFloat(ae)},writeDoubleField:function($,ae){this.writeTag($,t.Fixed64),this.writeDouble(ae)},writeBooleanField:function($,ae){this.writeVarintField($,!!ae)}},du}var Ad=B(mm());const Wf=3;function y_(n,t,a){n===1&&a.readMessage(wl,t)}function wl(n,t,a){if(n===3){const{id:c,bitmap:p,width:v,height:b,left:T,top:P,advance:I}=a.readMessage(Xf,{});t.push({id:c,bitmap:new hl({width:v+2*Wf,height:b+2*Wf},p),metrics:{width:v,height:b,left:T,top:P,advance:I}})}}function Xf(n,t,a){n===1?t.id=a.readVarint():n===2?t.bitmap=a.readBytes():n===3?t.width=a.readVarint():n===4?t.height=a.readVarint():n===5?t.left=a.readSVarint():n===6?t.top=a.readSVarint():n===7&&(t.advance=a.readVarint())}const gm=Wf;function fu(n){let t=0,a=0;for(const b of n)t+=b.w*b.h,a=Math.max(a,b.w);n.sort((b,T)=>T.h-b.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}];let p=0,v=0;for(const b of n)for(let T=c.length-1;T>=0;T--){const P=c[T];if(!(b.w>P.w||b.h>P.h)){if(b.x=P.x,b.y=P.y,v=Math.max(v,b.y+b.h),p=Math.max(p,b.x+b.w),b.w===P.w&&b.h===P.h){const I=c.pop();T<c.length&&(c[T]=I)}else b.h===P.h?(P.x+=b.w,P.w-=b.w):b.w===P.w?(P.y+=b.h,P.h-=b.h):(c.push({x:P.x+b.w,y:P.y,w:P.w-b.w,h:b.h}),P.y+=b.h,P.h-=b.h);break}}return{w:p,h:v,fill:t/(p*v)||0}}const Ua=1;class Yf{constructor(t,{pixelRatio:a,version:c,stretchX:p,stretchY:v,content:b,textFitWidth:T,textFitHeight:P}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=p,this.stretchY=v,this.content=b,this.version=c,this.textFitWidth=T,this.textFitHeight=P}get tl(){return[this.paddedRect.x+Ua,this.paddedRect.y+Ua]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ua,this.paddedRect.y+this.paddedRect.h-Ua]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Ua)/this.pixelRatio,(this.paddedRect.h-2*Ua)/this.pixelRatio]}}class ym{constructor(t,a){const c={},p={};this.haveRenderCallbacks=[];const v=[];this.addImages(t,c,v),this.addImages(a,p,v);const{w:b,h:T}=fu(v),P=new ja({width:b||1,height:T||1});for(const I in t){const D=t[I],L=c[I].paddedRect;ja.copy(D.data,P,{x:0,y:0},{x:L.x+Ua,y:L.y+Ua},D.data)}for(const I in a){const D=a[I],L=p[I].paddedRect,q=L.x+Ua,G=L.y+Ua,H=D.data.width,K=D.data.height;ja.copy(D.data,P,{x:0,y:0},{x:q,y:G},D.data),ja.copy(D.data,P,{x:0,y:K-1},{x:q,y:G-1},{width:H,height:1}),ja.copy(D.data,P,{x:0,y:0},{x:q,y:G+K},{width:H,height:1}),ja.copy(D.data,P,{x:H-1,y:0},{x:q-1,y:G},{width:1,height:K}),ja.copy(D.data,P,{x:0,y:0},{x:q+H,y:G},{width:1,height:K})}this.image=P,this.iconPositions=c,this.patternPositions=p}addImages(t,a,c){for(const p in t){const v=t[p],b={x:0,y:0,w:v.data.width+2*Ua,h:v.data.height+2*Ua};c.push(b),a[p]=new Yf(b,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(t,a){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in t.updatedImages)this.patchUpdatedImage(this.iconPositions[c],t.getImage(c),a),this.patchUpdatedImage(this.patternPositions[c],t.getImage(c),a)}patchUpdatedImage(t,a,c){if(!t||!a||t.version===a.version)return;t.version=a.version;const[p,v]=t.tl;c.update(a.data,void 0,{x:p,y:v})}}var vo;kt("ImagePosition",Yf),kt("ImageAtlas",ym),E.al=void 0,(vo=E.al||(E.al={}))[vo.none=0]="none",vo[vo.horizontal=1]="horizontal",vo[vo.vertical=2]="vertical",vo[vo.horizontalOnly=3]="horizontalOnly";const wh=-17;class kd{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,a,c){const p=new kd;return p.scale=t||1,p.fontStack=a,p.verticalAlign=c||"bottom",p}static forImage(t,a){const c=new kd;return c.imageName=t,c.verticalAlign=a||"bottom",c}}class Sh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){const c=new Sh;for(let p=0;p<t.sections.length;p++){const v=t.sections[p];v.image?c.addImageSection(v):c.addTextSection(v,a)}return c}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let a="";for(let c=0;c<t.length;c++){const p=t.charCodeAt(c+1)||null,v=t.charCodeAt(c-1)||null;a+=p&&lo(p)&&!hu[t[c+1]]||v&&lo(v)&&!hu[t[c-1]]||!hu[t[c]]?t[c]:hu[t[c]]}return a}(this.text)}trim(){let t=0;for(let c=0;c<this.text.length&&Pd[this.text.charCodeAt(c)];c++)t++;let a=this.text.length;for(let c=this.text.length-1;c>=0&&c>=t&&Pd[this.text.charCodeAt(c)];c--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){const c=new Sh;return c.text=this.text.substring(t,a),c.sectionIndex=this.sectionIndex.slice(t,a),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,a)=>Math.max(t,this.sections[a].scale),0)}getMaxImageSize(t){let a=0,c=0;for(let p=0;p<this.length();p++){const v=this.getSection(p);if(v.imageName){const b=t[v.imageName];if(!b)continue;const T=b.displaySize;a=Math.max(a,T[0]),c=Math.max(c,T[1])}}return{maxImageWidth:a,maxImageHeight:c}}addTextSection(t,a){this.text+=t.text,this.sections.push(kd.forText(t.scale,t.fontStack||a,t.verticalAlign));const c=this.sections.length-1;for(let p=0;p<t.text.length;++p)this.sectionIndex.push(c)}addImageSection(t){const a=t.image?t.image.name:"";if(a.length===0)return void hi("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(kd.forImage(a,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):hi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Kf(n,t,a,c,p,v,b,T,P,I,D,L,q,G,H){const K=Sh.fromFeature(n,p);let se;L===E.al.vertical&&K.verticalizePunctuation();const{processBidirectionalText:fe,processStyledBidirectionalText:Me}=Dn;if(fe&&K.sections.length===1){se=[];const ae=fe(K.toString(),fc(K,I,v,t,c,G));for(const _e of ae){const Fe=new Sh;Fe.text=_e,Fe.sections=K.sections;for(let ut=0;ut<_e.length;ut++)Fe.sectionIndex.push(0);se.push(Fe)}}else if(Me){se=[];const ae=Me(K.text,K.sectionIndex,fc(K,I,v,t,c,G));for(const _e of ae){const Fe=new Sh;Fe.text=_e[0],Fe.sectionIndex=_e[1],Fe.sections=K.sections,se.push(Fe)}}else se=function(ae,_e){const Fe=[],ut=ae.text;let qe=0;for(const Xe of _e)Fe.push(ae.substring(qe,Xe)),qe=Xe;return qe<ut.length&&Fe.push(ae.substring(qe,ut.length)),Fe}(K,fc(K,I,v,t,c,G));const me=[],$={positionedLines:me,text:K.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(ae,_e,Fe,ut,qe,Xe,mt,dt,gt,it,jt,Ut){let Gt=0,Nt=0,hr=0,yi=0;const Ki=dt==="right"?1:dt==="left"?0:.5,Qi=Lr/Ut;let Va=0;for(const ri of qe){ri.trim();const Fi=ri.getMaxScale(),na={positionedGlyphs:[],lineOffset:0};ae.positionedLines[Va]=na;const ua=na.positionedGlyphs;let ha=0;if(!ri.length()){Nt+=Xe,++Va;continue}const r=li(ut,ri,Qi);for(let h=0;h<ri.length();h++){const y=ri.getSection(h),M=ri.getSectionIndex(h),z=ri.getCharCode(h),Z=__(gt,jt,z);let ie;if(y.imageName){if(ae.iconsInText=!0,y.scale=y.scale*Qi,ie=v_(y,Z,Fi,r,ut),!ie)continue;ha=Math.max(ha,ie.imageOffset)}else if(ie=qg(y,z,Z,r,_e,Fe),!ie)continue;const{rect:ge,metrics:ze,baselineOffset:lt}=ie;ua.push({glyph:z,imageName:y.imageName,x:Gt,y:Nt+lt+wh,vertical:Z,scale:y.scale,fontStack:y.fontStack,sectionIndex:M,metrics:ze,rect:ge}),Z?(ae.verticalizable=!0,Gt+=(y.imageName?ze.advance:Lr)*y.scale+it):Gt+=ze.advance*y.scale+it}ua.length!==0&&(hr=Math.max(Gt-it,hr),x_(ua,0,ua.length-1,Ki)),Gt=0,na.lineOffset=Math.max(ha,(Fi-1)*Lr);const s=Xe*Fi+ha;Nt+=s,yi=Math.max(s,yi),++Va}const{horizontalAlign:qa,verticalAlign:Bi}=Qf(mt);(function(ri,Fi,na,ua,ha,r,s,h,y){const M=(Fi-na)*ha;let z=0;z=r!==s?-h*ua-wh:-ua*y*s+.5*s;for(const Z of ri)for(const ie of Z.positionedGlyphs)ie.x+=M,ie.y+=z})(ae.positionedLines,Ki,qa,Bi,hr,yi,Xe,Nt,qe.length),ae.top+=-Bi*Nt,ae.bottom=ae.top+Nt,ae.left+=-qa*hr,ae.right=ae.left+hr}($,t,a,c,se,b,T,P,L,I,q,H),!function(ae){for(const _e of ae)if(_e.positionedGlyphs.length!==0)return!1;return!0}(me)&&$}const Pd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Fg={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Th={40:!0};function jd(n,t,a,c,p,v){if(t.imageName){const b=c[t.imageName];return b?b.displaySize[0]*t.scale*Lr/v+p:0}{const b=a[t.fontStack],T=b&&b[n];return T?T.metrics.advance*t.scale+p:0}}function _m(n,t,a,c){const p=Math.pow(n-t,2);return c?n<t?p/2:2*p:p+Math.abs(a)*a}function Ug(n,t,a){let c=0;return n===10&&(c-=1e4),a&&(c+=150),n!==40&&n!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function Vg(n,t,a,c,p,v){let b=null,T=_m(t,a,p,v);for(const P of c){const I=_m(t-P.x,a,p,v)+P.badness;I<=T&&(b=P,T=I)}return{index:n,x:t,priorBreak:b,badness:T}}function vm(n){return n?vm(n.priorBreak).concat(n.index):[]}function fc(n,t,a,c,p,v){if(!n)return[];const b=[],T=function(L,q,G,H,K,se){let fe=0;for(let Me=0;Me<L.length();Me++){const me=L.getSection(Me);fe+=jd(L.getCharCode(Me),me,H,K,q,se)}return fe/Math.max(1,Math.ceil(fe/G))}(n,t,a,c,p,v),P=n.text.indexOf("​")>=0;let I=0;for(let L=0;L<n.length();L++){const q=n.getSection(L),G=n.getCharCode(L);if(Pd[G]||(I+=jd(G,q,c,p,t,v)),L<n.length()-1){const H=!((D=G)<11904)&&(!!dr["CJK Compatibility Forms"](D)||!!dr["CJK Compatibility"](D)||!!dr["CJK Strokes"](D)||!!dr["CJK Symbols and Punctuation"](D)||!!dr["Enclosed CJK Letters and Months"](D)||!!dr["Halfwidth and Fullwidth Forms"](D)||!!dr["Ideographic Description Characters"](D)||!!dr["Vertical Forms"](D)||oo.test(String.fromCodePoint(D)));(Fg[G]||H||q.imageName||L!==n.length()-2&&Th[n.getCharCode(L+1)])&&b.push(Vg(L+1,I,T,b,Ug(G,n.getCharCode(L+1),H&&P),!1))}}var D;return vm(Vg(n.length(),I,T,b,0,!0))}function Qf(n){let t=.5,a=.5;switch(n){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function li(n,t,a){const c=t.getMaxScale()*Lr,{maxImageWidth:p,maxImageHeight:v}=t.getMaxImageSize(n),b=Math.max(c,v*a);return{verticalLineContentWidth:Math.max(c,p*a),horizontalLineContentHeight:b}}function Jf(n){switch(n){case"top":return 0;case"center":return .5;default:return 1}}function __(n,t,a){return!(n===E.al.horizontal||!t&&!ls(a)||t&&(Pd[a]||(c=a,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(c)))));var c}function qg(n,t,a,c,p,v){const b=v[n.fontStack],T=function(I,D,L,q){if(I&&I.rect)return I;const G=D[L.fontStack],H=G&&G[q];return H?{rect:null,metrics:H.metrics}:null}(b&&b[t],p,n,t);if(T===null)return null;let P;if(a)P=c.verticalLineContentWidth-n.scale*Lr;else{const I=Jf(n.verticalAlign);P=(c.horizontalLineContentHeight-n.scale*Lr)*I}return{rect:T.rect,metrics:T.metrics,baselineOffset:P}}function v_(n,t,a,c,p){const v=p[n.imageName];if(!v)return null;const b=v.paddedRect,T=v.displaySize,P={width:T[0],height:T[1],left:Ua,top:-3,advance:t?T[1]:T[0]};let I;if(t)I=c.verticalLineContentWidth-T[1]*n.scale;else{const D=Jf(n.verticalAlign);I=(c.horizontalLineContentHeight-T[1]*n.scale)*D}return{rect:b,metrics:P,baselineOffset:I,imageOffset:(t?T[0]:T[1])*n.scale-Lr*a}}function x_(n,t,a,c){if(c===0)return;const p=n[a],v=(n[a].x+p.metrics.advance*p.scale)*c;for(let b=t;b<=a;b++)n[b].x-=v}function b_(n,t,a){const{horizontalAlign:c,verticalAlign:p}=Qf(a),v=t[0]-n.displaySize[0]*c,b=t[1]-n.displaySize[1]*p;return{image:n,top:b,bottom:b+n.displaySize[1],left:v,right:v+n.displaySize[0]}}function zd(n){var t,a;let c=n.left,p=n.top,v=n.right-c,b=n.bottom-p;const T=(t=n.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",P=(a=n.image.textFitHeight)!==null&&a!==void 0?a:"stretchOrShrink",I=(n.image.content[2]-n.image.content[0])/(n.image.content[3]-n.image.content[1]);if(P==="proportional"){if(T==="stretchOnly"&&v/b<I||T==="proportional"){const D=Math.ceil(b*I);c*=D/v,v=D}}else if(T==="proportional"&&P==="stretchOnly"&&I!==0&&v/b>I){const D=Math.ceil(v/I);p*=D/b,b=D}return{x1:c,y1:p,x2:c+v,y2:p+b}}function pu(n,t,a,c,p,v){const b=n.image;let T;if(b.content){const se=b.content,fe=b.pixelRatio||1;T=[se[0]/fe,se[1]/fe,b.displaySize[0]-se[2]/fe,b.displaySize[1]-se[3]/fe]}const P=t.left*v,I=t.right*v;let D,L,q,G;a==="width"||a==="both"?(G=p[0]+P-c[3],L=p[0]+I+c[1]):(G=p[0]+(P+I-b.displaySize[0])/2,L=G+b.displaySize[0]);const H=t.top*v,K=t.bottom*v;return a==="height"||a==="both"?(D=p[1]+H-c[0],q=p[1]+K+c[2]):(D=p[1]+(H+K-b.displaySize[1])/2,q=D+b.displaySize[1]),{image:b,top:D,right:L,bottom:q,left:G,collisionPadding:T}}const mu=255,$n=128,xo=mu*$n;function pc(n,t){const{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new Hr(n+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:p}=a;let v=0;for(;v<c.length&&c[v]<=n;)v++;v=Math.max(0,v-1);let b=v;for(;b<c.length&&c[b]<n+1;)b++;b=Math.min(c.length-1,b);const T=c[v],P=c[b];return a.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:P,interpolationType:p}:{kind:"camera",minZoom:T,maxZoom:P,minSize:a.evaluate(new Hr(T)),maxSize:a.evaluate(new Hr(P)),interpolationType:p}}}function fs(n,t,a){let c="never";const p=n.get(t);return p?c=p:n.get(a)&&(c="always"),c}const Id=hc.VectorTileFeature.types,w_=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Rd(n,t,a,c,p,v,b,T,P,I,D,L,q){const G=T?Math.min(xo,Math.round(T[0])):0,H=T?Math.min(xo,Math.round(T[1])):0;n.emplaceBack(t,a,Math.round(32*c),Math.round(32*p),v,b,(G<<1)+(P?1:0),H,16*I,16*D,256*L,256*q)}function ep(n,t,a){n.emplaceBack(t.x,t.y,a),n.emplaceBack(t.x,t.y,a),n.emplaceBack(t.x,t.y,a),n.emplaceBack(t.x,t.y,a)}function Zg(n){for(const t of n.sections)if(Li(t.text))return!0;return!1}class xm{constructor(t){this.layoutVertexArray=new ei,this.indexArray=new yr,this.programConfigurations=t,this.segments=new Er,this.dynamicLayoutVertexArray=new Nr,this.opacityVertexArray=new ni,this.hasVisibleVertices=!1,this.placedSymbolArray=new xe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,c,p){this.isEmpty()||(c&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qf.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Zf.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,w_,!0),this.opacityVertexBuffer.itemSize=1),(c||p)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}kt("SymbolBuffers",xm);class Dd{constructor(t,a,c){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new c,this.segments=new Er,this.collisionVertexArray=new Tr}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,dc.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}kt("CollisionBuffers",Dd);class gu{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(b=>b.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pc(this.zoom,a["text-size"]),this.iconSizeData=pc(this.zoom,a["icon-size"]);const c=this.layers[0].layout,p=c.get("symbol-sort-key"),v=c.get("symbol-z-order");this.canOverlap=fs(c,"text-overlap","text-allow-overlap")!=="never"||fs(c,"icon-overlap","icon-allow-overlap")!=="never"||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map(b=>E.al[b])),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=t.sourceID}createArrays(){this.text=new xm(new hs(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new xm(new hs(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ke,this.lineVertexArray=new Te,this.symbolInstances=new we,this.textAnchorOffsets=new et}calculateGlyphDependencies(t,a,c,p,v){for(let b=0;b<t.length;b++)if(a[t.charCodeAt(b)]=!0,(c||p)&&v){const T=hu[t.charAt(b)];T&&(a[T.charCodeAt(0)]=!0)}}populate(t,a,c){const p=this.layers[0],v=p.layout,b=v.get("text-font"),T=v.get("text-field"),P=v.get("icon-image"),I=(T.value.kind!=="constant"||T.value.value instanceof pa&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),D=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,L=v.get("symbol-sort-key");if(this.features=[],!I&&!D)return;const q=a.iconDependencies,G=a.glyphDependencies,H=a.availableImages,K=new Hr(this.zoom);for(const{feature:se,id:fe,index:Me,sourceLayerIndex:me}of t){const $=p._featureFilter.needGeometry,ae=sl(se,$);if(!p._featureFilter.filter(K,ae,c))continue;let _e,Fe;if($||(ae.geometry=nl(se)),I){const qe=p.getValueAndResolveTokens("text-field",ae,c,H),Xe=pa.factory(qe),mt=this.hasRTLText=this.hasRTLText||Zg(Xe);(!mt||Dn.getRTLTextPluginStatus()==="unavailable"||mt&&Dn.isParsed())&&(_e=Cd(Xe,p,ae))}if(D){const qe=p.getValueAndResolveTokens("icon-image",ae,c,H);Fe=qe instanceof Ta?qe:Ta.fromString(qe)}if(!_e&&!Fe)continue;const ut=this.sortFeaturesByKey?L.evaluate(ae,{},c):void 0;if(this.features.push({id:fe,text:_e,icon:Fe,index:Me,sourceLayerIndex:me,geometry:ae.geometry,properties:se.properties,type:Id[se.type],sortKey:ut}),Fe&&(q[Fe.name]=!0),_e){const qe=b.evaluate(ae,{},c).join(","),Xe=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(E.al.vertical)>=0;for(const mt of _e.sections)if(mt.image)q[mt.image.name]=!0;else{const dt=Rn(_e.toString()),gt=mt.fontStack||qe,it=G[gt]=G[gt]||{};this.calculateGlyphDependencies(mt.text,it,Xe,this.allowVerticalPlacement,dt)}}}v.get("symbol-placement")==="line"&&(this.features=function(se){const fe={},Me={},me=[];let $=0;function ae(qe){me.push(se[qe]),$++}function _e(qe,Xe,mt){const dt=Me[qe];return delete Me[qe],Me[Xe]=dt,me[dt].geometry[0].pop(),me[dt].geometry[0]=me[dt].geometry[0].concat(mt[0]),dt}function Fe(qe,Xe,mt){const dt=fe[Xe];return delete fe[Xe],fe[qe]=dt,me[dt].geometry[0].shift(),me[dt].geometry[0]=mt[0].concat(me[dt].geometry[0]),dt}function ut(qe,Xe,mt){const dt=mt?Xe[0][Xe[0].length-1]:Xe[0][0];return`${qe}:${dt.x}:${dt.y}`}for(let qe=0;qe<se.length;qe++){const Xe=se[qe],mt=Xe.geometry,dt=Xe.text?Xe.text.toString():null;if(!dt){ae(qe);continue}const gt=ut(dt,mt),it=ut(dt,mt,!0);if(gt in Me&&it in fe&&Me[gt]!==fe[it]){const jt=Fe(gt,it,mt),Ut=_e(gt,it,me[jt].geometry);delete fe[gt],delete Me[it],Me[ut(dt,me[Ut].geometry,!0)]=Ut,me[jt].geometry=null}else gt in Me?_e(gt,it,mt):it in fe?Fe(gt,it,mt):(ae(qe),fe[gt]=$-1,Me[it]=$-1)}return me.filter(qe=>qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((se,fe)=>se.sortKey-fe.sortKey)}update(t,a,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,c),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,c))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){const c=this.lineVertexArray.length;if(t.segment!==void 0){let p=t.dist(a[t.segment+1]),v=t.dist(a[t.segment]);const b={};for(let T=t.segment+1;T<a.length;T++)b[T]={x:a[T].x,y:a[T].y,tileUnitDistanceFromAnchor:p},T<a.length-1&&(p+=a[T+1].dist(a[T]));for(let T=t.segment||0;T>=0;T--)b[T]={x:a[T].x,y:a[T].y,tileUnitDistanceFromAnchor:v},T>0&&(v+=a[T-1].dist(a[T]));for(let T=0;T<a.length;T++){const P=b[T];this.lineVertexArray.emplaceBack(P.x,P.y,P.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(t,a,c,p,v,b,T,P,I,D,L,q){const G=t.indexArray,H=t.layoutVertexArray,K=t.segments.prepareSegment(4*a.length,H,G,this.canOverlap?b.sortKey:void 0),se=this.glyphOffsetArray.length,fe=K.vertexLength,Me=this.allowVerticalPlacement&&T===E.al.vertical?Math.PI/2:0,me=b.text&&b.text.sections;for(let $=0;$<a.length;$++){const{tl:ae,tr:_e,bl:Fe,br:ut,tex:qe,pixelOffsetTL:Xe,pixelOffsetBR:mt,minFontScaleX:dt,minFontScaleY:gt,glyphOffset:it,isSDF:jt,sectionIndex:Ut}=a[$],Gt=K.vertexLength,Nt=it[1];Rd(H,P.x,P.y,ae.x,Nt+ae.y,qe.x,qe.y,c,jt,Xe.x,Xe.y,dt,gt),Rd(H,P.x,P.y,_e.x,Nt+_e.y,qe.x+qe.w,qe.y,c,jt,mt.x,Xe.y,dt,gt),Rd(H,P.x,P.y,Fe.x,Nt+Fe.y,qe.x,qe.y+qe.h,c,jt,Xe.x,mt.y,dt,gt),Rd(H,P.x,P.y,ut.x,Nt+ut.y,qe.x+qe.w,qe.y+qe.h,c,jt,mt.x,mt.y,dt,gt),ep(t.dynamicLayoutVertexArray,P,Me),G.emplaceBack(Gt,Gt+2,Gt+1),G.emplaceBack(Gt+1,Gt+2,Gt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(it[0]),$!==a.length-1&&Ut===a[$+1].sectionIndex||t.programConfigurations.populatePaintArrays(H.length,b,b.index,{},q,me&&me[Ut])}t.placedSymbolArray.emplaceBack(P.x,P.y,se,this.glyphOffsetArray.length-se,fe,I,D,P.segment,c?c[0]:0,c?c[1]:0,p[0],p[1],T,0,!1,0,L)}_addCollisionDebugVertex(t,a,c,p,v,b){return a.emplaceBack(0,0),t.emplaceBack(c.x,c.y,p,v,Math.round(b.x),Math.round(b.y))}addCollisionDebugVertices(t,a,c,p,v,b,T){const P=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),I=P.vertexLength,D=v.layoutVertexArray,L=v.collisionVertexArray,q=T.anchorX,G=T.anchorY;this._addCollisionDebugVertex(D,L,b,q,G,new te(t,a)),this._addCollisionDebugVertex(D,L,b,q,G,new te(c,a)),this._addCollisionDebugVertex(D,L,b,q,G,new te(c,p)),this._addCollisionDebugVertex(D,L,b,q,G,new te(t,p)),P.vertexLength+=4;const H=v.indexArray;H.emplaceBack(I,I+1),H.emplaceBack(I+1,I+2),H.emplaceBack(I+2,I+3),H.emplaceBack(I+3,I),P.primitiveLength+=4}addDebugCollisionBoxes(t,a,c,p){for(let v=t;v<a;v++){const b=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,p?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,c)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Dd(si,Ed.members,ti),this.iconCollisionBox=new Dd(si,Ed.members,ti);for(let t=0;t<this.symbolInstances.length;t++){const a=this.symbolInstances.get(t);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(t,a,c,p,v,b,T,P,I){const D={};for(let L=a;L<c;L++){const q=t.get(L);D.textBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},D.textFeatureIndex=q.featureIndex;break}for(let L=p;L<v;L++){const q=t.get(L);D.verticalTextBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},D.verticalTextFeatureIndex=q.featureIndex;break}for(let L=b;L<T;L++){const q=t.get(L);D.iconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},D.iconFeatureIndex=q.featureIndex;break}for(let L=P;L<I;L++){const q=t.get(L);D.verticalIconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},D.verticalIconFeatureIndex=q.featureIndex;break}return D}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const c=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){const c=t.placedSymbolArray.get(a),p=c.vertexStartIndex+4*c.numGlyphs;for(let v=c.vertexStartIndex;v<p;v+=4)t.indexArray.emplaceBack(v,v+2,v+1),t.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(t),c=Math.cos(t),p=[],v=[],b=[];for(let T=0;T<this.symbolInstances.length;++T){b.push(T);const P=this.symbolInstances.get(T);p.push(0|Math.round(a*P.anchorX+c*P.anchorY)),v.push(P.featureIndex)}return b.sort((T,P)=>p[T]-p[P]||v[P]-v[T]),b}addToSortKeyRanges(t,a){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===a?c.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const c=this.symbolInstances.get(a);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((p,v,b)=>{p>=0&&b.indexOf(p)===v&&this.addIndicesForPlacedSymbol(this.text,p)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let bm,$g;kt("SymbolBucket",gu,{omit:["layers","collisionBoxArray","features","compareText"]}),gu.MAX_GLYPHS=65535,gu.addDynamicAttributes=ep;var Nd={get paint(){return $g=$g||new wi({"icon-opacity":new $t(oe.paint_symbol["icon-opacity"]),"icon-color":new $t(oe.paint_symbol["icon-color"]),"icon-halo-color":new $t(oe.paint_symbol["icon-halo-color"]),"icon-halo-width":new $t(oe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new $t(oe.paint_symbol["icon-halo-blur"]),"icon-translate":new Dt(oe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Dt(oe.paint_symbol["icon-translate-anchor"]),"text-opacity":new $t(oe.paint_symbol["text-opacity"]),"text-color":new $t(oe.paint_symbol["text-color"],{runtimeType:ii,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new $t(oe.paint_symbol["text-halo-color"]),"text-halo-width":new $t(oe.paint_symbol["text-halo-width"]),"text-halo-blur":new $t(oe.paint_symbol["text-halo-blur"]),"text-translate":new Dt(oe.paint_symbol["text-translate"]),"text-translate-anchor":new Dt(oe.paint_symbol["text-translate-anchor"])})},get layout(){return bm=bm||new wi({"symbol-placement":new Dt(oe.layout_symbol["symbol-placement"]),"symbol-spacing":new Dt(oe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Dt(oe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new $t(oe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Dt(oe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Dt(oe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Dt(oe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Dt(oe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Dt(oe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Dt(oe.layout_symbol["icon-rotation-alignment"]),"icon-size":new $t(oe.layout_symbol["icon-size"]),"icon-text-fit":new Dt(oe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Dt(oe.layout_symbol["icon-text-fit-padding"]),"icon-image":new $t(oe.layout_symbol["icon-image"]),"icon-rotate":new $t(oe.layout_symbol["icon-rotate"]),"icon-padding":new $t(oe.layout_symbol["icon-padding"]),"icon-keep-upright":new Dt(oe.layout_symbol["icon-keep-upright"]),"icon-offset":new $t(oe.layout_symbol["icon-offset"]),"icon-anchor":new $t(oe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Dt(oe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Dt(oe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Dt(oe.layout_symbol["text-rotation-alignment"]),"text-field":new $t(oe.layout_symbol["text-field"]),"text-font":new $t(oe.layout_symbol["text-font"]),"text-size":new $t(oe.layout_symbol["text-size"]),"text-max-width":new $t(oe.layout_symbol["text-max-width"]),"text-line-height":new Dt(oe.layout_symbol["text-line-height"]),"text-letter-spacing":new $t(oe.layout_symbol["text-letter-spacing"]),"text-justify":new $t(oe.layout_symbol["text-justify"]),"text-radial-offset":new $t(oe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Dt(oe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new $t(oe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new $t(oe.layout_symbol["text-anchor"]),"text-max-angle":new Dt(oe.layout_symbol["text-max-angle"]),"text-writing-mode":new Dt(oe.layout_symbol["text-writing-mode"]),"text-rotate":new $t(oe.layout_symbol["text-rotate"]),"text-padding":new Dt(oe.layout_symbol["text-padding"]),"text-keep-upright":new Dt(oe.layout_symbol["text-keep-upright"]),"text-transform":new $t(oe.layout_symbol["text-transform"]),"text-offset":new $t(oe.layout_symbol["text-offset"]),"text-allow-overlap":new Dt(oe.layout_symbol["text-allow-overlap"]),"text-overlap":new Dt(oe.layout_symbol["text-overlap"]),"text-ignore-placement":new Dt(oe.layout_symbol["text-ignore-placement"]),"text-optional":new Dt(oe.layout_symbol["text-optional"])})}};class tp{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Zt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}kt("FormatSectionOverride",tp,{omit:["defaultValue"]});class rp extends La{constructor(t){super(t,Nd)}recalculate(t,a){if(super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const c=this.layout.get("text-writing-mode");if(c){const p=[];for(const v of c)p.indexOf(v)<0&&p.push(v);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,a,c,p){const v=this.layout.get(t).evaluate(a,{},c,p),b=this._unevaluatedLayout._values[t];return b.isDataDriven()||Qa(b.value)||!v?v:function(T,P){return P.replace(/{([^{}]+)}/g,(I,D)=>T&&D in T?String(T[D]):"")}(a.properties,v)}createBucket(t){return new gu(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Nd.paint.overridableProperties){if(!rp.hasPaintOverride(this.layout,t))continue;const a=this.paint.get(t),c=new tp(a),p=new ns(c,a.property.specification);let v=null;v=a.value.kind==="constant"||a.value.kind==="source"?new Ps("source",p):new $c("composite",p,a.value.zoomStops),this.paint._values[t]=new Wr(a.property,v,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,c){return!(!this.layout||a.isDataDriven()||c.isDataDriven())&&rp.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){const c=t.get("text-field"),p=Nd.paint.properties[a];let v=!1;const b=T=>{for(const P of T)if(p.overrides&&p.overrides.hasOverride(P))return void(v=!0)};if(c.value.kind==="constant"&&c.value.value instanceof pa)b(c.value.value.sections);else if(c.value.kind==="source"){const T=I=>{v||(I instanceof Jt&&Jr(I.value)===jo?b(I.value.sections):I instanceof Vu?b(I.sections):I.eachChild(T))},P=c.value;P._styleExpression&&T(P._styleExpression.expression)}return v}}let Gg;var Ld={get paint(){return Gg=Gg||new wi({"background-color":new Dt(oe.paint_background["background-color"]),"background-pattern":new Qc(oe.paint_background["background-pattern"]),"background-opacity":new Dt(oe.paint_background["background-opacity"])})}};class S_ extends La{constructor(t){super(t,Ld)}}let wm;var zr={get paint(){return wm=wm||new wi({"raster-opacity":new Dt(oe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Dt(oe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Dt(oe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Dt(oe.paint_raster["raster-brightness-max"]),"raster-saturation":new Dt(oe.paint_raster["raster-saturation"]),"raster-contrast":new Dt(oe.paint_raster["raster-contrast"]),"raster-resampling":new Dt(oe.paint_raster["raster-resampling"]),"raster-fade-duration":new Dt(oe.paint_raster["raster-fade-duration"])})}};class Sm extends La{constructor(t){super(t,zr)}}class ip extends La{constructor(t){super(t,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Tm{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Hg={once:!0},Od=63710088e-1;class ps{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ps(rr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const a=Math.PI/180,c=this.lat*a,p=t.lat*a,v=Math.sin(c)*Math.sin(p)+Math.cos(c)*Math.cos(p)*Math.cos((t.lng-this.lng)*a);return Od*Math.acos(Math.min(v,1))}static convert(t){if(t instanceof ps)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new ps(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new ps(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Bd=2*Math.PI*Od;function yu(n){return Bd*Math.cos(n*Math.PI/180)}function Mm(n){return(180+n)/360}function Wg(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Xg(n,t){return n/yu(t)}function ap(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function Em(n,t){return n*yu(ap(t))}class mc{constructor(t,a,c=0){this.x=+t,this.y=+a,this.z=+c}static fromLngLat(t,a=0){const c=ps.convert(t);return new mc(Mm(c.lng),Wg(c.lat),Xg(a,c.lat))}toLngLat(){return new ps(360*this.x-180,ap(this.y))}toAltitude(){return Em(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Bd*(t=ap(this.y),1/Math.cos(t*Math.PI/180));var t}}function Xr(n,t,a){var c=2*Math.PI*6378137/256/Math.pow(2,a);return[n*c-2*Math.PI*6378137/2,t*c-2*Math.PI*6378137/2]}class Fd{constructor(t,a,c){if(!function(p,v,b){return!(p<0||p>25||b<0||b>=Math.pow(2,p)||v<0||v>=Math.pow(2,p))}(t,a,c))throw new Error(`x=${a}, y=${c}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=a,this.y=c,this.key=gc(0,t,t,a,c)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a,c){const p=(b=this.y,T=this.z,P=Xr(256*(v=this.x),256*(b=Math.pow(2,T)-b-1),T),I=Xr(256*(v+1),256*(b+1),T),P[0]+","+P[1]+","+I[0]+","+I[1]);var v,b,T,P,I;const D=function(L,q,G){let H,K="";for(let se=L;se>0;se--)H=1<<se-1,K+=(q&H?1:0)+(G&H?2:0);return K}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,p)}isChildOf(t){const a=this.z-t.z;return a>0&&t.x===this.x>>a&&t.y===this.y>>a}getTilePoint(t){const a=Math.pow(2,this.z);return new te((t.x*a-this.x)*Je,(t.y*a-this.y)*Je)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ba{constructor(t,a){this.wrap=t,this.canonical=a,this.key=gc(t,a.z,a.z,a.x,a.y)}}class Gn{constructor(t,a,c,p,v){if(this.terrainRttPosMatrix32f=null,t<c)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${c}`);this.overscaledZ=t,this.wrap=a,this.canonical=new Fd(c,+p,+v),this.key=gc(a,t,c,p,v)}clone(){return new Gn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?new Gn(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Gn(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(t,a){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-t;return t>this.canonical.z?gc(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y):gc(this.wrap*+a,t,t,this.canonical.x>>c,this.canonical.y>>c)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const a=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new Gn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,c=2*this.canonical.x,p=2*this.canonical.y;return[new Gn(a,this.wrap,a,c,p),new Gn(a,this.wrap,a,c+1,p),new Gn(a,this.wrap,a,c,p+1),new Gn(a,this.wrap,a,c+1,p+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Gn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Gn(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ba(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new mc(t.x-this.wrap,t.y))}}function gc(n,t,a,c,p){(n*=2)<0&&(n=-1*n-1);const v=1<<a;return(v*v*n+v*p+c).toString(36)+a.toString(36)+t.toString(36)}kt("CanonicalTileID",Fd),kt("OverscaledTileID",Gn,{omit:["terrainRttPosMatrix32f"]});class np{constructor(t,a,c,p=1,v=1,b=1,T=0){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(c&&!["mapbox","terrarium","custom"].includes(c))return void hi(`"${c}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const P=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),c){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=v,this.blueFactor=b,this.baseShift=T;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<P;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(P,I)]=this.data[this._idx(P-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,P)]=this.data[this._idx(I,P-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(P,-1)]=this.data[this._idx(P-1,0)],this.data[this._idx(-1,P)]=this.data[this._idx(0,P-1)],this.data[this._idx(P,P)]=this.data[this._idx(P-1,P-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<P;I++)for(let D=0;D<P;D++){const L=this.get(I,D);L>this.max&&(this.max=L),L<this.min&&(this.min=L)}}get(t,a){const c=new Uint8Array(this.data.buffer),p=4*this._idx(t,a);return this.unpack(c[p],c[p+1],c[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}unpack(t,a,c){return t*this.redFactor+a*this.greenFactor+c*this.blueFactor-this.baseShift}getPixels(){return new ja({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,a,c){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let p=a*this.dim,v=a*this.dim+this.dim,b=c*this.dim,T=c*this.dim+this.dim;switch(a){case-1:p=v-1;break;case 1:v=p+1}switch(c){case-1:b=T-1;break;case 1:T=b+1}const P=-a*this.dim,I=-c*this.dim;for(let D=b;D<T;D++)for(let L=p;L<v;L++)this.data[this._idx(L,D)]=t.data[this._idx(L+P,D+I)]}}kt("DEMData",np);class Ud{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){const c=t[a];this._stringToNumber[c]=a,this._numberToString[a]=c}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Cm{constructor(t,a,c,p,v){this.type="Feature",this._vectorTileFeature=t,t._z=a,t._x=c,t._y=p,this.properties=t.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(t[a]=this[a]);return t}}class Am{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new In(Je,16,0),this.grid3D=new In(Je,16,0),this.featureIndexArray=new He,this.promoteId=a}insert(t,a,c,p,v,b){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,p,v);const P=b?this.grid3D:this.grid;for(let I=0;I<a.length;I++){const D=a[I],L=[1/0,1/0,-1/0,-1/0];for(let q=0;q<D.length;q++){const G=D[q];L[0]=Math.min(L[0],G.x),L[1]=Math.min(L[1],G.y),L[2]=Math.max(L[2],G.x),L[3]=Math.max(L[3],G.y)}L[0]<Je&&L[1]<Je&&L[2]>=0&&L[3]>=0&&P.insert(T,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new hc.VectorTile(new Ad(this.rawTileData)).layers,this.sourceLayerCoder=new Ud(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,a,c,p){this.loadVTLayers();const v=t.params,b=Je/t.tileSize/t.scale,T=Ca(v.filter),P=t.queryGeometry,I=t.queryPadding*b,D=op(P),L=this.grid.query(D.minX-I,D.minY-I,D.maxX+I,D.maxY+I),q=op(t.cameraQueryGeometry),G=this.grid3D.query(q.minX-I,q.minY-I,q.maxX+I,q.maxY+I,(se,fe,Me,me)=>function($,ae,_e,Fe,ut){for(const Xe of $)if(ae<=Xe.x&&_e<=Xe.y&&Fe>=Xe.x&&ut>=Xe.y)return!0;const qe=[new te(ae,_e),new te(ae,ut),new te(Fe,ut),new te(Fe,_e)];if($.length>2){for(const Xe of qe)if(ll($,Xe))return!0}for(let Xe=0;Xe<$.length-1;Xe++)if(Qp($[Xe],$[Xe+1],qe))return!0;return!1}(t.cameraQueryGeometry,se-I,fe-I,Me+I,me+I));for(const se of G)L.push(se);L.sort(T_);const H={};let K;for(let se=0;se<L.length;se++){const fe=L[se];if(fe===K)continue;K=fe;const Me=this.featureIndexArray.get(fe);let me=null;this.loadMatchingFeature(H,Me.bucketIndex,Me.sourceLayerIndex,Me.featureIndex,T,v.layers,v.availableImages,a,c,p,($,ae,_e)=>(me||(me=nl($)),ae.queryIntersectsFeature({queryGeometry:P,feature:$,featureState:_e,geometry:me,zoom:this.z,transform:t.transform,pixelsToTileUnits:b,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return H}loadMatchingFeature(t,a,c,p,v,b,T,P,I,D,L){const q=this.bucketLayerIDs[a];if(b&&!q.some(se=>b.has(se)))return;const G=this.sourceLayerCoder.decode(c),H=this.vtLayers[G].feature(p);if(v.needGeometry){const se=sl(H,!0);if(!v.filter(new Hr(this.tileID.overscaledZ),se,this.tileID.canonical))return}else if(!v.filter(new Hr(this.tileID.overscaledZ),H))return;const K=this.getId(H,G);for(let se=0;se<q.length;se++){const fe=q[se];if(b&&!b.has(fe))continue;const Me=P[fe];if(!Me)continue;let me={};K&&D&&(me=D.getState(Me.sourceLayer||"_geojsonTileLayer",K));const $=qr({},I[fe]);$.paint=sp($.paint,Me.paint,H,me,T),$.layout=sp($.layout,Me.layout,H,me,T);const ae=!L||L(H,Me,me);if(!ae)continue;const _e=new Cm(H,this.z,this.x,this.y,K);_e.layer=$;let Fe=t[fe];Fe===void 0&&(Fe=t[fe]=[]),Fe.push({featureIndex:p,feature:_e,intersectionZ:ae})}}lookupSymbolFeatures(t,a,c,p,v,b,T,P){const I={};this.loadVTLayers();const D=Ca(v);for(const L of t)this.loadMatchingFeature(I,c,p,L,D,b,T,P,a);return I}hasLayer(t){for(const a of this.bucketLayerIDs)for(const c of a)if(t===c)return!0;return!1}getId(t,a){var c;let p=t.id;return this.promoteId&&(p=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof p=="boolean"&&(p=Number(p)),p===void 0&&(!((c=t.properties)===null||c===void 0)&&c.cluster)&&this.promoteId&&(p=Number(t.properties.cluster_id))),p}}function sp(n,t,a,c,p){return $r(n,(v,b)=>{const T=t instanceof bi?t.get(b):null;return T&&T.evaluate?T.evaluate(a,c,p):T})}function op(n){let t=1/0,a=1/0,c=-1/0,p=-1/0;for(const v of n)t=Math.min(t,v.x),a=Math.min(a,v.y),c=Math.max(c,v.x),p=Math.max(p,v.y);return{minX:t,minY:a,maxX:c,maxY:p}}function T_(n,t){return t-n}function km(n,t,a,c,p){const v=[];for(let b=0;b<n.length;b++){const T=n[b];let P;for(let I=0;I<T.length-1;I++){let D=T[I],L=T[I+1];D.x<t&&L.x<t||(D.x<t?D=new te(t,D.y+(t-D.x)/(L.x-D.x)*(L.y-D.y))._round():L.x<t&&(L=new te(t,D.y+(t-D.x)/(L.x-D.x)*(L.y-D.y))._round()),D.y<a&&L.y<a||(D.y<a?D=new te(D.x+(a-D.y)/(L.y-D.y)*(L.x-D.x),a)._round():L.y<a&&(L=new te(D.x+(a-D.y)/(L.y-D.y)*(L.x-D.x),a)._round()),D.x>=c&&L.x>=c||(D.x>=c?D=new te(c,D.y+(c-D.x)/(L.x-D.x)*(L.y-D.y))._round():L.x>=c&&(L=new te(c,D.y+(c-D.x)/(L.x-D.x)*(L.y-D.y))._round()),D.y>=p&&L.y>=p||(D.y>=p?D=new te(D.x+(p-D.y)/(L.y-D.y)*(L.x-D.x),p)._round():L.y>=p&&(L=new te(D.x+(p-D.y)/(L.y-D.y)*(L.x-D.x),p)._round()),P&&D.equals(P[P.length-1])||(P=[D],v.push(P)),P.push(L)))))}}return v}kt("FeatureIndex",Am,{omit:["rawTileData","sourceLayerCoder"]});class yc extends te{constructor(t,a,c,p){super(t,a),this.angle=c,p!==void 0&&(this.segment=p)}clone(){return new yc(this.x,this.y,this.angle,this.segment)}}function Pm(n,t,a,c,p){if(t.segment===void 0||a===0)return!0;let v=t,b=t.segment+1,T=0;for(;T>-a/2;){if(b--,b<0)return!1;T-=n[b].dist(v),v=n[b]}T+=n[b].dist(n[b+1]),b++;const P=[];let I=0;for(;T<a/2;){const D=n[b],L=n[b+1];if(!L)return!1;let q=n[b-1].angleTo(D)-D.angleTo(L);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:T,angleDelta:q}),I+=q;T-P[0].distance>c;)I-=P.shift().angleDelta;if(I>p)return!1;b++,T+=D.dist(L)}return!0}function Yg(n){let t=0;for(let a=0;a<n.length-1;a++)t+=n[a].dist(n[a+1]);return t}function Kg(n,t,a){return n?.6*t*a:0}function lp(n,t){return Math.max(n?n.right-n.left:0,t?t.right-t.left:0)}function jm(n,t,a,c,p,v){const b=Kg(a,p,v),T=lp(a,c)*v;let P=0;const I=Yg(n)/2;for(let D=0;D<n.length-1;D++){const L=n[D],q=n[D+1],G=L.dist(q);if(P+G>I){const H=(I-P)/G,K=ts.number(L.x,q.x,H),se=ts.number(L.y,q.y,H),fe=new yc(K,se,q.angleTo(L),D);return fe._round(),!b||Pm(n,fe,T,b,t)?fe:void 0}P+=G}}function M_(n,t,a,c,p,v,b,T,P){const I=Kg(c,v,b),D=lp(c,p),L=D*b,q=n[0].x===0||n[0].x===P||n[0].y===0||n[0].y===P;return t-L<t/4&&(t=L+t/4),Qg(n,q?t/2*T%t:(D/2+2*v)*b*T%t,t,I,a,L,q,!1,P)}function Qg(n,t,a,c,p,v,b,T,P){const I=v/2,D=Yg(n);let L=0,q=t-a,G=[];for(let H=0;H<n.length-1;H++){const K=n[H],se=n[H+1],fe=K.dist(se),Me=se.angleTo(K);for(;q+a<L+fe;){q+=a;const me=(q-L)/fe,$=ts.number(K.x,se.x,me),ae=ts.number(K.y,se.y,me);if($>=0&&$<P&&ae>=0&&ae<P&&q-I>=0&&q+I<=D){const _e=new yc($,ae,Me,H);_e._round(),c&&!Pm(n,_e,v,c,p)||G.push(_e)}}L+=fe}return T||G.length||b||(G=Qg(n,L/2,a,c,p,v,b,!0,P)),G}kt("Anchor",yc);const an=Ua;function zm(n,t,a,c){const p=[],v=n.image,b=v.pixelRatio,T=v.paddedRect.w-2*an,P=v.paddedRect.h-2*an;let I={x1:n.left,y1:n.top,x2:n.right,y2:n.bottom};const D=v.stretchX||[[0,T]],L=v.stretchY||[[0,P]],q=(it,jt)=>it+jt[1]-jt[0],G=D.reduce(q,0),H=L.reduce(q,0),K=T-G,se=P-H;let fe=0,Me=G,me=0,$=H,ae=0,_e=K,Fe=0,ut=se;if(v.content&&c){const it=v.content,jt=it[2]-it[0],Ut=it[3]-it[1];(v.textFitWidth||v.textFitHeight)&&(I=zd(n)),fe=Vd(D,0,it[0]),me=Vd(L,0,it[1]),Me=Vd(D,it[0],it[2]),$=Vd(L,it[1],it[3]),ae=it[0]-fe,Fe=it[1]-me,_e=jt-Me,ut=Ut-$}const qe=I.x1,Xe=I.y1,mt=I.x2-qe,dt=I.y2-Xe,gt=(it,jt,Ut,Gt)=>{const Nt=qd(it.stretch-fe,Me,mt,qe),hr=_u(it.fixed-ae,_e,it.stretch,G),yi=qd(jt.stretch-me,$,dt,Xe),Ki=_u(jt.fixed-Fe,ut,jt.stretch,H),Qi=qd(Ut.stretch-fe,Me,mt,qe),Va=_u(Ut.fixed-ae,_e,Ut.stretch,G),qa=qd(Gt.stretch-me,$,dt,Xe),Bi=_u(Gt.fixed-Fe,ut,Gt.stretch,H),ri=new te(Nt,yi),Fi=new te(Qi,yi),na=new te(Qi,qa),ua=new te(Nt,qa),ha=new te(hr/b,Ki/b),r=new te(Va/b,Bi/b),s=t*Math.PI/180;if(s){const M=Math.sin(s),z=Math.cos(s),Z=[z,-M,M,z];ri._matMult(Z),Fi._matMult(Z),ua._matMult(Z),na._matMult(Z)}const h=it.stretch+it.fixed,y=jt.stretch+jt.fixed;return{tl:ri,tr:Fi,bl:ua,br:na,tex:{x:v.paddedRect.x+an+h,y:v.paddedRect.y+an+y,w:Ut.stretch+Ut.fixed-h,h:Gt.stretch+Gt.fixed-y},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ha,pixelOffsetBR:r,minFontScaleX:_e/b/mt,minFontScaleY:ut/b/dt,isSDF:a}};if(c&&(v.stretchX||v.stretchY)){const it=Hn(D,K,G),jt=Hn(L,se,H);for(let Ut=0;Ut<it.length-1;Ut++){const Gt=it[Ut],Nt=it[Ut+1];for(let hr=0;hr<jt.length-1;hr++)p.push(gt(Gt,jt[hr],Nt,jt[hr+1]))}}else p.push(gt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:P+1}));return p}function Vd(n,t,a){let c=0;for(const p of n)c+=Math.max(t,Math.min(a,p[1]))-Math.max(t,Math.min(a,p[0]));return c}function Hn(n,t,a){const c=[{fixed:-1,stretch:0}];for(const[p,v]of n){const b=c[c.length-1];c.push({fixed:p-b.stretch,stretch:b.stretch}),c.push({fixed:p-b.stretch,stretch:b.stretch+(v-p)})}return c.push({fixed:t+an,stretch:a}),c}function qd(n,t,a,c){return n/t*a+c}function _u(n,t,a,c){return n-t*a/c}class ms{constructor(t,a,c,p,v,b,T,P,I,D){var L;if(this.boxStartIndex=t.length,I){let q=b.top,G=b.bottom;const H=b.collisionPadding;H&&(q-=H[1],G+=H[3]);let K=G-q;K>0&&(K=Math.max(10,K),this.circleDiameter=K)}else{const q=!((L=b.image)===null||L===void 0)&&L.content&&(b.image.textFitWidth||b.image.textFitHeight)?zd(b):{x1:b.left,y1:b.top,x2:b.right,y2:b.bottom};q.y1=q.y1*T-P[0],q.y2=q.y2*T+P[2],q.x1=q.x1*T-P[3],q.x2=q.x2*T+P[1];const G=b.collisionPadding;if(G&&(q.x1-=G[0]*T,q.y1-=G[1]*T,q.x2+=G[2]*T,q.y2+=G[3]*T),D){const H=new te(q.x1,q.y1),K=new te(q.x2,q.y1),se=new te(q.x1,q.y2),fe=new te(q.x2,q.y2),Me=D*Math.PI/180;H._rotate(Me),K._rotate(Me),se._rotate(Me),fe._rotate(Me),q.x1=Math.min(H.x,K.x,se.x,fe.x),q.x2=Math.max(H.x,K.x,se.x,fe.x),q.y1=Math.min(H.y,K.y,se.y,fe.y),q.y2=Math.max(H.y,K.y,se.y,fe.y)}t.emplaceBack(a.x,a.y,q.x1,q.y1,q.x2,q.y2,c,p,v)}this.boxEndIndex=t.length}}class E_{constructor(t=[],a=(c,p)=>c<p?-1:c>p?1:0){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:c}=this,p=a[t];for(;t>0;){const v=t-1>>1,b=a[v];if(c(p,b)>=0)break;a[t]=b,t=v}a[t]=p}_down(t){const{data:a,compare:c}=this,p=this.length>>1,v=a[t];for(;t<p;){let b=1+(t<<1);const T=b+1;if(T<this.length&&c(a[T],a[b])<0&&(b=T),c(a[b],v)>=0)break;a[t]=a[b],t=b}a[t]=v}}function C_(n,t=1,a=!1){let c=1/0,p=1/0,v=-1/0,b=-1/0;const T=n[0];for(let G=0;G<T.length;G++){const H=T[G];(!G||H.x<c)&&(c=H.x),(!G||H.y<p)&&(p=H.y),(!G||H.x>v)&&(v=H.x),(!G||H.y>b)&&(b=H.y)}const P=Math.min(v-c,b-p);let I=P/2;const D=new E_([],Mh);if(P===0)return new te(c,p);for(let G=c;G<v;G+=P)for(let H=p;H<b;H+=P)D.push(new vu(G+I,H+I,I,n));let L=function(G){let H=0,K=0,se=0;const fe=G[0];for(let Me=0,me=fe.length,$=me-1;Me<me;$=Me++){const ae=fe[Me],_e=fe[$],Fe=ae.x*_e.y-_e.x*ae.y;K+=(ae.x+_e.x)*Fe,se+=(ae.y+_e.y)*Fe,H+=3*Fe}return new vu(K/H,se/H,0,G)}(n),q=D.length;for(;D.length;){const G=D.pop();(G.d>L.d||!L.d)&&(L=G,a&&console.log("found best %d after %d probes",Math.round(1e4*G.d)/1e4,q)),G.max-L.d<=t||(I=G.h/2,D.push(new vu(G.p.x-I,G.p.y-I,I,n)),D.push(new vu(G.p.x+I,G.p.y-I,I,n)),D.push(new vu(G.p.x-I,G.p.y+I,I,n)),D.push(new vu(G.p.x+I,G.p.y+I,I,n)),q+=4)}return a&&(console.log(`num probes: ${q}`),console.log(`best distance: ${L.d}`)),L.p}function Mh(n,t){return t.max-n.max}function vu(n,t,a,c){this.p=new te(n,t),this.h=a,this.d=function(p,v){let b=!1,T=1/0;for(let P=0;P<v.length;P++){const I=v[P];for(let D=0,L=I.length,q=L-1;D<L;q=D++){const G=I[D],H=I[q];G.y>p.y!=H.y>p.y&&p.x<(H.x-G.x)*(p.y-G.y)/(H.y-G.y)+G.x&&(b=!b),T=Math.min(T,ol(p,G,H))}}return(b?1:-1)*Math.sqrt(T)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}var wa;E.aB=void 0,(wa=E.aB||(E.aB={}))[wa.center=1]="center",wa[wa.left=2]="left",wa[wa.right=3]="right",wa[wa.top=4]="top",wa[wa.bottom=5]="bottom",wa[wa["top-left"]=6]="top-left",wa[wa["top-right"]=7]="top-right",wa[wa["bottom-left"]=8]="bottom-left",wa[wa["bottom-right"]=9]="bottom-right";const _c=7,Im=Number.POSITIVE_INFINITY;function Jg(n,t){return t[1]!==Im?function(a,c,p){let v=0,b=0;switch(c=Math.abs(c),p=Math.abs(p),a){case"top-right":case"top-left":case"top":b=p-_c;break;case"bottom-right":case"bottom-left":case"bottom":b=-p+_c}switch(a){case"top-right":case"bottom-right":case"right":v=-c;break;case"top-left":case"bottom-left":case"left":v=c}return[v,b]}(n,t[0],t[1]):function(a,c){let p=0,v=0;c<0&&(c=0);const b=c/Math.SQRT2;switch(a){case"top-right":case"top-left":v=b-_c;break;case"bottom-right":case"bottom-left":v=-b+_c;break;case"bottom":v=-c+_c;break;case"top":v=c-_c}switch(a){case"top-right":case"bottom-right":p=-b;break;case"top-left":case"bottom-left":p=b;break;case"left":p=c;break;case"right":p=-c}return[p,v]}(n,t[0])}function e0(n,t,a){var c;const p=n.layout,v=(c=p.get("text-variable-anchor-offset"))===null||c===void 0?void 0:c.evaluate(t,{},a);if(v){const T=v.values,P=[];for(let I=0;I<T.length;I+=2){const D=P[I]=T[I],L=T[I+1].map(q=>q*Lr);D.startsWith("top")?L[1]-=_c:D.startsWith("bottom")&&(L[1]+=_c),P[I+1]=L}return new Wi(P)}const b=p.get("text-variable-anchor");if(b){let T;T=n._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(t,{},a)*Lr,Im]:p.get("text-offset").evaluate(t,{},a).map(I=>I*Lr);const P=[];for(const I of b)P.push(I,Jg(I,T));return new Wi(P)}return null}function Rm(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function A_(n,t,a,c,p,v,b,T,P,I,D,L){let q=v.textMaxSize.evaluate(t,{});q===void 0&&(q=b);const G=n.layers[0].layout,H=G.get("icon-offset").evaluate(t,{},D),K=xu(a.horizontal),se=b/24,fe=n.tilePixelRatio*se,Me=n.tilePixelRatio*q/24,me=n.tilePixelRatio*T,$=n.tilePixelRatio*G.get("symbol-spacing"),ae=G.get("text-padding")*n.tilePixelRatio,_e=function(Ut,Gt,Nt,hr=1){const yi=Ut.get("icon-padding").evaluate(Gt,{},Nt),Ki=yi&&yi.values;return[Ki[0]*hr,Ki[1]*hr,Ki[2]*hr,Ki[3]*hr]}(G,t,D,n.tilePixelRatio),Fe=G.get("text-max-angle")/180*Math.PI,ut=G.get("text-rotation-alignment")!=="viewport"&&G.get("symbol-placement")!=="point",qe=G.get("icon-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",Xe=G.get("symbol-placement"),mt=$/2,dt=G.get("icon-text-fit");let gt;c&&dt!=="none"&&(n.allowVerticalPlacement&&a.vertical&&(gt=pu(c,a.vertical,dt,G.get("icon-text-fit-padding"),H,se)),K&&(c=pu(c,K,dt,G.get("icon-text-fit-padding"),H,se)));const it=D?L.line.getGranularityForZoomLevel(D.z):1,jt=(Ut,Gt)=>{Gt.x<0||Gt.x>=Je||Gt.y<0||Gt.y>=Je||function(Nt,hr,yi,Ki,Qi,Va,qa,Bi,ri,Fi,na,ua,ha,r,s,h,y,M,z,Z,ie,ge,ze,lt,bt){const We=Nt.addToLineVertexArray(hr,yi);let ct,Vt,ir,ci,Oe=0,je=0,$e=0,pt=0,Ft=-1,xr=-1;const qt={};let tr=On("");if(Nt.allowVerticalPlacement&&Ki.vertical){const nn=Bi.layout.get("text-rotate").evaluate(ie,{},lt)+90;ir=new ms(ri,hr,Fi,na,ua,Ki.vertical,ha,r,s,nn),qa&&(ci=new ms(ri,hr,Fi,na,ua,qa,y,M,s,nn))}if(Qi){const nn=Bi.layout.get("icon-rotate").evaluate(ie,{}),Fs=Bi.layout.get("icon-text-fit")!=="none",Hd=zm(Qi,nn,ze,Fs),Tl=qa?zm(qa,nn,ze,Fs):void 0;Vt=new ms(ri,hr,Fi,na,ua,Qi,y,M,!1,nn),Oe=4*Hd.length;const Wd=Nt.iconSizeData;let bc=null;Wd.kind==="source"?(bc=[$n*Bi.layout.get("icon-size").evaluate(ie,{})],bc[0]>xo&&hi(`${Nt.layerIds[0]}: Value for "icon-size" is >= ${mu}. Reduce your "icon-size".`)):Wd.kind==="composite"&&(bc=[$n*ge.compositeIconSizes[0].evaluate(ie,{},lt),$n*ge.compositeIconSizes[1].evaluate(ie,{},lt)],(bc[0]>xo||bc[1]>xo)&&hi(`${Nt.layerIds[0]}: Value for "icon-size" is >= ${mu}. Reduce your "icon-size".`)),Nt.addSymbols(Nt.icon,Hd,bc,Z,z,ie,E.al.none,hr,We.lineStartIndex,We.lineLength,-1,lt),Ft=Nt.icon.placedSymbolArray.length-1,Tl&&(je=4*Tl.length,Nt.addSymbols(Nt.icon,Tl,bc,Z,z,ie,E.al.vertical,hr,We.lineStartIndex,We.lineLength,-1,lt),xr=Nt.icon.placedSymbolArray.length-1)}const da=Object.keys(Ki.horizontal);for(const nn of da){const Fs=Ki.horizontal[nn];if(!ct){tr=On(Fs.text);const Tl=Bi.layout.get("text-rotate").evaluate(ie,{},lt);ct=new ms(ri,hr,Fi,na,ua,Fs,ha,r,s,Tl)}const Hd=Fs.positionedLines.length===1;if($e+=Dm(Nt,hr,Fs,Va,Bi,s,ie,h,We,Ki.vertical?E.al.horizontal:E.al.horizontalOnly,Hd?da:[nn],qt,Ft,ge,lt),Hd)break}Ki.vertical&&(pt+=Dm(Nt,hr,Ki.vertical,Va,Bi,s,ie,h,We,E.al.vertical,["vertical"],qt,xr,ge,lt));const Vr=ct?ct.boxStartIndex:Nt.collisionBoxArray.length,xc=ct?ct.boxEndIndex:Nt.collisionBoxArray.length,k_=ir?ir.boxStartIndex:Nt.collisionBoxArray.length,p2=ir?ir.boxEndIndex:Nt.collisionBoxArray.length,m2=Vt?Vt.boxStartIndex:Nt.collisionBoxArray.length,g2=Vt?Vt.boxEndIndex:Nt.collisionBoxArray.length,y2=ci?ci.boxStartIndex:Nt.collisionBoxArray.length,_2=ci?ci.boxEndIndex:Nt.collisionBoxArray.length;let Sl=-1;const t0=(nn,Fs)=>nn&&nn.circleDiameter?Math.max(nn.circleDiameter,Fs):Fs;Sl=t0(ct,Sl),Sl=t0(ir,Sl),Sl=t0(Vt,Sl),Sl=t0(ci,Sl);const Rx=Sl>-1?1:0;Rx&&(Sl*=bt/Lr),Nt.glyphOffsetArray.length>=gu.MAX_GLYPHS&&hi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ie.sortKey!==void 0&&Nt.addToSortKeyRanges(Nt.symbolInstances.length,ie.sortKey);const v2=e0(Bi,ie,lt),[x2,b2]=function(nn,Fs){const Hd=nn.length,Tl=Fs==null?void 0:Fs.values;if((Tl==null?void 0:Tl.length)>0)for(let Wd=0;Wd<Tl.length;Wd+=2){const bc=Tl[Wd+1];nn.emplaceBack(E.aB[Tl[Wd]],bc[0],bc[1])}return[Hd,nn.length]}(Nt.textAnchorOffsets,v2);Nt.symbolInstances.emplaceBack(hr.x,hr.y,qt.right>=0?qt.right:-1,qt.center>=0?qt.center:-1,qt.left>=0?qt.left:-1,qt.vertical||-1,Ft,xr,tr,Vr,xc,k_,p2,m2,g2,y2,_2,Fi,$e,pt,Oe,je,Rx,0,ha,Sl,x2,b2)}(n,Gt,Ut,a,c,p,gt,n.layers[0],n.collisionBoxArray,t.index,t.sourceLayerIndex,n.index,fe,[ae,ae,ae,ae],ut,P,me,_e,qe,H,t,v,I,D,b)};if(Xe==="line")for(const Ut of km(t.geometry,0,0,Je,Je)){const Gt=lc(Ut,it),Nt=M_(Gt,$,Fe,a.vertical||K,c,24,Me,n.overscaling,Je);for(const hr of Nt)K&&Zd(n,K.text,mt,hr)||jt(Gt,hr)}else if(Xe==="line-center"){for(const Ut of t.geometry)if(Ut.length>1){const Gt=lc(Ut,it),Nt=jm(Gt,Fe,a.vertical||K,c,24,Me);Nt&&jt(Gt,Nt)}}else if(t.type==="Polygon")for(const Ut of Fc(t.geometry,0)){const Gt=C_(Ut,16);jt(lc(Ut[0],it,!0),new yc(Gt.x,Gt.y,0))}else if(t.type==="LineString")for(const Ut of t.geometry){const Gt=lc(Ut,it);jt(Gt,new yc(Gt[0].x,Gt[0].y,0))}else if(t.type==="Point")for(const Ut of t.geometry)for(const Gt of Ut)jt([Gt],new yc(Gt.x,Gt.y,0))}function Dm(n,t,a,c,p,v,b,T,P,I,D,L,q,G,H){const K=function(Me,me,$,ae,_e,Fe,ut,qe){const Xe=ae.layout.get("text-rotate").evaluate(Fe,{})*Math.PI/180,mt=[];for(const dt of me.positionedLines)for(const gt of dt.positionedGlyphs){if(!gt.rect)continue;const it=gt.rect||{};let jt=gm+1,Ut=!0,Gt=1,Nt=0;const hr=(_e||qe)&&gt.vertical,yi=gt.metrics.advance*gt.scale/2;if(qe&&me.verticalizable&&(Nt=dt.lineOffset/2-(gt.imageName?-(Lr-gt.metrics.width*gt.scale)/2:(gt.scale-1)*Lr)),gt.imageName){const M=ut[gt.imageName];Ut=M.sdf,Gt=M.pixelRatio,jt=Ua/Gt}const Ki=_e?[gt.x+yi,gt.y]:[0,0];let Qi=_e?[0,0]:[gt.x+yi+$[0],gt.y+$[1]-Nt],Va=[0,0];hr&&(Va=Qi,Qi=[0,0]);const qa=gt.metrics.isDoubleResolution?2:1,Bi=(gt.metrics.left-jt)*gt.scale-yi+Qi[0],ri=(-gt.metrics.top-jt)*gt.scale+Qi[1],Fi=Bi+it.w/qa*gt.scale/Gt,na=ri+it.h/qa*gt.scale/Gt,ua=new te(Bi,ri),ha=new te(Fi,ri),r=new te(Bi,na),s=new te(Fi,na);if(hr){const M=new te(-yi,yi-wh),z=-Math.PI/2,Z=Lr/2-yi,ie=new te(5-wh-Z,-(gt.imageName?Z:0)),ge=new te(...Va);ua._rotateAround(z,M)._add(ie)._add(ge),ha._rotateAround(z,M)._add(ie)._add(ge),r._rotateAround(z,M)._add(ie)._add(ge),s._rotateAround(z,M)._add(ie)._add(ge)}if(Xe){const M=Math.sin(Xe),z=Math.cos(Xe),Z=[z,-M,M,z];ua._matMult(Z),ha._matMult(Z),r._matMult(Z),s._matMult(Z)}const h=new te(0,0),y=new te(0,0);mt.push({tl:ua,tr:ha,bl:r,br:s,tex:it,writingMode:me.writingMode,glyphOffset:Ki,sectionIndex:gt.sectionIndex,isSDF:Ut,pixelOffsetTL:h,pixelOffsetBR:y,minFontScaleX:0,minFontScaleY:0})}return mt}(0,a,T,p,v,b,c,n.allowVerticalPlacement),se=n.textSizeData;let fe=null;se.kind==="source"?(fe=[$n*p.layout.get("text-size").evaluate(b,{})],fe[0]>xo&&hi(`${n.layerIds[0]}: Value for "text-size" is >= ${mu}. Reduce your "text-size".`)):se.kind==="composite"&&(fe=[$n*G.compositeTextSizes[0].evaluate(b,{},H),$n*G.compositeTextSizes[1].evaluate(b,{},H)],(fe[0]>xo||fe[1]>xo)&&hi(`${n.layerIds[0]}: Value for "text-size" is >= ${mu}. Reduce your "text-size".`)),n.addSymbols(n.text,K,fe,T,v,b,I,t,P.lineStartIndex,P.lineLength,q,H);for(const Me of D)L[Me]=n.text.placedSymbolArray.length-1;return 4*K.length}function xu(n){for(const t in n)return n[t];return null}function Zd(n,t,a,c){const p=n.compareText;if(t in p){const v=p[t];for(let b=v.length-1;b>=0;b--)if(c.dist(v[b])<a)return!0}else p[t]=[];return p[t].push(c),!1}const Nm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Lm{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,c]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=c>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const v=Nm[15&c];if(!v)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(t,2,1),[T]=new Uint32Array(t,4,1);return new Lm(T,b,v,t)}constructor(t,a=64,c=Float64Array,p){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=c,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const v=Nm.indexOf(this.ArrayType),b=2*t*this.ArrayType.BYTES_PER_ELEMENT,T=t*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-T%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${c}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+T+P,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+b+T+P),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+T+P,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=t,this.coords[this._pos++]=a,c}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return vc(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,c,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:b,nodeSize:T}=this,P=[0,v.length-1,0],I=[];for(;P.length;){const D=P.pop()||0,L=P.pop()||0,q=P.pop()||0;if(L-q<=T){for(let se=q;se<=L;se++){const fe=b[2*se],Me=b[2*se+1];fe>=t&&fe<=c&&Me>=a&&Me<=p&&I.push(v[se])}continue}const G=q+L>>1,H=b[2*G],K=b[2*G+1];H>=t&&H<=c&&K>=a&&K<=p&&I.push(v[G]),(D===0?t<=H:a<=K)&&(P.push(q),P.push(G-1),P.push(1-D)),(D===0?c>=H:p>=K)&&(P.push(G+1),P.push(L),P.push(1-D))}return I}within(t,a,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:v,nodeSize:b}=this,T=[0,p.length-1,0],P=[],I=c*c;for(;T.length;){const D=T.pop()||0,L=T.pop()||0,q=T.pop()||0;if(L-q<=b){for(let se=q;se<=L;se++)cp(v[2*se],v[2*se+1],t,a)<=I&&P.push(p[se]);continue}const G=q+L>>1,H=v[2*G],K=v[2*G+1];cp(H,K,t,a)<=I&&P.push(p[G]),(D===0?t-c<=H:a-c<=K)&&(T.push(q),T.push(G-1),T.push(1-D)),(D===0?t+c>=H:a+c>=K)&&(T.push(G+1),T.push(L),T.push(1-D))}return P}}function vc(n,t,a,c,p,v){if(p-c<=a)return;const b=c+p>>1;Eh(n,t,b,c,p,v),vc(n,t,a,c,b-1,1-v),vc(n,t,a,b+1,p,1-v)}function Eh(n,t,a,c,p,v){for(;p>c;){if(p-c>600){const I=p-c+1,D=a-c+1,L=Math.log(I),q=.5*Math.exp(2*L/3),G=.5*Math.sqrt(L*q*(I-q)/I)*(D-I/2<0?-1:1);Eh(n,t,a,Math.max(c,Math.floor(a-D*q/I+G)),Math.min(p,Math.floor(a+(I-D)*q/I+G)),v)}const b=t[2*a+v];let T=c,P=p;for(Ch(n,t,c,a),t[2*p+v]>b&&Ch(n,t,c,p);T<P;){for(Ch(n,t,T,P),T++,P--;t[2*T+v]<b;)T++;for(;t[2*P+v]>b;)P--}t[2*c+v]===b?Ch(n,t,c,P):(P++,Ch(n,t,P,p)),P<=a&&(c=P+1),a<=P&&(p=P-1)}}function Ch(n,t,a,c){Ah(n,a,c),Ah(t,2*a,2*c),Ah(t,2*a+1,2*c+1)}function Ah(n,t,a){const c=n[t];n[t]=n[a],n[a]=c}function cp(n,t,a,c){const p=n-a,v=t-c;return p*p+v*v}var $d;E.co=void 0,($d=E.co||(E.co={})).create="create",$d.load="load",$d.fullLoad="fullLoad";let bu=null,kh=[];const up=1e3/60,Om="loadTime",hp="fullLoadTime",Gd={mark(n){performance.mark(n)},frame(n){const t=n;bu!=null&&kh.push(t-bu),bu=t},clearMetrics(){bu=null,kh=[],performance.clearMeasures(Om),performance.clearMeasures(hp);for(const n in E.co)performance.clearMarks(E.co[n])},getPerformanceMetrics(){performance.measure(Om,E.co.create,E.co.load),performance.measure(hp,E.co.create,E.co.fullLoad);const n=performance.getEntriesByName(Om)[0].duration,t=performance.getEntriesByName(hp)[0].duration,a=kh.length,c=1/(kh.reduce((v,b)=>v+b,0)/a/1e3),p=kh.filter(v=>v>up).reduce((v,b)=>v+(b-up)/up,0);return{loadTime:n,fullLoadTime:t,fps:c,percentDroppedFrames:p/(a+p)*100,totalFrames:a}}};E.$=mc,E.A=Ye,E.B=ts,E.C=Hr,E.D=Dt,E.E=Ce,E.F=hd,E.G=function(n){if(Ga==null){const t=n.navigator?n.navigator.userAgent:null;Ga=!!n.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ga},E.H=class{constructor(n,t){this.target=n,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Tm(()=>this.process()),this.subscription=Co(this.target,"message",a=>this.receive(a),!1),this.globalScope=$a(self)?n:window}registerMessageHandler(n,t){this.messageHandlers[n]=t}sendAsync(n,t){return new Promise((a,c)=>{const p=Math.round(1e18*Math.random()).toString(36).substring(0,10),v=t?Co(t.signal,"abort",()=>{v==null||v.unsubscribe(),delete this.resolveRejects[p];const P={id:p,type:"<cancel>",origin:location.origin,targetMapId:n.targetMapId,sourceMapId:this.mapId};this.target.postMessage(P)},Hg):null;this.resolveRejects[p]={resolve:P=>{v==null||v.unsubscribe(),a(P)},reject:P=>{v==null||v.unsubscribe(),c(P)}};const b=[],T=Object.assign(Object.assign({},n),{id:p,sourceMapId:this.mapId,origin:location.origin,data:wn(n.data,b)});this.target.postMessage(T,{transfer:b})})}receive(n){const t=n.data,a=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[a];const c=this.abortControllers[a];return delete this.abortControllers[a],void(c&&c.abort())}if($a(self)||t.mustQueue)return this.tasks[a]=t,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,t)}}process(){if(this.taskQueue.length===0)return;const n=this.taskQueue.shift(),t=this.tasks[n];delete this.tasks[n],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(n,t)}processTask(n,t){return l(this,void 0,void 0,function*(){if(t.type==="<response>"){const p=this.resolveRejects[n];return delete this.resolveRejects[n],p?void(t.error?p.reject(tl(t.error)):p.resolve(tl(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(n,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=tl(t.data),c=new AbortController;this.abortControllers[n]=c;try{const p=yield this.messageHandlers[t.type](t.sourceMapId,a,c);this.completeTask(n,null,p)}catch(p){this.completeTask(n,p)}})}completeTask(n,t,a){const c=[];delete this.abortControllers[n];const p={id:n,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?wn(t):null,data:wn(a,c)};this.target.postMessage(p,{transfer:c})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},E.I=Yf,E.J=Nl,E.K=function(){var n=new Ye(16);return Ye!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},E.L=function(n,t,a){var c,p,v,b,T,P,I,D,L,q,G,H,K=a[0],se=a[1],fe=a[2];return t===n?(n[12]=t[0]*K+t[4]*se+t[8]*fe+t[12],n[13]=t[1]*K+t[5]*se+t[9]*fe+t[13],n[14]=t[2]*K+t[6]*se+t[10]*fe+t[14],n[15]=t[3]*K+t[7]*se+t[11]*fe+t[15]):(p=t[1],v=t[2],b=t[3],T=t[4],P=t[5],I=t[6],D=t[7],L=t[8],q=t[9],G=t[10],H=t[11],n[0]=c=t[0],n[1]=p,n[2]=v,n[3]=b,n[4]=T,n[5]=P,n[6]=I,n[7]=D,n[8]=L,n[9]=q,n[10]=G,n[11]=H,n[12]=c*K+T*se+L*fe+t[12],n[13]=p*K+P*se+q*fe+t[13],n[14]=v*K+I*se+G*fe+t[14],n[15]=b*K+D*se+H*fe+t[15]),n},E.M=function(n,t,a){var c=a[0],p=a[1],v=a[2];return n[0]=t[0]*c,n[1]=t[1]*c,n[2]=t[2]*c,n[3]=t[3]*c,n[4]=t[4]*p,n[5]=t[5]*p,n[6]=t[6]*p,n[7]=t[7]*p,n[8]=t[8]*v,n[9]=t[9]*v,n[10]=t[10]*v,n[11]=t[11]*v,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},E.N=function(n,t,a){var c=t[0],p=t[1],v=t[2],b=t[3],T=t[4],P=t[5],I=t[6],D=t[7],L=t[8],q=t[9],G=t[10],H=t[11],K=t[12],se=t[13],fe=t[14],Me=t[15],me=a[0],$=a[1],ae=a[2],_e=a[3];return n[0]=me*c+$*T+ae*L+_e*K,n[1]=me*p+$*P+ae*q+_e*se,n[2]=me*v+$*I+ae*G+_e*fe,n[3]=me*b+$*D+ae*H+_e*Me,n[4]=(me=a[4])*c+($=a[5])*T+(ae=a[6])*L+(_e=a[7])*K,n[5]=me*p+$*P+ae*q+_e*se,n[6]=me*v+$*I+ae*G+_e*fe,n[7]=me*b+$*D+ae*H+_e*Me,n[8]=(me=a[8])*c+($=a[9])*T+(ae=a[10])*L+(_e=a[11])*K,n[9]=me*p+$*P+ae*q+_e*se,n[10]=me*v+$*I+ae*G+_e*fe,n[11]=me*b+$*D+ae*H+_e*Me,n[12]=(me=a[12])*c+($=a[13])*T+(ae=a[14])*L+(_e=a[15])*K,n[13]=me*p+$*P+ae*q+_e*se,n[14]=me*v+$*I+ae*G+_e*fe,n[15]=me*b+$*D+ae*H+_e*Me,n},E.O=function(n,t){const a={};for(let c=0;c<t.length;c++){const p=t[c];p in n&&(a[p]=n[p])}return a},E.P=te,E.Q=ps,E.R=ja,E.S=Wg,E.T=Sf,E.U=Mm,E.V=tt,E.W=vt,E.X=Eo,E.Y=Gn,E.Z=Je,E._=l,E.a=ws,E.a$=function(n,t,a){var c=Math.sin(a),p=Math.cos(a),v=t[4],b=t[5],T=t[6],P=t[7],I=t[8],D=t[9],L=t[10],q=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=v*p+I*c,n[5]=b*p+D*c,n[6]=T*p+L*c,n[7]=P*p+q*c,n[8]=I*p-v*c,n[9]=D*p-b*c,n[10]=L*p-T*c,n[11]=q*p-P*c,n},E.a0=25,E.a1=Fd,E.a2=n=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(a=>{t.onloadstart=()=>{a(t)};for(const c of n){const p=window.document.createElement("source");Re(c)||(t.crossOrigin="Anonymous"),p.src=c,t.appendChild(p)}})},E.a3=Qe,E.a4=function(){return wr++},E.a5=de,E.a6=gu,E.a7=Ca,E.a8=sl,E.a9=Cm,E.aA=function(n,t,a,c,p=!1){if(!a[0]&&!a[1])return[0,0];const v=p?c==="map"?-n.bearingInRadians:0:c==="viewport"?n.bearingInRadians:0;if(v){const b=Math.sin(v),T=Math.cos(v);a=[a[0]*T-a[1]*b,a[0]*b+a[1]*T]}return[p?a[0]:Pt(t,a[0],n.zoom),p?a[1]:Pt(t,a[1],n.zoom)]},E.aC=fs,E.aD=Rm,E.aE=Qf,E.aF=Lm,E.aG=ai,E.aH=ml,E.aI=Ke,E.aJ=Er,E.aK=yr,E.aL=rr,E.aM=Ji,E.aN=Em,E.aO=function(n,t,a){return n[0]=t[0]*a,n[1]=t[1]*a,n[2]=t[2]*a,n},E.aP=function(n,t,a){return n[0]=t[0]+a[0],n[1]=t[1]+a[1],n[2]=t[2]+a[2],n},E.aQ=function(n){var t=new Ye(3);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},E.aR=function(n,t,a){return n[0]=t[0]*a[0],n[1]=t[1]*a[1],n[2]=t[2]*a[2],n[3]=t[3]*a[3],n},E.aS=function(n,t,a){return n[0]=t[0]-a[0],n[1]=t[1]-a[1],n[2]=t[2]-a[2],n},E.aT=function(n,t){var a=t[0],c=t[1],p=t[2],v=a*a+c*c+p*p;return v>0&&(v=1/Math.sqrt(v)),n[0]=t[0]*v,n[1]=t[1]*v,n[2]=t[2]*v,n},E.aU=function(n,t,a){var c=t[0],p=t[1],v=t[2],b=a[0],T=a[1],P=a[2];return n[0]=p*P-v*T,n[1]=v*b-c*P,n[2]=c*T-p*b,n},E.aV=function(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]},E.aW=ba,E.aX=gc,E.aY=function(n,t,a,c,p){var v,b=1/Math.tan(t/2);return n[0]=b/a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=b,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,p!=null&&p!==1/0?(n[10]=(p+c)*(v=1/(c-p)),n[14]=2*p*c*v):(n[10]=-1,n[14]=-2*c),n},E.aZ=function(n){var t=new Ye(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},E.a_=function(n,t,a){var c=Math.sin(a),p=Math.cos(a),v=t[0],b=t[1],T=t[2],P=t[3],I=t[4],D=t[5],L=t[6],q=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=v*p+I*c,n[1]=b*p+D*c,n[2]=T*p+L*c,n[3]=P*p+q*c,n[4]=I*p-v*c,n[5]=D*p-b*c,n[6]=L*p-T*c,n[7]=q*p-P*c,n},E.aa=function(n){const t={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,c,p,v)=>{const b=p||v;return t[c]=!b||b.toLowerCase(),""}),t["max-age"]){const a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t},E.ab=Ao,E.ac=function(n){return Math.pow(2,n)},E.ad=ot,E.ae=Kt,E.af=85.051129,E.ag=Xg,E.ah=function(n){return Math.log(n)/Math.LN2},E.ai=function(n){var t=n[0],a=n[1];return t*t+a*a},E.aj=function(n,t){const a=[];for(const c in n)c in t||a.push(c);return a},E.ak=function(n,t){let a=0,c=0;if(n.kind==="constant")c=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:p,minZoom:v,maxZoom:b}=n,T=p?Kt(ma.interpolationFactor(p,t,v,b),0,1):0;n.kind==="camera"?c=ts.number(n.minSize,n.maxSize,T):a=T}return{uSizeT:a,uSize:c}},E.am=function(n,{uSize:t,uSizeT:a},{lowerSize:c,upperSize:p}){return n.kind==="source"?c/$n:n.kind==="composite"?ts.number(c/$n,p/$n,a):t},E.an=function(n,t){var a=t[0],c=t[1],p=t[2],v=t[3],b=t[4],T=t[5],P=t[6],I=t[7],D=t[8],L=t[9],q=t[10],G=t[11],H=t[12],K=t[13],se=t[14],fe=t[15],Me=a*T-c*b,me=a*P-p*b,$=a*I-v*b,ae=c*P-p*T,_e=c*I-v*T,Fe=p*I-v*P,ut=D*K-L*H,qe=D*se-q*H,Xe=D*fe-G*H,mt=L*se-q*K,dt=L*fe-G*K,gt=q*fe-G*se,it=Me*gt-me*dt+$*mt+ae*Xe-_e*qe+Fe*ut;return it?(n[0]=(T*gt-P*dt+I*mt)*(it=1/it),n[1]=(p*dt-c*gt-v*mt)*it,n[2]=(K*Fe-se*_e+fe*ae)*it,n[3]=(q*_e-L*Fe-G*ae)*it,n[4]=(P*Xe-b*gt-I*qe)*it,n[5]=(a*gt-p*Xe+v*qe)*it,n[6]=(se*$-H*Fe-fe*me)*it,n[7]=(D*Fe-q*$+G*me)*it,n[8]=(b*dt-T*Xe+I*ut)*it,n[9]=(c*Xe-a*dt-v*ut)*it,n[10]=(H*_e-K*$+fe*Me)*it,n[11]=(L*$-D*_e-G*Me)*it,n[12]=(T*qe-b*mt-P*ut)*it,n[13]=(a*mt-c*qe+p*ut)*it,n[14]=(K*me-H*ae-se*Me)*it,n[15]=(D*ae-L*me+q*Me)*it,n):null},E.ao=Mt,E.ap=function(n){return Math.hypot(n[0],n[1])},E.aq=function(n){return n[0]=0,n[1]=0,n},E.ar=function(n,t,a){return n[0]=t[0]*a,n[1]=t[1]*a,n},E.as=ep,E.at=er,E.au=function(n,t,a,c){const p=t.y-n.y,v=t.x-n.x,b=c.y-a.y,T=c.x-a.x,P=b*v-T*p;if(P===0)return null;const I=(T*(n.y-a.y)-b*(n.x-a.x))/P;return new te(n.x+I*v,n.y+I*p)},E.av=km,E.aw=po,E.ax=function(n){let t=1/0,a=1/0,c=-1/0,p=-1/0;for(const v of n)t=Math.min(t,v.x),a=Math.min(a,v.y),c=Math.max(c,v.x),p=Math.max(p,v.y);return[t,a,c,p]},E.ay=Lr,E.az=Pt,E.b=za,E.b$=class extends Y{},E.b0=function(){const n=new Float32Array(16);return ot(n),n},E.b1=function(){const n=new Float64Array(16);return ot(n),n},E.b2=function(){return new Float64Array(16)},E.b3=function(n,t,a){const c=new Float64Array(4);return function(p,v,b,T){var P=.5*Math.PI/180;v*=P,b*=P,T*=P;var I=Math.sin(v),D=Math.cos(v),L=Math.sin(b),q=Math.cos(b),G=Math.sin(T),H=Math.cos(T);p[0]=I*q*H-D*L*G,p[1]=D*L*H+I*q*G,p[2]=D*q*G-I*L*H,p[3]=D*q*H+I*L*G}(c,n,t-90,a),c},E.b4=function(n,t,a,c){var p,v,b,T,P,I=t[0],D=t[1],L=t[2],q=t[3],G=a[0],H=a[1],K=a[2],se=a[3];return(v=I*G+D*H+L*K+q*se)<0&&(v=-v,G=-G,H=-H,K=-K,se=-se),1-v>nt?(p=Math.acos(v),b=Math.sin(p),T=Math.sin((1-c)*p)/b,P=Math.sin(c*p)/b):(T=1-c,P=c),n[0]=T*I+P*G,n[1]=T*D+P*H,n[2]=T*L+P*K,n[3]=T*q+P*se,n},E.b5=function(n){const t=new Float64Array(9);var a,c,p,v,b,T,P,I,D,L,q,G,H,K,se,fe,Me,me;L=(p=(c=n)[0])*(P=p+p),q=(v=c[1])*P,H=(b=c[2])*P,K=b*(I=v+v),fe=(T=c[3])*P,Me=T*I,me=T*(D=b+b),(a=t)[0]=1-(G=v*I)-(se=b*D),a[3]=q-me,a[6]=H+Me,a[1]=q+me,a[4]=1-L-se,a[7]=K-fe,a[2]=H-Me,a[5]=K+fe,a[8]=1-L-G;const $=Ji(-Math.asin(Kt(t[2],-1,1)));let ae,_e;return Math.hypot(t[5],t[8])<.001?(ae=0,_e=-Ji(Math.atan2(t[3],t[4]))):(ae=Ji(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),_e=Ji(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:ae,pitch:$+90,bearing:_e}},E.b6=function(n,t){return n.roll==t.roll&&n.pitch==t.pitch&&n.bearing==t.bearing},E.b7=vr,E.b8=qi,E.b9=Un,E.bA=function(n){if(n.type==="custom")return new ip(n);switch(n.type){case"background":return new S_(n);case"circle":return new sc(n);case"fill":return new Ng(n);case"fill-extrusion":return new Cr(n);case"heatmap":return new bd(n);case"hillshade":return new zg(n);case"line":return new pm(n);case"raster":return new Sm(n);case"symbol":return new rp(n)}},E.bB=vi,E.bC=function(n,t){if(!n)return[{command:"setStyle",args:[t]}];let a=[];try{if(!Le(n.version,t.version))return[{command:"setStyle",args:[t]}];Le(n.center,t.center)||a.push({command:"setCenter",args:[t.center]}),Le(n.state,t.state)||a.push({command:"setGlobalState",args:[t.state]}),Le(n.centerAltitude,t.centerAltitude)||a.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Le(n.zoom,t.zoom)||a.push({command:"setZoom",args:[t.zoom]}),Le(n.bearing,t.bearing)||a.push({command:"setBearing",args:[t.bearing]}),Le(n.pitch,t.pitch)||a.push({command:"setPitch",args:[t.pitch]}),Le(n.roll,t.roll)||a.push({command:"setRoll",args:[t.roll]}),Le(n.sprite,t.sprite)||a.push({command:"setSprite",args:[t.sprite]}),Le(n.glyphs,t.glyphs)||a.push({command:"setGlyphs",args:[t.glyphs]}),Le(n.transition,t.transition)||a.push({command:"setTransition",args:[t.transition]}),Le(n.light,t.light)||a.push({command:"setLight",args:[t.light]}),Le(n.terrain,t.terrain)||a.push({command:"setTerrain",args:[t.terrain]}),Le(n.sky,t.sky)||a.push({command:"setSky",args:[t.sky]}),Le(n.projection,t.projection)||a.push({command:"setProjection",args:[t.projection]});const c={},p=[];(function(b,T,P,I){let D;for(D in T=T||{},b=b||{})Object.prototype.hasOwnProperty.call(b,D)&&(Object.prototype.hasOwnProperty.call(T,D)||ht(D,P,I));for(D in T)Object.prototype.hasOwnProperty.call(T,D)&&(Object.prototype.hasOwnProperty.call(b,D)?Le(b[D],T[D])||(b[D].type==="geojson"&&T[D].type==="geojson"&&Ct(b,T,D)?Ze(P,{command:"setGeoJSONSourceData",args:[D,T[D].data]}):Tt(D,T,P,I)):Ne(D,T,P))})(n.sources,t.sources,p,c);const v=[];n.layers&&n.layers.forEach(b=>{"source"in b&&c[b.source]?a.push({command:"removeLayer",args:[b.id]}):v.push(b)}),a=a.concat(p),function(b,T,P){T=T||[];const I=(b=b||[]).map(ar),D=T.map(ar),L=b.reduce(Xt,{}),q=T.reduce(Xt,{}),G=I.slice(),H=Object.create(null);let K,se,fe,Me,me;for(let $=0,ae=0;$<I.length;$++)K=I[$],Object.prototype.hasOwnProperty.call(q,K)?ae++:(Ze(P,{command:"removeLayer",args:[K]}),G.splice(G.indexOf(K,ae),1));for(let $=0,ae=0;$<D.length;$++)K=D[D.length-1-$],G[G.length-1-$]!==K&&(Object.prototype.hasOwnProperty.call(L,K)?(Ze(P,{command:"removeLayer",args:[K]}),G.splice(G.lastIndexOf(K,G.length-ae),1)):ae++,Me=G[G.length-$],Ze(P,{command:"addLayer",args:[q[K],Me]}),G.splice(G.length-$,0,K),H[K]=!0);for(let $=0;$<D.length;$++)if(K=D[$],se=L[K],fe=q[K],!H[K]&&!Le(se,fe))if(Le(se.source,fe.source)&&Le(se["source-layer"],fe["source-layer"])&&Le(se.type,fe.type)){for(me in Bt(se.layout,fe.layout,P,K,null,"setLayoutProperty"),Bt(se.paint,fe.paint,P,K,null,"setPaintProperty"),Le(se.filter,fe.filter)||Ze(P,{command:"setFilter",args:[K,fe.filter]}),Le(se.minzoom,fe.minzoom)&&Le(se.maxzoom,fe.maxzoom)||Ze(P,{command:"setLayerZoomRange",args:[K,fe.minzoom,fe.maxzoom]}),se)Object.prototype.hasOwnProperty.call(se,me)&&me!=="layout"&&me!=="paint"&&me!=="filter"&&me!=="metadata"&&me!=="minzoom"&&me!=="maxzoom"&&(me.indexOf("paint.")===0?Bt(se[me],fe[me],P,K,me.slice(6),"setPaintProperty"):Le(se[me],fe[me])||Ze(P,{command:"setLayerProperty",args:[K,me,fe[me]]}));for(me in fe)Object.prototype.hasOwnProperty.call(fe,me)&&!Object.prototype.hasOwnProperty.call(se,me)&&me!=="layout"&&me!=="paint"&&me!=="filter"&&me!=="metadata"&&me!=="minzoom"&&me!=="maxzoom"&&(me.indexOf("paint.")===0?Bt(se[me],fe[me],P,K,me.slice(6),"setPaintProperty"):Le(se[me],fe[me])||Ze(P,{command:"setLayerProperty",args:[K,me,fe[me]]}))}else Ze(P,{command:"removeLayer",args:[K]}),Me=G[G.lastIndexOf(K)+1],Ze(P,{command:"addLayer",args:[fe,Me]})}(v,t.layers,a)}catch(c){console.warn("Unable to compute style diff:",c),a=[{command:"setStyle",args:[t]}]}return a},E.bD=function(n){const t=[],a=n.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),n.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},E.bE=function n(t,a){if(Array.isArray(t)){if(!Array.isArray(a)||t.length!==a.length)return!1;for(let c=0;c<t.length;c++)if(!n(t[c],a[c]))return!1;return!0}if(typeof t=="object"&&t!==null&&a!==null){if(typeof a!="object"||Object.keys(t).length!==Object.keys(a).length)return!1;for(const c in t)if(!n(t[c],a[c]))return!1;return!0}return t===a},E.bF=$r,E.bG=Br,E.bH=class extends cr{constructor(n,t){super(n,t),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},E.bI=yd,E.bJ=class extends cr{constructor(n,t){super(n,t),this.current=Tf}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let t=1;t<16;t++)if(n[t]!==this.current[t]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},E.bK=gd,E.bL=class extends cr{constructor(n,t){super(n,t),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},E.bM=class extends cr{constructor(n,t){super(n,t),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},E.bN=st,E.bO=function(n,t){var a=Math.sin(t),c=Math.cos(t);return n[0]=c,n[1]=a,n[2]=0,n[3]=-a,n[4]=c,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},E.bP=function(n,t,a){var c=t[0],p=t[1],v=t[2];return n[0]=c*a[0]+p*a[3]+v*a[6],n[1]=c*a[1]+p*a[4]+v*a[7],n[2]=c*a[2]+p*a[5]+v*a[8],n},E.bQ=function(n,t,a,c,p,v,b){var T=1/(t-a),P=1/(c-p),I=1/(v-b);return n[0]=-2*T,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*P,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*I,n[11]=0,n[12]=(t+a)*T,n[13]=(p+c)*P,n[14]=(b+v)*I,n[15]=1,n},E.bR=class extends cr{constructor(n,t){super(n,t),this.current=new Array}set(n){if(n!=this.current){this.current=n;const t=new Float32Array(4*n.length);for(let a=0;a<n.length;a++)t[4*a]=n[a].r,t[4*a+1]=n[a].g,t[4*a+2]=n[a].b,t[4*a+3]=n[a].a;this.gl.uniform4fv(this.location,t)}}},E.bS=class extends cr{constructor(n,t){super(n,t),this.current=new Array}set(n){if(n!=this.current){this.current=n;const t=new Float32Array(n);this.gl.uniform1fv(this.location,t)}}},E.bT=class extends _{},E.bU=uu,E.bV=class extends A{},E.bW=zf,E.bX=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},E.bY=Jp,E.bZ=function(n,t,a){var c=t[0],p=t[1],v=t[2],b=a[3]*c+a[7]*p+a[11]*v+a[15];return n[0]=(a[0]*c+a[4]*p+a[8]*v+a[12])/(b=b||1),n[1]=(a[1]*c+a[5]*p+a[9]*v+a[13])/b,n[2]=(a[2]*c+a[6]*p+a[10]*v+a[14])/b,n},E.b_=class extends ho{},E.ba=lu,E.bb=Tn,E.bc=_t,E.bd=Ot,E.be=ra,E.bf=function(n,t,a,c,p){return _t(c,p,Kt((n-t)/(a-t),0,1))},E.bg=Se,E.bh=function(){return new Float64Array(3)},E.bi=function(n,t,a,c){return n[0]=t[0]+a[0]*c,n[1]=t[1]+a[1]*c,n[2]=t[2]+a[2]*c,n},E.bj=Yt,E.bk=function(){return new Float64Array(4)},E.bl=function(n,t,a,c){var p=[],v=[];return p[0]=t[0]-a[0],p[1]=t[1]-a[1],p[2]=t[2]-a[2],v[0]=p[0]*Math.cos(c)-p[1]*Math.sin(c),v[1]=p[0]*Math.sin(c)+p[1]*Math.cos(c),v[2]=p[2],n[0]=v[0]+a[0],n[1]=v[1]+a[1],n[2]=v[2]+a[2],n},E.bm=function(n,t,a,c){var p=[],v=[];return p[0]=t[0]-a[0],p[1]=t[1]-a[1],p[2]=t[2]-a[2],v[0]=p[0],v[1]=p[1]*Math.cos(c)-p[2]*Math.sin(c),v[2]=p[1]*Math.sin(c)+p[2]*Math.cos(c),n[0]=v[0]+a[0],n[1]=v[1]+a[1],n[2]=v[2]+a[2],n},E.bn=function(n,t,a,c){var p=[],v=[];return p[0]=t[0]-a[0],p[1]=t[1]-a[1],p[2]=t[2]-a[2],v[0]=p[2]*Math.sin(c)+p[0]*Math.cos(c),v[1]=p[1],v[2]=p[2]*Math.cos(c)-p[0]*Math.sin(c),n[0]=v[0]+a[0],n[1]=v[1]+a[1],n[2]=v[2]+a[2],n},E.bo=xt,E.bp=function(n,t,a){var c=Math.sin(a),p=Math.cos(a),v=t[0],b=t[1],T=t[2],P=t[3],I=t[8],D=t[9],L=t[10],q=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=v*p-I*c,n[1]=b*p-D*c,n[2]=T*p-L*c,n[3]=P*p-q*c,n[8]=v*c+I*p,n[9]=b*c+D*p,n[10]=T*c+L*p,n[11]=P*c+q*p,n},E.bq=function(n,t){const a=Se(n,360),c=Se(t,360),p=c-a,v=c>a?p-360:p+360;return Math.abs(p)<Math.abs(v)?p:v},E.br=function(n){return n[0]=0,n[1]=0,n[2]=0,n},E.bs=function(n,t,a,c){const p=Math.sqrt(n*n+t*t),v=Math.sqrt(a*a+c*c);n/=p,t/=p,a/=v,c/=v;const b=Math.acos(n*a+t*c);return-t*a+n*c>0?b:-b},E.bt=function(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]},E.bu=Od,E.bv=function(n,t){const a=Se(n,2*Math.PI),c=Se(t,2*Math.PI);return Math.min(Math.abs(a-c),Math.abs(a-c+2*Math.PI),Math.abs(a-c-2*Math.PI))},E.bw=function(){const n={},t=oe.$version;for(const a in oe.$root){const c=oe.$root[a];if(c.required){let p=null;p=a==="version"?t:c.type==="array"?[]:{},p!=null&&(n[a]=p)}}return n},E.bx=tc,E.by=ea,E.bz=function(n){n=n.slice();const t=Object.create(null);for(let a=0;a<n.length;a++)t[n[a].id]=n[a];for(let a=0;a<n.length;a++)"ref"in n[a]&&(n[a]=Pe(n[a],t[n[a].ref]));return n},E.c=cn,E.c0=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]&&n[8]===t[8]&&n[9]===t[9]&&n[10]===t[10]&&n[11]===t[11]&&n[12]===t[12]&&n[13]===t[13]&&n[14]===t[14]&&n[15]===t[15]},E.c1=function(n,t){var a=n[0],c=n[1],p=n[2],v=n[3],b=n[4],T=n[5],P=n[6],I=n[7],D=n[8],L=n[9],q=n[10],G=n[11],H=n[12],K=n[13],se=n[14],fe=n[15],Me=t[0],me=t[1],$=t[2],ae=t[3],_e=t[4],Fe=t[5],ut=t[6],qe=t[7],Xe=t[8],mt=t[9],dt=t[10],gt=t[11],it=t[12],jt=t[13],Ut=t[14],Gt=t[15];return Math.abs(a-Me)<=nt*Math.max(1,Math.abs(a),Math.abs(Me))&&Math.abs(c-me)<=nt*Math.max(1,Math.abs(c),Math.abs(me))&&Math.abs(p-$)<=nt*Math.max(1,Math.abs(p),Math.abs($))&&Math.abs(v-ae)<=nt*Math.max(1,Math.abs(v),Math.abs(ae))&&Math.abs(b-_e)<=nt*Math.max(1,Math.abs(b),Math.abs(_e))&&Math.abs(T-Fe)<=nt*Math.max(1,Math.abs(T),Math.abs(Fe))&&Math.abs(P-ut)<=nt*Math.max(1,Math.abs(P),Math.abs(ut))&&Math.abs(I-qe)<=nt*Math.max(1,Math.abs(I),Math.abs(qe))&&Math.abs(D-Xe)<=nt*Math.max(1,Math.abs(D),Math.abs(Xe))&&Math.abs(L-mt)<=nt*Math.max(1,Math.abs(L),Math.abs(mt))&&Math.abs(q-dt)<=nt*Math.max(1,Math.abs(q),Math.abs(dt))&&Math.abs(G-gt)<=nt*Math.max(1,Math.abs(G),Math.abs(gt))&&Math.abs(H-it)<=nt*Math.max(1,Math.abs(H),Math.abs(it))&&Math.abs(K-jt)<=nt*Math.max(1,Math.abs(K),Math.abs(jt))&&Math.abs(se-Ut)<=nt*Math.max(1,Math.abs(se),Math.abs(Ut))&&Math.abs(fe-Gt)<=nt*Math.max(1,Math.abs(fe),Math.abs(Gt))},E.c2=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},E.c3=n=>n.type==="symbol",E.c4=n=>n.type==="circle",E.c5=n=>n.type==="heatmap",E.c6=n=>n.type==="line",E.c7=n=>n.type==="fill",E.c8=n=>n.type==="fill-extrusion",E.c9=n=>n.type==="hillshade",E.cA=cc,E.cB=dm,E.cC=hc,E.cD=Ad,E.cE=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},E.cF=function(n,t,a,c,p){return l(this,void 0,void 0,function*(){if(vt())try{return yield Eo(n,t,a,c,p)}catch{}return function(v,b,T,P,I){const D=v.width,L=v.height;Sa&&ln||(Sa=new OffscreenCanvas(D,L),ln=Sa.getContext("2d",{willReadFrequently:!0})),Sa.width=D,Sa.height=L,ln.drawImage(v,0,0,D,L);const q=ln.getImageData(b,T,P,I);return ln.clearRect(0,0,D,L),q.data}(n,t,a,c,p)})},E.cG=np,E.cH=B,E.cI=ne,E.cJ=hm,E.cK=mm,E.cL=vn,E.cM=Dn,E.ca=n=>n.type==="raster",E.cb=n=>n.type==="background",E.cc=n=>n.type==="custom",E.cd=It,E.ce=function(n,t,a){const c=yt(t.x-a.x,t.y-a.y),p=yt(n.x-a.x,n.y-a.y);var v,b;return Ji(Math.atan2(c[0]*p[1]-c[1]*p[0],(v=c)[0]*(b=p)[0]+v[1]*b[1]))},E.cf=Et,E.cg=function(n,t){return ko[t]&&(n instanceof MouseEvent||n instanceof WheelEvent)},E.ch=function(n,t){return Dl[t]&&"touches"in n},E.ci=function(n){return Dl[n]||ko[n]},E.cj=function(n,t,a){var c=t[0],p=t[1];return n[0]=a[0]*c+a[4]*p+a[12],n[1]=a[1]*c+a[5]*p+a[13],n},E.ck=function(n,t){const{x:a,y:c}=mc.fromLngLat(t);return!(n<0||n>25||c<0||c>=1||a<0||a>=1)},E.cl=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},E.cm=class extends il{},E.cn=Gd,E.cp=function(n){return n.message===Po},E.cq=un,E.cr=function(n,t){ws.REGISTERED_PROTOCOLS[n]=t},E.cs=function(n){delete ws.REGISTERED_PROTOCOLS[n]},E.ct=function(n,t){const a={};for(let p=0;p<n.length;p++){const v=t&&t[n[p].id]||Kl(n[p]);t&&(t[n[p].id]=v);let b=a[v];b||(b=a[v]=[]),b.push(n[p])}const c=[];for(const p in a)c.push(a[p]);return c},E.cu=kt,E.cv=Ud,E.cw=Am,E.cx=ym,E.cy=function(n){n.bucket.createArrays(),n.bucket.tilePixelRatio=Je/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const t=n.bucket.layers[0],a=t.layout,c=t._unevaluatedLayout._values,p={layoutIconSize:c["icon-size"].possiblyEvaluate(new Hr(n.bucket.zoom+1),n.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new Hr(n.bucket.zoom+1),n.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new Hr(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:D}=n.bucket.textSizeData;p.compositeTextSizes=[c["text-size"].possiblyEvaluate(new Hr(I),n.canonical),c["text-size"].possiblyEvaluate(new Hr(D),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:D}=n.bucket.iconSizeData;p.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new Hr(I),n.canonical),c["icon-size"].possiblyEvaluate(new Hr(D),n.canonical)]}const v=a.get("text-line-height")*Lr,b=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",T=a.get("text-keep-upright"),P=a.get("text-size");for(const I of n.bucket.features){const D=a.get("text-font").evaluate(I,{},n.canonical).join(","),L=P.evaluate(I,{},n.canonical),q=p.layoutTextSize.evaluate(I,{},n.canonical),G=p.layoutIconSize.evaluate(I,{},n.canonical),H={horizontal:{},vertical:void 0},K=I.text;let se,fe=[0,0];if(K){const $=K.toString(),ae=a.get("text-letter-spacing").evaluate(I,{},n.canonical)*Lr,_e=gr($)?ae:0,Fe=a.get("text-anchor").evaluate(I,{},n.canonical),ut=e0(t,I,n.canonical);if(!ut){const dt=a.get("text-radial-offset").evaluate(I,{},n.canonical);fe=dt?Jg(Fe,[dt*Lr,Im]):a.get("text-offset").evaluate(I,{},n.canonical).map(gt=>gt*Lr)}let qe=b?"center":a.get("text-justify").evaluate(I,{},n.canonical);const Xe=a.get("symbol-placement")==="point"?a.get("text-max-width").evaluate(I,{},n.canonical)*Lr:1/0,mt=()=>{n.bucket.allowVerticalPlacement&&Rn($)&&(H.vertical=Kf(K,n.glyphMap,n.glyphPositions,n.imagePositions,D,Xe,v,Fe,"left",_e,fe,E.al.vertical,!0,q,L))};if(!b&&ut){const dt=new Set;if(qe==="auto")for(let it=0;it<ut.values.length;it+=2)dt.add(Rm(ut.values[it]));else dt.add(qe);let gt=!1;for(const it of dt)if(!H.horizontal[it])if(gt)H.horizontal[it]=H.horizontal[0];else{const jt=Kf(K,n.glyphMap,n.glyphPositions,n.imagePositions,D,Xe,v,"center",it,_e,fe,E.al.horizontal,!1,q,L);jt&&(H.horizontal[it]=jt,gt=jt.positionedLines.length===1)}mt()}else{qe==="auto"&&(qe=Rm(Fe));const dt=Kf(K,n.glyphMap,n.glyphPositions,n.imagePositions,D,Xe,v,Fe,qe,_e,fe,E.al.horizontal,!1,q,L);dt&&(H.horizontal[qe]=dt),mt(),Rn($)&&b&&T&&(H.vertical=Kf(K,n.glyphMap,n.glyphPositions,n.imagePositions,D,Xe,v,Fe,qe,_e,fe,E.al.vertical,!1,q,L))}}let Me=!1;if(I.icon&&I.icon.name){const $=n.imageMap[I.icon.name];$&&(se=b_(n.imagePositions[I.icon.name],a.get("icon-offset").evaluate(I,{},n.canonical),a.get("icon-anchor").evaluate(I,{},n.canonical)),Me=!!$.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=Me:n.bucket.sdfIcons!==Me&&hi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),($.pixelRatio!==n.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const me=xu(H.horizontal)||H.vertical;n.bucket.iconsInText=!!me&&me.iconsInText,(me||se)&&A_(n.bucket,I,H,se,n.imageMap,p,q,G,fe,Me,n.canonical,n.subdivisionGranularity)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},E.cz=bl,E.d=Re,E.e=qr,E.f=n=>l(void 0,void 0,void 0,function*(){if(n.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(n)],{type:"image/png"});try{return createImageBitmap(t)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),E.g=Ss,E.h=n=>new Promise((t,a)=>{const c=new Image;c.onload=()=>{t(c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=Gs})},c.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(n)],{type:"image/png"});c.src=n.byteLength?URL.createObjectURL(p):Gs}),E.i=$a,E.j=(n,t)=>Mi(qr(n,{type:"json"}),t),E.k=ye,E.l=le,E.m=Mi,E.n=(n,t)=>Mi(qr(n,{type:"arrayBuffer"}),t),E.o=function(n){return new Ad(n).readFields(y_,[])},E.p=fu,E.q=hl,E.r=wi,E.s=Co,E.t=Ai,E.u=dr,E.v=oe,E.w=hi,E.x=Wc,E.y=ec,E.z=function([n,t,a]){return t+=90,t*=Math.PI/180,a*=Math.PI/180,{x:n*Math.cos(t)*Math.sin(a),y:n*Math.sin(t)*Math.sin(a),z:n*Math.cos(a)}}}),C("worker",["./shared"],function(E){class l{constructor(Q){this.keyCache={},Q&&this.replace(Q)}replace(Q){this._layerConfigs={},this._layers={},this.update(Q,[])}update(Q,J){for(const ye of Q){this._layerConfigs[ye.id]=ye;const Ce=this._layers[ye.id]=E.bA(ye);Ce._featureFilter=E.a7(Ce.filter),this.keyCache[ye.id]&&delete this.keyCache[ye.id]}for(const ye of J)delete this.keyCache[ye],delete this._layerConfigs[ye],delete this._layers[ye];this.familiesBySource={};const le=E.ct(Object.values(this._layerConfigs),this.keyCache);for(const ye of le){const Ce=ye.map(Ne=>this._layers[Ne.id]),oe=Ce[0];if(oe.visibility==="none")continue;const Ue=oe.source||"";let Pe=this.familiesBySource[Ue];Pe||(Pe=this.familiesBySource[Ue]={});const Le=oe.sourceLayer||"_geojsonTileLayer";let Ze=Pe[Le];Ze||(Ze=Pe[Le]=[]),Ze.push(Ce)}}}class B{constructor(Q){const J={},le=[];for(const Ue in Q){const Pe=Q[Ue],Le=J[Ue]={};for(const Ze in Pe){const Ne=Pe[+Ze];if(!Ne||Ne.bitmap.width===0||Ne.bitmap.height===0)continue;const ht={x:0,y:0,w:Ne.bitmap.width+2,h:Ne.bitmap.height+2};le.push(ht),Le[Ze]={rect:ht,metrics:Ne.metrics}}}const{w:ye,h:Ce}=E.p(le),oe=new E.q({width:ye||1,height:Ce||1});for(const Ue in Q){const Pe=Q[Ue];for(const Le in Pe){const Ze=Pe[+Le];if(!Ze||Ze.bitmap.width===0||Ze.bitmap.height===0)continue;const Ne=J[Ue][Le].rect;E.q.copy(Ze.bitmap,oe,{x:0,y:0},{x:Ne.x+1,y:Ne.y+1},Ze.bitmap)}}this.image=oe,this.positions=J}}E.cu("GlyphAtlas",B);class V{constructor(Q){this.tileID=new E.Y(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),this.uid=Q.uid,this.zoom=Q.zoom,this.pixelRatio=Q.pixelRatio,this.tileSize=Q.tileSize,this.source=Q.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Q.showCollisionBoxes,this.collectResourceTiming=!!Q.collectResourceTiming,this.returnDependencies=!!Q.returnDependencies,this.promoteId=Q.promoteId,this.inFlightDependencies=[]}parse(Q,J,le,ye,Ce){return E._(this,void 0,void 0,function*(){this.status="parsing",this.data=Q,this.collisionBoxArray=new E.a5;const oe=new E.cv(Object.keys(Q.layers).sort()),Ue=new E.cw(this.tileID,this.promoteId);Ue.bucketLayerIDs=[];const Pe={},Le={featureIndex:Ue,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le,subdivisionGranularity:Ce},Ze=J.familiesBySource[this.source];for(const Zt in Ze){const rt=Q.layers[Zt];if(!rt)continue;rt.version===1&&E.w(`Vector tile source "${this.source}" layer "${Zt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Rt=oe.encode(Zt),Qt=[];for(let ii=0;ii<rt.length;ii++){const xi=rt.feature(ii),Ia=Ue.getId(xi,Zt);Qt.push({feature:xi,id:Ia,index:ii,sourceLayerIndex:Rt})}for(const ii of Ze[Zt]){const xi=ii[0];xi.source!==this.source&&E.w(`layer.source = ${xi.source} does not equal this.source = ${this.source}`),xi.minzoom&&this.zoom<Math.floor(xi.minzoom)||xi.maxzoom&&this.zoom>=xi.maxzoom||xi.visibility!=="none"&&(X(ii,this.zoom,le),(Pe[xi.id]=xi.createBucket({index:Ue.bucketLayerIDs.length,layers:ii,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Rt,sourceID:this.source})).populate(Qt,Le,this.tileID.canonical),Ue.bucketLayerIDs.push(ii.map(Ia=>Ia.id)))}}const Ne=E.bF(Le.glyphDependencies,Zt=>Object.keys(Zt).map(Number));this.inFlightDependencies.forEach(Zt=>Zt==null?void 0:Zt.abort()),this.inFlightDependencies=[];let ht=Promise.resolve({});if(Object.keys(Ne).length){const Zt=new AbortController;this.inFlightDependencies.push(Zt),ht=ye.sendAsync({type:"GG",data:{stacks:Ne,source:this.source,tileID:this.tileID,type:"glyphs"}},Zt)}const Tt=Object.keys(Le.iconDependencies);let Ct=Promise.resolve({});if(Tt.length){const Zt=new AbortController;this.inFlightDependencies.push(Zt),Ct=ye.sendAsync({type:"GI",data:{icons:Tt,source:this.source,tileID:this.tileID,type:"icons"}},Zt)}const Bt=Object.keys(Le.patternDependencies);let ar=Promise.resolve({});if(Bt.length){const Zt=new AbortController;this.inFlightDependencies.push(Zt),ar=ye.sendAsync({type:"GI",data:{icons:Bt,source:this.source,tileID:this.tileID,type:"patterns"}},Zt)}const[Xt,Qe,jr]=yield Promise.all([ht,Ct,ar]),fr=new B(Xt),Ar=new E.cx(Qe,jr);for(const Zt in Pe){const rt=Pe[Zt];rt instanceof E.a6?(X(rt.layers,this.zoom,le),E.cy({bucket:rt,glyphMap:Xt,glyphPositions:fr.positions,imageMap:Qe,imagePositions:Ar.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Le.subdivisionGranularity})):rt.hasPattern&&(rt instanceof E.cz||rt instanceof E.cA||rt instanceof E.cB)&&(X(rt.layers,this.zoom,le),rt.addFeatures(Le,this.tileID.canonical,Ar.patternPositions))}return this.status="done",{buckets:Object.values(Pe).filter(Zt=>!Zt.isEmpty()),featureIndex:Ue,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:fr.image,imageAtlas:Ar,glyphMap:this.returnDependencies?Xt:null,iconMap:this.returnDependencies?Qe:null,glyphPositions:this.returnDependencies?fr.positions:null}})}}function X(Re,Q,J){const le=new E.C(Q);for(const ye of Re)ye.recalculate(le,J)}class ne{constructor(Q,J,le){this.actor=Q,this.layerIndex=J,this.availableImages=le,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(Q,J){return E._(this,void 0,void 0,function*(){const le=yield E.n(Q.request,J);try{return{vectorTile:new E.cC.VectorTile(new E.cD(le.data)),rawData:le.data,cacheControl:le.cacheControl,expires:le.expires}}catch(ye){const Ce=new Uint8Array(le.data);let oe=`Unable to parse the tile at ${Q.request.url}, `;throw oe+=Ce[0]===31&&Ce[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ye.message}`,new Error(oe)}})}loadTile(Q){return E._(this,void 0,void 0,function*(){const J=Q.uid,le=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new E.cE(Q.request),ye=new V(Q);this.loading[J]=ye;const Ce=new AbortController;ye.abort=Ce;try{const oe=yield this.loadVectorTile(Q,Ce);if(delete this.loading[J],!oe)return null;const Ue=oe.rawData,Pe={};oe.expires&&(Pe.expires=oe.expires),oe.cacheControl&&(Pe.cacheControl=oe.cacheControl);const Le={};if(le){const Ne=le.finish();Ne&&(Le.resourceTiming=JSON.parse(JSON.stringify(Ne)))}ye.vectorTile=oe.vectorTile;const Ze=ye.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.actor,Q.subdivisionGranularity);this.loaded[J]=ye,this.fetching[J]={rawTileData:Ue,cacheControl:Pe,resourceTiming:Le};try{const Ne=yield Ze;return E.e({rawTileData:Ue.slice(0)},Ne,Pe,Le)}finally{delete this.fetching[J]}}catch(oe){throw delete this.loading[J],ye.status="done",this.loaded[J]=ye,oe}})}reloadTile(Q){return E._(this,void 0,void 0,function*(){const J=Q.uid;if(!this.loaded||!this.loaded[J])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const le=this.loaded[J];if(le.showCollisionBoxes=Q.showCollisionBoxes,le.status==="parsing"){const ye=yield le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor,Q.subdivisionGranularity);let Ce;if(this.fetching[J]){const{rawTileData:oe,cacheControl:Ue,resourceTiming:Pe}=this.fetching[J];delete this.fetching[J],Ce=E.e({rawTileData:oe.slice(0)},ye,Ue,Pe)}else Ce=ye;return Ce}if(le.status==="done"&&le.vectorTile)return le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor,Q.subdivisionGranularity)})}abortTile(Q){return E._(this,void 0,void 0,function*(){const J=this.loading,le=Q.uid;J&&J[le]&&J[le].abort&&(J[le].abort.abort(),delete J[le])})}removeTile(Q){return E._(this,void 0,void 0,function*(){this.loaded&&this.loaded[Q.uid]&&delete this.loaded[Q.uid]})}}class re{constructor(){this.loaded={}}loadTile(Q){return E._(this,void 0,void 0,function*(){const{uid:J,encoding:le,rawImageData:ye,redFactor:Ce,greenFactor:oe,blueFactor:Ue,baseShift:Pe}=Q,Le=ye.width+2,Ze=ye.height+2,Ne=E.b(ye)?new E.R({width:Le,height:Ze},yield E.cF(ye,-1,-1,Le,Ze)):ye,ht=new E.cG(J,Ne,le,Ce,oe,Ue,Pe);return this.loaded=this.loaded||{},this.loaded[J]=ht,ht})}removeTile(Q){const J=this.loaded,le=Q.uid;J&&J[le]&&delete J[le]}}var ee,te,be=function(){if(te)return ee;function Re(J,le){if(J.length!==0){Q(J[0],le);for(var ye=1;ye<J.length;ye++)Q(J[ye],!le)}}function Q(J,le){for(var ye=0,Ce=0,oe=0,Ue=J.length,Pe=Ue-1;oe<Ue;Pe=oe++){var Le=(J[oe][0]-J[Pe][0])*(J[Pe][1]+J[oe][1]),Ze=ye+Le;Ce+=Math.abs(ye)>=Math.abs(Le)?ye-Ze+Le:Le-Ze+ye,ye=Ze}ye+Ce>=0!=!!le&&J.reverse()}return te=1,ee=function J(le,ye){var Ce,oe=le&&le.type;if(oe==="FeatureCollection")for(Ce=0;Ce<le.features.length;Ce++)J(le.features[Ce],ye);else if(oe==="GeometryCollection")for(Ce=0;Ce<le.geometries.length;Ce++)J(le.geometries[Ce],ye);else if(oe==="Feature")J(le.geometry,ye);else if(oe==="Polygon")Re(le.coordinates,ye);else if(oe==="MultiPolygon")for(Ce=0;Ce<le.coordinates.length;Ce++)Re(le.coordinates[Ce],ye);return le}}(),Ee=E.cH(be);const Ae=E.cC.VectorTileFeature.prototype.toGeoJSON;class Ie{constructor(Q){this._feature=Q,this.extent=E.Z,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(this._feature.type===1){const Q=[];for(const J of this._feature.geometry)Q.push([new E.P(J[0],J[1])]);return Q}{const Q=[];for(const J of this._feature.geometry){const le=[];for(const ye of J)le.push(new E.P(ye[0],ye[1]));Q.push(le)}return Q}}toGeoJSON(Q,J,le){return Ae.call(this,Q,J,le)}}class tt{constructor(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=E.Z,this.length=Q.length,this._features=Q}feature(Q){return new Ie(this._features[Q])}}var vt,nt,Ye,st={exports:{}},ot=function(){if(Ye)return st.exports;Ye=1;var Re=E.cK(),Q=function(){if(nt)return vt;nt=1;var Ze=E.cI(),Ne=E.cJ().VectorTileFeature;function ht(Ct,Bt){this.options=Bt||{},this.features=Ct,this.length=Ct.length}function Tt(Ct,Bt){this.id=typeof Ct.id=="number"?Ct.id:void 0,this.type=Ct.type,this.rawGeometry=Ct.type===1?[Ct.geometry]:Ct.geometry,this.properties=Ct.tags,this.extent=Bt||4096}return vt=ht,ht.prototype.feature=function(Ct){return new Tt(this.features[Ct],this.options.extent)},Tt.prototype.loadGeometry=function(){var Ct=this.rawGeometry;this.geometry=[];for(var Bt=0;Bt<Ct.length;Bt++){for(var ar=Ct[Bt],Xt=[],Qe=0;Qe<ar.length;Qe++)Xt.push(new Ze(ar[Qe][0],ar[Qe][1]));this.geometry.push(Xt)}return this.geometry},Tt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ct=this.geometry,Bt=1/0,ar=-1/0,Xt=1/0,Qe=-1/0,jr=0;jr<Ct.length;jr++)for(var fr=Ct[jr],Ar=0;Ar<fr.length;Ar++){var Zt=fr[Ar];Bt=Math.min(Bt,Zt.x),ar=Math.max(ar,Zt.x),Xt=Math.min(Xt,Zt.y),Qe=Math.max(Qe,Zt.y)}return[Bt,Xt,ar,Qe]},Tt.prototype.toGeoJSON=Ne.prototype.toGeoJSON,vt}();function J(Ze){var Ne=new Re;return function(ht,Tt){for(var Ct in ht.layers)Tt.writeMessage(3,le,ht.layers[Ct])}(Ze,Ne),Ne.finish()}function le(Ze,Ne){var ht;Ne.writeVarintField(15,Ze.version||1),Ne.writeStringField(1,Ze.name||""),Ne.writeVarintField(5,Ze.extent||4096);var Tt={keys:[],values:[],keycache:{},valuecache:{}};for(ht=0;ht<Ze.length;ht++)Tt.feature=Ze.feature(ht),Ne.writeMessage(2,ye,Tt);var Ct=Tt.keys;for(ht=0;ht<Ct.length;ht++)Ne.writeStringField(3,Ct[ht]);var Bt=Tt.values;for(ht=0;ht<Bt.length;ht++)Ne.writeMessage(4,Le,Bt[ht])}function ye(Ze,Ne){var ht=Ze.feature;ht.id!==void 0&&Ne.writeVarintField(1,ht.id),Ne.writeMessage(2,Ce,Ze),Ne.writeVarintField(3,ht.type),Ne.writeMessage(4,Pe,ht)}function Ce(Ze,Ne){var ht=Ze.feature,Tt=Ze.keys,Ct=Ze.values,Bt=Ze.keycache,ar=Ze.valuecache;for(var Xt in ht.properties){var Qe=ht.properties[Xt],jr=Bt[Xt];if(Qe!==null){jr===void 0&&(Tt.push(Xt),Bt[Xt]=jr=Tt.length-1),Ne.writeVarint(jr);var fr=typeof Qe;fr!=="string"&&fr!=="boolean"&&fr!=="number"&&(Qe=JSON.stringify(Qe));var Ar=fr+":"+Qe,Zt=ar[Ar];Zt===void 0&&(Ct.push(Qe),ar[Ar]=Zt=Ct.length-1),Ne.writeVarint(Zt)}}}function oe(Ze,Ne){return(Ne<<3)+(7&Ze)}function Ue(Ze){return Ze<<1^Ze>>31}function Pe(Ze,Ne){for(var ht=Ze.loadGeometry(),Tt=Ze.type,Ct=0,Bt=0,ar=ht.length,Xt=0;Xt<ar;Xt++){var Qe=ht[Xt],jr=1;Tt===1&&(jr=Qe.length),Ne.writeVarint(oe(1,jr));for(var fr=Tt===3?Qe.length-1:Qe.length,Ar=0;Ar<fr;Ar++){Ar===1&&Tt!==1&&Ne.writeVarint(oe(2,fr-1));var Zt=Qe[Ar].x-Ct,rt=Qe[Ar].y-Bt;Ne.writeVarint(Ue(Zt)),Ne.writeVarint(Ue(rt)),Ct+=Zt,Bt+=rt}Tt===3&&Ne.writeVarint(oe(7,1))}}function Le(Ze,Ne){var ht=typeof Ze;ht==="string"?Ne.writeStringField(1,Ze):ht==="boolean"?Ne.writeBooleanField(7,Ze):ht==="number"&&(Ze%1!=0?Ne.writeDoubleField(3,Ze):Ze<0?Ne.writeSVarintField(6,Ze):Ne.writeVarintField(5,Ze))}return st.exports=J,st.exports.fromVectorTileJs=J,st.exports.fromGeojsonVt=function(Ze,Ne){Ne=Ne||{};var ht={};for(var Tt in Ze)ht[Tt]=new Q(Ze[Tt].features,Ne),ht[Tt].name=Tt,ht[Tt].version=Ne.version,ht[Tt].extent=Ne.extent;return J({layers:ht})},st.exports.GeoJSONWrapper=Q,st.exports}(),at=E.cH(ot);const xt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Re=>Re},zt=Math.fround||(Ht=new Float32Array(1),Re=>(Ht[0]=+Re,Ht[0]));var Ht;const Yt=3,er=5,Rr=6;class Mt{constructor(Q){this.options=Object.assign(Object.create(xt),Q),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Q){const{log:J,minZoom:le,maxZoom:ye}=this.options;J&&console.time("total time");const Ce=`prepare ${Q.length} points`;J&&console.time(Ce),this.points=Q;const oe=[];for(let Pe=0;Pe<Q.length;Pe++){const Le=Q[Pe];if(!Le.geometry)continue;const[Ze,Ne]=Le.geometry.coordinates,ht=zt(Pt(Ze)),Tt=zt(Se(Ne));oe.push(ht,Tt,1/0,Pe,-1,1),this.options.reduce&&oe.push(0)}let Ue=this.trees[ye+1]=this._createTree(oe);J&&console.timeEnd(Ce);for(let Pe=ye;Pe>=le;Pe--){const Le=+Date.now();Ue=this.trees[Pe]=this._createTree(this._cluster(Ue,Pe)),J&&console.log("z%d: %d clusters in %dms",Pe,Ue.numItems,+Date.now()-Le)}return J&&console.timeEnd("total time"),this}getClusters(Q,J){let le=((Q[0]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,Q[1]));let Ce=Q[2]===180?180:((Q[2]+180)%360+360)%360-180;const oe=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)le=-180,Ce=180;else if(le>Ce){const Ne=this.getClusters([le,ye,180,oe],J),ht=this.getClusters([-180,ye,Ce,oe],J);return Ne.concat(ht)}const Ue=this.trees[this._limitZoom(J)],Pe=Ue.range(Pt(le),Se(oe),Pt(Ce),Se(ye)),Le=Ue.data,Ze=[];for(const Ne of Pe){const ht=this.stride*Ne;Ze.push(Le[ht+er]>1?yt(Le,ht,this.clusterProps):this.points[Le[ht+Yt]])}return Ze}getChildren(Q){const J=this._getOriginId(Q),le=this._getOriginZoom(Q),ye="No cluster with the specified id.",Ce=this.trees[le];if(!Ce)throw new Error(ye);const oe=Ce.data;if(J*this.stride>=oe.length)throw new Error(ye);const Ue=this.options.radius/(this.options.extent*Math.pow(2,le-1)),Pe=Ce.within(oe[J*this.stride],oe[J*this.stride+1],Ue),Le=[];for(const Ze of Pe){const Ne=Ze*this.stride;oe[Ne+4]===Q&&Le.push(oe[Ne+er]>1?yt(oe,Ne,this.clusterProps):this.points[oe[Ne+Yt]])}if(Le.length===0)throw new Error(ye);return Le}getLeaves(Q,J,le){const ye=[];return this._appendLeaves(ye,Q,J=J||10,le=le||0,0),ye}getTile(Q,J,le){const ye=this.trees[this._limitZoom(Q)],Ce=Math.pow(2,Q),{extent:oe,radius:Ue}=this.options,Pe=Ue/oe,Le=(le-Pe)/Ce,Ze=(le+1+Pe)/Ce,Ne={features:[]};return this._addTileFeatures(ye.range((J-Pe)/Ce,Le,(J+1+Pe)/Ce,Ze),ye.data,J,le,Ce,Ne),J===0&&this._addTileFeatures(ye.range(1-Pe/Ce,Le,1,Ze),ye.data,Ce,le,Ce,Ne),J===Ce-1&&this._addTileFeatures(ye.range(0,Le,Pe/Ce,Ze),ye.data,-1,le,Ce,Ne),Ne.features.length?Ne:null}getClusterExpansionZoom(Q){let J=this._getOriginZoom(Q)-1;for(;J<=this.options.maxZoom;){const le=this.getChildren(Q);if(J++,le.length!==1)break;Q=le[0].properties.cluster_id}return J}_appendLeaves(Q,J,le,ye,Ce){const oe=this.getChildren(J);for(const Ue of oe){const Pe=Ue.properties;if(Pe&&Pe.cluster?Ce+Pe.point_count<=ye?Ce+=Pe.point_count:Ce=this._appendLeaves(Q,Pe.cluster_id,le,ye,Ce):Ce<ye?Ce++:Q.push(Ue),Q.length===le)break}return Ce}_createTree(Q){const J=new E.aF(Q.length/this.stride|0,this.options.nodeSize,Float32Array);for(let le=0;le<Q.length;le+=this.stride)J.add(Q[le],Q[le+1]);return J.finish(),J.data=Q,J}_addTileFeatures(Q,J,le,ye,Ce,oe){for(const Ue of Q){const Pe=Ue*this.stride,Le=J[Pe+er]>1;let Ze,Ne,ht;if(Le)Ze=Je(J,Pe,this.clusterProps),Ne=J[Pe],ht=J[Pe+1];else{const Bt=this.points[J[Pe+Yt]];Ze=Bt.properties;const[ar,Xt]=Bt.geometry.coordinates;Ne=Pt(ar),ht=Se(Xt)}const Tt={type:1,geometry:[[Math.round(this.options.extent*(Ne*Ce-le)),Math.round(this.options.extent*(ht*Ce-ye))]],tags:Ze};let Ct;Ct=Le||this.options.generateId?J[Pe+Yt]:this.points[J[Pe+Yt]].id,Ct!==void 0&&(Tt.id=Ct),oe.features.push(Tt)}}_limitZoom(Q){return Math.max(this.options.minZoom,Math.min(Math.floor(+Q),this.options.maxZoom+1))}_cluster(Q,J){const{radius:le,extent:ye,reduce:Ce,minPoints:oe}=this.options,Ue=le/(ye*Math.pow(2,J)),Pe=Q.data,Le=[],Ze=this.stride;for(let Ne=0;Ne<Pe.length;Ne+=Ze){if(Pe[Ne+2]<=J)continue;Pe[Ne+2]=J;const ht=Pe[Ne],Tt=Pe[Ne+1],Ct=Q.within(Pe[Ne],Pe[Ne+1],Ue),Bt=Pe[Ne+er];let ar=Bt;for(const Xt of Ct){const Qe=Xt*Ze;Pe[Qe+2]>J&&(ar+=Pe[Qe+er])}if(ar>Bt&&ar>=oe){let Xt,Qe=ht*Bt,jr=Tt*Bt,fr=-1;const Ar=((Ne/Ze|0)<<5)+(J+1)+this.points.length;for(const Zt of Ct){const rt=Zt*Ze;if(Pe[rt+2]<=J)continue;Pe[rt+2]=J;const Rt=Pe[rt+er];Qe+=Pe[rt]*Rt,jr+=Pe[rt+1]*Rt,Pe[rt+4]=Ar,Ce&&(Xt||(Xt=this._map(Pe,Ne,!0),fr=this.clusterProps.length,this.clusterProps.push(Xt)),Ce(Xt,this._map(Pe,rt)))}Pe[Ne+4]=Ar,Le.push(Qe/ar,jr/ar,1/0,Ar,-1,ar),Ce&&Le.push(fr)}else{for(let Xt=0;Xt<Ze;Xt++)Le.push(Pe[Ne+Xt]);if(ar>1)for(const Xt of Ct){const Qe=Xt*Ze;if(!(Pe[Qe+2]<=J)){Pe[Qe+2]=J;for(let jr=0;jr<Ze;jr++)Le.push(Pe[Qe+jr])}}}}return Le}_getOriginId(Q){return Q-this.points.length>>5}_getOriginZoom(Q){return(Q-this.points.length)%32}_map(Q,J,le){if(Q[J+er]>1){const oe=this.clusterProps[Q[J+Rr]];return le?Object.assign({},oe):oe}const ye=this.points[Q[J+Yt]].properties,Ce=this.options.map(ye);return le&&Ce===ye?Object.assign({},Ce):Ce}}function yt(Re,Q,J){return{type:"Feature",id:Re[Q+Yt],properties:Je(Re,Q,J),geometry:{type:"Point",coordinates:[(le=Re[Q],360*(le-.5)),_t(Re[Q+1])]}};var le}function Je(Re,Q,J){const le=Re[Q+er],ye=le>=1e4?`${Math.round(le/1e3)}k`:le>=1e3?Math.round(le/100)/10+"k":le,Ce=Re[Q+Rr],oe=Ce===-1?{}:Object.assign({},J[Ce]);return Object.assign(oe,{cluster:!0,cluster_id:Re[Q+Yt],point_count:le,point_count_abbreviated:ye})}function Pt(Re){return Re/360+.5}function Se(Re){const Q=Math.sin(Re*Math.PI/180),J=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return J<0?0:J>1?1:J}function _t(Re){const Q=(180-360*Re)*Math.PI/180;return 360*Math.atan(Math.exp(Q))/Math.PI-90}function Ot(Re,Q,J,le){let ye=le;const Ce=Q+(J-Q>>1);let oe,Ue=J-Q;const Pe=Re[Q],Le=Re[Q+1],Ze=Re[J],Ne=Re[J+1];for(let ht=Q+3;ht<J;ht+=3){const Tt=It(Re[ht],Re[ht+1],Pe,Le,Ze,Ne);if(Tt>ye)oe=ht,ye=Tt;else if(Tt===ye){const Ct=Math.abs(ht-Ce);Ct<Ue&&(oe=ht,Ue=Ct)}}ye>le&&(oe-Q>3&&Ot(Re,Q,oe,le),Re[oe+2]=ye,J-oe>3&&Ot(Re,oe,J,le))}function It(Re,Q,J,le,ye,Ce){let oe=ye-J,Ue=Ce-le;if(oe!==0||Ue!==0){const Pe=((Re-J)*oe+(Q-le)*Ue)/(oe*oe+Ue*Ue);Pe>1?(J=ye,le=Ce):Pe>0&&(J+=oe*Pe,le+=Ue*Pe)}return oe=Re-J,Ue=Q-le,oe*oe+Ue*Ue}function Et(Re,Q,J,le){const ye={id:Re??null,type:Q,geometry:J,tags:le,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Q==="Point"||Q==="MultiPoint"||Q==="LineString")Kt(ye,J);else if(Q==="Polygon")Kt(ye,J[0]);else if(Q==="MultiLineString")for(const Ce of J)Kt(ye,Ce);else if(Q==="MultiPolygon")for(const Ce of J)Kt(ye,Ce[0]);return ye}function Kt(Re,Q){for(let J=0;J<Q.length;J+=3)Re.minX=Math.min(Re.minX,Q[J]),Re.minY=Math.min(Re.minY,Q[J+1]),Re.maxX=Math.max(Re.maxX,Q[J]),Re.maxY=Math.max(Re.maxY,Q[J+1])}function rr(Re,Q,J,le){if(!Q.geometry)return;const ye=Q.geometry.coordinates;if(ye&&ye.length===0)return;const Ce=Q.geometry.type,oe=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2);let Ue=[],Pe=Q.id;if(J.promoteId?Pe=Q.properties[J.promoteId]:J.generateId&&(Pe=le||0),Ce==="Point")qr(ye,Ue);else if(Ce==="MultiPoint")for(const Le of ye)qr(Le,Ue);else if(Ce==="LineString")wr(ye,Ue,oe,!1);else if(Ce==="MultiLineString"){if(J.lineMetrics){for(const Le of ye)Ue=[],wr(Le,Ue,oe,!1),Re.push(Et(Pe,"LineString",Ue,Q.properties));return}$r(ye,Ue,oe,!1)}else if(Ce==="Polygon")$r(ye,Ue,oe,!0);else{if(Ce!=="MultiPolygon"){if(Ce==="GeometryCollection"){for(const Le of Q.geometry.geometries)rr(Re,{id:Pe,geometry:Le,properties:Q.properties},J,le);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Le of ye){const Ze=[];$r(Le,Ze,oe,!0),Ue.push(Ze)}}Re.push(Et(Pe,Ce,Ue,Q.properties))}function qr(Re,Q){Q.push(Br(Re[0]),vi(Re[1]),0)}function wr(Re,Q,J,le){let ye,Ce,oe=0;for(let Pe=0;Pe<Re.length;Pe++){const Le=Br(Re[Pe][0]),Ze=vi(Re[Pe][1]);Q.push(Le,Ze,0),Pe>0&&(oe+=le?(ye*Ze-Le*Ce)/2:Math.sqrt(Math.pow(Le-ye,2)+Math.pow(Ze-Ce,2))),ye=Le,Ce=Ze}const Ue=Q.length-3;Q[2]=1,Ot(Q,0,Ue,J),Q[Ue+2]=1,Q.size=Math.abs(oe),Q.start=0,Q.end=Q.size}function $r(Re,Q,J,le){for(let ye=0;ye<Re.length;ye++){const Ce=[];wr(Re[ye],Ce,J,le),Q.push(Ce)}}function Br(Re){return Re/360+.5}function vi(Re){const Q=Math.sin(Re*Math.PI/180),J=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return J<0?0:J>1?1:J}function Hi(Re,Q,J,le,ye,Ce,oe,Ue){if(le/=Q,Ce>=(J/=Q)&&oe<le)return Re;if(oe<J||Ce>=le)return null;const Pe=[];for(const Le of Re){const Ze=Le.geometry;let Ne=Le.type;const ht=ye===0?Le.minX:Le.minY,Tt=ye===0?Le.maxX:Le.maxY;if(ht>=J&&Tt<le){Pe.push(Le);continue}if(Tt<J||ht>=le)continue;let Ct=[];if(Ne==="Point"||Ne==="MultiPoint")hi(Ze,Ct,J,le,ye);else if(Ne==="LineString")Fr(Ze,Ct,J,le,ye,!1,Ue.lineMetrics);else if(Ne==="MultiLineString")Ga(Ze,Ct,J,le,ye,!1);else if(Ne==="Polygon")Ga(Ze,Ct,J,le,ye,!0);else if(Ne==="MultiPolygon")for(const Bt of Ze){const ar=[];Ga(Bt,ar,J,le,ye,!0),ar.length&&Ct.push(ar)}if(Ct.length){if(Ue.lineMetrics&&Ne==="LineString"){for(const Bt of Ct)Pe.push(Et(Le.id,Ne,Bt,Le.tags));continue}Ne!=="LineString"&&Ne!=="MultiLineString"||(Ct.length===1?(Ne="LineString",Ct=Ct[0]):Ne="MultiLineString"),Ne!=="Point"&&Ne!=="MultiPoint"||(Ne=Ct.length===3?"Point":"MultiPoint"),Pe.push(Et(Le.id,Ne,Ct,Le.tags))}}return Pe.length?Pe:null}function hi(Re,Q,J,le,ye){for(let Ce=0;Ce<Re.length;Ce+=3){const oe=Re[Ce+ye];oe>=J&&oe<=le&&za(Q,Re[Ce],Re[Ce+1],Re[Ce+2])}}function Fr(Re,Q,J,le,ye,Ce,oe){let Ue=$a(Re);const Pe=ye===0?Gs:Eo;let Le,Ze,Ne=Re.start;for(let ar=0;ar<Re.length-3;ar+=3){const Xt=Re[ar],Qe=Re[ar+1],jr=Re[ar+2],fr=Re[ar+3],Ar=Re[ar+4],Zt=ye===0?Xt:Qe,rt=ye===0?fr:Ar;let Rt=!1;oe&&(Le=Math.sqrt(Math.pow(Xt-fr,2)+Math.pow(Qe-Ar,2))),Zt<J?rt>J&&(Ze=Pe(Ue,Xt,Qe,fr,Ar,J),oe&&(Ue.start=Ne+Le*Ze)):Zt>le?rt<le&&(Ze=Pe(Ue,Xt,Qe,fr,Ar,le),oe&&(Ue.start=Ne+Le*Ze)):za(Ue,Xt,Qe,jr),rt<J&&Zt>=J&&(Ze=Pe(Ue,Xt,Qe,fr,Ar,J),Rt=!0),rt>le&&Zt<=le&&(Ze=Pe(Ue,Xt,Qe,fr,Ar,le),Rt=!0),!Ce&&Rt&&(oe&&(Ue.end=Ne+Le*Ze),Q.push(Ue),Ue=$a(Re)),oe&&(Ne+=Le)}let ht=Re.length-3;const Tt=Re[ht],Ct=Re[ht+1],Bt=ye===0?Tt:Ct;Bt>=J&&Bt<=le&&za(Ue,Tt,Ct,Re[ht+2]),ht=Ue.length-3,Ce&&ht>=3&&(Ue[ht]!==Ue[0]||Ue[ht+1]!==Ue[1])&&za(Ue,Ue[0],Ue[1],Ue[2]),Ue.length&&Q.push(Ue)}function $a(Re){const Q=[];return Q.size=Re.size,Q.start=Re.start,Q.end=Re.end,Q}function Ga(Re,Q,J,le,ye,Ce){for(const oe of Re)Fr(oe,Q,J,le,ye,Ce,!1)}function za(Re,Q,J,le){Re.push(Q,J,le)}function Gs(Re,Q,J,le,ye,Ce){const oe=(Ce-Q)/(le-Q);return za(Re,Ce,J+(ye-J)*oe,1),oe}function Eo(Re,Q,J,le,ye,Ce){const oe=(Ce-J)/(ye-J);return za(Re,Q+(le-Q)*oe,Ce,1),oe}function Sa(Re,Q){const J=[];for(let le=0;le<Re.length;le++){const ye=Re[le],Ce=ye.type;let oe;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")oe=ln(ye.geometry,Q);else if(Ce==="MultiLineString"||Ce==="Polygon"){oe=[];for(const Ue of ye.geometry)oe.push(ln(Ue,Q))}else if(Ce==="MultiPolygon"){oe=[];for(const Ue of ye.geometry){const Pe=[];for(const Le of Ue)Pe.push(ln(Le,Q));oe.push(Pe)}}J.push(Et(ye.id,Ce,oe,ye.tags))}return J}function ln(Re,Q){const J=[];J.size=Re.size,Re.start!==void 0&&(J.start=Re.start,J.end=Re.end);for(let le=0;le<Re.length;le+=3)J.push(Re[le]+Q,Re[le+1],Re[le+2]);return J}function Co(Re,Q){if(Re.transformed)return Re;const J=1<<Re.z,le=Re.x,ye=Re.y;for(const Ce of Re.features){const oe=Ce.geometry,Ue=Ce.type;if(Ce.geometry=[],Ue===1)for(let Pe=0;Pe<oe.length;Pe+=2)Ce.geometry.push(Ao(oe[Pe],oe[Pe+1],Q,J,le,ye));else for(let Pe=0;Pe<oe.length;Pe++){const Le=[];for(let Ze=0;Ze<oe[Pe].length;Ze+=2)Le.push(Ao(oe[Pe][Ze],oe[Pe][Ze+1],Q,J,le,ye));Ce.geometry.push(Le)}}return Re.transformed=!0,Re}function Ao(Re,Q,J,le,ye,Ce){return[Math.round(J*(Re*le-ye)),Math.round(J*(Q*le-Ce))]}function Ji(Re,Q,J,le,ye){const Ce=Q===ye.maxZoom?0:ye.tolerance/((1<<Q)*ye.extent),oe={features:[],numPoints:0,numSimplified:0,numFeatures:Re.length,source:null,x:J,y:le,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ue of Re)Dl(oe,Ue,Ce,ye);return oe}function Dl(Re,Q,J,le){const ye=Q.geometry,Ce=Q.type,oe=[];if(Re.minX=Math.min(Re.minX,Q.minX),Re.minY=Math.min(Re.minY,Q.minY),Re.maxX=Math.max(Re.maxX,Q.maxX),Re.maxY=Math.max(Re.maxY,Q.maxY),Ce==="Point"||Ce==="MultiPoint")for(let Ue=0;Ue<ye.length;Ue+=3)oe.push(ye[Ue],ye[Ue+1]),Re.numPoints++,Re.numSimplified++;else if(Ce==="LineString")ko(oe,ye,Re,J,!1,!1);else if(Ce==="MultiLineString"||Ce==="Polygon")for(let Ue=0;Ue<ye.length;Ue++)ko(oe,ye[Ue],Re,J,Ce==="Polygon",Ue===0);else if(Ce==="MultiPolygon")for(let Ue=0;Ue<ye.length;Ue++){const Pe=ye[Ue];for(let Le=0;Le<Pe.length;Le++)ko(oe,Pe[Le],Re,J,!0,Le===0)}if(oe.length){let Ue=Q.tags||null;if(Ce==="LineString"&&le.lineMetrics){Ue={};for(const Le in Q.tags)Ue[Le]=Q.tags[Le];Ue.mapbox_clip_start=ye.start/ye.size,Ue.mapbox_clip_end=ye.end/ye.size}const Pe={geometry:oe,type:Ce==="Polygon"||Ce==="MultiPolygon"?3:Ce==="LineString"||Ce==="MultiLineString"?2:1,tags:Ue};Q.id!==null&&(Pe.id=Q.id),Re.features.push(Pe)}}function ko(Re,Q,J,le,ye,Ce){const oe=le*le;if(le>0&&Q.size<(ye?oe:le))return void(J.numPoints+=Q.length/3);const Ue=[];for(let Pe=0;Pe<Q.length;Pe+=3)(le===0||Q[Pe+2]>oe)&&(J.numSimplified++,Ue.push(Q[Pe],Q[Pe+1])),J.numPoints++;ye&&function(Pe,Le){let Ze=0;for(let Ne=0,ht=Pe.length,Tt=ht-2;Ne<ht;Tt=Ne,Ne+=2)Ze+=(Pe[Ne]-Pe[Tt])*(Pe[Ne+1]+Pe[Tt+1]);if(Ze>0===Le)for(let Ne=0,ht=Pe.length;Ne<ht/2;Ne+=2){const Tt=Pe[Ne],Ct=Pe[Ne+1];Pe[Ne]=Pe[ht-2-Ne],Pe[Ne+1]=Pe[ht-1-Ne],Pe[ht-2-Ne]=Tt,Pe[ht-1-Ne]=Ct}}(Ue,Ce),Re.push(Ue)}const Po={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class cn{constructor(Q,J){const le=(J=this.options=function(Ce,oe){for(const Ue in oe)Ce[Ue]=oe[Ue];return Ce}(Object.create(Po),J)).debug;if(le&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");let ye=function(Ce,oe){const Ue=[];if(Ce.type==="FeatureCollection")for(let Pe=0;Pe<Ce.features.length;Pe++)rr(Ue,Ce.features[Pe],oe,Pe);else rr(Ue,Ce.type==="Feature"?Ce:{geometry:Ce},oe);return Ue}(Q,J);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ye=function(Ce,oe){const Ue=oe.buffer/oe.extent;let Pe=Ce;const Le=Hi(Ce,1,-1-Ue,Ue,0,-1,2,oe),Ze=Hi(Ce,1,1-Ue,2+Ue,0,-1,2,oe);return(Le||Ze)&&(Pe=Hi(Ce,1,-Ue,1+Ue,0,-1,2,oe)||[],Le&&(Pe=Sa(Le,1).concat(Pe)),Ze&&(Pe=Pe.concat(Sa(Ze,-1)))),Pe}(ye,J),ye.length&&this.splitTile(ye,0,0,0),le&&(ye.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Q,J,le,ye,Ce,oe,Ue){const Pe=[Q,J,le,ye],Le=this.options,Ze=Le.debug;for(;Pe.length;){ye=Pe.pop(),le=Pe.pop(),J=Pe.pop(),Q=Pe.pop();const Ne=1<<J,ht=ws(J,le,ye);let Tt=this.tiles[ht];if(!Tt&&(Ze>1&&console.time("creation"),Tt=this.tiles[ht]=Ji(Q,J,le,ye,Le),this.tileCoords.push({z:J,x:le,y:ye}),Ze)){Ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,le,ye,Tt.numFeatures,Tt.numPoints,Tt.numSimplified),console.timeEnd("creation"));const Rt=`z${J}`;this.stats[Rt]=(this.stats[Rt]||0)+1,this.total++}if(Tt.source=Q,Ce==null){if(J===Le.indexMaxZoom||Tt.numPoints<=Le.indexMaxPoints)continue}else{if(J===Le.maxZoom||J===Ce)continue;if(Ce!=null){const Rt=Ce-J;if(le!==oe>>Rt||ye!==Ue>>Rt)continue}}if(Tt.source=null,Q.length===0)continue;Ze>1&&console.time("clipping");const Ct=.5*Le.buffer/Le.extent,Bt=.5-Ct,ar=.5+Ct,Xt=1+Ct;let Qe=null,jr=null,fr=null,Ar=null,Zt=Hi(Q,Ne,le-Ct,le+ar,0,Tt.minX,Tt.maxX,Le),rt=Hi(Q,Ne,le+Bt,le+Xt,0,Tt.minX,Tt.maxX,Le);Q=null,Zt&&(Qe=Hi(Zt,Ne,ye-Ct,ye+ar,1,Tt.minY,Tt.maxY,Le),jr=Hi(Zt,Ne,ye+Bt,ye+Xt,1,Tt.minY,Tt.maxY,Le),Zt=null),rt&&(fr=Hi(rt,Ne,ye-Ct,ye+ar,1,Tt.minY,Tt.maxY,Le),Ar=Hi(rt,Ne,ye+Bt,ye+Xt,1,Tt.minY,Tt.maxY,Le),rt=null),Ze>1&&console.timeEnd("clipping"),Pe.push(Qe||[],J+1,2*le,2*ye),Pe.push(jr||[],J+1,2*le,2*ye+1),Pe.push(fr||[],J+1,2*le+1,2*ye),Pe.push(Ar||[],J+1,2*le+1,2*ye+1)}}getTile(Q,J,le){Q=+Q,J=+J,le=+le;const ye=this.options,{extent:Ce,debug:oe}=ye;if(Q<0||Q>24)return null;const Ue=1<<Q,Pe=ws(Q,J=J+Ue&Ue-1,le);if(this.tiles[Pe])return Co(this.tiles[Pe],Ce);oe>1&&console.log("drilling down to z%d-%d-%d",Q,J,le);let Le,Ze=Q,Ne=J,ht=le;for(;!Le&&Ze>0;)Ze--,Ne>>=1,ht>>=1,Le=this.tiles[ws(Ze,Ne,ht)];return Le&&Le.source?(oe>1&&(console.log("found parent tile z%d-%d-%d",Ze,Ne,ht),console.time("drilling down")),this.splitTile(Le.source,Ze,Ne,ht,Q,J,le),oe>1&&console.timeEnd("drilling down"),this.tiles[Pe]?Co(this.tiles[Pe],Ce):null):null}}function ws(Re,Q,J){return 32*((1<<Re)*J+Q)+Re}function Ss(Re,Q){return Q?Re.properties[Q]:Re.id}function Nl(Re,Q){if(Re==null)return!0;if(Re.type==="Feature")return Ss(Re,Q)!=null;if(Re.type==="FeatureCollection"){const J=new Set;for(const le of Re.features){const ye=Ss(le,Q);if(ye==null||J.has(ye))return!1;J.add(ye)}return!0}return!1}function un(Re,Q){const J=new Map;if(Re!=null)if(Re.type==="Feature")J.set(Ss(Re,Q),Re);else for(const le of Re.features)J.set(Ss(le,Q),le);return J}class ea extends ne{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(Q,J){return E._(this,void 0,void 0,function*(){const le=Q.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ye=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!ye)return null;const Ce=new tt(ye.features);let oe=at(Ce);return oe.byteOffset===0&&oe.byteLength===oe.buffer.byteLength||(oe=new Uint8Array(oe)),{vectorTile:Ce,rawData:oe.buffer}})}loadData(Q){return E._(this,void 0,void 0,function*(){var J;(J=this._pendingRequest)===null||J===void 0||J.abort();const le=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new E.cE(Q.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(Q,this._pendingRequest),this._geoJSONIndex=Q.cluster?new Mt(function({superclusterOptions:oe,clusterProperties:Ue}){if(!Ue||!oe)return oe;const Pe={},Le={},Ze={accumulated:null,zoom:0},Ne={properties:null},ht=Object.keys(Ue);for(const Tt of ht){const[Ct,Bt]=Ue[Tt],ar=E.cL(Bt),Xt=E.cL(typeof Ct=="string"?[Ct,["accumulated"],["get",Tt]]:Ct);Pe[Tt]=ar.value,Le[Tt]=Xt.value}return oe.map=Tt=>{Ne.properties=Tt;const Ct={};for(const Bt of ht)Ct[Bt]=Pe[Bt].evaluate(Ze,Ne);return Ct},oe.reduce=(Tt,Ct)=>{Ne.properties=Ct;for(const Bt of ht)Ze.accumulated=Tt[Bt],Tt[Bt]=Le[Bt].evaluate(Ze,Ne)},oe}(Q)).load((yield this._pendingData).features):(ye=yield this._pendingData,new cn(ye,Q.geojsonVtOptions)),this.loaded={};const Ce={};if(le){const oe=le.finish();oe&&(Ce.resourceTiming={},Ce.resourceTiming[Q.source]=JSON.parse(JSON.stringify(oe)))}return Ce}catch(Ce){if(delete this._pendingRequest,E.cp(Ce))return{abandoned:!0};throw Ce}var ye})}getData(){return E._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(Q){const J=this.loaded;return J&&J[Q.uid]?super.reloadTile(Q):this.loadTile(Q)}loadAndProcessGeoJSON(Q,J){return E._(this,void 0,void 0,function*(){let le=yield this.loadGeoJSON(Q,J);if(delete this._pendingRequest,typeof le!="object")throw new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`);if(Ee(le,!0),Q.filter){const ye=E.cL(Q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(oe=>`${oe.key}: ${oe.message}`).join(", "));le={type:"FeatureCollection",features:le.features.filter(oe=>ye.value.evaluate({zoom:0},oe))}}return le})}loadGeoJSON(Q,J){return E._(this,void 0,void 0,function*(){const{promoteId:le}=Q;if(Q.request){const ye=yield E.j(Q.request,J);return this._dataUpdateable=Nl(ye.data,le)?un(ye.data,le):void 0,ye.data}if(typeof Q.data=="string")try{const ye=JSON.parse(Q.data);return this._dataUpdateable=Nl(ye,le)?un(ye,le):void 0,ye}catch{throw new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`)}if(!Q.dataDiff)throw new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${Q.source}`);return function(ye,Ce,oe){var Ue,Pe,Le,Ze;if(Ce.removeAll&&ye.clear(),Ce.remove)for(const Ne of Ce.remove)ye.delete(Ne);if(Ce.add)for(const Ne of Ce.add){const ht=Ss(Ne,oe);ht!=null&&ye.set(ht,Ne)}if(Ce.update)for(const Ne of Ce.update){let ht=ye.get(Ne.id);if(ht==null)continue;const Tt=!Ne.removeAllProperties&&(((Ue=Ne.removeProperties)===null||Ue===void 0?void 0:Ue.length)>0||((Pe=Ne.addOrUpdateProperties)===null||Pe===void 0?void 0:Pe.length)>0);if((Ne.newGeometry||Ne.removeAllProperties||Tt)&&(ht=Object.assign({},ht),ye.set(Ne.id,ht),Tt&&(ht.properties=Object.assign({},ht.properties))),Ne.newGeometry&&(ht.geometry=Ne.newGeometry),Ne.removeAllProperties)ht.properties={};else if(((Le=Ne.removeProperties)===null||Le===void 0?void 0:Le.length)>0)for(const Ct of Ne.removeProperties)Object.prototype.hasOwnProperty.call(ht.properties,Ct)&&delete ht.properties[Ct];if(((Ze=Ne.addOrUpdateProperties)===null||Ze===void 0?void 0:Ze.length)>0)for(const{key:Ct,value:Bt}of Ne.addOrUpdateProperties)ht.properties[Ct]=Bt}}(this._dataUpdateable,Q.dataDiff,le),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(Q){return E._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(Q){return this._geoJSONIndex.getClusterExpansionZoom(Q.clusterId)}getClusterChildren(Q){return this._geoJSONIndex.getChildren(Q.clusterId)}getClusterLeaves(Q){return this._geoJSONIndex.getLeaves(Q.clusterId,Q.limit,Q.offset)}}class Mi{constructor(Q){this.self=Q,this.actor=new E.H(Q),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(J,le)=>{if(this.externalWorkerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.externalWorkerSourceTypes[J]=le},this.self.addProtocol=E.cr,this.self.removeProtocol=E.cs,this.self.registerRTLTextPlugin=J=>{E.cM.setMethods(J)},this.actor.registerMessageHandler("LDT",(J,le)=>this._getDEMWorkerSource(J,le.source).loadTile(le)),this.actor.registerMessageHandler("RDT",(J,le)=>E._(this,void 0,void 0,function*(){this._getDEMWorkerSource(J,le.source).removeTile(le)})),this.actor.registerMessageHandler("GCEZ",(J,le)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(J,le.type,le.source).getClusterExpansionZoom(le)})),this.actor.registerMessageHandler("GCC",(J,le)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(J,le.type,le.source).getClusterChildren(le)})),this.actor.registerMessageHandler("GCL",(J,le)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(J,le.type,le.source).getClusterLeaves(le)})),this.actor.registerMessageHandler("LD",(J,le)=>this._getWorkerSource(J,le.type,le.source).loadData(le)),this.actor.registerMessageHandler("GD",(J,le)=>this._getWorkerSource(J,le.type,le.source).getData()),this.actor.registerMessageHandler("LT",(J,le)=>this._getWorkerSource(J,le.type,le.source).loadTile(le)),this.actor.registerMessageHandler("RT",(J,le)=>this._getWorkerSource(J,le.type,le.source).reloadTile(le)),this.actor.registerMessageHandler("AT",(J,le)=>this._getWorkerSource(J,le.type,le.source).abortTile(le)),this.actor.registerMessageHandler("RMT",(J,le)=>this._getWorkerSource(J,le.type,le.source).removeTile(le)),this.actor.registerMessageHandler("RS",(J,le)=>E._(this,void 0,void 0,function*(){if(!this.workerSources[J]||!this.workerSources[J][le.type]||!this.workerSources[J][le.type][le.source])return;const ye=this.workerSources[J][le.type][le.source];delete this.workerSources[J][le.type][le.source],ye.removeSource!==void 0&&ye.removeSource(le)})),this.actor.registerMessageHandler("RM",J=>E._(this,void 0,void 0,function*(){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J]})),this.actor.registerMessageHandler("SR",(J,le)=>E._(this,void 0,void 0,function*(){this.referrer=le})),this.actor.registerMessageHandler("SRPS",(J,le)=>this._syncRTLPluginState(J,le)),this.actor.registerMessageHandler("IS",(J,le)=>E._(this,void 0,void 0,function*(){this.self.importScripts(le)})),this.actor.registerMessageHandler("SI",(J,le)=>this._setImages(J,le)),this.actor.registerMessageHandler("UL",(J,le)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(J).update(le.layers,le.removedIds)})),this.actor.registerMessageHandler("SL",(J,le)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(J).replace(le)}))}_setImages(Q,J){return E._(this,void 0,void 0,function*(){this.availableImages[Q]=J;for(const le in this.workerSources[Q]){const ye=this.workerSources[Q][le];for(const Ce in ye)ye[Ce].availableImages=J}})}_syncRTLPluginState(Q,J){return E._(this,void 0,void 0,function*(){return yield E.cM.syncState(J,this.self.importScripts)})}_getAvailableImages(Q){let J=this.availableImages[Q];return J||(J=[]),J}_getLayerIndex(Q){let J=this.layerIndexes[Q];return J||(J=this.layerIndexes[Q]=new l),J}_getWorkerSource(Q,J,le){if(this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][J]||(this.workerSources[Q][J]={}),!this.workerSources[Q][J][le]){const ye={sendAsync:(Ce,oe)=>(Ce.targetMapId=Q,this.actor.sendAsync(Ce,oe))};switch(J){case"vector":this.workerSources[Q][J][le]=new ne(ye,this._getLayerIndex(Q),this._getAvailableImages(Q));break;case"geojson":this.workerSources[Q][J][le]=new ea(ye,this._getLayerIndex(Q),this._getAvailableImages(Q));break;default:this.workerSources[Q][J][le]=new this.externalWorkerSourceTypes[J](ye,this._getLayerIndex(Q),this._getAvailableImages(Q))}}return this.workerSources[Q][J][le]}_getDEMWorkerSource(Q,J){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][J]||(this.demWorkerSources[Q][J]=new re),this.demWorkerSources[Q][J]}}return E.i(self)&&(self.worker=new Mi(self)),Mi}),C("index",["exports","./shared"],function(E,l){var B="5.5.0";function V(){var g=new l.A(4);return l.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g}let X,ne;const re={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(g,e,i){const u=requestAnimationFrame(_=>{f(),e(_)}),{unsubscribe:f}=l.s(g.signal,"abort",()=>{f(),cancelAnimationFrame(u),i(l.c())},!1)},frameAsync(g){return new Promise((e,i)=>{this.frame(g,e,i)})},getImageData(g,e=0){return this.getImageCanvasContext(g).getImageData(-e,-e,g.width+2*e,g.height+2*e)},getImageCanvasContext(g){const e=window.document.createElement("canvas"),i=e.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return e.width=g.width,e.height=g.height,i.drawImage(g,0,0,g.width,g.height),i},resolveURL:g=>(X||(X=document.createElement("a")),X.href=g,X.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ne==null&&(ne=matchMedia("(prefers-reduced-motion: reduce)")),ne.matches)}};class ee{static testProp(e){if(!ee.docStyle)return e[0];for(let i=0;i<e.length;i++)if(e[i]in ee.docStyle)return e[i];return e[0]}static create(e,i,u){const f=window.document.createElement(e);return i!==void 0&&(f.className=i),u&&u.appendChild(f),f}static createNS(e,i){return window.document.createElementNS(e,i)}static disableDrag(){ee.docStyle&&ee.selectProp&&(ee.userSelect=ee.docStyle[ee.selectProp],ee.docStyle[ee.selectProp]="none")}static enableDrag(){ee.docStyle&&ee.selectProp&&(ee.docStyle[ee.selectProp]=ee.userSelect)}static setTransform(e,i){e.style[ee.transformProp]=i}static addEventListener(e,i,u,f={}){e.addEventListener(i,u,"passive"in f?f:f.capture)}static removeEventListener(e,i,u,f={}){e.removeEventListener(i,u,"passive"in f?f:f.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",ee.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ee.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ee.suppressClickInternal,!0)},0)}static getScale(e){const i=e.getBoundingClientRect();return{x:i.width/e.offsetWidth||1,y:i.height/e.offsetHeight||1,boundingClientRect:i}}static getPoint(e,i,u){const f=i.boundingClientRect;return new l.P((u.clientX-f.left)/i.x-e.clientLeft,(u.clientY-f.top)/i.y-e.clientTop)}static mousePos(e,i){const u=ee.getScale(e);return ee.getPoint(e,u,i)}static touchPos(e,i){const u=[],f=ee.getScale(e);for(let _=0;_<i.length;_++)u.push(ee.getPoint(e,f,i[_]));return u}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const i=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),u=i.querySelectorAll("script");for(const f of u)f.remove();return ee.clean(i),i.innerHTML}static isPossiblyDangerous(e,i){const u=i.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!u.includes("javascript:")&&!u.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const i=e.children;for(const u of i)ee.removeAttributes(u),ee.clean(u)}static removeAttributes(e){for(const{name:i,value:u}of e.attributes)ee.isPossiblyDangerous(i,u)&&e.removeAttribute(i)}}ee.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ee.selectProp=ee.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ee.transformProp=ee.testProp(["transform","WebkitTransform"]);const te={supported:!1,testSupport:function(g){!Ae&&Ee&&(Ie?tt(g):be=g)}};let be,Ee,Ae=!1,Ie=!1;function tt(g){const e=g.createTexture();g.bindTexture(g.TEXTURE_2D,e);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,Ee),g.isContextLost())return;te.supported=!0}catch{}g.deleteTexture(e),Ae=!0}var vt;typeof document<"u"&&(Ee=document.createElement("img"),Ee.onload=()=>{be&&tt(be),be=null,Ie=!0},Ee.onerror=()=>{Ae=!0,be=null},Ee.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let e,i,u,f;g.resetRequestQueue=()=>{e=[],i=0,u=0,f={}},g.addThrottleControl=j=>{const R=u++;return f[R]=j,R},g.removeThrottleControl=j=>{delete f[j],S()},g.getImage=(j,R,N=!0)=>new Promise((F,U)=>{te.supported&&(j.headers||(j.headers={}),j.headers.accept="image/webp,*/*"),l.e(j,{type:"image"}),e.push({abortController:R,requestParameters:j,supportImageRefresh:N,state:"queued",onError:W=>{U(W)},onSuccess:W=>{F(W)}}),S()});const _=j=>l._(this,void 0,void 0,function*(){j.state="running";const{requestParameters:R,supportImageRefresh:N,onError:F,onSuccess:U,abortController:W}=j,Y=N===!1&&!l.i(self)&&!l.g(R.url)&&(!R.headers||Object.keys(R.headers).reduce((de,pe)=>de&&pe==="accept",!0));i++;const ue=Y?A(R,W):l.m(R,W);try{const de=yield ue;delete j.abortController,j.state="completed",de.data instanceof HTMLImageElement||l.b(de.data)?U(de):de.data&&U({data:yield(ce=de.data,typeof createImageBitmap=="function"?l.f(ce):l.h(ce)),cacheControl:de.cacheControl,expires:de.expires})}catch(de){delete j.abortController,F(de)}finally{i--,S()}var ce}),S=()=>{const j=(()=>{for(const R of Object.keys(f))if(f[R]())return!0;return!1})()?l.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let R=i;R<j&&e.length>0;R++){const N=e.shift();N.abortController.signal.aborted?R--:_(N)}},A=(j,R)=>new Promise((N,F)=>{const U=new Image,W=j.url,Y=j.credentials;Y&&Y==="include"?U.crossOrigin="use-credentials":(Y&&Y==="same-origin"||!l.d(W))&&(U.crossOrigin="anonymous"),R.signal.addEventListener("abort",()=>{U.src="",F(l.c())}),U.fetchPriority="high",U.onload=()=>{U.onerror=U.onload=null,N({data:U})},U.onerror=()=>{U.onerror=U.onload=null,R.signal.aborted||F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},U.src=W})}(vt||(vt={})),vt.resetRequestQueue();class nt{constructor(e){this._transformRequestFn=e}transformRequest(e,i){return this._transformRequestFn&&this._transformRequestFn(e,i)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Ye(g){const e=[];if(typeof g=="string")e.push({id:"default",url:g});else if(g&&g.length>0){const i=[];for(const{id:u,url:f}of g){const _=`${u}${f}`;i.indexOf(_)===-1&&(i.push(_),e.push({id:u,url:f}))}}return e}function st(g,e,i){try{const u=new URL(g);return u.pathname+=`${e}${i}`,u.toString()}catch{throw new Error(`Invalid sprite URL "${g}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class ot{constructor(e,i,u,f){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(i,f)}update(e,i,u){const{width:f,height:_}=e,S=!(this.size&&this.size[0]===f&&this.size[1]===_||u),{context:A}=this,{gl:j}=A;if(this.useMipmap=!!(i&&i.useMipmap),j.bindTexture(j.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===j.RGBA&&(!i||i.premultiply!==!1)),S)this.size=[f,_],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||l.b(e)?j.texImage2D(j.TEXTURE_2D,0,this.format,this.format,j.UNSIGNED_BYTE,e):j.texImage2D(j.TEXTURE_2D,0,this.format,f,_,0,this.format,j.UNSIGNED_BYTE,e.data);else{const{x:R,y:N}=u||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||l.b(e)?j.texSubImage2D(j.TEXTURE_2D,0,R,N,j.RGBA,j.UNSIGNED_BYTE,e):j.texSubImage2D(j.TEXTURE_2D,0,R,N,f,_,j.RGBA,j.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&j.generateMipmap(j.TEXTURE_2D),A.pixelStoreUnpackFlipY.setDefault(),A.pixelStoreUnpack.setDefault(),A.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,i,u){const{context:f}=this,{gl:_}=f;_.bindTexture(_.TEXTURE_2D,this.texture),u!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=_.LINEAR),e!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,e),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,u||e),this.filter=e),i!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,i),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function at(g){const{userImage:e}=g;return!!(e&&e.render&&e.render())&&(g.data.replace(new Uint8Array(e.data.buffer)),!0)}class xt extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:i,promiseResolve:u}of this.requestors)u(this._getImagesForIds(i));this.requestors=[]}}getImage(e){const i=this.images[e];if(i&&!i.data&&i.spriteData){const u=i.spriteData;i.data=new l.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),i.spriteData=null}return i}addImage(e,i){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,i)&&(this.images[e]=i)}_validate(e,i){let u=!0;const f=i.data||i.spriteData;return this._validateStretch(i.stretchX,f&&f.width)||(this.fire(new l.k(new Error(`Image "${e}" has invalid "stretchX" value`))),u=!1),this._validateStretch(i.stretchY,f&&f.height)||(this.fire(new l.k(new Error(`Image "${e}" has invalid "stretchY" value`))),u=!1),this._validateContent(i.content,i)||(this.fire(new l.k(new Error(`Image "${e}" has invalid "content" value`))),u=!1),u}_validateStretch(e,i){if(!e)return!0;let u=0;for(const f of e){if(f[0]<u||f[1]<f[0]||i<f[1])return!1;u=f[1]}return!0}_validateContent(e,i){if(!e)return!0;if(e.length!==4)return!1;const u=i.spriteData,f=u&&u.width||i.data.width,_=u&&u.height||i.data.height;return!(e[0]<0||f<e[0]||e[1]<0||_<e[1]||e[2]<0||f<e[2]||e[3]<0||_<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,i,u=!0){const f=this.getImage(e);if(u&&(f.data.width!==i.data.width||f.data.height!==i.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${i.data.width}x${i.data.height}).`);i.version=f.version+1,this.images[e]=i,this.updatedImages[e]=!0}removeImage(e){const i=this.images[e];delete this.images[e],delete this.patterns[e],i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((i,u)=>{let f=!0;if(!this.isLoaded())for(const _ of e)this.images[_]||(f=!1);this.isLoaded()||f?i(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:i})})}_getImagesForIds(e){const i={};for(const u of e){let f=this.getImage(u);f||(this.fire(new l.l("styleimagemissing",{id:u})),f=this.getImage(u)),f?i[u]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:l.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return i}getPixelSize(){const{width:e,height:i}=this.atlasImage;return{width:e,height:i}}getPattern(e){const i=this.patterns[e],u=this.getImage(e);if(!u)return null;if(i&&i.position.version===u.version)return i.position;if(i)i.position.version=u.version;else{const f={w:u.data.width+2,h:u.data.height+2,x:0,y:0},_=new l.I(f,u);this.patterns[e]={bin:f,position:_}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const i=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ot(e,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const _ in this.patterns)e.push(this.patterns[_].bin);const{w:i,h:u}=l.p(e),f=this.atlasImage;f.resize({width:i||1,height:u||1});for(const _ in this.patterns){const{bin:S}=this.patterns[_],A=S.x+1,j=S.y+1,R=this.getImage(_).data,N=R.width,F=R.height;l.R.copy(R,f,{x:0,y:0},{x:A,y:j},{width:N,height:F}),l.R.copy(R,f,{x:0,y:F-1},{x:A,y:j-1},{width:N,height:1}),l.R.copy(R,f,{x:0,y:0},{x:A,y:j+F},{width:N,height:1}),l.R.copy(R,f,{x:N-1,y:0},{x:A-1,y:j},{width:1,height:F}),l.R.copy(R,f,{x:0,y:0},{x:A+N,y:j},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const i of e){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const u=this.getImage(i);u||l.w(`Image with ID: "${i}" was not found`),at(u)&&this.updateImage(i,u)}}}const zt=1e20;function Ht(g,e,i,u,f,_,S,A,j){for(let R=e;R<e+u;R++)Yt(g,i*_+R,_,f,S,A,j);for(let R=i;R<i+f;R++)Yt(g,R*_+e,1,u,S,A,j)}function Yt(g,e,i,u,f,_,S){_[0]=0,S[0]=-1e20,S[1]=zt,f[0]=g[e];for(let A=1,j=0,R=0;A<u;A++){f[A]=g[e+A*i];const N=A*A;do{const F=_[j];R=(f[A]-f[F]+N-F*F)/(A-F)/2}while(R<=S[j]&&--j>-1);j++,_[j]=A,S[j]=R,S[j+1]=zt}for(let A=0,j=0;A<u;A++){for(;S[j+1]<A;)j++;const R=_[j],N=A-R;g[e+A*i]=f[R]+N*N}}class er{constructor(e,i){this.requestManager=e,this.localIdeographFontFamily=i,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return l._(this,void 0,void 0,function*(){const i=[];for(const _ in e)for(const S of e[_])i.push(this._getAndCacheGlyphsPromise(_,S));const u=yield Promise.all(i),f={};for(const{stack:_,id:S,glyph:A}of u)f[_]||(f[_]={}),f[_][S]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics};return f})}_getAndCacheGlyphsPromise(e,i){return l._(this,void 0,void 0,function*(){let u=this.entries[e];u||(u=this.entries[e]={glyphs:{},requests:{},ranges:{}});let f=u.glyphs[i];if(f!==void 0)return{stack:e,id:i,glyph:f};if(f=this._tinySDF(u,e,i),f)return u.glyphs[i]=f,{stack:e,id:i,glyph:f};const _=Math.floor(i/256);if(256*_>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[_])return{stack:e,id:i,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[_]){const A=er.loadGlyphRange(e,_,this.url,this.requestManager);u.requests[_]=A}const S=yield u.requests[_];for(const A in S)this._doesCharSupportLocalGlyph(+A)||(u.glyphs[+A]=S[+A]);return u.ranges[_]=!0,{stack:e,id:i,glyph:S[i]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||l.u["CJK Unified Ideographs"](e)||l.u["Hangul Syllables"](e)||l.u.Hiragana(e)||l.u.Katakana(e)||l.u["CJK Symbols and Punctuation"](e)||l.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,i,u){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(u))return;let _=e.tinySDF;if(!_){let A="400";/bold/i.test(i)?A="900":/medium/i.test(i)?A="500":/light/i.test(i)&&(A="200"),_=e.tinySDF=new er.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:A})}const S=_.draw(String.fromCharCode(u));return{id:u,bitmap:new l.q({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}er.loadGlyphRange=function(g,e,i,u){return l._(this,void 0,void 0,function*(){const f=256*e,_=f+255,S=u.transformRequest(i.replace("{fontstack}",g).replace("{range}",`${f}-${_}`),"Glyphs"),A=yield l.n(S,new AbortController);if(!A||!A.data)throw new Error(`Could not load glyph range. range: ${e}, ${f}-${_}`);const j={};for(const R of l.o(A.data))j[R.id]=R;return j})},er.TinySDF=class{constructor({fontSize:g=24,buffer:e=3,radius:i=8,cutoff:u=.25,fontFamily:f="sans-serif",fontWeight:_="normal",fontStyle:S="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=i;const A=this.size=g+4*e,j=this._createCanvas(A),R=this.ctx=j.getContext("2d",{willReadFrequently:!0});R.font=`${S} ${_} ${g}px ${f}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(g){const e=document.createElement("canvas");return e.width=e.height=g,e}draw(g){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:u,actualBoundingBoxLeft:f,actualBoundingBoxRight:_}=this.ctx.measureText(g),S=Math.ceil(i),A=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-f))),j=Math.min(this.size-this.buffer,S+Math.ceil(u)),R=A+2*this.buffer,N=j+2*this.buffer,F=Math.max(R*N,0),U=new Uint8ClampedArray(F),W={data:U,width:R,height:N,glyphWidth:A,glyphHeight:j,glyphTop:S,glyphLeft:0,glyphAdvance:e};if(A===0||j===0)return W;const{ctx:Y,buffer:ue,gridInner:ce,gridOuter:de}=this;Y.clearRect(ue,ue,A,j),Y.fillText(g,ue,ue+S);const pe=Y.getImageData(ue,ue,A,j);de.fill(zt,0,F),ce.fill(0,0,F);for(let xe=0;xe<j;xe++)for(let ve=0;ve<A;ve++){const we=pe.data[4*(xe*A+ve)+3]/255;if(we===0)continue;const ke=(xe+ue)*R+ve+ue;if(we===1)de[ke]=0,ce[ke]=zt;else{const Te=.5-we;de[ke]=Te>0?Te*Te:0,ce[ke]=Te<0?Te*Te:0}}Ht(de,0,0,R,N,R,this.f,this.v,this.z),Ht(ce,ue,ue,A,j,R,this.f,this.v,this.z);for(let xe=0;xe<F;xe++){const ve=Math.sqrt(de[xe])-Math.sqrt(ce[xe]);U[xe]=Math.round(255-255*(ve/this.radius+this.cutoff))}return W}};class Rr{constructor(){this.specification=l.v.light.position}possiblyEvaluate(e,i){return l.z(e.expression.evaluate(i))}interpolate(e,i,u){return{x:l.B.number(e.x,i.x,u),y:l.B.number(e.y,i.y,u),z:l.B.number(e.z,i.z,u)}}}let Mt;class yt extends l.E{constructor(e){super(),Mt=Mt||new l.r({anchor:new l.D(l.v.light.anchor),position:new Rr,color:new l.D(l.v.light.color),intensity:new l.D(l.v.light.intensity)}),this._transitionable=new l.T(Mt),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,i={}){if(!this._validate(l.t,e,i))for(const u in e){const f=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),f):this._transitionable.setValue(u,f)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,i,u){return(!u||u.validate!==!1)&&l.x(this,e.call(l.y,{value:i,style:{glyphs:!0,sprite:!0},styleSpec:l.v}))}}const Je=new l.r({"sky-color":new l.D(l.v.sky["sky-color"]),"horizon-color":new l.D(l.v.sky["horizon-color"]),"fog-color":new l.D(l.v.sky["fog-color"]),"fog-ground-blend":new l.D(l.v.sky["fog-ground-blend"]),"horizon-fog-blend":new l.D(l.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new l.D(l.v.sky["sky-horizon-blend"]),"atmosphere-blend":new l.D(l.v.sky["atmosphere-blend"])});class Pt extends l.E{constructor(e){super(),this._transitionable=new l.T(Je),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.C(0))}setSky(e,i={}){if(!this._validate(l.F,e,i)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const u in e){const f=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),f):this._transitionable.setValue(u,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,i,u={}){return(u==null?void 0:u.validate)!==!1&&l.x(this,e.call(l.y,l.e({value:i,style:{glyphs:!0,sprite:!0},styleSpec:l.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Se{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,i){const u=e.join(",")+String(i);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(e,i)),this.dashEntry[u]}getDashRanges(e,i,u){const f=[];let _=e.length%2==1?-e[e.length-1]*u:0,S=e[0]*u,A=!0;f.push({left:_,right:S,isDash:A,zeroLength:e[0]===0});let j=e[0];for(let R=1;R<e.length;R++){A=!A;const N=e[R];_=j*u,j+=N,S=j*u,f.push({left:_,right:S,isDash:A,zeroLength:N===0})}return f}addRoundDash(e,i,u){const f=i/2;for(let _=-u;_<=u;_++){const S=this.width*(this.nextRow+u+_);let A=0,j=e[A];for(let R=0;R<this.width;R++){R/j.right>1&&(j=e[++A]);const N=Math.abs(R-j.left),F=Math.abs(R-j.right),U=Math.min(N,F);let W;const Y=_/u*(f+1);if(j.isDash){const ue=f-Math.abs(Y);W=Math.sqrt(U*U+ue*ue)}else W=f-Math.sqrt(U*U+Y*Y);this.data[S+R]=Math.max(0,Math.min(255,W+128))}}}addRegularDash(e){for(let A=e.length-1;A>=0;--A){const j=e[A],R=e[A+1];j.zeroLength?e.splice(A,1):R&&R.isDash===j.isDash&&(R.left=j.left,e.splice(A,1))}const i=e[0],u=e[e.length-1];i.isDash===u.isDash&&(i.left=u.left-this.width,u.right=i.right+this.width);const f=this.width*this.nextRow;let _=0,S=e[_];for(let A=0;A<this.width;A++){A/S.right>1&&(S=e[++_]);const j=Math.abs(A-S.left),R=Math.abs(A-S.right),N=Math.min(j,R);this.data[f+A]=Math.max(0,Math.min(255,(S.isDash?N:-N)+128))}}addDash(e,i){const u=i?7:0,f=2*u+1;if(this.nextRow+f>this.height)return l.w("LineAtlas out of space"),null;let _=0;for(let A=0;A<e.length;A++)_+=e[A];if(_!==0){const A=this.width/_,j=this.getDashRanges(e,this.width,A);i?this.addRoundDash(j,A,u):this.addRegularDash(j)}const S={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:_};return this.nextRow+=f,this.dirty=!0,S}bind(e){const i=e.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))}}const _t="maplibre_preloaded_worker_pool";class Ot{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Ot.workerCount;)this.workers.push(new Worker(l.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[_t]}numActive(){return Object.keys(this.active).length}}const It=Math.floor(re.hardwareConcurrency/2);let Et,Kt;function rr(){return Et||(Et=new Ot),Et}Ot.workerCount=l.G(globalThis)?Math.max(Math.min(It,3),1):1;class qr{constructor(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=i;const u=this.workerPool.acquire(i);for(let f=0;f<u.length;f++){const _=new l.H(u[f],i);_.name=`Worker ${f}`,this.actors.push(_)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,i){const u=[];for(const f of this.actors)u.push(f.sendAsync({type:e,data:i}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(i=>{i.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,i){for(const u of this.actors)u.registerMessageHandler(e,i)}}function wr(){return Kt||(Kt=new qr(rr(),l.J),Kt.registerMessageHandler("GR",(g,e,i)=>l.m(e,i))),Kt}function $r(g,e){const i=l.K();return l.L(i,i,[1,1,0]),l.M(i,i,[.5*g.width,.5*g.height,1]),g.calculatePosMatrix?l.N(i,i,g.calculatePosMatrix(e.toUnwrapped())):i}function Br(g,e,i,u,f,_,S){var A;const j=function(U,W,Y){if(U)for(const ue of U){const ce=W[ue];if(ce&&ce.source===Y&&ce.type==="fill-extrusion")return!0}else for(const ue in W){const ce=W[ue];if(ce.source===Y&&ce.type==="fill-extrusion")return!0}return!1}((A=f==null?void 0:f.layers)!==null&&A!==void 0?A:null,e,g.id),R=_.maxPitchScaleFactor(),N=g.tilesIn(u,R,j);N.sort(vi);const F=[];for(const U of N)F.push({wrappedTileID:U.tileID.wrapped().key,queryResults:U.tile.queryRenderedFeatures(e,i,g._state,U.queryGeometry,U.cameraQueryGeometry,U.scale,f,_,R,$r(g.transform,U.tileID),S?(W,Y)=>S(U.tileID,W,Y):void 0)});return function(U,W){for(const Y in U)for(const ue of U[Y])Hi(ue,W);return U}(function(U){const W={},Y={};for(const ue of U){const ce=ue.queryResults,de=ue.wrappedTileID,pe=Y[de]=Y[de]||{};for(const xe in ce){const ve=ce[xe],we=pe[xe]=pe[xe]||{},ke=W[xe]=W[xe]||[];for(const Te of ve)we[Te.featureIndex]||(we[Te.featureIndex]=!0,ke.push(Te))}}return W}(F),g)}function vi(g,e){const i=g.tileID,u=e.tileID;return i.overscaledZ-u.overscaledZ||i.canonical.y-u.canonical.y||i.wrap-u.wrap||i.canonical.x-u.canonical.x}function Hi(g,e){const i=g.feature,u=e.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=u}function hi(g,e,i){return l._(this,void 0,void 0,function*(){let u=g;if(g.url?u=(yield l.j(e.transformRequest(g.url,"Source"),i)).data:yield re.frameAsync(i),!u)return null;const f=l.O(l.e(u,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(f.vectorLayerIds=u.vector_layers.map(_=>_.id)),f})}class Fr{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof l.Q?new l.Q(e.lng,e.lat):l.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof l.Q?new l.Q(e.lng,e.lat):l.Q.convert(e),this}extend(e){const i=this._sw,u=this._ne;let f,_;if(e instanceof l.Q)f=e,_=e;else{if(!(e instanceof Fr))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Fr.convert(e)):this.extend(l.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(l.Q.convert(e)):this;if(f=e._sw,_=e._ne,!f||!_)return this}return i||u?(i.lng=Math.min(f.lng,i.lng),i.lat=Math.min(f.lat,i.lat),u.lng=Math.max(_.lng,u.lng),u.lat=Math.max(_.lat,u.lat)):(this._sw=new l.Q(f.lng,f.lat),this._ne=new l.Q(_.lng,_.lat)),this}getCenter(){return new l.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.Q(this.getWest(),this.getNorth())}getSouthEast(){return new l.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:u}=l.Q.convert(e);let f=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f}static convert(e){return e instanceof Fr?e:e&&new Fr(e)}static fromLngLat(e,i=0){const u=360*i/40075017,f=u/Math.cos(Math.PI/180*e.lat);return new Fr(new l.Q(e.lng-f,e.lat-u),new l.Q(e.lng+f,e.lat+u))}adjustAntiMeridian(){const e=new l.Q(this._sw.lng,this._sw.lat),i=new l.Q(this._ne.lng,this._ne.lat);return new Fr(e,e.lng>i.lng?new l.Q(i.lng+360,i.lat):i)}}class $a{constructor(e,i,u){this.bounds=Fr.convert(this.validateBounds(e)),this.minzoom=i||0,this.maxzoom=u||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const i=Math.pow(2,e.z),u=Math.floor(l.U(this.bounds.getWest())*i),f=Math.floor(l.S(this.bounds.getNorth())*i),_=Math.ceil(l.U(this.bounds.getEast())*i),S=Math.ceil(l.S(this.bounds.getSouth())*i);return e.x>=u&&e.x<_&&e.y>=f&&e.y<S}}class Ga extends l.E{constructor(e,i,u,f){if(super(),this.id=e,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.O(i,["url","scheme","tileSize","promoteId"])),this._options=l.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return l._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield hi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(l.e(this,e),e.bounds&&(this.tileBounds=new $a(e.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new l.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return l.e({},this._options)}loadTile(e){return l._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(i,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};u.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((_,S)=>{e.reloadPromise={resolve:_,reject:S}})}else e.actor=this.dispatcher.getActor(),f="LT";e.abortController=new AbortController;try{const _=yield e.actor.sendAsync({type:f,data:u},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,_)}catch(_){if(delete e.abortController,e.aborted)return;if(_&&_.status!==404)throw _;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,i){if(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),i&&this.map._refreshExpiredTiles&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),e.reloadPromise){const u=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(u.resolve).catch(u.reject)}}abortTile(e){return l._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return l._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class za extends l.E{constructor(e,i,u,f){super(),this.id=e,this.dispatcher=u,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},i),l.e(this,l.O(i,["url","scheme","tileSize"]))}load(){return l._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield hi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,i&&(l.e(this,i),i.bounds&&(this.tileBounds=new $a(i.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(i){this._tileJSONRequest=null,this.fire(new l.k(i))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return l.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return l._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const u=yield vt.getImage(this.map._requestManager.transformRequest(i,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&(u.cacheControl||u.expires)&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const f=this.map.painter.context,_=f.gl,S=u.data;e.texture=this.map.painter.getTileTexture(S.width),e.texture?e.texture.update(S,{useMipmap:!0}):(e.texture=new ot(f,S,_.RGBA,{useMipmap:!0}),e.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}abortTile(e){return l._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return l._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class Gs extends za{constructor(e,i,u,f){super(e,i,u,f),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(e){return l._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(i,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const f=yield vt.getImage(u,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(f&&f.data){const _=f.data;this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&e.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const S=l.b(_)&&l.V()?_:yield this.readImageNow(_),A={type:this.type,uid:e.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const j=yield e.actor.sendAsync({type:"LDT",data:A});e.dem=j,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(f){if(delete e.abortController,e.aborted)e.state="unloaded";else if(f)throw e.state="errored",f}})}readImageNow(e){return l._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&l.W()){const i=e.width+2,u=e.height+2;try{return new l.R({width:i,height:u},yield l.X(e,-1,-1,i,u))}catch{}}return re.getImageData(e,1)})}_getNeighboringTiles(e){const i=e.canonical,u=Math.pow(2,i.z),f=(i.x-1+u)%u,_=i.x===0?e.wrap-1:e.wrap,S=(i.x+1+u)%u,A=i.x+1===u?e.wrap+1:e.wrap,j={};return j[new l.Y(e.overscaledZ,_,i.z,f,i.y).key]={backfilled:!1},j[new l.Y(e.overscaledZ,A,i.z,S,i.y).key]={backfilled:!1},i.y>0&&(j[new l.Y(e.overscaledZ,_,i.z,f,i.y-1).key]={backfilled:!1},j[new l.Y(e.overscaledZ,e.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},j[new l.Y(e.overscaledZ,A,i.z,S,i.y-1).key]={backfilled:!1}),i.y+1<u&&(j[new l.Y(e.overscaledZ,_,i.z,f,i.y+1).key]={backfilled:!1},j[new l.Y(e.overscaledZ,e.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},j[new l.Y(e.overscaledZ,A,i.z,S,i.y+1).key]={backfilled:!1}),j}unloadTile(e){return l._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Eo extends l.E{constructor(e,i,u,f){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(f),this._data=i.data,this._options=l.e({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId,i.clusterMaxZoom!==void 0&&this.maxzoom<=i.clusterMaxZoom&&l.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${i.clusterMaxZoom}".`),this.workerOptions=l.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(i.buffer!==void 0?i.buffer:128),tolerance:this._pixelsToTileUnits(i.tolerance!==void 0?i.tolerance:.375),extent:l.Z,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:l.Z,radius:this._pixelsToTileUnits(i.clusterRadius||50),log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(l.Z/this.tileSize)}load(){return l._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return l._(this,void 0,void 0,function*(){const e=l.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(i=>i.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return l._(this,void 0,void 0,function*(){const e=new Fr,i=yield this.getData();let u;switch(i.type){case"FeatureCollection":u=i.features.map(f=>this.getCoordinatesFromGeometry(f.geometry)).flat(1/0);break;case"Feature":u=this.getCoordinatesFromGeometry(i.geometry);break;default:u=this.getCoordinatesFromGeometry(i)}if(u.length==0)return e;for(let f=0;f<u.length-1;f+=2)e.extend([u[f],u[f+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,i,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:i,offset:u}})}_updateWorkerData(e){return l._(this,void 0,void 0,function*(){const i=l.e({type:this.type},this.workerOptions);e?i.dataDiff=e:typeof this._data=="string"?(i.request=this.map._requestManager.transformRequest(re.resolveURL(this._data),"Source"),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.l("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"LD",data:i});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new l.l("dataabort",{dataType:"source"}));let f=null;u.resourceTiming&&u.resourceTiming[this.id]&&(f=u.resourceTiming[this.id].slice(0));const _={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&l.e(_,{resourceTiming:f}),this.fire(new l.l("data",Object.assign(Object.assign({},_),{sourceDataType:"metadata"}))),this.fire(new l.l("data",Object.assign(Object.assign({},_),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new l.l("dataabort",{dataType:"source"}));this.fire(new l.k(u))}})}loaded(){return this._pendingLoads===0}loadTile(e){return l._(this,void 0,void 0,function*(){const i=e.actor?"RT":"LT";e.actor=this.actor;const u={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const f=yield this.actor.sendAsync({type:i,data:u},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(f,this.map.painter,i==="RT")})}abortTile(e){return l._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return l._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return l.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Sa extends l.E{constructor(e,i,u,f){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=u,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=i}load(e){return l._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const i=yield vt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,i&&i.data&&(this.image=i.data,e&&(this.coordinates=e),this._finishLoading())}catch(i){this._request=null,this._loaded=!0,this.fire(new l.k(i))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const i=e.map(l.$.fromLngLat);var u;return this.tileID=function(f){let _=1/0,S=1/0,A=-1/0,j=-1/0;for(const U of f)_=Math.min(_,U.x),S=Math.min(S,U.y),A=Math.max(A,U.x),j=Math.max(j,U.y);const R=Math.max(A-_,j-S),N=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),F=Math.pow(2,N);return new l.a1(N,Math.floor((_+A)/2*F),Math.floor((S+j)/2*F))}(i),this.terrainTileRanges=this._getOverlappingTileRanges(i),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=i.map(f=>this.tileID.getTilePoint(f)._round()),this.flippedWindingOrder=((u=this.tileCoords)[1].x-u[0].x)*(u[2].y-u[0].y)-(u[1].y-u[0].y)*(u[2].x-u[0].x)<0,this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,i=e.gl;this.texture||(this.texture=new ot(e,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let u=!1;for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,u=!0)}u&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return l._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){let i=1/0,u=1/0,f=-1/0,_=-1/0;for(const A of e)i=Math.min(i,A.x),u=Math.min(u,A.y),f=Math.max(f,A.x),_=Math.max(_,A.y);const S={};for(let A=0;A<=l.a0;A++){const j=Math.pow(2,A),R=Math.floor(i*j),N=Math.floor(u*j),F=Math.floor(f*j),U=Math.floor(_*j);S[A]={minTileX:R,minTileY:N,maxTileX:F,maxTileY:U}}return S}}class ln extends Sa{constructor(e,i,u,f){super(e,i,u,f),this.roundZoom=!0,this.type="video",this.options=i}load(){return l._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const i of e.urls)this.urls.push(this.map._requestManager.transformRequest(i,"Source").url);try{const i=yield l.a2(this.urls);if(this._loaded=!0,!i)return;this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(i){this.fire(new l.k(i))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const i=this.video.seekable;e<i.start(0)||e>i.end(0)?this.fire(new l.k(new l.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,i=e.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new ot(e,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let u=!1;for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,u=!0)}u&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Co extends Sa{constructor(e,i,u,f){super(e,i,u,f),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(S=>typeof S!="number"))||this.fire(new l.k(new l.a3(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.k(new l.a3(`sources.${e}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new l.k(new l.a3(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof HTMLCanvasElement||this.fire(new l.k(new l.a3(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.k(new l.a3(`sources.${e}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){return l._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context,u=i.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ot(i,this.canvas,u.RGBA,{premultiply:!0});let f=!1;for(const _ in this.tiles){const S=this.tiles[_];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,f=!0)}f&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Ao={},Ji=g=>{switch(g){case"geojson":return Eo;case"image":return Sa;case"raster":return za;case"raster-dem":return Gs;case"vector":return Ga;case"video":return ln;case"canvas":return Co}return Ao[g]},Dl="RTLPluginLoaded";class ko extends l.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=wr()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(i=>{throw this.status="error",i})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return l._(this,arguments,void 0,function*(i,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=re.resolveURL(i),!this.url)throw new Error(`requested url ${i} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return l._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new l.l(Dl))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Po=null;function cn(){return Po||(Po=new ko),Po}class ws{constructor(e,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=l.a4(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const i=e+this.timeAdded;i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,i,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(f,_){const S={};if(!_)return S;for(const A of f){const j=A.layerIds.map(R=>_.getLayer(R)).filter(Boolean);if(j.length!==0){A.layers=j,A.stateDependentLayerIds&&(A.stateDependentLayers=A.stateDependentLayerIds.map(R=>j.filter(N=>N.id===R)[0]));for(const R of j)S[R.id]=A}}return S}(e.buckets,i==null?void 0:i.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof l.a6){if(this.hasSymbolBuckets=!0,!u)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof l.a6&&_.hasRTLText){this.hasRTLText=!0,cn().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const _=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(f).queryRadius(_))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new l.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const u in this.buckets){const f=this.buckets[u];f.uploadPending()&&f.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ot(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ot(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,u,f,_,S,A,j,R,N,F){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:_,scale:S,tileSize:this.tileSize,pixelPosMatrix:N,transform:j,params:A,queryPadding:this.queryPadding*R,getElevation:F},e,i,u):{}}querySourceFeatures(e,i){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const f=u.loadVTLayers(),_=i&&i.sourceLayer?i.sourceLayer:"",S=f._geojsonTileLayer||f[_];if(!S)return;const A=l.a7(i&&i.filter),{z:j,x:R,y:N}=this.tileID.canonical,F={z:j,x:R,y:N};for(let U=0;U<S.length;U++){const W=S.feature(U);if(A.needGeometry){const ce=l.a8(W,!0);if(!A.filter(new l.C(this.tileID.overscaledZ),ce,this.tileID.canonical))continue}else if(!A.filter(new l.C(this.tileID.overscaledZ),W))continue;const Y=u.getId(W,_),ue=new l.a9(W,j,R,N,Y);ue.tile=F,e.push(ue)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const u=l.aa(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const u=Date.now();let f=!1;if(this.expirationTime>u)f=!1;else if(i)if(this.expirationTime<i)f=!0;else{const _=this.expirationTime-i;_?this.expirationTime=u+Math.max(_,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!i.style.hasLayer(f))continue;const _=this.buckets[f],S=_.layers[0].sourceLayer||"_geojsonTileLayer",A=u[S],j=e[S];if(!A||!j||Object.keys(j).length===0)continue;_.update(j,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});const R=i&&i.style&&i.style.getLayer(f);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(_)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<re.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=re.now()+e}setDependencies(e,i){const u={};for(const f of i)u[f]=!0;this.dependencies[e]=u}hasDependency(e,i){for(const u of e){const f=this.dependencies[u];if(f){for(const _ of i)if(f[_])return!0}}return!1}}class Ss{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,u){const f=e.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const _={value:i,timeout:void 0};if(u!==void 0&&(_.timeout=setTimeout(()=>{this.remove(e,_)},u)),this.data[f].push(_),this.order.push(f),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const u=e.wrapped().key,f=i===void 0?0:this.data[u].indexOf(i),_=this.data[u][f];return this.data[u].splice(f,1),_.timeout&&clearTimeout(_.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(_.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const u in this.data)for(const f of this.data[u])e(f.value)||i.push(f);for(const u of i)this.remove(u.value.tileID,u)}}class Nl{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,u){const f=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},l.e(this.stateChanges[e][f],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(const _ in this.state[e])_!==f&&(this.deletedStates[e][_]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][f]===null){this.deletedStates[e][f]={};for(const _ in this.state[e][f])u[_]||(this.deletedStates[e][f][_]=null)}else for(const _ in u)this.deletedStates[e]&&this.deletedStates[e][f]&&this.deletedStates[e][f][_]===null&&delete this.deletedStates[e][f][_]}removeFeatureState(e,i,u){if(this.deletedStates[e]===null)return;const f=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&i!==void 0)this.deletedStates[e][f]!==null&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][u]=null);else if(i!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][f])for(u in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][u]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}getState(e,i){const u=String(i),f=l.e({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const _=this.deletedStates[e][i];if(_===null)return{};for(const S in _)delete f[S]}return f}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const u={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const _={};for(const S in this.stateChanges[f])this.state[f][S]||(this.state[f][S]={}),l.e(this.state[f][S],this.stateChanges[f][S]),_[S]=this.state[f][S];u[f]=_}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const _={};if(this.deletedStates[f]===null)for(const S in this.state[f])_[S]={},this.state[f][S]={};else for(const S in this.deletedStates[f]){if(this.deletedStates[f][S]===null)this.state[f][S]={};else for(const A of Object.keys(this.deletedStates[f][S]))delete this.state[f][S][A];_[S]=this.state[f][S]}u[f]=u[f]||{},l.e(u[f],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const f in e)e[f].setFeatureState(u,i)}}const un=89.25;function ea(g,e){const i=l.ae(e.lat,-85.051129,l.af);return new l.P(l.U(e.lng)*g,l.S(i)*g)}function Mi(g,e){return new l.$(e.x/g,e.y/g).toLngLat()}function Re(g){return g.cameraToCenterDistance*Math.min(.85*Math.tan(l.ab(90-g.pitch)),Math.tan(l.ab(un-g.pitch)))}function Q(g,e){const i=g.canonical,u=e/l.ac(i.z),f=i.x+Math.pow(2,i.z)*g.wrap,_=l.ad(new Float64Array(16));return l.L(_,_,[f*u,i.y*u,0]),l.M(_,_,[u/l.Z,u/l.Z,1]),_}function J(g,e,i,u,f){const _=l.$.fromLngLat(g,e),S=f*l.ag(1,g.lat),A=S*Math.cos(l.ab(i)),j=Math.sqrt(S*S-A*A),R=j*Math.sin(l.ab(-u)),N=j*Math.cos(l.ab(-u));return new l.$(_.x+R,_.y+N,_.z+A)}function le(g,e,i){const u=e.intersectsFrustum(g);if(!i)return u;const f=e.intersectsPlane(i);return u===0||f===0?0:u===2&&f===2?2:1}function ye(g,e,i){let u=0;const f=(i-e)/10;for(let _=0;_<10;_++)u+=f*Math.pow(Math.cos(e+(_+.5)/10*(i-e)),g);return u}function Ce(g,e){return function(i,u,f,_,S){const A=2*((g-1)/l.ah(Math.cos(l.ab(un-S))/Math.cos(l.ab(un)))-1),j=Math.acos(f/_),R=2*ye(A-1,0,l.ab(S/2)),N=Math.min(l.ab(un),j+l.ab(S/2)),F=ye(A-1,Math.min(N,j-l.ab(S/2)),N),U=Math.atan(u/f),W=Math.hypot(u,f);let Y=i;return Y+=l.ah(_/W/Math.max(.5,Math.cos(l.ab(S/2)))),Y+=A*l.ah(Math.cos(U))/2,Y-=l.ah(Math.max(1,F/R/e))/2,Y}}const oe=Ce(9.314,3);function Ue(g,e){const i=(e.roundZoom?Math.round:Math.floor)(g.zoom+l.ah(g.tileSize/e.tileSize));return Math.max(0,i)}function Pe(g,e){const i=g.getCameraFrustum(),u=g.getClippingPlane(),f=g.screenPointToMercatorCoordinate(g.getCameraPoint()),_=l.$.fromLngLat(g.center,g.elevation);f.z=_.z+Math.cos(g.pitchInRadians)*g.cameraToCenterDistance/g.worldSize;const S=g.getCoveringTilesDetailsProvider(),A=S.allowVariableZoom(g,e),j=Ue(g,e),R=e.minzoom||0,N=e.maxzoom!==void 0?e.maxzoom:g.maxZoom,F=Math.min(Math.max(0,j),N),U=Math.pow(2,F),W=[U*f.x,U*f.y,0],Y=[U*_.x,U*_.y,0],ue=Math.hypot(_.x-f.x,_.y-f.y),ce=Math.abs(_.z-f.z),de=Math.hypot(ue,ce),pe=we=>({zoom:0,x:0,y:0,wrap:we,fullyVisible:!1}),xe=[],ve=[];if(g.renderWorldCopies&&S.allowWorldCopies())for(let we=1;we<=3;we++)xe.push(pe(-we)),xe.push(pe(we));for(xe.push(pe(0));xe.length>0;){const we=xe.pop(),ke=we.x,Te=we.y;let Ve=we.fullyVisible;const et={x:ke,y:Te,z:we.zoom},Ge=S.getTileAABB(et,we.wrap,g.elevation,e);if(!Ve){const wt=le(i,Ge,u);if(wt===0)continue;Ve=wt===2}const He=S.distanceToTile2d(f.x,f.y,et,Ge);let Ke=j;A&&(Ke=(e.calculateTileZoom||oe)(g.zoom+l.ah(g.tileSize/e.tileSize),He,ce,de,g.fov)),Ke=(e.roundZoom?Math.round:Math.floor)(Ke),Ke=Math.max(0,Ke);const St=Math.min(Ke,N);if(we.wrap=S.getWrap(_,et,we.wrap),we.zoom>=St){if(we.zoom<R)continue;const wt=F-we.zoom,ft=W[0]-.5-(ke<<wt),Lt=W[1]-.5-(Te<<wt),lr=e.reparseOverscaled?Math.max(we.zoom,Ke):we.zoom;ve.push({tileID:new l.Y(we.zoom===N?lr:we.zoom,we.wrap,we.zoom,ke,Te),distanceSq:l.ai([Y[0]-.5-ke,Y[1]-.5-Te]),tileDistanceToCamera:Math.sqrt(ft*ft+Lt*Lt)})}else for(let wt=0;wt<4;wt++)xe.push({zoom:we.zoom+1,x:(ke<<1)+wt%2,y:(Te<<1)+(wt>>1),wrap:we.wrap,fullyVisible:Ve})}return ve.sort((we,ke)=>we.distanceSq-ke.distanceSq).map(we=>we.tileID)}class Le extends l.E{constructor(e,i,u){super(),this.id=e,this.dispatcher=u,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,_,S,A)=>{const j=new(Ji(_.type))(f,_,S,A);if(j.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${j.id}`);return j})(e,i,u,this),this._tiles={},this._cache=new Ss(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Nl,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const i=this._tiles[e];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,i,u){return l._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,i,u)}catch(f){e.state="errored",f.status!==404?this._source.fire(new l.k(f,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new l.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const u=this._tiles[i];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Ze).map(e=>e.key)}getRenderableIds(e){const i=[];for(const u in this._tiles)this._isIdRenderable(u,e)&&i.push(this._tiles[u]);return e?i.sort((u,f)=>{const _=u.tileID,S=f.tileID,A=new l.P(_.canonical.x,_.canonical.y)._rotate(-this.transform.bearingInRadians),j=new l.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return _.overscaledZ-S.overscaledZ||j.y-A.y||j.x-A.x}).map(u=>u.tileID.key):i.map(u=>u.tileID).sort(Ze).map(u=>u.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)(e||this._tiles[i].state!=="errored")&&this._reloadTile(i,"reloading")}}_reloadTile(e,i){return l._(this,void 0,void 0,function*(){const u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=i),yield this._loadTile(u,e,i))})}_tileLoaded(e,i,u){e.timeAdded=re.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new l.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const i=this.getRenderableIds();for(let f=0;f<i.length;f++){const _=i[f];if(e.neighboringTiles&&e.neighboringTiles[_]){const S=this.getTileByID(_);u(e,S),u(S,e)}}function u(f,_){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let S=_.tileID.canonical.x-f.tileID.canonical.x;const A=_.tileID.canonical.y-f.tileID.canonical.y,j=Math.pow(2,f.tileID.canonical.z),R=_.tileID.key;S===0&&A===0||Math.abs(A)>1||(Math.abs(S)>1&&(Math.abs(S+j)===1?S+=j:Math.abs(S-j)===1&&(S-=j)),_.dem&&f.dem&&(f.dem.backfillBorder(_.dem,S,A),f.neighboringTiles&&f.neighboringTiles[R]&&(f.neighboringTiles[R].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,u,f){for(const _ in this._tiles){let S=this._tiles[_];if(f[_]||!S.hasData()||S.tileID.overscaledZ<=i||S.tileID.overscaledZ>u)continue;let A=S.tileID;for(;S&&S.tileID.overscaledZ>i+1;){const R=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[R.key],S&&S.hasData()&&(A=R)}let j=A;for(;j.overscaledZ>i;)if(j=j.scaledTo(j.overscaledZ-1),e[j.key]||e[j.canonical.key]){f[A.key]=A;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=i?u:null}for(let u=e.overscaledZ-1;u>=i;u--){const f=e.scaledTo(u),_=this._getLoadedTile(f);if(_)return _}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const i=Math.ceil(e.width/this._source.tileSize)+1,u=Math.ceil(e.height/this._source.tileSize)+1,f=Math.floor(i*u*(this._maxTileCacheZoomLevels===null?l.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(_)}handleWrapJump(e){const i=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,i){const u={};for(const f in this._tiles){const _=this._tiles[f];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+i),u[_.tileID.key]=_}this._tiles=u;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(e,i,u,f,_,S){const A={},j={},R=Object.keys(e),N=re.now();for(const F of R){const U=e[F],W=this._tiles[F];if(!W||W.fadeEndTime!==0&&W.fadeEndTime<=N)continue;const Y=this.findLoadedParent(U,i),ue=this.findLoadedSibling(U),ce=Y||ue||null;ce&&(this._addTile(ce.tileID),A[ce.tileID.key]=ce.tileID),j[F]=U}this._retainLoadedChildren(j,f,u,e);for(const F in A)e[F]||(this._coveredTiles[F]=!0,e[F]=A[F]);if(S){const F={},U={};for(const W of _)this._tiles[W.key].hasData()?F[W.key]=W:U[W.key]=W;for(const W in U){const Y=U[W].children(this._source.maxzoom);this._tiles[Y[0].key]&&this._tiles[Y[1].key]&&this._tiles[Y[2].key]&&this._tiles[Y[3].key]&&(F[Y[0].key]=e[Y[0].key]=Y[0],F[Y[1].key]=e[Y[1].key]=Y[1],F[Y[2].key]=e[Y[2].key]=Y[2],F[Y[3].key]=e[Y[3].key]=Y[3],delete U[W])}for(const W in U){const Y=U[W],ue=this.findLoadedParent(Y,this._source.minzoom),ce=this.findLoadedSibling(Y),de=ue||ce||null;if(de){F[de.tileID.key]=e[de.tileID.key]=de.tileID;for(const pe in F)F[pe].isChildOf(de.tileID)&&delete F[pe]}}for(const W in this._tiles)F[W]||(this._coveredTiles[W]=!0)}}update(e,i){if(!this._sourceLoaded||this._paused)return;let u;this.transform=e,this.terrain=i,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(N=>new l.Y(N.canonical.z,N.wrap,N.canonical.z,N.canonical.x,N.canonical.y)):(u=Pe(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(u=u.filter(N=>this._source.hasTile(N)))):u=[];const f=Ue(e,this._source),_=Math.max(f-Le.maxOverzooming,this._source.minzoom),S=Math.max(f+Le.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const N={};for(const F of u)if(F.canonical.z>this._source.minzoom){const U=F.scaledTo(F.canonical.z-1);N[U.key]=U;const W=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));N[W.key]=W}u=u.concat(Object.values(N))}const A=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,A&&this.fire(new l.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const j=this._updateRetainedTiles(u,f);Ne(this._source.type)&&this._updateCoveredAndRetainedTiles(j,_,S,f,u,i);for(const N in j)this._tiles[N].clearFadeHold();const R=l.aj(this._tiles,j);for(const N of R){const F=this._tiles[N];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(N)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,i){var u;const f={},_={},S=Math.max(i-Le.maxOverzooming,this._source.minzoom),A=Math.max(i+Le.maxUnderzooming,this._source.minzoom),j={};for(const R of e){const N=this._addTile(R);f[R.key]=R,N.hasData()||i<this._source.maxzoom&&(j[R.key]=R)}this._retainLoadedChildren(j,i,A,f);for(const R of e){let N=this._tiles[R.key];if(N.hasData())continue;if(i+1>this._source.maxzoom){const U=R.children(this._source.maxzoom)[0],W=this.getTile(U);if(W&&W.hasData()){f[U.key]=U;continue}}else{const U=R.children(this._source.maxzoom);if(f[U[0].key]&&f[U[1].key]&&f[U[2].key]&&f[U[3].key])continue}let F=N.wasRequested();for(let U=R.overscaledZ-1;U>=S;--U){const W=R.scaledTo(U);if(_[W.key])break;if(_[W.key]=!0,N=this.getTile(W),!N&&F&&(N=this._addTile(W)),N){const Y=N.hasData();if((Y||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||F)&&(f[W.key]=W),F=N.wasRequested(),Y)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let u,f=this._tiles[e].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){u=this._loadedParentTiles[f.key];break}i.push(f.key);const _=f.scaledTo(f.overscaledZ-1);if(u=this._getLoadedTile(_),u)break;f=_}for(const _ of i)this._loadedParentTiles[_]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const i=this._tiles[e].tileID,u=this._getLoadedTile(i);this._loadedSiblingTiles[i.key]=u}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const u=i;return i||(i=new ws(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(i,e.key,i.state)),i.uses++,this._tiles[e.key]=i,u||this._source.fire(new l.l("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const u=i.getExpiryTimeout();u&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},u))}refreshTiles(e){for(const i in this._tiles)this._isIdRenderable(i)&&e.some(u=>u.equals(this._tiles[i].tileID.canonical))&&this._reloadTile(i,"expired")}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}_dataHandler(e){const i=e.sourceDataType;e.dataType==="source"&&i==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&i==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,i,u){const f=[],_=this.transform;if(!_)return f;const S=u?_.getCameraQueryGeometry(e):e,A=e.map(Y=>_.screenPointToMercatorCoordinate(Y,this.terrain)),j=S.map(Y=>_.screenPointToMercatorCoordinate(Y,this.terrain)),R=this.getIds();let N=1/0,F=1/0,U=-1/0,W=-1/0;for(const Y of j)N=Math.min(N,Y.x),F=Math.min(F,Y.y),U=Math.max(U,Y.x),W=Math.max(W,Y.y);for(let Y=0;Y<R.length;Y++){const ue=this._tiles[R[Y]];if(ue.holdingForFade())continue;const ce=_.getCoveringTilesDetailsProvider().allowWorldCopies()?ue.tileID:ue.tileID.unwrapTo(0),de=Math.pow(2,_.zoom-ue.tileID.overscaledZ),pe=i*ue.queryPadding*l.Z/ue.tileSize/de,xe=[ce.getTilePoint(new l.$(N,F)),ce.getTilePoint(new l.$(U,W))];if(xe[0].x-pe<l.Z&&xe[0].y-pe<l.Z&&xe[1].x+pe>=0&&xe[1].y+pe>=0){const ve=A.map(ke=>ce.getTilePoint(ke)),we=j.map(ke=>ce.getTilePoint(ke));f.push({tile:ue,tileID:ce,queryGeometry:ve,cameraQueryGeometry:we,scale:de})}}return f}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(u=>this._tiles[u].tileID);return this.transform&&this.transform.populateCache(i),i}hasTransition(){if(this._source.hasTransition())return!0;if(Ne(this._source.type)){const e=re.now();for(const i in this._tiles)if(this._tiles[i].fadeEndTime>=e)return!0}return!1}setFeatureState(e,i,u){this._state.updateState(e=e||"_geojsonTileLayer",i,u)}removeFeatureState(e,i,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,u)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,u){const f=this._tiles[e];f&&f.setDependencies(i,u)}reloadTilesForDependencies(e,i){for(const u in this._tiles)this._tiles[u].hasDependency(e,i)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(e,i))}}function Ze(g,e){const i=Math.abs(2*g.wrap)-+(g.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return g.overscaledZ-e.overscaledZ||u-i||e.canonical.y-g.canonical.y||e.canonical.x-g.canonical.x}function Ne(g){return g==="raster"||g==="image"||g==="video"}Le.maxOverzooming=10,Le.maxUnderzooming=3;class ht{constructor(e,i){this.reset(e,i)}reset(e,i){this.points=e||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=l.ae(e,0,1);let i=1,u=this._distances[i];const f=e*this.paddedLength+this.padding;for(;u<f&&i<this._distances.length;)u=this._distances[++i];const _=i-1,S=this._distances[_],A=u-S,j=A>0?(f-S)/A:0;return this.points[_].mult(1-j).add(this.points[i].mult(j))}}function Tt(g,e){let i=!0;return g==="always"||g!=="never"&&e!=="never"||(i=!1),i}class Ct{constructor(e,i,u){const f=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(e/u),this.yCellCount=Math.ceil(i/u);for(let S=0;S<this.xCellCount*this.yCellCount;S++)f.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=i,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,i,u,f,_){this._forEachCell(i,u,f,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(i),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(_)}insertCircle(e,i,u,f){this._forEachCell(i-f,u-f,i+f,u+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(i),this.circles.push(u),this.circles.push(f)}_insertBoxCell(e,i,u,f,_,S){this.boxCells[_].push(S)}_insertCircleCell(e,i,u,f,_,S){this.circleCells[_].push(S)}_query(e,i,u,f,_,S,A){if(u<0||e>this.width||f<0||i>this.height)return[];const j=[];if(e<=0&&i<=0&&this.width<=u&&this.height<=f){if(_)return[{key:null,x1:e,y1:i,x2:u,y2:f}];for(let R=0;R<this.boxKeys.length;R++)j.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const N=this.circles[3*R],F=this.circles[3*R+1],U=this.circles[3*R+2];j.push({key:this.circleKeys[R],x1:N-U,y1:F-U,x2:N+U,y2:F+U})}}else this._forEachCell(e,i,u,f,this._queryCell,j,{hitTest:_,overlapMode:S,seenUids:{box:{},circle:{}}},A);return j}query(e,i,u,f){return this._query(e,i,u,f,!1,null)}hitTest(e,i,u,f,_,S){return this._query(e,i,u,f,!0,_,S).length>0}hitTestCircle(e,i,u,f,_){const S=e-u,A=e+u,j=i-u,R=i+u;if(A<0||S>this.width||R<0||j>this.height)return!1;const N=[];return this._forEachCell(S,j,A,R,this._queryCellCircle,N,{hitTest:!0,overlapMode:f,circle:{x:e,y:i,radius:u},seenUids:{box:{},circle:{}}},_),N.length>0}_queryCell(e,i,u,f,_,S,A,j){const{seenUids:R,hitTest:N,overlapMode:F}=A,U=this.boxCells[_];if(U!==null){const Y=this.bboxes;for(const ue of U)if(!R.box[ue]){R.box[ue]=!0;const ce=4*ue,de=this.boxKeys[ue];if(e<=Y[ce+2]&&i<=Y[ce+3]&&u>=Y[ce+0]&&f>=Y[ce+1]&&(!j||j(de))&&(!N||!Tt(F,de.overlapMode))&&(S.push({key:de,x1:Y[ce],y1:Y[ce+1],x2:Y[ce+2],y2:Y[ce+3]}),N))return!0}}const W=this.circleCells[_];if(W!==null){const Y=this.circles;for(const ue of W)if(!R.circle[ue]){R.circle[ue]=!0;const ce=3*ue,de=this.circleKeys[ue];if(this._circleAndRectCollide(Y[ce],Y[ce+1],Y[ce+2],e,i,u,f)&&(!j||j(de))&&(!N||!Tt(F,de.overlapMode))){const pe=Y[ce],xe=Y[ce+1],ve=Y[ce+2];if(S.push({key:de,x1:pe-ve,y1:xe-ve,x2:pe+ve,y2:xe+ve}),N)return!0}}}return!1}_queryCellCircle(e,i,u,f,_,S,A,j){const{circle:R,seenUids:N,overlapMode:F}=A,U=this.boxCells[_];if(U!==null){const Y=this.bboxes;for(const ue of U)if(!N.box[ue]){N.box[ue]=!0;const ce=4*ue,de=this.boxKeys[ue];if(this._circleAndRectCollide(R.x,R.y,R.radius,Y[ce+0],Y[ce+1],Y[ce+2],Y[ce+3])&&(!j||j(de))&&!Tt(F,de.overlapMode))return S.push(!0),!0}}const W=this.circleCells[_];if(W!==null){const Y=this.circles;for(const ue of W)if(!N.circle[ue]){N.circle[ue]=!0;const ce=3*ue,de=this.circleKeys[ue];if(this._circlesCollide(Y[ce],Y[ce+1],Y[ce+2],R.x,R.y,R.radius)&&(!j||j(de))&&!Tt(F,de.overlapMode))return S.push(!0),!0}}}_forEachCell(e,i,u,f,_,S,A,j){const R=this._convertToXCellCoord(e),N=this._convertToYCellCoord(i),F=this._convertToXCellCoord(u),U=this._convertToYCellCoord(f);for(let W=R;W<=F;W++)for(let Y=N;Y<=U;Y++)if(_.call(this,e,i,u,f,this.xCellCount*Y+W,S,A,j))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,i,u,f,_,S){const A=f-e,j=_-i,R=u+S;return R*R>A*A+j*j}_circleAndRectCollide(e,i,u,f,_,S,A){const j=(S-f)/2,R=Math.abs(e-(f+j));if(R>j+u)return!1;const N=(A-_)/2,F=Math.abs(i-(_+N));if(F>N+u)return!1;if(R<=j||F<=N)return!0;const U=R-j,W=F-N;return U*U+W*W<=u*u}}function Bt(g,e,i){const u=l.K();if(!g){const{vecSouth:F,vecEast:U}=Xt(e),W=V();W[0]=U[0],W[1]=U[1],W[2]=F[0],W[3]=F[1],f=W,(N=(S=(_=W)[0])*(R=_[3])-(j=_[2])*(A=_[1]))&&(f[0]=R*(N=1/N),f[1]=-A*N,f[2]=-j*N,f[3]=S*N),u[0]=W[0],u[1]=W[1],u[4]=W[2],u[5]=W[3]}var f,_,S,A,j,R,N;return l.M(u,u,[1/i,1/i,1]),u}function ar(g,e,i,u){if(g){const f=l.K();if(!e){const{vecSouth:_,vecEast:S}=Xt(i);f[0]=S[0],f[1]=S[1],f[4]=_[0],f[5]=_[1]}return l.M(f,f,[u,u,1]),f}return i.pixelsToClipSpaceMatrix}function Xt(g){const e=Math.cos(g.rollInRadians),i=Math.sin(g.rollInRadians),u=Math.cos(g.pitchInRadians),f=Math.cos(g.bearingInRadians),_=Math.sin(g.bearingInRadians),S=l.ao();S[0]=-f*u*i-_*e,S[1]=-_*u*i+f*e;const A=l.ap(S);A<1e-9?l.aq(S):l.ar(S,S,1/A);const j=l.ao();j[0]=f*u*e-_*i,j[1]=_*u*e+f*i;const R=l.ap(j);return R<1e-9?l.aq(j):l.ar(j,j,1/R),{vecEast:j,vecSouth:S}}function Qe(g,e,i,u){let f;u?(f=[g,e,u(g,e),1],l.at(f,f,i)):(f=[g,e,0,1],hn(f,f,i));const _=f[3];return{point:new l.P(f[0]/_,f[1]/_),signedDistanceFromCamera:_,isOccluded:!1}}function jr(g,e){return .5+g/e*.5}function fr(g,e){return g.x>=-e[0]&&g.x<=e[0]&&g.y>=-e[1]&&g.y<=e[1]}function Ar(g,e,i,u,f,_,S,A,j,R,N,F,U){const W=i?g.textSizeData:g.iconSizeData,Y=l.ak(W,e.transform.zoom),ue=[256/e.width*2+1,256/e.height*2+1],ce=i?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;ce.clear();const de=g.lineVertexArray,pe=i?g.text.placedSymbolArray:g.icon.placedSymbolArray,xe=e.transform.width/e.transform.height;let ve=!1;for(let we=0;we<pe.length;we++){const ke=pe.get(we);if(ke.hidden||ke.writingMode===l.al.vertical&&!ve){Wa(ke.numGlyphs,ce);continue}ve=!1;const Te=new l.P(ke.anchorX,ke.anchorY),Ve={getElevation:U,pitchedLabelPlaneMatrix:u,lineVertexArray:de,pitchWithMap:_,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:Te,unwrappedTileID:j,width:R,height:N,translation:F},et=nr(ke.anchorX,ke.anchorY,Ve);if(!fr(et.point,ue)){Wa(ke.numGlyphs,ce);continue}const Ge=jr(e.transform.cameraToCenterDistance,et.signedDistanceFromCamera),He=l.am(W,Y,ke),Ke=_?He*e.transform.getPitchedTextCorrection(ke.anchorX,ke.anchorY,j)/Ge:He*Ge,St=Rt({projectionContext:Ve,pitchedLabelPlaneMatrixInverse:f,symbol:ke,fontSize:Ke,flip:!1,keepUpright:S,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:ce,aspectRatio:xe,rotateToLine:A});ve=St.useVertical,(St.notEnoughRoom||ve||St.needsFlipping&&Rt({projectionContext:Ve,pitchedLabelPlaneMatrixInverse:f,symbol:ke,fontSize:Ke,flip:!0,keepUpright:S,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:ce,aspectRatio:xe,rotateToLine:A}).notEnoughRoom)&&Wa(ke.numGlyphs,ce)}i?g.text.dynamicLayoutVertexBuffer.updateData(ce):g.icon.dynamicLayoutVertexBuffer.updateData(ce)}function Zt(g,e,i,u,f,_,S,A){const j=_.glyphStartIndex+_.numGlyphs,R=_.lineStartIndex,N=_.lineStartIndex+_.lineLength,F=e.getoffsetX(_.glyphStartIndex),U=e.getoffsetX(j-1),W=Ha(g*F,i,u,f,_.segment,R,N,A,S);if(!W)return null;const Y=Ha(g*U,i,u,f,_.segment,R,N,A,S);return Y?A.projectionCache.anyProjectionOccluded?null:{first:W,last:Y}:null}function rt(g,e,i,u){return g===l.al.horizontal&&Math.abs(i.y-e.y)>Math.abs(i.x-e.x)*u?{useVertical:!0}:(g===l.al.vertical?e.y<i.y:e.x>i.x)?{needsFlipping:!0}:null}function Rt(g){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:i,symbol:u,fontSize:f,flip:_,keepUpright:S,glyphOffsetArray:A,dynamicLayoutVertexArray:j,aspectRatio:R,rotateToLine:N}=g,F=f/24,U=u.lineOffsetX*F,W=u.lineOffsetY*F;let Y;if(u.numGlyphs>1){const ue=u.glyphStartIndex+u.numGlyphs,ce=u.lineStartIndex,de=u.lineStartIndex+u.lineLength,pe=Zt(F,A,U,W,_,u,N,e);if(!pe)return{notEnoughRoom:!0};const xe=Ia(pe.first.point.x,pe.first.point.y,e,i),ve=Ia(pe.last.point.x,pe.last.point.y,e,i);if(S&&!_){const we=rt(u.writingMode,xe,ve,R);if(we)return we}Y=[pe.first];for(let we=u.glyphStartIndex+1;we<ue-1;we++)Y.push(Ha(F*A.getoffsetX(we),U,W,_,u.segment,ce,de,e,N));Y.push(pe.last)}else{if(S&&!_){const ce=xi(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,de=u.lineStartIndex+u.segment+1,pe=new l.P(e.lineVertexArray.getx(de),e.lineVertexArray.gety(de)),xe=xi(pe.x,pe.y,e),ve=xe.signedDistanceFromCamera>0?xe.point:Qt(e.tileAnchorPoint,pe,ce,1,e),we=Ia(ce.x,ce.y,e,i),ke=Ia(ve.x,ve.y,e,i),Te=rt(u.writingMode,we,ke,R);if(Te)return Te}const ue=Ha(F*A.getoffsetX(u.glyphStartIndex),U,W,_,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,e,N);if(!ue||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Y=[ue]}for(const ue of Y)l.as(j,ue.point,ue.angle);return{}}function Qt(g,e,i,u,f){const _=g.add(g.sub(e)._unit()),S=xi(_.x,_.y,f).point,A=i.sub(S);return i.add(A._mult(u/A.mag()))}function ii(g,e,i){const u=e.projectionCache;if(u.projections[g])return u.projections[g];const f=new l.P(e.lineVertexArray.getx(g),e.lineVertexArray.gety(g)),_=xi(f.x,f.y,e);if(_.signedDistanceFromCamera>0)return u.projections[g]=_.point,u.anyProjectionOccluded=u.anyProjectionOccluded||_.isOccluded,_.point;const S=g-i.direction;return Qt(i.distanceFromAnchor===0?e.tileAnchorPoint:new l.P(e.lineVertexArray.getx(S),e.lineVertexArray.gety(S)),f,i.previousVertex,i.absOffsetX-i.distanceFromAnchor+1,e)}function xi(g,e,i){const u=g+i.translation[0],f=e+i.translation[1];let _;return i.pitchWithMap?(_=Qe(u,f,i.pitchedLabelPlaneMatrix,i.getElevation),_.isOccluded=!1):(_=i.transform.projectTileCoordinates(u,f,i.unwrappedTileID,i.getElevation),_.point.x=(.5*_.point.x+.5)*i.width,_.point.y=(.5*-_.point.y+.5)*i.height),_}function Ia(g,e,i,u){if(i.pitchWithMap){const f=[g,e,0,1];return l.at(f,f,u),i.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],i.unwrappedTileID,i.getElevation).point}return{x:g/i.width*2-1,y:e/i.height*2-1}}function nr(g,e,i){return i.transform.projectTileCoordinates(g,e,i.unwrappedTileID,i.getElevation)}function Xn(g,e,i){return g._unit()._perp()._mult(e*i)}function jo(g,e,i,u,f,_,S,A,j){if(A.projectionCache.offsets[g])return A.projectionCache.offsets[g];const R=i.add(e);if(g+j.direction<u||g+j.direction>=f)return A.projectionCache.offsets[g]=R,R;const N=ii(g+j.direction,A,j),F=Xn(N.sub(i),S,j.direction),U=i.add(F),W=N.add(F);return A.projectionCache.offsets[g]=l.au(_,R,U,W)||R,A.projectionCache.offsets[g]}function Ha(g,e,i,u,f,_,S,A,j){const R=u?g-e:g+e;let N=R>0?1:-1,F=0;u&&(N*=-1,F=Math.PI),N<0&&(F+=Math.PI);let U,W=N>0?_+f:_+f+1;A.projectionCache.cachedAnchorPoint?U=A.projectionCache.cachedAnchorPoint:(U=xi(A.tileAnchorPoint.x,A.tileAnchorPoint.y,A).point,A.projectionCache.cachedAnchorPoint=U);let Y,ue,ce=U,de=U,pe=0,xe=0;const ve=Math.abs(R),we=[];let ke;for(;pe+xe<=ve;){if(W+=N,W<_||W>=S)return null;pe+=xe,de=ce,ue=Y;const et={absOffsetX:ve,direction:N,distanceFromAnchor:pe,previousVertex:de};if(ce=ii(W,A,et),i===0)we.push(de),ke=ce.sub(de);else{let Ge;const He=ce.sub(de);Ge=He.mag()===0?Xn(ii(W+N,A,et).sub(ce),i,N):Xn(He,i,N),ue||(ue=de.add(Ge)),Y=jo(W,Ge,ce,_,S,ue,i,A,et),we.push(ue),ke=Y.sub(ue)}xe=ke.mag()}const Te=ke._mult((ve-pe)/xe)._add(ue||de),Ve=F+Math.atan2(ce.y-de.y,ce.x-de.x);return we.push(Te),{point:Te,angle:j?Ve:0,path:we}}const Yn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Wa(g,e){for(let i=0;i<g;i++){const u=e.length;e.resize(u+4),e.float32.set(Yn,3*u)}}function hn(g,e,i){const u=e[0],f=e[1];return g[0]=i[0]*u+i[4]*f+i[12],g[1]=i[1]*u+i[5]*f+i[13],g[3]=i[3]*u+i[7]*f+i[15],g}const _r=100;class Ra{constructor(e,i=new Ct(e.width+200,e.height+200,25),u=new Ct(e.width+200,e.height+200,25)){this.transform=e,this.grid=i,this.ignoredGrid=u,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+_r,this.screenBottomBoundary=e.height+_r,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,i,u,f,_,S,A,j,R,N,F,U){const W=this.projectAndGetPerspectiveRatio(e.anchorPointX+j[0],e.anchorPointY+j[1],_,N,U),Y=u*W.perspectiveRatio;let ue;if(S||A)ue=this._projectCollisionBox(e,Y,f,_,S,A,j,W,N,F,U);else{const ke=W.x+(F?F.x*Y:0),Te=W.y+(F?F.y*Y:0);ue={allPointsOccluded:!1,box:[ke+e.x1*Y,Te+e.y1*Y,ke+e.x2*Y,Te+e.y2*Y]}}const[ce,de,pe,xe]=ue.box,ve=S?ue.allPointsOccluded:W.isOccluded;let we=ve;return we||(we=W.perspectiveRatio<this.perspectiveRatioCutoff),we||(we=!this.isInsideGrid(ce,de,pe,xe)),we||i!=="always"&&this.grid.hitTest(ce,de,pe,xe,i,R)?{box:[ce,de,pe,xe],placeable:!1,offscreen:!1,occluded:ve}:{box:[ce,de,pe,xe],placeable:!0,offscreen:this.isOffscreen(ce,de,pe,xe),occluded:ve}}placeCollisionCircles(e,i,u,f,_,S,A,j,R,N,F,U,W,Y){const ue=[],ce=new l.P(i.anchorX,i.anchorY),de=this.getPerspectiveRatio(ce.x,ce.y,S,Y),pe=(R?_*this.transform.getPitchedTextCorrection(i.anchorX,i.anchorY,S)/de:_*de)/l.ay,xe={getElevation:Y,pitchedLabelPlaneMatrix:A,lineVertexArray:u,pitchWithMap:R,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ce,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:W},ve=Zt(pe,f,i.lineOffsetX*pe,i.lineOffsetY*pe,!1,i,!1,xe);let we=!1,ke=!1,Te=!0;if(ve){const Ve=.5*F*de+U,et=new l.P(-100,-100),Ge=new l.P(this.screenRightBoundary,this.screenBottomBoundary),He=new ht,Ke=ve.first,St=ve.last;let wt=[];for(let lr=Ke.path.length-1;lr>=1;lr--)wt.push(Ke.path[lr]);for(let lr=1;lr<St.path.length;lr++)wt.push(St.path[lr]);const ft=2.5*Ve;if(R){const lr=this.projectPathToScreenSpace(wt,xe);wt=lr.some(ur=>ur.signedDistanceFromCamera<=0)?[]:lr.map(ur=>ur.point)}let Lt=[];if(wt.length>0){const lr=wt[0].clone(),ur=wt[0].clone();for(let ei=1;ei<wt.length;ei++)lr.x=Math.min(lr.x,wt[ei].x),lr.y=Math.min(lr.y,wt[ei].y),ur.x=Math.max(ur.x,wt[ei].x),ur.y=Math.max(ur.y,wt[ei].y);Lt=lr.x>=et.x&&ur.x<=Ge.x&&lr.y>=et.y&&ur.y<=Ge.y?[wt]:ur.x<et.x||lr.x>Ge.x||ur.y<et.y||lr.y>Ge.y?[]:l.av([wt],et.x,et.y,Ge.x,Ge.y)}for(const lr of Lt){He.reset(lr,.25*Ve);let ur=0;ur=He.length<=.5*Ve?1:Math.ceil(He.paddedLength/ft)+1;for(let ei=0;ei<ur;ei++){const Nr=ei/Math.max(ur-1,1),ni=He.lerp(Nr),si=ni.x+_r,Tr=ni.y+_r;ue.push(si,Tr,Ve,0);const yr=si-Ve,ti=Tr-Ve,mi=si+Ve,Yi=Tr+Ve;if(Te=Te&&this.isOffscreen(yr,ti,mi,Yi),ke=ke||this.isInsideGrid(yr,ti,mi,Yi),e!=="always"&&this.grid.hitTestCircle(si,Tr,Ve,e,N)&&(we=!0,!j))return{circles:[],offscreen:!1,collisionDetected:we}}}}return{circles:!j&&we||!ke||de<this.perspectiveRatioCutoff?[]:ue,offscreen:Te,collisionDetected:we}}projectPathToScreenSpace(e,i){const u=function(f,_){const S=l.K();return l.an(S,_.pitchedLabelPlaneMatrix),f.map(A=>{const j=Qe(A.x,A.y,S,_.getElevation),R=_.transform.projectTileCoordinates(j.point.x,j.point.y,_.unwrappedTileID,_.getElevation);return R.point.x=(.5*R.point.x+.5)*_.width,R.point.y=(.5*-R.point.y+.5)*_.height,R})}(e,i);return function(f){let _=0,S=0,A=0,j=0;for(let R=0;R<f.length;R++)f[R].isOccluded?(A=R+1,j=0):(j++,j>S&&(S=j,_=A));return f.slice(_,_+S)}(u)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const i=[];let u=1/0,f=1/0,_=-1/0,S=-1/0;for(const N of e){const F=new l.P(N.x+_r,N.y+_r);u=Math.min(u,F.x),f=Math.min(f,F.y),_=Math.max(_,F.x),S=Math.max(S,F.y),i.push(F)}const A=this.grid.query(u,f,_,S).concat(this.ignoredGrid.query(u,f,_,S)),j={},R={};for(const N of A){const F=N.key;if(j[F.bucketInstanceId]===void 0&&(j[F.bucketInstanceId]={}),j[F.bucketInstanceId][F.featureIndex])continue;const U=[new l.P(N.x1,N.y1),new l.P(N.x2,N.y1),new l.P(N.x2,N.y2),new l.P(N.x1,N.y2)];l.aw(i,U)&&(j[F.bucketInstanceId][F.featureIndex]=!0,R[F.bucketInstanceId]===void 0&&(R[F.bucketInstanceId]=[]),R[F.bucketInstanceId].push(F.featureIndex))}return R}insertCollisionBox(e,i,u,f,_,S){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:S,overlapMode:i},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,i,u,f,_,S){const A=u?this.ignoredGrid:this.grid,j={bucketInstanceId:f,featureIndex:_,collisionGroupID:S,overlapMode:i};for(let R=0;R<e.length;R+=4)A.insertCircle(j,e[R],e[R+1],e[R+2])}projectAndGetPerspectiveRatio(e,i,u,f,_){if(_){let S;f?(S=[e,i,f(e,i),1],l.at(S,S,_)):(S=[e,i,0,1],hn(S,S,_));const A=S[3];return{x:(S[0]/A+1)/2*this.transform.width+_r,y:(-S[1]/A+1)/2*this.transform.height+_r,perspectiveRatio:.5+this.transform.cameraToCenterDistance/A*.5,isOccluded:!1,signedDistanceFromCamera:A}}{const S=this.transform.projectTileCoordinates(e,i,u,f);return{x:(S.point.x+1)/2*this.transform.width+_r,y:(1-S.point.y)/2*this.transform.height+_r,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(e,i,u,f){const _=this.transform.projectTileCoordinates(e,i,u,f);return .5+this.transform.cameraToCenterDistance/_.signedDistanceFromCamera*.5}isOffscreen(e,i,u,f){return u<_r||e>=this.screenRightBoundary||f<_r||i>this.screenBottomBoundary}isInsideGrid(e,i,u,f){return u>=0&&e<this.gridRightBoundary&&f>=0&&i<this.gridBottomBoundary}getViewportMatrix(){const e=l.ad([]);return l.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,i,u,f,_,S,A,j,R,N,F){let U=1,W=0,Y=0,ue=1;const ce=e.anchorPointX+A[0],de=e.anchorPointY+A[1];if(S&&!_){const wt=this.projectAndGetPerspectiveRatio(ce+1,de,f,R,F),ft=wt.x-j.x,Lt=Math.atan((wt.y-j.y)/ft)+(ft<0?Math.PI:0),lr=Math.sin(Lt),ur=Math.cos(Lt);U=ur,W=lr,Y=-lr,ue=ur}else if(!S&&_){const wt=Xt(this.transform);U=wt.vecEast[0],W=wt.vecEast[1],Y=wt.vecSouth[0],ue=wt.vecSouth[1]}let pe=j.x,xe=j.y,ve=i;_&&(pe=ce,xe=de,ve=Math.pow(2,-(this.transform.zoom-u.overscaledZ)),ve*=this.transform.getPitchedTextCorrection(ce,de,f),N||(ve*=l.ae(.5+j.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),N&&(pe+=U*N.x*ve+Y*N.y*ve,xe+=W*N.x*ve+ue*N.y*ve);const we=e.x1*ve,ke=e.x2*ve,Te=(we+ke)/2,Ve=e.y1*ve,et=e.y2*ve,Ge=(Ve+et)/2,He=[{offsetX:we,offsetY:Ve},{offsetX:Te,offsetY:Ve},{offsetX:ke,offsetY:Ve},{offsetX:ke,offsetY:Ge},{offsetX:ke,offsetY:et},{offsetX:Te,offsetY:et},{offsetX:we,offsetY:et},{offsetX:we,offsetY:Ge}];let Ke=[];for(const{offsetX:wt,offsetY:ft}of He)Ke.push(new l.P(pe+U*wt+Y*ft,xe+W*wt+ue*ft));let St=!1;if(_){const wt=Ke.map(ft=>this.projectAndGetPerspectiveRatio(ft.x,ft.y,f,R,F));St=wt.some(ft=>!ft.isOccluded),Ke=wt.map(ft=>new l.P(ft.x,ft.y))}else St=!0;return{box:l.ax(Ke),allPointsOccluded:!St}}}class Kr{constructor(e,i,u,f){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?i:-i))):f&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class An{constructor(e,i,u,f,_){this.text=new Kr(e?e.text:null,i,u,_),this.icon=new Kr(e?e.icon:null,i,f,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class kn{constructor(e,i,u){this.text=e,this.icon=i,this.skipFade=u}}class Pn{constructor(e,i,u,f,_){this.bucketInstanceId=e,this.featureIndex=i,this.sourceLayerIndex=u,this.bucketIndex=f,this.tileID=_}}class zo{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const i=++this.maxGroupID;this.collisionGroups[e]={ID:i,predicate:u=>u.collisionGroupID===i}}return this.collisionGroups[e]}}function Kn(g,e,i,u,f){const{horizontalAlign:_,verticalAlign:S}=l.aE(g);return new l.P(-(_-.5)*e+u[0]*f,-(S-.5)*i+u[1]*f)}class qh{constructor(e,i,u,f,_){this.transform=e.clone(),this.terrain=i,this.collisionIndex=new Ra(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new zo(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const i=this.terrain;return i?(u,f)=>i.getElevation(e,u,f):null}getBucketParts(e,i,u,f){const _=u.getBucket(i),S=u.latestFeatureIndex;if(!_||!S||i.id!==_.layerIds[0])return;const A=u.collisionBoxArray,j=_.layers[0].layout,R=_.layers[0].paint,N=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),F=u.tileSize/l.Z,U=u.tileID.toUnwrapped(),W=j.get("text-rotation-alignment")==="map",Y=l.az(u,1,this.transform.zoom),ue=l.aA(this.collisionIndex.transform,u,R.get("text-translate"),R.get("text-translate-anchor")),ce=l.aA(this.collisionIndex.transform,u,R.get("icon-translate"),R.get("icon-translate-anchor")),de=Bt(W,this.transform,Y);this.retainedQueryData[_.bucketInstanceId]=new Pn(_.bucketInstanceId,S,_.sourceLayerIndex,_.index,u.tileID);const pe={bucket:_,layout:j,translationText:ue,translationIcon:ce,unwrappedTileID:U,pitchedLabelPlaneMatrix:de,scale:N,textPixelRatio:F,holdingForFade:u.holdingForFade(),collisionBoxArray:A,partiallyEvaluatedTextSize:l.ak(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(f)for(const xe of _.sortKeyRanges){const{sortKey:ve,symbolInstanceStart:we,symbolInstanceEnd:ke}=xe;e.push({sortKey:ve,symbolInstanceStart:we,symbolInstanceEnd:ke,parameters:pe})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:pe})}attemptAnchorPlacement(e,i,u,f,_,S,A,j,R,N,F,U,W,Y,ue,ce,de,pe,xe,ve){const we=l.aB[e.textAnchor],ke=[e.textOffset0,e.textOffset1],Te=Kn(we,u,f,ke,_),Ve=this.collisionIndex.placeCollisionBox(i,U,j,R,N,A,S,ce,F.predicate,xe,Te,ve);if((!pe||this.collisionIndex.placeCollisionBox(pe,U,j,R,N,A,S,de,F.predicate,xe,Te,ve).placeable)&&Ve.placeable){let et;if(this.prevPlacement&&this.prevPlacement.variableOffsets[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID].text&&(et=this.prevPlacement.variableOffsets[W.crossTileID].anchor),W.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[W.crossTileID]={textOffset:ke,width:u,height:f,anchor:we,textBoxScale:_,prevAnchor:et},this.markUsedJustification(Y,we,W,ue),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,ue,W),this.placedOrientations[W.crossTileID]=ue),{shift:Te,placedGlyphBoxes:Ve}}}placeLayerBucketPart(e,i,u){const{bucket:f,layout:_,translationText:S,translationIcon:A,unwrappedTileID:j,pitchedLabelPlaneMatrix:R,textPixelRatio:N,holdingForFade:F,collisionBoxArray:U,partiallyEvaluatedTextSize:W,collisionGroup:Y}=e.parameters,ue=_.get("text-optional"),ce=_.get("icon-optional"),de=l.aC(_,"text-overlap","text-allow-overlap"),pe=de==="always",xe=l.aC(_,"icon-overlap","icon-allow-overlap"),ve=xe==="always",we=_.get("text-rotation-alignment")==="map",ke=_.get("text-pitch-alignment")==="map",Te=_.get("icon-text-fit")!=="none",Ve=_.get("symbol-z-order")==="viewport-y",et=pe&&(ve||!f.hasIconData()||ce),Ge=ve&&(pe||!f.hasTextData()||ue);!f.collisionArrays&&U&&f.deserializeCollisionBoxes(U);const He=this.retainedQueryData[f.bucketInstanceId].tileID,Ke=this._getTerrainElevationFunc(He),St=this.transform.getFastPathSimpleProjectionMatrix(He),wt=(ft,Lt,lr)=>{var ur,ei;if(i[ft.crossTileID])return;if(F)return void(this.placements[ft.crossTileID]=new kn(!1,!1,!1));let Nr=!1,ni=!1,si=!0,Tr=null,yr={box:null,placeable:!1,offscreen:null,occluded:!1},ti={placeable:!1},mi=null,Yi=null,Er=null,Ds=0,Ln=0,Oa=0;Lt.textFeatureIndex?Ds=Lt.textFeatureIndex:ft.useRuntimeCollisionCircles&&(Ds=ft.featureIndex),Lt.verticalTextFeatureIndex&&(Ln=Lt.verticalTextFeatureIndex);const cs=Lt.textBox;if(cs){const ya=Oi=>{let Vi=l.al.horizontal;if(f.allowVerticalPlacement&&!Oi&&this.prevPlacement){const _a=this.prevPlacement.placedOrientations[ft.crossTileID];_a&&(this.placedOrientations[ft.crossTileID]=_a,Vi=_a,this.markUsedOrientation(f,Vi,ft))}return Vi},Ls=(Oi,Vi)=>{if(f.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&Lt.verticalTextBox){for(const _a of f.writingModes)if(_a===l.al.vertical?(yr=Vi(),ti=yr):yr=Oi(),yr&&yr.placeable)break}else yr=Oi()},On=ft.textAnchorOffsetStartIndex,Os=ft.textAnchorOffsetEndIndex;if(Os===On){const Oi=(Vi,_a)=>{const cr=this.collisionIndex.placeCollisionBox(Vi,de,N,He,j,ke,we,S,Y.predicate,Ke,void 0,St);return cr&&cr.placeable&&(this.markUsedOrientation(f,_a,ft),this.placedOrientations[ft.crossTileID]=_a),cr};Ls(()=>Oi(cs,l.al.horizontal),()=>{const Vi=Lt.verticalTextBox;return f.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&Vi?Oi(Vi,l.al.vertical):{box:null,offscreen:null}}),ya(yr&&yr.placeable)}else{let Oi=l.aB[(ei=(ur=this.prevPlacement)===null||ur===void 0?void 0:ur.variableOffsets[ft.crossTileID])===null||ei===void 0?void 0:ei.anchor];const Vi=(cr,qi,gd)=>{const yd=cr.x2-cr.x1,Tf=cr.y2-cr.y1,mh=ft.textBoxScale,nc=Te&&xe==="never"?qi:null;let va=null,Sn=de==="never"?1:2,tn="never";Oi&&Sn++;for(let us=0;us<Sn;us++){for(let eu=On;eu<Os;eu++){const hs=f.textAnchorOffsets.get(eu);if(Oi&&hs.textAnchor!==Oi)continue;const tu=this.attemptAnchorPlacement(hs,cr,yd,Tf,mh,we,ke,N,He,j,Y,tn,ft,f,gd,S,A,nc,Ke);if(tu&&(va=tu.placedGlyphBoxes,va&&va.placeable))return Nr=!0,Tr=tu.shift,va}Oi?Oi=null:tn=de}return u&&!va&&(va={box:this.collisionIndex.placeCollisionBox(cs,"always",N,He,j,ke,we,S,Y.predicate,Ke,void 0,St).box,offscreen:!1,placeable:!1,occluded:!1}),va};Ls(()=>Vi(cs,Lt.iconBox,l.al.horizontal),()=>{const cr=Lt.verticalTextBox;return f.allowVerticalPlacement&&(!yr||!yr.placeable)&&ft.numVerticalGlyphVertices>0&&cr?Vi(cr,Lt.verticalIconBox,l.al.vertical):{box:null,occluded:!0,offscreen:null}}),yr&&(Nr=yr.placeable,si=yr.offscreen);const _a=ya(yr&&yr.placeable);if(!Nr&&this.prevPlacement){const cr=this.prevPlacement.variableOffsets[ft.crossTileID];cr&&(this.variableOffsets[ft.crossTileID]=cr,this.markUsedJustification(f,cr.anchor,ft,_a))}}}if(mi=yr,Nr=mi&&mi.placeable,si=mi&&mi.offscreen,ft.useRuntimeCollisionCircles){const ya=f.text.placedSymbolArray.get(ft.centerJustifiedTextSymbolIndex),Ls=l.am(f.textSizeData,W,ya),On=_.get("text-padding");Yi=this.collisionIndex.placeCollisionCircles(de,ya,f.lineVertexArray,f.glyphOffsetArray,Ls,j,R,u,ke,Y.predicate,ft.collisionCircleDiameter,On,S,Ke),Yi.circles.length&&Yi.collisionDetected&&!u&&l.w("Collisions detected, but collision boxes are not shown"),Nr=pe||Yi.circles.length>0&&!Yi.collisionDetected,si=si&&Yi.offscreen}if(Lt.iconFeatureIndex&&(Oa=Lt.iconFeatureIndex),Lt.iconBox){const ya=Ls=>this.collisionIndex.placeCollisionBox(Ls,xe,N,He,j,ke,we,A,Y.predicate,Ke,Te&&Tr?Tr:void 0,St);ti&&ti.placeable&&Lt.verticalIconBox?(Er=ya(Lt.verticalIconBox),ni=Er.placeable):(Er=ya(Lt.iconBox),ni=Er.placeable),si=si&&Er.offscreen}const ac=ue||ft.numHorizontalGlyphVertices===0&&ft.numVerticalGlyphVertices===0,Ns=ce||ft.numIconVertices===0;ac||Ns?Ns?ac||(ni=ni&&Nr):Nr=ni&&Nr:ni=Nr=ni&&Nr;const fo=ni&&Er.placeable;if(Nr&&mi.placeable&&this.collisionIndex.insertCollisionBox(mi.box,de,_.get("text-ignore-placement"),f.bucketInstanceId,ti&&ti.placeable&&Ln?Ln:Ds,Y.ID),fo&&this.collisionIndex.insertCollisionBox(Er.box,xe,_.get("icon-ignore-placement"),f.bucketInstanceId,Oa,Y.ID),Yi&&Nr&&this.collisionIndex.insertCollisionCircles(Yi.circles,de,_.get("text-ignore-placement"),f.bucketInstanceId,Ds,Y.ID),u&&this.storeCollisionData(f.bucketInstanceId,lr,Lt,mi,Er,Yi),ft.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ft.crossTileID]=new kn((Nr||et)&&!(mi!=null&&mi.occluded),(ni||Ge)&&!(Er!=null&&Er.occluded),si||f.justReloaded),i[ft.crossTileID]=!0};if(Ve){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ft=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Lt=ft.length-1;Lt>=0;--Lt){const lr=ft[Lt];wt(f.symbolInstances.get(lr),f.collisionArrays[lr],lr)}}else for(let ft=e.symbolInstanceStart;ft<e.symbolInstanceEnd;ft++)wt(f.symbolInstances.get(ft),f.collisionArrays[ft],ft);f.justReloaded=!1}storeCollisionData(e,i,u,f,_,S){if(u.textBox||u.iconBox){let A,j;this.collisionBoxArrays.has(e)?A=this.collisionBoxArrays.get(e):(A=new Map,this.collisionBoxArrays.set(e,A)),A.has(i)?j=A.get(i):(j={text:null,icon:null},A.set(i,j)),u.textBox&&(j.text=f.box),u.iconBox&&(j.icon=_.box)}if(S){let A=this.collisionCircleArrays[e];A===void 0&&(A=this.collisionCircleArrays[e]=[]);for(let j=0;j<S.circles.length;j+=4)A.push(S.circles[j+0]-_r),A.push(S.circles[j+1]-_r),A.push(S.circles[j+2]),A.push(S.collisionDetected?1:0)}}markUsedJustification(e,i,u,f){let _;_=f===l.al.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[l.aD(i)];const S=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const A of S)A>=0&&(e.text.placedSymbolArray.get(A).crossTileID=_>=0&&A!==_?0:u.crossTileID)}markUsedOrientation(e,i,u){const f=i===l.al.horizontal||i===l.al.horizontalOnly?i:0,_=i===l.al.vertical?i:0,S=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const A of S)e.text.placedSymbolArray.get(A).placedOrientation=f;u.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const i=this.prevPlacement;let u=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;const f=i?i.symbolFadeChange(e):1,_=i?i.opacities:{},S=i?i.variableOffsets:{},A=i?i.placedOrientations:{};for(const j in this.placements){const R=this.placements[j],N=_[j];N?(this.opacities[j]=new An(N,f,R.text,R.icon),u=u||R.text!==N.text.placed||R.icon!==N.icon.placed):(this.opacities[j]=new An(null,f,R.text,R.icon,R.skipFade),u=u||R.text||R.icon)}for(const j in _){const R=_[j];if(!this.opacities[j]){const N=new An(R,f,!1,!1);N.isHidden()||(this.opacities[j]=N,u=u||R.text.placed||R.icon.placed)}}for(const j in S)this.variableOffsets[j]||!this.opacities[j]||this.opacities[j].isHidden()||(this.variableOffsets[j]=S[j]);for(const j in A)this.placedOrientations[j]||!this.opacities[j]||this.opacities[j].isHidden()||(this.placedOrientations[j]=A[j]);if(i&&i.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:e)}updateLayerOpacities(e,i){const u={};for(const f of i){const _=f.getBucket(e);_&&f.latestFeatureIndex&&e.id===_.layerIds[0]&&this.updateBucketOpacities(_,f.tileID,u,f.collisionBoxArray)}}updateBucketOpacities(e,i,u,f){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const _=e.layers[0],S=_.layout,A=new An(null,0,!1,!1,!0),j=S.get("text-allow-overlap"),R=S.get("icon-allow-overlap"),N=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),F=S.get("text-rotation-alignment")==="map",U=S.get("text-pitch-alignment")==="map",W=S.get("icon-text-fit")!=="none",Y=new An(null,0,j&&(R||!e.hasIconData()||S.get("icon-optional")),R&&(j||!e.hasTextData()||S.get("text-optional")),!0);!e.collisionArrays&&f&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(f);const ue=(de,pe,xe)=>{for(let ve=0;ve<pe/4;ve++)de.opacityVertexArray.emplaceBack(xe);de.hasVisibleVertices=de.hasVisibleVertices||xe!==Jn},ce=this.collisionBoxArrays.get(e.bucketInstanceId);for(let de=0;de<e.symbolInstances.length;de++){const pe=e.symbolInstances.get(de),{numHorizontalGlyphVertices:xe,numVerticalGlyphVertices:ve,crossTileID:we}=pe;let ke=this.opacities[we];u[we]?ke=A:ke||(ke=Y,this.opacities[we]=ke),u[we]=!0;const Te=pe.numIconVertices>0,Ve=this.placedOrientations[pe.crossTileID],et=Ve===l.al.vertical,Ge=Ve===l.al.horizontal||Ve===l.al.horizontalOnly;if(xe>0||ve>0){const Ke=Du(ke.text);ue(e.text,xe,et?Jn:Ke),ue(e.text,ve,Ge?Jn:Ke);const St=ke.text.isHidden();[pe.rightJustifiedTextSymbolIndex,pe.centerJustifiedTextSymbolIndex,pe.leftJustifiedTextSymbolIndex].forEach(Lt=>{Lt>=0&&(e.text.placedSymbolArray.get(Lt).hidden=St||et?1:0)}),pe.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(pe.verticalPlacedTextSymbolIndex).hidden=St||Ge?1:0);const wt=this.variableOffsets[pe.crossTileID];wt&&this.markUsedJustification(e,wt.anchor,pe,Ve);const ft=this.placedOrientations[pe.crossTileID];ft&&(this.markUsedJustification(e,"left",pe,ft),this.markUsedOrientation(e,ft,pe))}if(Te){const Ke=Du(ke.icon),St=!(W&&pe.verticalPlacedIconSymbolIndex&&et);pe.placedIconSymbolIndex>=0&&(ue(e.icon,pe.numIconVertices,St?Ke:Jn),e.icon.placedSymbolArray.get(pe.placedIconSymbolIndex).hidden=ke.icon.isHidden()),pe.verticalPlacedIconSymbolIndex>=0&&(ue(e.icon,pe.numVerticalIconVertices,St?Jn:Ke),e.icon.placedSymbolArray.get(pe.verticalPlacedIconSymbolIndex).hidden=ke.icon.isHidden())}const He=ce&&ce.has(de)?ce.get(de):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ke=e.collisionArrays[de];if(Ke){let St=new l.P(0,0);if(Ke.textBox||Ke.verticalTextBox){let wt=!0;if(N){const ft=this.variableOffsets[we];ft?(St=Kn(ft.anchor,ft.width,ft.height,ft.textOffset,ft.textBoxScale),F&&St._rotate(U?-this.transform.bearingInRadians:this.transform.bearingInRadians)):wt=!1}if(Ke.textBox||Ke.verticalTextBox){let ft;Ke.textBox&&(ft=et),Ke.verticalTextBox&&(ft=Ge),Zh(e.textCollisionBox.collisionVertexArray,ke.text.placed,!wt||ft,He.text,St.x,St.y)}}if(Ke.iconBox||Ke.verticalIconBox){const wt=!!(!Ge&&Ke.verticalIconBox);let ft;Ke.iconBox&&(ft=wt),Ke.verticalIconBox&&(ft=!wt),Zh(e.iconCollisionBox.collisionVertexArray,ke.icon.placed,ft,He.icon,W?St.x:0,W?St.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,i){const u=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*u>e}setStale(){this.stale=!0}}function Zh(g,e,i,u,f,_){u&&u.length!==0||(u=[0,0,0,0]);const S=u[0]-_r,A=u[1]-_r,j=u[2]-_r,R=u[3]-_r;g.emplaceBack(e?1:0,i?1:0,f||0,_||0,S,A),g.emplaceBack(e?1:0,i?1:0,f||0,_||0,j,A),g.emplaceBack(e?1:0,i?1:0,f||0,_||0,j,R),g.emplaceBack(e?1:0,i?1:0,f||0,_||0,S,R)}const Rc=Math.pow(2,25),Ts=Math.pow(2,24),Qn=Math.pow(2,17),dn=Math.pow(2,16),hf=Math.pow(2,9),Vp=Math.pow(2,8),Dc=Math.pow(2,1);function Du(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const e=g.placed?1:0,i=Math.floor(127*g.opacity);return i*Rc+e*Ts+i*Qn+e*dn+i*hf+e*Vp+i*Dc+e}const Jn=0;class $h{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,i,u,f,_){const S=this._bucketParts;for(;this._currentTileIndex<e.length;)if(i.getBucketParts(S,f,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((A,j)=>A.sortKey-j.sortKey));this._currentPartIndex<S.length;)if(i.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,_())return!0;return!1}}class Xa{constructor(e,i,u,f,_,S,A,j){this.placement=new qh(e,i,S,A,j),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(e,i,u){const f=re.now(),_=()=>!this._forceFullPlacement&&re.now()-f>2;for(;this._currentPlacementIndex>=0;){const S=i[e[this._currentPlacementIndex]],A=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=A)&&(!S.maxzoom||S.maxzoom>A)){if(this._inProgressLayer||(this._inProgressLayer=new $h(S)),this._inProgressLayer.continuePlacement(u[S.source],this.placement,this._showCollisionBoxes,S,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Ms=512/l.Z/2;class Nu{constructor(e,i,u){this.tileID=e,this.bucketInstanceId=u,this._symbolsByKey={};const f=new Map;for(let _=0;_<i.length;_++){const S=i.get(_),A=S.key,j=f.get(A);j?j.push(S):f.set(A,[S])}for(const[_,S]of f){const A={positions:S.map(j=>({x:Math.floor(j.anchorX*Ms),y:Math.floor(j.anchorY*Ms)})),crossTileIDs:S.map(j=>j.crossTileID)};if(A.positions.length>128){const j=new l.aF(A.positions.length,16,Uint16Array);for(const{x:R,y:N}of A.positions)j.add(R,N);j.finish(),delete A.positions,A.index=j}this._symbolsByKey[_]=A}}getScaledCoordinates(e,i){const{x:u,y:f,z:_}=this.tileID.canonical,{x:S,y:A,z:j}=i.canonical,R=Ms/Math.pow(2,j-_),N=(A*l.Z+e.anchorY)*R,F=f*l.Z*Ms;return{x:Math.floor((S*l.Z+e.anchorX)*R-u*l.Z*Ms),y:Math.floor(N-F)}}findMatches(e,i,u){const f=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z);for(let _=0;_<e.length;_++){const S=e.get(_);if(S.crossTileID)continue;const A=this._symbolsByKey[S.key];if(!A)continue;const j=this.getScaledCoordinates(S,i);if(A.index){const R=A.index.range(j.x-f,j.y-f,j.x+f,j.y+f).sort();for(const N of R){const F=A.crossTileIDs[N];if(!u[F]){u[F]=!0,S.crossTileID=F;break}}}else if(A.positions)for(let R=0;R<A.positions.length;R++){const N=A.positions[R],F=A.crossTileIDs[R];if(Math.abs(N.x-j.x)<=f&&Math.abs(N.y-j.y)<=f&&!u[F]){u[F]=!0,S.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Gh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class es{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const i=Math.round((e-this.lng)/360);if(i!==0)for(const u in this.indexes){const f=this.indexes[u],_={};for(const S in f){const A=f[S];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+i),_[A.tileID.key]=A}this.indexes[u]=_}this.lng=e}addBucket(e,i,u){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let _=0;_<i.symbolInstances.length;_++)i.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const f=this.usedCrossTileIDs[e.overscaledZ];for(const _ in this.indexes){const S=this.indexes[_];if(Number(_)>e.overscaledZ)for(const A in S){const j=S[A];j.tileID.isChildOf(e)&&j.findMatches(i.symbolInstances,e,f)}else{const A=S[e.scaledTo(Number(_)).key];A&&A.findMatches(i.symbolInstances,e,f)}}for(let _=0;_<i.symbolInstances.length;_++){const S=i.symbolInstances.get(_);S.crossTileID||(S.crossTileID=u.generate(),f[S.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Nu(e,i.symbolInstances,i.bucketInstanceId),!0}removeBucketCrossTileIDs(e,i){for(const u of i.getCrossTileIDsLists())for(const f of u)delete this.usedCrossTileIDs[e][f]}removeStaleBuckets(e){let i=!1;for(const u in this.indexes){const f=this.indexes[u];for(const _ in f)e[f[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,f[_]),delete f[_],i=!0)}return i}}class Ll{constructor(){this.layerIndexes={},this.crossTileIDs=new Gh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,i,u){let f=this.layerIndexes[e.id];f===void 0&&(f=this.layerIndexes[e.id]=new es);let _=!1;const S={};f.handleWrapJump(u);for(const A of i){const j=A.getBucket(e);j&&e.id===j.layerIds[0]&&(j.bucketInstanceId||(j.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(A.tileID,j,this.crossTileIDs)&&(_=!0),S[j.bucketInstanceId]=!0)}return f.removeStaleBuckets(S)&&(_=!0),_}pruneUnusedLayers(e){const i={};e.forEach(u=>{i[u]=!0});for(const u in this.layerIndexes)i[u]||delete this.layerIndexes[u]}}var Lu="void main() {fragColor=vec4(1.0);}";const Ui={prelude:Sr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Sr("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Sr("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Sr(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Sr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Sr(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Sr(Lu,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Sr(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Sr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Sr("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Sr("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Sr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Sr(Lu,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Sr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Sr(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Sr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Sr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Sr(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Sr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Sr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Sr(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Sr(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Sr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Sr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Sr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Sr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Sr(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Sr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Sr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Sr("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Sr("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Sr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Sr("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Sr(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Sr("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Sr(g,e){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=e.match(/in ([\w]+) ([\w]+)/g),f=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=_?_.concat(f):f,A={};return{fragmentSource:g=g.replace(i,(j,R,N,F,U)=>(A[U]=!0,R==="define"?`
#ifndef HAS_UNIFORM_u_${U}
in ${N} ${F} ${U};
#else
uniform ${N} ${F} u_${U};
#endif
`:`
#ifdef HAS_UNIFORM_u_${U}
    ${N} ${F} ${U} = u_${U};
#endif
`)),vertexSource:e=e.replace(i,(j,R,N,F,U)=>{const W=F==="float"?"vec2":"vec4",Y=U.match(/color/)?"color":W;return A[U]?R==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${N} ${W} a_${U};
out ${N} ${F} ${U};
#else
uniform ${N} ${F} u_${U};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${N} ${F} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = unpack_mix_${Y}(a_${U}, u_${U}_t);
#else
    ${N} ${F} ${U} = u_${U};
#endif
`:R==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${N} ${W} a_${U};
#else
uniform ${N} ${F} u_${U};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${N} ${F} ${U} = a_${U};
#else
    ${N} ${F} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${N} ${F} ${U} = unpack_mix_${Y}(a_${U}, u_${U}_t);
#else
    ${N} ${F} ${U} = u_${U};
#endif
`}),staticAttributes:u,staticUniforms:S}}class Io{constructor(e,i,u){this.vertexBuffer=e,this.indexBuffer=i,this.segments=u}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var fa=l.aG([{name:"a_pos",type:"Int16",components:2}]);const Es="#define PROJECTION_MERCATOR",vr="mercator";class Nc{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return vr}get shaderDefine(){return Es}get shaderPreludeCode(){return Ui.projectionMercator}get vertexShaderPreludeCode(){return Ui.projectionMercator.vertexSource}get subdivisionGranularity(){return l.aH.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,i,u,f,_){if(this._cachedMesh)return this._cachedMesh;const S=new l.aI;S.emplaceBack(0,0),S.emplaceBack(l.Z,0),S.emplaceBack(0,l.Z),S.emplaceBack(l.Z,l.Z);const A=e.createVertexBuffer(S,fa.members),j=l.aJ.simpleSegment(0,0,4,2),R=new l.aK;R.emplaceBack(1,0,2),R.emplaceBack(1,2,3);const N=e.createIndexBuffer(R);return this._cachedMesh=new Io(A,N,j),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Hs{constructor(e=0,i=0,u=0,f=0){if(isNaN(e)||e<0||isNaN(i)||i<0||isNaN(u)||u<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=i,this.left=u,this.right=f}interpolate(e,i,u){return i.top!=null&&e.top!=null&&(this.top=l.B.number(e.top,i.top,u)),i.bottom!=null&&e.bottom!=null&&(this.bottom=l.B.number(e.bottom,i.bottom,u)),i.left!=null&&e.left!=null&&(this.left=l.B.number(e.left,i.left,u)),i.right!=null&&e.right!=null&&(this.right=l.B.number(e.right,i.right,u)),this}getCenter(e,i){const u=l.ae((this.left+e-this.right)/2,0,e),f=l.ae((this.top+i-this.bottom)/2,0,i);return new l.P(u,f)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Hs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ws(g,e){if(!g.renderWorldCopies||g.lngRange)return;const i=e.lng-g.center.lng;e.lng+=i>180?-360:i<-180?360:0}function pa(g){return Math.max(0,Math.floor(g))}class Ei{constructor(e,i,u,f,_,S){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=i||0,this._maxZoom=u||22,this._minPitch=f??0,this._maxPitch=_??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new l.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=pa(this._zoom),this._scale=l.ac(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Hs,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,i,u){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=pa(this._zoom),this._scale=l.ac(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Hs(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!u&&e.autoCalculateNearFarZ,i&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const i=l.aL(e,-180,180)*Math.PI/180;var u,f,_,S,A,j,R,N,F;this._bearingInRadians!==i&&(this._unmodified=!1,this._bearingInRadians=i,this._calcMatrices(),this._rotationMatrix=V(),u=this._rotationMatrix,_=-this._bearingInRadians,S=(f=this._rotationMatrix)[0],A=f[1],j=f[2],R=f[3],N=Math.sin(_),F=Math.cos(_),u[0]=S*F+j*N,u[1]=A*F+R*N,u[2]=S*-N+j*F,u[3]=A*-N+R*F)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const i=l.ae(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==i&&(this._unmodified=!1,this._pitchInRadians=i,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const i=e/180*Math.PI;this._rollInRadians!==i&&(this._unmodified=!1,this._rollInRadians=i,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return l.aM(this._fovInRadians)}setFov(e){e=l.ae(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=l.ab(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const i=this.getConstrained(this._center,e).zoom;this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this._tileZoom=Math.max(0,Math.floor(i)),this._scale=l.ac(i),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,i){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=i,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,i,u){this._unmodified=!1,this._edgeInsets.interpolate(e,i,u),this._constrain(),this._calcMatrices()}resize(e,i,u=!0){this._width=e,this._height=i,u&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Fr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,l.af])}getConstrained(e,i){return this._callbacks.getConstrained(e,i)}getCameraQueryGeometry(e,i){if(i.length===1)return[i[0],e];{let u=e.x,f=e.y,_=e.x,S=e.y;for(const A of i)u=Math.min(u,A.x),f=Math.min(f,A.y),_=Math.max(_,A.x),S=Math.max(S,A.y);return[new l.P(u,f),new l.P(_,f),new l.P(_,S),new l.P(u,S),new l.P(u,f)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:i,zoom:u}=this.getConstrained(this.center,this.zoom);this.setCenter(i),this.setZoom(u),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=l.ad(new Float64Array(16));l.M(e,e,[this._width/2,-this._height/2,1]),l.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=l.ad(new Float64Array(16)),l.M(e,e,[1,-1,1]),l.L(e,e,[-1,-1,0]),l.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,i,u,f){const _=u!==void 0?u:this.bearing,S=f=f!==void 0?f:this.pitch,A=l.$.fromLngLat(e,i),j=-Math.cos(l.ab(S)),R=Math.sin(l.ab(S)),N=R*Math.sin(l.ab(_)),F=-R*Math.cos(l.ab(_));let U=this.elevation;const W=i-U;let Y;j*W>=0||Math.abs(j)<.1?(Y=1e4,U=i+Y*j):Y=-W/j;let ue,ce,de=l.aN(1,A.y),pe=0;do{if(pe+=1,pe>10)break;ce=Y/de,ue=new l.$(A.x+N*ce,A.y+F*ce),de=1/ue.meterInMercatorCoordinateUnits()}while(Math.abs(Y-ce*de)>1e-12);return{center:ue.toLngLat(),elevation:U,zoom:l.ah(this.height/2/Math.tan(this.fovInRadians/2)/ce/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const i=l.ag(1,this.center.lat)*this.worldSize,u=this.cameraToCenterDistance/i,f=l.$.fromLngLat(this.center,this.elevation),_=J(this.center,this.elevation,this.pitch,this.bearing,u);this._elevation=e;const S=this.calculateCenterFromCameraLngLatAlt(_.toLngLat(),l.aN(_.z,f.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=l.ag(1,this.center.lat)*this.worldSize;return J(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const i=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/i,e.canonical.y/i,1/i/l.Z,1/i/l.Z]}}class Qr{constructor(e,i){this.min=e,this.max=i,this.center=l.aO([],l.aP([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],u=l.aQ(this.min),f=l.aQ(this.max);for(let _=0;_<i.length;_++)u[_]=i[_]?this.min[_]:this.center[_],f[_]=i[_]?this.center[_]:this.max[_];return f[2]=this.max[2],new Qr(u,f)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let i=!0;for(let u=0;u<e.planes.length;u++){const f=this.intersectsPlane(e.planes[u]);if(f===0)return 0;f===1&&(i=!1)}return i?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let i=e[3],u=e[3];for(let f=0;f<3;f++)e[f]>0?(i+=e[f]*this.min[f],u+=e[f]*this.max[f]):(u+=e[f]*this.min[f],i+=e[f]*this.max[f]);return i>=0?2:u<0?0:1}}class ta{distanceToTile2d(e,i,u,f){const _=f.distanceX([e,i]),S=f.distanceY([e,i]);return Math.hypot(_,S)}getWrap(e,i,u){return u}getTileAABB(e,i,u,f){var _,S;let A=u,j=u;if(f.terrain){const N=new l.Y(e.z,i,e.z,e.x,e.y),F=f.terrain.getMinMaxElevation(N);A=(_=F.minElevation)!==null&&_!==void 0?_:u,j=(S=F.maxElevation)!==null&&S!==void 0?S:u}const R=1<<e.z;return new Qr([i+e.x/R,e.y/R,A],[i+(e.x+1)/R,(e.y+1)/R,j])}allowVariableZoom(e,i){const u=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,f=l.ae(78.5-u/2,0,60);return!!i.terrain||e.pitch>f}allowWorldCopies(){return!0}recalculateCache(){}}class Gr{constructor(e,i,u){this.points=e,this.planes=i,this.aabb=u}static fromInvProjectionMatrix(e,i=1,u=0){const f=Math.pow(2,u),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(R=>{const N=1/(R=l.at([],R,e))[3]/i*f;return l.aR(R,R,[N,N,1/R[3],N])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(R=>{const N=l.aS([],_[R[0]],_[R[1]]),F=l.aS([],_[R[2]],_[R[1]]),U=l.aT([],l.aU([],N,F)),W=-l.aV(U,_[R[1]]);return U.concat(W)}),A=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],j=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const R of _)for(let N=0;N<3;N++)A[N]=Math.min(A[N],R[N]),j[N]=Math.max(j[N],R[N]);return new Gr(_,S,new Qr(A,j))}}class Ro{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,u){return this._helper.interpolatePadding(e,i,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i,u=!0){this._helper.resize(e,i,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,i){}constructor(e,i,u,f,_){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Ei({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,A)=>this.getConstrained(S,A)},e,i,u,f,_),this._coveringTilesDetailsProvider=new ta}clone(){const e=new Ro;return e.apply(this),e}apply(e,i,u){this._helper.apply(e,i,u)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const i=[new l.aW(0,e)];if(this._helper._renderWorldCopies){const u=this.screenPointToMercatorCoordinate(new l.P(0,0)),f=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,0)),_=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new l.P(0,this._helper._height)),A=Math.floor(Math.min(u.x,f.x,_.x,S.x)),j=Math.floor(Math.max(u.x,f.x,_.x,S.x)),R=1;for(let N=A-R;N<=j+R;N++)N!==0&&i.push(new l.aW(N,e))}return i}getCameraFrustum(){return Gr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const i=this.screenPointToLocation(this.centerPoint,e),u=e?e.getElevationForLngLatZoom(i,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(u)}setLocationAtPoint(e,i){const u=l.ag(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(i,u),_=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,u),S=l.$.fromLngLat(e),A=new l.$(S.x-(f.x-_.x),S.y-(f.y-_.y));this.setCenter(A==null?void 0:A.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,i){return i?this.coordinatePoint(l.$.fromLngLat(e),i.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(l.$.fromLngLat(e))}screenPointToLocation(e,i){var u;return(u=this.screenPointToMercatorCoordinate(e,i))===null||u===void 0?void 0:u.toLngLat()}screenPointToMercatorCoordinate(e,i){if(i){const u=i.pointCoordinate(e);if(u!=null)return u}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,i){const u=i||0,f=[e.x,e.y,0,1],_=[e.x,e.y,1,1];l.at(f,f,this._pixelMatrixInverse),l.at(_,_,this._pixelMatrixInverse);const S=f[3],A=_[3],j=f[1]/S,R=_[1]/A,N=f[2]/S,F=_[2]/A,U=N===F?0:(u-N)/(F-N);return new l.$(l.B.number(f[0]/S,_[0]/A,U)/this.worldSize,l.B.number(j,R,U)/this.worldSize,u)}coordinatePoint(e,i=0,u=this._pixelMatrix){const f=[e.x*this.worldSize,e.y*this.worldSize,i,1];return l.at(f,f,u),new l.P(f[0]/f[3],f[1]/f[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Re(this));return new Fr().extend(this.screenPointToLocation(new l.P(0,e))).extend(this.screenPointToLocation(new l.P(this._helper._width,e))).extend(this.screenPointToLocation(new l.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new l.P(0,this._helper._height)))}isPointOnMapSurface(e,i){return i?i.pointCoordinate(e)!=null:e.y>this.height/2-Re(this)}calculatePosMatrix(e,i=!1,u){var f;const _=(f=e.key)!==null&&f!==void 0?f:l.aX(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),S=i?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(_)){const R=S.get(_);return u?R.f32:R.f64}const A=Q(e,this.worldSize);l.N(A,i?this._alignedProjMatrix:this._viewProjMatrix,A);const j={f64:A,f32:new Float32Array(A)};return S.set(_,j),u?j.f32:j.f64}calculateFogMatrix(e){const i=e.key,u=this._fogMatrixCacheF32;if(u.has(i))return u.get(i);const f=Q(e,this.worldSize);return l.N(f,this._fogMatrix,f),u.set(i,new Float32Array(f)),u.get(i)}getConstrained(e,i){i=l.ae(+i,this.minZoom,this.maxZoom);const u={center:new l.Q(e.lng,e.lat),zoom:i};let f=this._helper._lngRange;this._helper._renderWorldCopies||f!==null||(f=[-179.9999999999,180-1e-10]);const _=this.tileSize*l.ac(u.zoom);let S=0,A=_,j=0,R=_,N=0,F=0;const{x:U,y:W}=this.size;if(this._helper._latRange){const xe=this._helper._latRange;S=l.S(xe[1])*_,A=l.S(xe[0])*_,A-S<W&&(N=W/(A-S))}f&&(j=l.aL(l.U(f[0])*_,0,_),R=l.aL(l.U(f[1])*_,0,_),R<j&&(R+=_),R-j<U&&(F=U/(R-j)));const{x:Y,y:ue}=ea(_,e);let ce,de;const pe=Math.max(F||0,N||0);if(pe){const xe=new l.P(F?(R+j)/2:Y,N?(A+S)/2:ue);return u.center=Mi(_,xe).wrap(),u.zoom+=l.ah(pe),u}if(this._helper._latRange){const xe=W/2;ue-xe<S&&(de=S+xe),ue+xe>A&&(de=A-xe)}if(f){const xe=(j+R)/2;let ve=Y;this._helper._renderWorldCopies&&(ve=l.aL(Y,xe-_/2,xe+_/2));const we=U/2;ve-we<j&&(ce=j+we),ve+we>R&&(ce=R-we)}if(ce!==void 0||de!==void 0){const xe=new l.P(ce??Y,de??ue);u.center=Mi(_,xe).wrap()}return u}calculateCenterFromCameraLngLatAlt(e,i,u,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,u,f)}_calculateNearFarZIfNeeded(e,i,u){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),_=e-f*this._helper._pixelPerMeter/Math.cos(i),S=f<0?_:e,A=Math.PI/2+this.pitchInRadians,j=l.ab(this.fov)*(Math.abs(Math.cos(l.ab(this.roll)))*this.height+Math.abs(Math.sin(l.ab(this.roll)))*this.width)/this.height*(.5+u.y/this.height),R=Math.sin(j)*S/Math.sin(l.ae(Math.PI-A-j,.01,Math.PI-.01)),N=Re(this),F=Math.atan(N/this._helper.cameraToCenterDistance),U=l.ab(.75),W=F>U?2*F*(.5+u.y/(2*N)):U,Y=Math.sin(W)*S/Math.sin(l.ae(Math.PI-A-W,.01,Math.PI-.01)),ue=Math.min(R,Y);this._helper._farZ=1.01*(Math.cos(Math.PI/2-i)*ue+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,i=ea(this.worldSize,this.center),u=i.x,f=i.y;this._helper._pixelPerMeter=l.ag(1,this.center.lat)*this.worldSize;const _=l.ab(Math.min(this.pitch,un)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(_));let A;this._calculateNearFarZIfNeeded(S,_,e),A=new Float64Array(16),l.aY(A,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),l.an(this._invProjMatrix,A),A[8]=2*-e.x/this._helper._width,A[9]=2*e.y/this._helper._height,this._projectionMatrix=l.aZ(A),l.M(A,A,[1,-1,1]),l.L(A,A,[0,0,-this._helper.cameraToCenterDistance]),l.a_(A,A,-this.rollInRadians),l.a$(A,A,this.pitchInRadians),l.a_(A,A,-this.bearingInRadians),l.L(A,A,[-u,-f,0]),this._mercatorMatrix=l.M([],A,[this.worldSize,this.worldSize,this.worldSize]),l.M(A,A,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=l.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,A),l.L(A,A,[0,0,-this.elevation]),this._viewProjMatrix=A,this._invViewProjMatrix=l.an([],A);const j=[0,0,-1,1];l.at(j,j,this._invViewProjMatrix),this._cameraPosition=[j[0]/j[3],j[1]/j[3],j[2]/j[3]],this._fogMatrix=new Float64Array(16),l.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,l.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),l.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),l.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),l.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),l.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),l.L(this._fogMatrix,this._fogMatrix,[-u,-f,0]),l.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),l.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=l.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,A);const R=this._helper._width%2/2,N=this._helper._height%2/2,F=Math.cos(this.bearingInRadians),U=Math.sin(-this.bearingInRadians),W=u-Math.round(u)+F*R+U*N,Y=f-Math.round(f)+F*N+U*R,ue=new Float64Array(A);if(l.L(ue,ue,[W>.5?W-1:W,Y>.5?Y-1:Y,0]),this._alignedProjMatrix=ue,A=l.an(new Float64Array(16),this._pixelMatrix),!A)throw new Error("failed to invert matrix");this._pixelMatrixInverse=A,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new l.P(0,0)),i=[e.x*this.worldSize,e.y*this.worldSize,0,1];return l.at(i,i,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=l.ag(1,this.center.lat)*this.worldSize;return J(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,i){const u=l.$.fromLngLat(e),f=[u.x*this.worldSize,u.y*this.worldSize,i,1];return l.at(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(e){const{overscaledTileID:i,aligned:u,applyTerrainMatrix:f}=e,_=this._helper.getMercatorTileCoordinates(i),S=i?this.calculatePosMatrix(i,u,!0):null;let A;return A=i&&i.terrainRttPosMatrix32f&&f?i.terrainRttPosMatrix32f:S||l.b0(),{mainMatrix:A,tileMercatorCoords:_,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:A}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,i,u){return 1}transformLightDirection(e){return l.aQ(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,i,u,f){const _=this.calculatePosMatrix(u);let S;f?(S=[e,i,f(e,i),1],l.at(S,S,_)):(S=[e,i,0,1],hn(S,S,_));const A=S[3];return{point:new l.P(S[0]/A,S[1]/A),signedDistanceFromCamera:A,isOccluded:!1}}populateCache(e){for(const i of e)this.calculatePosMatrix(i)}getMatrixForModel(e,i){const u=l.$.fromLngLat(e,i),f=u.meterInMercatorCoordinateUnits(),_=l.b1();return l.L(_,_,[u.x,u.y,u.z]),l.a_(_,_,Math.PI),l.a$(_,_,Math.PI/2),l.M(_,_,[-f,f,f]),_}getProjectionDataForCustomLayer(e=!0){const i=new l.Y(0,0,0,0,0),u=this.getProjectionData({overscaledTileID:i,applyGlobeMatrix:e}),f=Q(i,this.worldSize);l.N(f,this._viewProjMatrix,f),u.tileMercatorCoords=[0,0,1,1];const _=[l.Z,l.Z,this.worldSize/this._helper.pixelsPerMeter],S=l.b2();return l.M(S,f,_),u.fallbackMatrix=S,u.mainMatrix=S,u}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Wi(){l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ta(g){if(g.useSlerp)if(g.k<1){const e=l.b3(g.startEulerAngles.roll,g.startEulerAngles.pitch,g.startEulerAngles.bearing),i=l.b3(g.endEulerAngles.roll,g.endEulerAngles.pitch,g.endEulerAngles.bearing),u=new Float64Array(4);l.b4(u,e,i,g.k);const f=l.b5(u);g.tr.setRoll(f.roll),g.tr.setPitch(f.pitch),g.tr.setBearing(f.bearing)}else g.tr.setRoll(g.endEulerAngles.roll),g.tr.setPitch(g.endEulerAngles.pitch),g.tr.setBearing(g.endEulerAngles.bearing);else g.tr.setRoll(l.B.number(g.startEulerAngles.roll,g.endEulerAngles.roll,g.k)),g.tr.setPitch(l.B.number(g.startEulerAngles.pitch,g.endEulerAngles.pitch,g.k)),g.tr.setBearing(l.B.number(g.startEulerAngles.bearing,g.endEulerAngles.bearing,g.k))}function ra(g,e,i,u,f){const _=f.padding,S=ea(f.worldSize,i.getNorthWest()),A=ea(f.worldSize,i.getNorthEast()),j=ea(f.worldSize,i.getSouthEast()),R=ea(f.worldSize,i.getSouthWest()),N=l.ab(-u),F=S.rotate(N),U=A.rotate(N),W=j.rotate(N),Y=R.rotate(N),ue=new l.P(Math.max(F.x,U.x,Y.x,W.x),Math.max(F.y,U.y,Y.y,W.y)),ce=new l.P(Math.min(F.x,U.x,Y.x,W.x),Math.min(F.y,U.y,Y.y,W.y)),de=ue.sub(ce),pe=(f.width-(_.left+_.right+e.left+e.right))/de.x,xe=(f.height-(_.top+_.bottom+e.top+e.bottom))/de.y;if(xe<0||pe<0)return void Wi();const ve=Math.min(l.ah(f.scale*Math.min(pe,xe)),g.maxZoom),we=l.P.convert(g.offset),ke=new l.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(l.ab(u)),Te=we.add(ke).mult(f.scale/l.ac(ve));return{center:Mi(f.worldSize,S.add(j).div(2).sub(Te)),zoom:ve,bearing:u}}class fn{get useGlobeControls(){return!1}handlePanInertia(e,i){return{easingOffset:e,easingCenter:i.center}}handleMapControlsRollPitchBearingZoom(e,i){e.bearingDelta&&i.setBearing(i.bearing+e.bearingDelta),e.pitchDelta&&i.setPitch(i.pitch+e.pitchDelta),e.rollDelta&&i.setRoll(i.roll+e.rollDelta),e.zoomDelta&&i.setZoom(i.zoom+e.zoomDelta)}handleMapControlsPan(e,i,u){e.around.distSqr(i.centerPoint)<.01||i.setLocationAtPoint(u,e.around)}cameraForBoxAndBearing(e,i,u,f,_){return ra(e,i,u,f,_)}handleJumpToCenterZoom(e,i){e.zoom!==(i.zoom!==void 0?+i.zoom:e.zoom)&&e.setZoom(+i.zoom),i.center!==void 0&&e.setCenter(l.Q.convert(i.center))}handleEaseTo(e,i){const u=e.zoom,f=e.padding,_={roll:e.roll,pitch:e.pitch,bearing:e.bearing},S={roll:i.roll===void 0?e.roll:i.roll,pitch:i.pitch===void 0?e.pitch:i.pitch,bearing:i.bearing===void 0?e.bearing:i.bearing},A=i.zoom!==void 0,j=!e.isPaddingEqual(i.padding);let R=!1;const N=A?+i.zoom:e.zoom;let F=e.centerPoint.add(i.offsetAsPoint);const U=e.screenPointToLocation(F),{center:W,zoom:Y}=e.getConstrained(l.Q.convert(i.center||U),N??u);Ws(e,W);const ue=ea(e.worldSize,U),ce=ea(e.worldSize,W).sub(ue),de=l.ac(Y-u);return R=Y!==u,{easeFunc:pe=>{if(R&&e.setZoom(l.B.number(u,Y,pe)),l.b6(_,S)||Ta({startEulerAngles:_,endEulerAngles:S,tr:e,k:pe,useSlerp:_.roll!=S.roll}),j&&(e.interpolatePadding(f,i.padding,pe),F=e.centerPoint.add(i.offsetAsPoint)),i.around)e.setLocationAtPoint(i.around,i.aroundPoint);else{const xe=l.ac(e.zoom-u),ve=Y>u?Math.min(2,de):Math.max(.5,de),we=Math.pow(ve,1-pe),ke=Mi(e.worldSize,ue.add(ce.mult(pe*we)).mult(xe));e.setLocationAtPoint(e.renderWorldCopies?ke.wrap():ke,F)}},isZooming:R,elevationCenter:W}}handleFlyTo(e,i){const u=i.zoom!==void 0,f=e.zoom,_=e.getConstrained(l.Q.convert(i.center||i.locationAtOffset),u?+i.zoom:f),S=_.center,A=_.zoom;Ws(e,S);const j=ea(e.worldSize,i.locationAtOffset),R=ea(e.worldSize,S).sub(j),N=R.mag(),F=l.ac(A-f);let U;if(i.minZoom!==void 0){const W=Math.min(+i.minZoom,f,A),Y=e.getConstrained(S,W).zoom;U=l.ac(Y-f)}return{easeFunc:(W,Y,ue,ce)=>{e.setZoom(W===1?A:f+l.ah(Y));const de=W===1?S:Mi(e.worldSize,j.add(R.mult(ue)).mult(Y));e.setLocationAtPoint(e.renderWorldCopies?de.wrap():de,ce)},scaleOfZoom:F,targetCenter:S,scaleOfMinZoom:U,pixelPathLength:N}}}class Dr{constructor(e,i,u){this.blendFunction=e,this.blendColor=i,this.mask=u}}Dr.Replace=[1,0],Dr.disabled=new Dr(Dr.Replace,l.b7.transparent,[!1,!1,!1,!1]),Dr.unblended=new Dr(Dr.Replace,l.b7.transparent,[!0,!0,!0,!0]),Dr.alphaBlended=new Dr([1,771],l.b7.transparent,[!0,!0,!0,!0]);const Jr=2305;class pr{constructor(e,i,u){this.enable=e,this.mode=i,this.frontFace=u}}pr.disabled=new pr(!1,1029,Jr),pr.backCCW=new pr(!0,1029,Jr),pr.frontCCW=new pr(!0,1028,Jr);class Jt{constructor(e,i,u){this.func=e,this.mask=i,this.range=u}}Jt.ReadOnly=!1,Jt.ReadWrite=!0,Jt.disabled=new Jt(519,Jt.ReadOnly,[0,1]);const Cs=7680;class sr{constructor(e,i,u,f,_,S){this.test=e,this.ref=i,this.mask=u,this.fail=f,this.depthFail=_,this.pass=S}}sr.disabled=new sr({func:519,mask:0},0,0,Cs,Cs,Cs);const oa=new WeakMap;function Ci(g){var e;if(oa.has(g))return oa.get(g);{const i=(e=g.getParameter(g.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return oa.set(g,i),i}}class Ol{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const i=e.context,u=i.gl;this._texFormat=u.RGBA,this._texType=u.UNSIGNED_BYTE;const f=new l.aI;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const _=new l.aK;_.emplaceBack(0,1,2),this._fullscreenTriangle=new Io(i.createVertexBuffer(f,fa.members),i.createIndexBuffer(_),l.aJ.simpleSegment(0,0,f.length,_.length)),this._resultBuffer=new Uint8Array(4),i.activeTexture.set(u.TEXTURE1);const S=u.createTexture();u.bindTexture(u.TEXTURE_2D,S),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texImage2D(u.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=i.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),Ci(u)&&(this._pbo=u.createBuffer(),u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.bufferData(u.PIXEL_PACK_BUFFER,4,u.STREAM_READ),u.bindBuffer(u.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,i){const u=this._updateCount;return this._readbackQueue?u>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():u>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,i),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,i=e.gl;e.activeTexture.set(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,i){const u=this._cachedRenderContext.context,f=u.gl;if(this._bindFramebuffer(),u.viewport.set([0,0,this._texWidth,this._texHeight]),u.clear({color:l.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(u,f.TRIANGLES,Jt.disabled,sr.disabled,Dr.unblended,pr.disabled,((_,S)=>({u_input:_,u_output_expected:S}))(e,i),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Ci(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const _=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:_}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Ci(e)){const i=e.clientWaitSync(this._readbackQueue.sync,0,0);if(i===e.WAIT_FAILED)return l.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(i===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Ol._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let i=0;return i+=e[0]/256,i+=e[1]/65536,i+=e[2]/16777216,e[3]<127&&(i=-i),i/128}}const Do=l.Z/128;function Lc(g,e){const i=g.granularity!==void 0?Math.max(g.granularity,1):1,u=i+(g.generateBorders?2:0),f=i+(g.extendToNorthPole||g.generateBorders?1:0)+(g.extendToSouthPole||g.generateBorders?1:0),_=u+1,S=f+1,A=g.generateBorders?-1:0,j=g.generateBorders||g.extendToNorthPole?-1:0,R=i+(g.generateBorders?1:0),N=i+(g.generateBorders||g.extendToSouthPole?1:0),F=_*S,U=u*f*6,W=_*S>65536;if(W&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Y=W||e==="32bit",ue=new Int16Array(2*F);let ce=0;for(let xe=j;xe<=N;xe++)for(let ve=A;ve<=R;ve++){let we=ve/i*l.Z;ve===-1&&(we=-64),ve===i+1&&(we=l.Z+Do);let ke=xe/i*l.Z;xe===-1&&(ke=g.extendToNorthPole?l.b9:-64),xe===i+1&&(ke=g.extendToSouthPole?l.ba:l.Z+Do),ue[ce++]=we,ue[ce++]=ke}const de=Y?new Uint32Array(U):new Uint16Array(U);let pe=0;for(let xe=0;xe<f;xe++)for(let ve=0;ve<u;ve++){const we=ve+1+xe*_,ke=ve+(xe+1)*_,Te=ve+1+(xe+1)*_;de[pe++]=ve+xe*_,de[pe++]=ke,de[pe++]=we,de[pe++]=we,de[pe++]=ke,de[pe++]=Te}return{vertices:ue.buffer.slice(0),indices:de.buffer.slice(0),uses32bitIndices:Y}}const Xs=new l.aH({fill:new l.bb(128,2),line:new l.bb(512,0),tile:new l.bb(128,32),stencil:new l.bb(128,1),circle:3});class No{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ui.projectionGlobe}get vertexShaderPreludeCode(){return Ui.projectionMercator.vertexSource}get subdivisionGranularity(){return Xs}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Ol(e));const i=l.S(this._errorQueryLatitudeDegrees),u=2*Math.atan(Math.exp(Math.PI-i*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(i,u),_=re.now();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=_);const S=Math.min(Math.max((_-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=l.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,l.bd(S))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,i,u,f,_){const S=(_==="stencil"?Xs.stencil:Xs.tile).getGranularityForZoomLevel(i.z);return this._getMesh(e,{granularity:S,generateBorders:u,extendToNorthPole:i.y===0&&f,extendToSouthPole:i.y===(1<<i.z)-1&&f})}_getMesh(e,i){const u=this._getMeshKey(i);if(u in this._tileMeshCache)return this._tileMeshCache[u];const f=function(_,S){const A=Lc(S,"16bit"),j=l.aI.deserialize({arrayBuffer:A.vertices,length:A.vertices.byteLength/2/2}),R=l.aK.deserialize({arrayBuffer:A.indices,length:A.indices.byteLength/2/3});return new Io(_.createVertexBuffer(j,fa.members),_.createIndexBuffer(R),l.aJ.simpleSegment(0,0,j.length,R.length))}(e,i);return this._tileMeshCache[u]=f,f}recalculate(e){}hasTransition(){const e=re.now();let i=!1;return i=i||(e-this._errorMeasurementLastChangeTime)/1e3<.7,i=i||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,i}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Lo=new l.r({type:new l.D(l.v.projection.type)});class Oo extends l.E{constructor(e){super(),this._transitionable=new l.T(Lo),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.C(0)),this._mercatorProjection=new Nc,this._verticalPerspectiveProjection=new No}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof l.be){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,i,u,f,_){return this.currentProjection.getMeshFromTileID(e,i,u,f,_)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Bl(g){const e=Fo(g.worldSize,g.center.lat);return 2*Math.PI*e}function Bo(g,e,i,u,f){const _=1/(1<<f),S=e/l.Z*_+u*_,A=l.bg((g/l.Z*_+i*_)*Math.PI*2+Math.PI,2*Math.PI),j=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,R=Math.cos(j),N=new Float64Array(3);return N[0]=Math.sin(A)*R,N[1]=Math.sin(j),N[2]=Math.cos(A)*R,N}function ia(g){return function(e,i){const u=Math.cos(i),f=new Float64Array(3);return f[0]=Math.sin(e)*u,f[1]=Math.sin(i),f[2]=Math.cos(e)*u,f}(g.lng*Math.PI/180,g.lat*Math.PI/180)}function Fo(g,e){return g/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Uo(g){const e=Math.asin(g[1])/Math.PI*180,i=Math.sqrt(g[0]*g[0]+g[2]*g[2]);if(i>1e-6){const u=g[0]/i,f=Math.acos(g[2]/i),_=(u>0?f:-f)/Math.PI*180;return new l.Q(l.aL(_,-180,180),e)}return new l.Q(0,e)}function Ys(g){return Math.cos(g*Math.PI/180)}function aa(g,e){const i=Ys(g),u=Ys(e);return l.ah(u/i)}function Ou(g,e){const i=g.rotate(e.bearingInRadians),u=e.zoom+aa(e.center.lat,0),f=l.bc(1/Ys(e.center.lat),1/Ys(Math.min(Math.abs(e.center.lat),60)),l.bf(u,7,3,0,1)),_=360/Bl({worldSize:e.worldSize,center:{lat:e.center.lat}});return new l.Q(e.center.lng-i.x*_*f,l.ae(e.center.lat+i.y*_,-85.051129,l.af))}function Bu(g){const e=.5*g,i=Math.sin(e),u=Math.cos(e);return Math.log(i+u)-Math.log(u-i)}function df(g,e,i,u){const f=g.lat+i*u;if(Math.abs(i)>1){const _=(Math.sign(g.lat+i)!==Math.sign(g.lat)?-Math.abs(g.lat):Math.abs(g.lat))*Math.PI/180,S=Math.abs(g.lat+i)*Math.PI/180,A=Bu(_+u*(S-_)),j=Bu(_),R=Bu(S);return new l.Q(g.lng+e*((A-j)/(R-j)),f)}return new l.Q(g.lng+e*u,f)}class ff{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,i,u,f){const _=`${e.z}_${e.x}_${e.y}`,S=this._cache.get(_);if(S)return S;const A=this._cachePrevious.get(_);if(A)return this._cache.set(_,A),A;const j=this._aabbFactory(e,i,u,f);return this._cache.set(_,j),this._hadAnyChanges=!0,j}}function ma(g,e,i){const u=g-e;return u<0?-u:Math.max(0,u-i)}function Oc(g,e,i,u,f){const _=g-i;let S;return S=_<0?Math.min(-_,1+_-f):_>1?Math.min(Math.max(_-f,0),1-_):0,Math.max(S,ma(e,u,f))}class ts{constructor(){this._aabbCache=new ff(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,i,u,f){const _=1<<u.z,S=1/_,A=u.x/_,j=u.y/_;let R=2;return R=Math.min(R,Oc(e,i,A,j,S)),R=Math.min(R,Oc(e,i,A+.5,-j-S,S)),R=Math.min(R,Oc(e,i,A+.5,2-j-S,S)),R}getWrap(e,i,u){const f=1<<i.z,_=1/f,S=i.x/f,A=ma(e.x,S,_),j=ma(e.x,S-1,_),R=ma(e.x,S+1,_),N=Math.min(A,j,R);return N===R?1:N===j?-1:0}allowVariableZoom(e,i){return Ue(e,i)>4}allowWorldCopies(){return!1}getTileAABB(e,i,u,f){return this._aabbCache.getTileAABB(e,i,u,f)}_computeTileAABB(e,i,u,f){if(e.z<=0)return new Qr([-1,-1,-1],[1,1,1]);if(e.z===1)return new Qr([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const _=[Bo(0,0,e.x,e.y,e.z),Bo(l.Z,0,e.x,e.y,e.z),Bo(l.Z,l.Z,e.x,e.y,e.z),Bo(0,l.Z,e.x,e.y,e.z)],S=[1,1,1],A=[-1,-1,-1];for(const j of _)for(let R=0;R<3;R++)S[R]=Math.min(S[R],j[R]),A[R]=Math.max(A[R],j[R]);if(e.y===0||e.y===(1<<e.z)-1){const j=[0,e.y===0?1:-1,0];for(let R=0;R<3;R++)S[R]=Math.min(S[R],j[R]),A[R]=Math.max(A[R],j[R])}return new Qr(S,A)}}}class Vo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,u){return this._helper.interpolatePadding(e,i,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i){this._helper.resize(e,i)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=l.bk(),this._projectionMatrix=l.b1(),this._globeViewProjMatrix32f=l.b0(),this._globeViewProjMatrixNoCorrection=l.b1(),this._globeViewProjMatrixNoCorrectionInverted=l.b1(),this._globeProjMatrixInverted=l.b1(),this._cameraPosition=l.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Ei({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,i)=>this.getConstrained(e,i)}),this._coveringTilesDetailsProvider=new ts}clone(){const e=new Vo;return e.apply(this),e}apply(e,i){this._globeLatitudeErrorCorrectionRadians=i||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=l.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:i,applyGlobeMatrix:u}=e,f=this._helper.getMercatorTileCoordinates(i);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:u?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const i=this.pitchInRadians,u=this.cameraToCenterDistance/e,f=Math.sin(i)*u,_=Math.cos(i)*u+1,S=1/Math.sqrt(f*f+_*_)*1;let A=-f,j=_;const R=Math.sqrt(A*A+j*j);A/=R,j/=R;const N=[0,A,j];l.bl(N,N,[0,0,0],-this.bearingInRadians),l.bm(N,N,[0,0,0],-1*this.center.lat*Math.PI/180),l.bn(N,N,[0,0,0],this.center.lng*Math.PI/180);const F=1/l.bo(N);return l.aO(N,N,F),[...N,-S*F]}isLocationOccluded(e){return!this.isSurfacePointVisible(ia(e))}transformLightDirection(e){const i=this._helper._center.lng*Math.PI/180,u=this._helper._center.lat*Math.PI/180,f=Math.cos(u),_=[Math.sin(i)*f,Math.sin(u),Math.cos(i)*f],S=[_[2],0,-_[0]],A=[0,0,0];l.aU(A,S,_),l.aT(S,S),l.aT(A,A);const j=[0,0,0];return l.aT(j,[S[0]*e[0]+A[0]*e[1]+_[0]*e[2],S[1]*e[0]+A[1]*e[1]+_[1]*e[2],S[2]*e[0]+A[2]*e[1]+_[2]*e[2]]),j}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,i,u){const f=function(A,j,R){const N=1/(1<<R.z);return new l.$(A/l.Z*N+R.x*N,j/l.Z*N+R.y*N)}(e,i,u.canonical),_=(S=f.y,[l.bg(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(_[1])}projectTileCoordinates(e,i,u,f){const _=u.canonical,S=Bo(e,i,_.x,_.y,_.z),A=1+(f?f(e,i):0)/l.bu,j=[S[0]*A,S[1]*A,S[2]*A,1];l.at(j,j,this._globeViewProjMatrixNoCorrection);const R=this._cachedClippingPlane,N=R[0]*S[0]+R[1]*S[1]+R[2]*S[2]+R[3]<0;return{point:new l.P(j[0]/j[3],j[1]/j[3]),signedDistanceFromCamera:j[3],isOccluded:N}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Fo(this.worldSize,this.center.lat),i=l.b2(),u=l.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),l.aY(i,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;i[8]=2*-f.x/this._helper._width,i[9]=2*f.y/this._helper._height,this._projectionMatrix=l.aZ(i),this._globeProjMatrixInverted=l.b2(),l.an(this._globeProjMatrixInverted,i),l.L(i,i,[0,0,-this.cameraToCenterDistance]),l.a_(i,i,this.rollInRadians),l.a$(i,i,-this.pitchInRadians),l.a_(i,i,this.bearingInRadians),l.L(i,i,[0,0,-e]);const _=l.bh();_[0]=e,_[1]=e,_[2]=e,l.a$(u,i,this.center.lat*Math.PI/180),l.bp(u,u,-this.center.lng*Math.PI/180),l.M(u,u,_),this._globeViewProjMatrixNoCorrection=u,l.a$(i,i,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),l.bp(i,i,-this.center.lng*Math.PI/180),l.M(i,i,_),this._globeViewProjMatrix32f=new Float32Array(i),this._globeViewProjMatrixNoCorrectionInverted=l.b2(),l.an(this._globeViewProjMatrixNoCorrectionInverted,u);const S=l.bh();this._cameraPosition=l.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,l.bl(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),l.bm(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),l.bl(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),l.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),l.bm(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),l.bn(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const A=l.aZ(this._globeViewProjMatrixNoCorrectionInverted);l.M(A,A,[1,1,-1]),this._cachedFrustum=Gr.fromInvProjectionMatrix(A)}calculateFogMatrix(e){l.w("calculateFogMatrix is not supported on globe projection.");const i=l.b2();return l.ad(i),i}getVisibleUnwrappedCoordinates(e){return[new l.aW(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&l.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,i){if(!this._globeViewProjMatrixNoCorrection)return 1;const u=ia(e);l.aO(u,u,1+i/l.bu);const f=l.bk();return l.at(f,[u[0],u[1],u[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(e){}getBounds(){const e=.5*this.width,i=.5*this.height,u=[new l.P(0,0),new l.P(e,0),new l.P(this.width,0),new l.P(this.width,i),new l.P(this.width,this.height),new l.P(e,this.height),new l.P(0,this.height),new l.P(0,i)],f=[];for(const F of u)f.push(this.unprojectScreenPoint(F));let _=0,S=0,A=0,j=0;const R=this.center;for(const F of f){const U=l.bq(R.lng,F.lng),W=l.bq(R.lat,F.lat);U<S&&(S=U),U>_&&(_=U),W<j&&(j=W),W>A&&(A=W)}const N=[R.lng+S,R.lat+j,R.lng+_,R.lat+A];return this.isSurfacePointOnScreen([0,1,0])&&(N[3]=90,N[0]=-180,N[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(N[1]=-90,N[0]=-180,N[2]=180),new Fr(N)}getConstrained(e,i){const u=l.ae(e.lat,-85.051129,l.af),f=l.ae(+i,this.minZoom+aa(0,u),this.maxZoom);return{center:new l.Q(e.lng,u),zoom:f}}calculateCenterFromCameraLngLatAlt(e,i,u,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,u,f)}setLocationAtPoint(e,i){const u=ia(this.unprojectScreenPoint(i)),f=ia(e),_=l.bh();l.br(_);const S=l.bh();l.bn(S,u,_,-this.center.lng*Math.PI/180),l.bm(S,S,_,this.center.lat*Math.PI/180);const A=f[0]*f[0]+f[2]*f[2],j=S[0]*S[0];if(A<j)return;const R=Math.sqrt(A-j),N=-R,F=l.bs(f[0],f[2],S[0],R),U=l.bs(f[0],f[2],S[0],N),W=l.bh();l.bn(W,f,_,-F);const Y=l.bs(W[1],W[2],S[1],S[2]),ue=l.bh();l.bn(ue,f,_,-U);const ce=l.bs(ue[1],ue[2],S[1],S[2]),de=.5*Math.PI,pe=Y>=-de&&Y<=de,xe=ce>=-de&&ce<=de;let ve,we;if(pe&&xe){const et=this.center.lng*Math.PI/180,Ge=this.center.lat*Math.PI/180;l.bv(F,et)+l.bv(Y,Ge)<l.bv(U,et)+l.bv(ce,Ge)?(ve=F,we=Y):(ve=U,we=ce)}else if(pe)ve=F,we=Y;else{if(!xe)return;ve=U,we=ce}const ke=ve/Math.PI*180,Te=we/Math.PI*180,Ve=this.center.lat;this.setCenter(new l.Q(ke,l.ae(Te,-90,90))),this.setZoom(this.zoom+aa(Ve,this.center.lat))}locationToScreenPoint(e,i){const u=ia(e);if(i){const f=i.getElevationForLngLatZoom(e,this._helper._tileZoom);l.aO(u,u,1+f/l.bu)}return this._projectSurfacePointToScreen(u)}_projectSurfacePointToScreen(e){const i=l.bk();return l.at(i,[...e,1],this._globeViewProjMatrixNoCorrection),i[0]/=i[3],i[1]/=i[3],new l.P((.5*i[0]+.5)*this.width,(.5*-i[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,i){if(i){const u=i.pointCoordinate(e);if(u)return u}return l.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,i){var u;return(u=this.screenPointToMercatorCoordinate(e,i))===null||u===void 0?void 0:u.toLngLat()}isPointOnMapSurface(e,i){const u=this._cameraPosition,f=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(u,f)}getRayDirectionFromPixel(e){const i=l.bk();i[0]=e.x/this.width*2-1,i[1]=-1*(e.y/this.height*2-1),i[2]=1,i[3]=1,l.at(i,i,this._globeViewProjMatrixNoCorrectionInverted),i[0]/=i[3],i[1]/=i[3],i[2]/=i[3];const u=l.bh();u[0]=i[0]-this._cameraPosition[0],u[1]=i[1]-this._cameraPosition[1],u[2]=i[2]-this._cameraPosition[2];const f=l.bh();return l.aT(f,u),f}isSurfacePointVisible(e){const i=this._cachedClippingPlane;return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const i=l.bk();return l.at(i,[...e,1],this._globeViewProjMatrixNoCorrection),i[0]/=i[3],i[1]/=i[3],i[2]/=i[3],i[0]>-1&&i[0]<1&&i[1]>-1&&i[1]<1&&i[2]>-1&&i[2]<1}rayPlanetIntersection(e,i){const u=l.aV(e,i),f=l.bh(),_=l.bh();l.aO(_,i,u),l.aS(f,e,_);const S=1-l.aV(f,f);if(S<0)return null;const A=l.aV(e,e)-1,j=-u+(u<0?1:-1)*Math.sqrt(S),R=A/j,N=j;return{tMin:Math.min(R,N),tMax:Math.max(R,N)}}unprojectScreenPoint(e){const i=this._cameraPosition,u=this.getRayDirectionFromPixel(e),f=this.rayPlanetIntersection(i,u);if(f){const N=l.bh();l.aP(N,i,[u[0]*f.tMin,u[1]*f.tMin,u[2]*f.tMin]);const F=l.bh();return l.aT(F,N),Uo(F)}const _=this._cachedClippingPlane,S=_[0]*u[0]+_[1]*u[1]+_[2]*u[2],A=-l.bt(_,i)/S,j=l.bh();if(A>0)l.aP(j,i,[u[0]*A,u[1]*A,u[2]*A]);else{const N=l.bh();l.aP(N,i,[2*u[0],2*u[1],2*u[2]]);const F=l.bt(this._cachedClippingPlane,N);l.aS(j,N,[this._cachedClippingPlane[0]*F,this._cachedClippingPlane[1]*F,this._cachedClippingPlane[2]*F])}const R=function(N){const F=l.bh();return F[0]=N[0]*-N[3],F[1]=N[1]*-N[3],F[2]=N[2]*-N[3],{center:F,radius:Math.sqrt(1-N[3]*N[3])}}(_);return Uo(function(N,F,U){const W=l.bh();l.aS(W,U,N);const Y=l.bh();return l.bi(Y,N,W,F/l.bj(W)),Y}(R.center,R.radius,j))}getMatrixForModel(e,i){const u=l.Q.convert(e),f=1/l.bu,_=l.b1();return l.bp(_,_,u.lng/180*Math.PI),l.a$(_,_,-u.lat/180*Math.PI),l.L(_,_,[0,0,1+i/l.bu]),l.a$(_,_,.5*Math.PI),l.M(_,_,[f,f,f]),_}getProjectionDataForCustomLayer(e=!0){const i=this.getProjectionData({overscaledTileID:new l.Y(0,0,0,0,0),applyGlobeMatrix:e});return i.tileMercatorCoords=[0,0,1,1],i}getFastPathSimpleProjectionMatrix(e){}}class qo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,u){return this._helper.interpolatePadding(e,i,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i,u=!0){this._helper.resize(e,i,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,i){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=i,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Ei({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,i)=>this.getConstrained(e,i)}),this._globeness=1,this._mercatorTransform=new Ro,this._verticalPerspectiveTransform=new Vo}clone(){const e=new qo;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const i=this._mercatorTransform.getProjectionData(e),u=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?u.mainMatrix:i.mainMatrix,clippingPlane:u.clippingPlane,tileMercatorCoords:u.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:i.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return l.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return l.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,i,u){const f=this._mercatorTransform.getPitchedTextCorrection(e,i,u),_=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,i,u);return l.bc(f,_,this._globeness)}projectTileCoordinates(e,i,u,f){return this.currentTransform.projectTileCoordinates(e,i,u,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,i){return this.currentTransform.lngLatToCameraDepth(e,i)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,i){return this.currentTransform.getConstrained(e,i)}calculateCenterFromCameraLngLatAlt(e,i,u,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,u,f)}setLocationAtPoint(e,i){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,i),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,i),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,i){return this.currentTransform.locationToScreenPoint(e,i)}screenPointToMercatorCoordinate(e,i){return this.currentTransform.screenPointToMercatorCoordinate(e,i)}screenPointToLocation(e,i){return this.currentTransform.screenPointToLocation(e,i)}isPointOnMapSurface(e,i){return this.currentTransform.isPointOnMapSurface(e,i)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,i){return this.currentTransform.getMatrixForModel(e,i)}getProjectionDataForCustomLayer(e=!0){const i=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return i;const u=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return u.fallbackMatrix=i.mainMatrix,u}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class pn{get useGlobeControls(){return!0}handlePanInertia(e,i){const u=Ou(e,i);return Math.abs(u.lng-i.center.lng)>180&&(u.lng=i.center.lng+179.5*Math.sign(u.lng-i.center.lng)),{easingCenter:u,easingOffset:new l.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,i){const u=e.around,f=i.screenPointToLocation(u);e.bearingDelta&&i.setBearing(i.bearing+e.bearingDelta),e.pitchDelta&&i.setPitch(i.pitch+e.pitchDelta),e.rollDelta&&i.setRoll(i.roll+e.rollDelta);const _=i.zoom;e.zoomDelta&&i.setZoom(i.zoom+e.zoomDelta);const S=i.zoom-_;if(S===0)return;const A=l.bq(i.center.lng,f.lng),j=A/(Math.abs(A/180)+1),R=l.bq(i.center.lat,f.lat),N=i.getRayDirectionFromPixel(u),F=i.cameraPosition,U=-1*l.aV(F,N),W=l.bh();l.aP(W,F,[N[0]*U,N[1]*U,N[2]*U]);const Y=l.bo(W)-1,ue=Math.exp(.5*-Math.max(Y-.3,0)),ce=Fo(i.worldSize,i.center.lat)/Math.min(i.width,i.height),de=l.bf(ce,.9,.5,1,.25),pe=(1-l.ac(-S))*Math.min(ue,de),xe=i.center.lat,ve=i.zoom,we=new l.Q(i.center.lng+j*pe,l.ae(i.center.lat+R*pe,-85.051129,l.af));i.setLocationAtPoint(f,u);const ke=i.center,Te=l.bf(Math.abs(A),45,85,0,1),Ve=l.bf(ce,.75,.35,0,1),et=Math.pow(Math.max(Te,Ve),.25),Ge=l.bq(ke.lng,we.lng),He=l.bq(ke.lat,we.lat);i.setCenter(new l.Q(ke.lng+Ge*et,ke.lat+He*et).wrap()),i.setZoom(ve+aa(xe,i.center.lat))}handleMapControlsPan(e,i,u){if(!e.panDelta)return;const f=i.center.lat,_=i.zoom;i.setCenter(Ou(e.panDelta,i).wrap()),i.setZoom(_+aa(f,i.center.lat))}cameraForBoxAndBearing(e,i,u,f,_){const S=ra(e,i,u,f,_),A=i.left/_.width*2-1,j=(_.width-i.right)/_.width*2-1,R=i.top/_.height*-2+1,N=(_.height-i.bottom)/_.height*-2+1,F=l.bq(u.getWest(),u.getEast())<0,U=F?u.getEast():u.getWest(),W=F?u.getWest():u.getEast(),Y=Math.max(u.getNorth(),u.getSouth()),ue=Math.min(u.getNorth(),u.getSouth()),ce=U+.5*l.bq(U,W),de=Y+.5*l.bq(Y,ue),pe=_.clone();pe.setCenter(S.center),pe.setBearing(S.bearing),pe.setPitch(0),pe.setRoll(0),pe.setZoom(S.zoom);const xe=pe.modelViewProjectionMatrix,ve=[ia(u.getNorthWest()),ia(u.getNorthEast()),ia(u.getSouthWest()),ia(u.getSouthEast()),ia(new l.Q(W,de)),ia(new l.Q(U,de)),ia(new l.Q(ce,Y)),ia(new l.Q(ce,ue))],we=ia(S.center);let ke=Number.POSITIVE_INFINITY;for(const Te of ve)A<0&&(ke=pn.getLesserNonNegativeNonNull(ke,pn.solveVectorScale(Te,we,xe,"x",A))),j>0&&(ke=pn.getLesserNonNegativeNonNull(ke,pn.solveVectorScale(Te,we,xe,"x",j))),R>0&&(ke=pn.getLesserNonNegativeNonNull(ke,pn.solveVectorScale(Te,we,xe,"y",R))),N<0&&(ke=pn.getLesserNonNegativeNonNull(ke,pn.solveVectorScale(Te,we,xe,"y",N)));if(Number.isFinite(ke)&&ke!==0)return S.zoom=pe.zoom+l.ah(ke),S;Wi()}handleJumpToCenterZoom(e,i){const u=e.center.lat,f=e.getConstrained(i.center?l.Q.convert(i.center):e.center,e.zoom).center;e.setCenter(f.wrap());const _=i.zoom!==void 0?+i.zoom:e.zoom+aa(u,f.lat);e.zoom!==_&&e.setZoom(_)}handleEaseTo(e,i){const u=e.zoom,f=e.center,_=e.padding,S={roll:e.roll,pitch:e.pitch,bearing:e.bearing},A={roll:i.roll===void 0?e.roll:i.roll,pitch:i.pitch===void 0?e.pitch:i.pitch,bearing:i.bearing===void 0?e.bearing:i.bearing},j=i.zoom!==void 0,R=!e.isPaddingEqual(i.padding);let N=!1;const F=i.center?l.Q.convert(i.center):f,U=e.getConstrained(F,u).center;Ws(e,U);const W=e.clone();W.setCenter(U),W.setZoom(j?+i.zoom:u+aa(f.lat,F.lat)),W.setBearing(i.bearing);const Y=new l.P(l.ae(e.centerPoint.x+i.offsetAsPoint.x,0,e.width),l.ae(e.centerPoint.y+i.offsetAsPoint.y,0,e.height));W.setLocationAtPoint(U,Y);const ue=(i.offset&&i.offsetAsPoint.mag())>0?W.center:U,ce=j?+i.zoom:u+aa(f.lat,ue.lat),de=u+aa(f.lat,0),pe=ce+aa(ue.lat,0),xe=l.bq(f.lng,ue.lng),ve=l.bq(f.lat,ue.lat),we=l.ac(pe-de);return N=ce!==u,{easeFunc:ke=>{if(l.b6(S,A)||Ta({startEulerAngles:S,endEulerAngles:A,tr:e,k:ke,useSlerp:S.roll!=A.roll}),R&&e.interpolatePadding(_,i.padding,ke),i.around)l.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(i.around,i.aroundPoint);else{const Te=pe>de?Math.min(2,we):Math.max(.5,we),Ve=Math.pow(Te,1-ke),et=df(f,xe,ve,ke*Ve);e.setCenter(et.wrap())}if(N){const Te=l.B.number(de,pe,ke)+aa(0,e.center.lat);e.setZoom(Te)}},isZooming:N,elevationCenter:ue}}handleFlyTo(e,i){const u=i.zoom!==void 0,f=e.center,_=e.zoom,S=e.padding,A=!e.isPaddingEqual(i.padding),j=e.getConstrained(l.Q.convert(i.center||i.locationAtOffset),_).center,R=u?+i.zoom:e.zoom+aa(e.center.lat,j.lat),N=e.clone();N.setCenter(j),N.setZoom(R),N.setBearing(i.bearing);const F=new l.P(l.ae(e.centerPoint.x+i.offsetAsPoint.x,0,e.width),l.ae(e.centerPoint.y+i.offsetAsPoint.y,0,e.height));N.setLocationAtPoint(j,F);const U=N.center;Ws(e,U);const W=function(ve,we,ke){const Te=ia(we),Ve=ia(ke),et=l.aV(Te,Ve),Ge=Math.acos(et),He=Bl(ve);return Ge/(2*Math.PI)*He}(e,f,U),Y=_+aa(f.lat,0),ue=R+aa(U.lat,0),ce=l.ac(ue-Y);let de;if(typeof i.minZoom=="number"){const ve=+i.minZoom+aa(U.lat,0),we=Math.min(ve,Y,ue)+aa(0,U.lat),ke=e.getConstrained(U,we).zoom+aa(U.lat,0);de=l.ac(ke-Y)}const pe=l.bq(f.lng,U.lng),xe=l.bq(f.lat,U.lat);return{easeFunc:(ve,we,ke,Te)=>{const Ve=df(f,pe,xe,ke);A&&e.interpolatePadding(S,i.padding,ve);const et=ve===1?U:Ve;e.setCenter(et.wrap());const Ge=Y+l.ah(we);e.setZoom(ve===1?R:Ge+aa(0,et.lat))},scaleOfZoom:ce,targetCenter:U,scaleOfMinZoom:de,pixelPathLength:W}}static solveVectorScale(e,i,u,f,_){const S=f==="x"?[u[0],u[4],u[8],u[12]]:[u[1],u[5],u[9],u[13]],A=[u[3],u[7],u[11],u[15]],j=e[0]*S[0]+e[1]*S[1]+e[2]*S[2],R=e[0]*A[0]+e[1]*A[1]+e[2]*A[2],N=i[0]*S[0]+i[1]*S[1]+i[2]*S[2],F=i[0]*A[0]+i[1]*A[1]+i[2]*A[2];return N+_*R===j+_*F||A[3]*(j-N)+S[3]*(F-R)+j*F==N*R?null:(N+S[3]-_*F-_*A[3])/(N-j-_*F+_*R)}static getLesserNonNegativeNonNull(e,i){return i!==null&&i>=0&&i<e?i:e}}class Zo{constructor(e){this._globe=e,this._mercatorCameraHelper=new fn,this._verticalPerspectiveCameraHelper=new pn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,i){return this.currentHelper.handlePanInertia(e,i)}handleMapControlsRollPitchBearingZoom(e,i){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,i)}handleMapControlsPan(e,i,u){this.currentHelper.handleMapControlsPan(e,i,u)}cameraForBoxAndBearing(e,i,u,f,_){return this.currentHelper.cameraForBoxAndBearing(e,i,u,f,_)}handleJumpToCenterZoom(e,i){this.currentHelper.handleJumpToCenterZoom(e,i)}handleEaseTo(e,i){return this.currentHelper.handleEaseTo(e,i)}handleFlyTo(e,i){return this.currentHelper.handleFlyTo(e,i)}}const Fu=(g,e)=>l.x(g,e&&e.filter(i=>i.identifier!=="source.canvas")),pf=l.bw();class Hh extends l.E{constructor(e,i={}){super(),this._rtlPluginLoaded=()=>{for(const u in this.sourceCaches){const f=this.sourceCaches[u].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[u].reload()}},this.map=e,this.dispatcher=new qr(rr(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(u,f)=>this.getGlyphs(u,f)),this.dispatcher.registerMessageHandler("GI",(u,f)=>this.getImages(u,f)),this.imageManager=new xt,this.imageManager.setEventedParent(this),this.glyphManager=new er(e._requestManager,i.localIdeographFontFamily),this.lineAtlas=new Se(256,512),this.crossTileSymbolIndex=new Ll,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.bx,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",l.by()),cn().on(Dl,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const f=this.sourceCaches[u.sourceId];if(!f)return;const _=f.getSource();if(_&&_.vectorLayerIds)for(const S in this._layers){const A=this._layers[S];A.source===_.id&&this._validateLayer(A)}})}loadURL(e,i={},u){this.fire(new l.l("dataloading",{dataType:"style"})),i.validate=typeof i.validate!="boolean"||i.validate;const f=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const _=this._loadStyleRequest;l.j(f,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,i,u)}).catch(S=>{this._loadStyleRequest=null,S&&!_.signal.aborted&&this.fire(new l.k(S))})}loadJSON(e,i={},u){this.fire(new l.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,re.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,i.validate=i.validate!==!1,this._load(e,i,u)}).catch(()=>{})}loadEmpty(){this.fire(new l.l("dataloading",{dataType:"style"})),this._load(pf,{validate:!1})}_load(e,i,u){var f,_;const S=i.transformStyle?i.transformStyle(u,e):e;if(!i.validate||!Fu(this,l.y(S))){this._loaded=!0,this.stylesheet=S;for(const A in S.sources)this.addSource(A,S.sources[A],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs),this._createLayers(),this.light=new yt(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new Pt(this.stylesheet.sky),this.map.setTerrain((_=this.stylesheet.terrain)!==null&&_!==void 0?_:null),this.fire(new l.l("data",{dataType:"style"})),this.fire(new l.l("style.load"))}}_createLayers(){const e=l.bz(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(i=>i.id),this._layers={},this._serializedLayers=null;for(const i of e){const u=l.bA(i);u.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=u}}_loadSprite(e,i=!1,u=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(_,S,A,j){return l._(this,void 0,void 0,function*(){const R=Ye(_),N=A>1?"@2x":"",F={},U={};for(const{id:W,url:Y}of R){const ue=S.transformRequest(st(Y,N,".json"),"SpriteJSON");F[W]=l.j(ue,j);const ce=S.transformRequest(st(Y,N,".png"),"SpriteImage");U[W]=vt.getImage(ce,j)}return yield Promise.all([...Object.values(F),...Object.values(U)]),function(W,Y){return l._(this,void 0,void 0,function*(){const ue={};for(const ce in W){ue[ce]={};const de=re.getImageCanvasContext((yield Y[ce]).data),pe=(yield W[ce]).data;for(const xe in pe){const{width:ve,height:we,x:ke,y:Te,sdf:Ve,pixelRatio:et,stretchX:Ge,stretchY:He,content:Ke,textFitWidth:St,textFitHeight:wt}=pe[xe];ue[ce][xe]={data:null,pixelRatio:et,sdf:Ve,stretchX:Ge,stretchY:He,content:Ke,textFitWidth:St,textFitHeight:wt,spriteData:{width:ve,height:we,x:ke,y:Te,context:de}}}}return ue})}(F,U)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(_=>{if(this._spriteRequest=null,_)for(const S in _){this._spritesImagesIds[S]=[];const A=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(j=>!(j in _)):[];for(const j of A)this.imageManager.removeImage(j),this._changedImages[j]=!0;for(const j in _[S]){const R=S==="default"?j:`${S}:${j}`;this._spritesImagesIds[S].push(R),R in this.imageManager.images?this.imageManager.updateImage(R,_[S][j],!1):this.imageManager.addImage(R,_[S][j]),i&&(this._changedImages[R]=!0)}}}).catch(_=>{this._spriteRequest=null,f=_,this.fire(new l.k(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"})),u&&u(f)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}_validateLayer(e){const i=this.sourceCaches[e.source];if(!i)return;const u=e.sourceLayer;if(!u)return;const f=i.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(u)===-1)&&this.fire(new l.k(new Error(`Source layer "${u}" does not exist on source "${f.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,i=!1){const u=this._serializedAllLayers();if(!e||e.length===0)return Object.values(i?l.bB(u):u);const f=[];for(const _ of e)if(u[_]){const S=i?l.bB(u[_]):u[_];f.push(S)}return f}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const i=Object.keys(this._layers);for(const u of i){const f=this._layers[u];f.type!=="custom"&&(e[u]=f.serialize())}return e}hasTransitions(){var e,i,u;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((i=this.sky)===null||i===void 0)&&i.hasTransition()||!((u=this.projection)===null||u===void 0)&&u.hasTransition())return!0;for(const f in this.sourceCaches)if(this.sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const i=this._changed;if(i){const f=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(f.length||_.length)&&this._updateWorkerLayers(f,_);for(const S in this._updatedSources){const A=this._updatedSources[S];if(A==="reload")this._reloadSource(S);else{if(A!=="clear")throw new Error(`Invalid action ${A}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const u={};for(const f in this.sourceCaches){const _=this.sourceCaches[f];u[f]=_.used,_.used=!1}for(const f of this._order){const _=this._layers[f];_.recalculate(e,this._availableImages),!_.isHidden(e.zoom)&&_.source&&(this.sourceCaches[_.source].used=!0)}for(const f in u){const _=this.sourceCaches[f];!!u[f]!=!!_.used&&_.fire(new l.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,i&&this.fire(new l.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,i){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:i})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,i={}){var u;this._checkLoaded();const f=this.serialize();if(e=i.transformStyle?i.transformStyle(f,e):e,((u=i.validate)===null||u===void 0||u)&&Fu(this,l.y(e)))return!1;(e=l.bB(e)).layers=l.bz(e.layers);const _=l.bC(f,e),S=this._getOperationsToPerform(_);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const A of S.operations)A();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const i=[],u=[];for(const f of e)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":i.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":i.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":i.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":i.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":i.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":i.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":i.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":i.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":i.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":i.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":i.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":i.push(()=>this.setSprite.apply(this,f.args));break;case"setTerrain":i.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setSky":i.push(()=>this.setSky.apply(this,f.args));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setTransition":i.push(()=>{});break;default:u.push(f.command)}return{operations:i,unimplemented:u}}addImage(e,i){if(this.getImage(e))return this.fire(new l.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,i),this._afterImageUpdated(e)}updateImage(e,i){this.imageManager.updateImage(e,i)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new l.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,i,u={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(l.y.source,`sources.${e}`,i,null,u))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const f=this.sourceCaches[e]=new Le(e,i,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:e})),f.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===e)return this.fire(new l.k(new Error(`Source "${e}" cannot be removed while layer "${u}" is using it.`)));const i=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],i.fire(new l.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,i){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const u=this.sourceCaches[e].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(i),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,i,u={}){this._checkLoaded();const f=e.id;if(this.getLayer(f))return void this.fire(new l.k(new Error(`Layer "${f}" already exists on this map.`)));let _;if(e.type==="custom"){if(Fu(this,l.bD(e)))return;_=l.bA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(f,e.source),e=l.bB(e),e=l.e(e,{source:f})),this._validate(l.y.layer,`layers.${f}`,e,{arrayIndex:-1},u))return;_=l.bA(e),this._validateLayer(_),_.setEventedParent(this,{layer:{id:f}})}const S=i?this._order.indexOf(i):this._order.length;if(i&&S===-1)this.fire(new l.k(new Error(`Cannot add layer "${f}" before non-existing layer "${i}".`)));else{if(this._order.splice(S,0,f),this._layerOrderChanged=!0,this._layers[f]=_,this._removedLayers[f]&&_.source&&_.type!=="custom"){const A=this._removedLayers[f];delete this._removedLayers[f],A.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map)}}moveLayer(e,i){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new l.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===i)return;const u=this._order.indexOf(e);this._order.splice(u,1);const f=i?this._order.indexOf(i):this._order.length;i&&f===-1?this.fire(new l.k(new Error(`Cannot move layer "${e}" before non-existing layer "${i}".`))):(this._order.splice(f,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const i=this._layers[e];if(!i)return void this.fire(new l.k(new Error(`Cannot remove non-existing layer "${e}".`)));i.setEventedParent(null);const u=this._order.indexOf(e);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=i,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],i.onRemove&&i.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,i,u){this._checkLoaded();const f=this.getLayer(e);f?f.minzoom===i&&f.maxzoom===u||(i!=null&&(f.minzoom=i),u!=null&&(f.maxzoom=u),this._updateLayer(f)):this.fire(new l.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,i,u={}){this._checkLoaded();const f=this.getLayer(e);if(f){if(!l.bE(f.filter,i))return i==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(l.y.filter,`layers.${f.id}.filter`,i,null,u)||(f.filter=l.bB(i),this._updateLayer(f)))}else this.fire(new l.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return l.bB(this.getLayer(e).filter)}setLayoutProperty(e,i,u,f={}){this._checkLoaded();const _=this.getLayer(e);_?l.bE(_.getLayoutProperty(i),u)||(_.setLayoutProperty(i,u,f),this._updateLayer(_)):this.fire(new l.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,i){const u=this.getLayer(e);if(u)return u.getLayoutProperty(i);this.fire(new l.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,i,u,f={}){this._checkLoaded();const _=this.getLayer(e);_?l.bE(_.getPaintProperty(i),u)||(_.setPaintProperty(i,u,f)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new l.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,i){return this.getLayer(e).getPaintProperty(i)}setFeatureState(e,i){this._checkLoaded();const u=e.source,f=e.sourceLayer,_=this.sourceCaches[u];if(_===void 0)return void this.fire(new l.k(new Error(`The source '${u}' does not exist in the map's style.`)));const S=_.getSource().type;S==="geojson"&&f?this.fire(new l.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||f?(e.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),_.setFeatureState(f,e.id,i)):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,i){this._checkLoaded();const u=e.source,f=this.sourceCaches[u];if(f===void 0)return void this.fire(new l.k(new Error(`The source '${u}' does not exist in the map's style.`)));const _=f.getSource().type,S=_==="vector"?e.sourceLayer:void 0;_!=="vector"||S?i&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new l.k(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(S,e.id,i):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const i=e.source,u=e.sourceLayer,f=this.sourceCaches[i];if(f!==void 0)return f.getSource().type!=="vector"||u?(e.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),f.getFeatureState(u,e.id)):void this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.k(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=l.bF(this.sourceCaches,_=>_.serialize()),i=this._serializeByIds(this._order,!0),u=this.map.getTerrain()||void 0,f=this.stylesheet;return l.bG({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:e,layers:i,terrain:u},_=>_!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const i=S=>this._layers[S].type==="fill-extrusion",u={},f=[];for(let S=this._order.length-1;S>=0;S--){const A=this._order[S];if(i(A)){u[A]=S;for(const j of e){const R=j[A];if(R)for(const N of R)f.push(N)}}}f.sort((S,A)=>A.intersectionZ-S.intersectionZ);const _=[];for(let S=this._order.length-1;S>=0;S--){const A=this._order[S];if(i(A))for(let j=f.length-1;j>=0;j--){const R=f[j].feature;if(u[R.layer.id]<S)break;_.push(R),f.pop()}else for(const j of e){const R=j[A];if(R)for(const N of R)_.push(N.feature)}}return _}queryRenderedFeatures(e,i,u){i&&i.filter&&this._validate(l.y.filter,"queryRenderedFeatures.filter",i.filter,null,i);const f={};if(i&&i.layers){if(!(Array.isArray(i.layers)||i.layers instanceof Set))return this.fire(new l.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const R of i.layers){const N=this._layers[R];if(!N)return this.fire(new l.k(new Error(`The layer '${R}' does not exist in the map's style and cannot be queried for features.`))),[];f[N.source]=!0}}const _=[];i.availableImages=this._availableImages;const S=this._serializedAllLayers(),A=i.layers instanceof Set?i.layers:Array.isArray(i.layers)?new Set(i.layers):null,j=Object.assign(Object.assign({},i),{layers:A});for(const R in this.sourceCaches)i.layers&&!f[R]||_.push(Br(this.sourceCaches[R],this._layers,S,e,j,u,this.map.terrain?(N,F,U)=>this.map.terrain.getElevation(N,F,U):void 0));return this.placement&&_.push(function(R,N,F,U,W,Y,ue){const ce={},de=Y.queryRenderedSymbols(U),pe=[];for(const xe of Object.keys(de).map(Number))pe.push(ue[xe]);pe.sort(vi);for(const xe of pe){const ve=xe.featureIndex.lookupSymbolFeatures(de[xe.bucketInstanceId],N,xe.bucketIndex,xe.sourceLayerIndex,W.filter,W.layers,W.availableImages,R);for(const we in ve){const ke=ce[we]=ce[we]||[],Te=ve[we];Te.sort((Ve,et)=>{const Ge=xe.featureSortOrder;if(Ge){const He=Ge.indexOf(Ve.featureIndex);return Ge.indexOf(et.featureIndex)-He}return et.featureIndex-Ve.featureIndex});for(const Ve of Te)ke.push(Ve)}}return function(xe,ve,we){for(const ke in xe)for(const Te of xe[ke])Hi(Te,we[ve[ke].source]);return xe}(ce,R,F)}(this._layers,S,this.sourceCaches,e,j,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(e,i){i&&i.filter&&this._validate(l.y.filter,"querySourceFeatures.filter",i.filter,null,i);const u=this.sourceCaches[e];return u?function(f,_){const S=f.getRenderableIds().map(R=>f.getTileByID(R)),A=[],j={};for(let R=0;R<S.length;R++){const N=S[R],F=N.tileID.canonical.key;j[F]||(j[F]=!0,N.querySourceFeatures(A,_))}return A}(u,i):[]}getLight(){return this.light.getLight()}setLight(e,i={}){this._checkLoaded();const u=this.light.getLight();let f=!1;for(const S in e)if(!l.bE(e[S],u[S])){f=!0;break}if(!f)return;const _={now:re.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,i),this.light.updateTransitions(_)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,i={}){this._checkLoaded();const u=this.getSky();let f=!1;if(!e&&!u)return;if(e&&!u)f=!0;else if(!e&&u)f=!0;else for(const S in e)if(!l.bE(e[S],u[S])){f=!0;break}if(!f)return;const _={now:re.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,i),this.sky.updateTransitions(_)}_setProjectionInternal(e){const i=function(u){if(Array.isArray(u)){const f=new Oo({type:u});return{projection:f,transform:new qo,cameraHelper:new Zo(f)}}switch(u){case"mercator":return{projection:new Nc,transform:new Ro,cameraHelper:new fn};case"globe":{const f=new Oo({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:f,transform:new qo,cameraHelper:new Zo(f)}}case"vertical-perspective":return{projection:new No,transform:new Vo,cameraHelper:new pn};default:return l.w(`Unknown projection name: ${u}. Falling back to mercator projection.`),{projection:new Nc,transform:new Ro,cameraHelper:new fn}}}(e);this.projection=i.projection,this.map.migrateProjection(i.transform,i.cameraHelper);for(const u in this.sourceCaches)this.sourceCaches[u].reload()}_validate(e,i,u,f,_={}){return(!_||_.validate!==!1)&&Fu(this,e.call(l.y,l.e({key:i,style:this.serialize(),value:u,styleSpec:l.v},f)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),cn().off(Dl,this._rtlPluginLoaded);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this.sourceCaches){const u=this.sourceCaches[i];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const i in this.sourceCaches)this.sourceCaches[i].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,i,u,f,_=!1){let S=!1,A=!1;const j={};for(const R of this._order){const N=this._layers[R];if(N.type!=="symbol")continue;if(!j[N.source]){const U=this.sourceCaches[N.source];j[N.source]=U.getRenderableIds(!0).map(W=>U.getTileByID(W)).sort((W,Y)=>Y.tileID.overscaledZ-W.tileID.overscaledZ||(W.tileID.isLessThan(Y.tileID)?-1:1))}const F=this.crossTileSymbolIndex.addLayer(N,j[N.source],e.center.lng);S=S||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((_=_||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(re.now(),e.zoom))&&(this.pauseablePlacement=new Xa(e,this.map.terrain,this._order,_,i,u,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,j),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(re.now()),A=!0),S&&this.pauseablePlacement.placement.setStale()),A||S)for(const R of this._order){const N=this._layers[R];N.type==="symbol"&&this.placement.updateLayerOpacities(N,j[N.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(re.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,i){return l._(this,void 0,void 0,function*(){const u=yield this.imageManager.getImages(i.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[i.source];return f&&f.setDependencies(i.tileID.key,i.type,i.icons),u})}getGlyphs(e,i){return l._(this,void 0,void 0,function*(){const u=yield this.glyphManager.getGlyphs(i.stacks),f=this.sourceCaches[i.source];return f&&f.setDependencies(i.tileID.key,i.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,i={}){this._checkLoaded(),e&&this._validate(l.y.glyphs,"glyphs",e,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,i,u={},f){this._checkLoaded();const _=[{id:e,url:i}],S=[...Ye(this.stylesheet.sprite),..._];this._validate(l.y.sprite,"sprite",S,null,u)||(this.stylesheet.sprite=S,this._loadSprite(_,!0,f))}removeSprite(e){this._checkLoaded();const i=Ye(this.stylesheet.sprite);if(i.find(u=>u.id===e)){if(this._spritesImagesIds[e])for(const u of this._spritesImagesIds[e])this.imageManager.removeImage(u),this._changedImages[u]=!0;i.splice(i.findIndex(u=>u.id===e),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}else this.fire(new l.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Ye(this.stylesheet.sprite)}setSprite(e,i={},u){this._checkLoaded(),e&&this._validate(l.y.sprite,"sprite",e,null,i)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,u):(this._unloadSprite(),u&&u(null)))}}var qp=l.aG([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Zp{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,i,u,f,_,S,A,j,R){this.context=e;let N=this.boundPaintVertexBuffers.length!==f.length;for(let F=0;!N&&F<f.length;F++)this.boundPaintVertexBuffers[F]!==f[F]&&(N=!0);!this.vao||this.boundProgram!==i||this.boundLayoutVertexBuffer!==u||N||this.boundIndexBuffer!==_||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==A||this.boundDynamicVertexBuffer2!==j||this.boundDynamicVertexBuffer3!==R?this.freshBind(i,u,f,_,S,A,j,R):(e.bindVertexArray.set(this.vao),A&&A.bind(),_&&_.dynamicDraw&&_.bind(),j&&j.bind(),R&&R.bind())}freshBind(e,i,u,f,_,S,A,j){const R=e.numAttributes,N=this.context,F=N.gl;this.vao&&this.destroy(),this.vao=N.createVertexArray(),N.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=f,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=A,this.boundDynamicVertexBuffer3=j,i.enableAttributes(F,e);for(const U of u)U.enableAttributes(F,e);S&&S.enableAttributes(F,e),A&&A.enableAttributes(F,e),j&&j.enableAttributes(F,e),i.bind(),i.setVertexAttribPointers(F,e,_);for(const U of u)U.bind(),U.setVertexAttribPointers(F,e,_);S&&(S.bind(),S.setVertexAttribPointers(F,e,_)),f&&f.bind(),A&&(A.bind(),A.setVertexAttribPointers(F,e,_)),j&&(j.bind(),j.setVertexAttribPointers(F,e,_)),N.currentNumAttributes=R}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const $p=(g,e,i,u,f)=>({u_texture:0,u_ele_delta:g,u_fog_matrix:e,u_fog_color:i?i.properties.get("fog-color"):l.b7.white,u_fog_ground_blend:i?i.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:i?i.calculateFogBlendOpacity(u):0,u_horizon_color:i?i.properties.get("horizon-color"):l.b7.white,u_horizon_fog_blend:i?i.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),Uu={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Fl(g){const e=[];for(let i=0;i<g.length;i++){if(g[i]===null)continue;const u=g[i].split(" ");e.push(u.pop())}return e}class Vu{constructor(e,i,u,f,_,S,A,j,R=[]){const N=e.gl;this.program=N.createProgram();const F=Fl(i.staticAttributes),U=u?u.getBinderAttributes():[],W=F.concat(U),Y=Ui.prelude.staticUniforms?Fl(Ui.prelude.staticUniforms):[],ue=A.staticUniforms?Fl(A.staticUniforms):[],ce=i.staticUniforms?Fl(i.staticUniforms):[],de=u?u.getBinderUniforms():[],pe=Y.concat(ue).concat(ce).concat(de),xe=[];for(const Ge of pe)xe.indexOf(Ge)<0&&xe.push(Ge);const ve=u?u.defines():[];Ci(N)&&ve.unshift("#version 300 es"),_&&ve.push("#define OVERDRAW_INSPECTOR;"),S&&ve.push("#define TERRAIN3D;"),j&&ve.push(j),R&&ve.push(...R);let we=ve.concat(Ui.prelude.fragmentSource,A.fragmentSource,i.fragmentSource).join(`
`),ke=ve.concat(Ui.prelude.vertexSource,A.vertexSource,i.vertexSource).join(`
`);Ci(N)||(we=function(Ge){return Ge.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(we),ke=function(Ge){return Ge.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(ke));const Te=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(Te,we),N.compileShader(Te),!N.getShaderParameter(Te,N.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${N.getShaderInfoLog(Te)}`);N.attachShader(this.program,Te);const Ve=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(Ve,ke),N.compileShader(Ve),!N.getShaderParameter(Ve,N.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${N.getShaderInfoLog(Ve)}`);N.attachShader(this.program,Ve),this.attributes={};const et={};this.numAttributes=W.length;for(let Ge=0;Ge<this.numAttributes;Ge++)W[Ge]&&(N.bindAttribLocation(this.program,Ge,W[Ge]),this.attributes[W[Ge]]=Ge);if(N.linkProgram(this.program),!N.getProgramParameter(this.program,N.LINK_STATUS))throw new Error(`Program failed to link: ${N.getProgramInfoLog(this.program)}`);N.deleteShader(Ve),N.deleteShader(Te);for(let Ge=0;Ge<xe.length;Ge++){const He=xe[Ge];if(He&&!et[He]){const Ke=N.getUniformLocation(this.program,He);Ke&&(et[He]=Ke)}}this.fixedUniforms=f(e,et),this.terrainUniforms=((Ge,He)=>({u_depth:new l.bH(Ge,He.u_depth),u_terrain:new l.bH(Ge,He.u_terrain),u_terrain_dim:new l.b8(Ge,He.u_terrain_dim),u_terrain_matrix:new l.bJ(Ge,He.u_terrain_matrix),u_terrain_unpack:new l.bK(Ge,He.u_terrain_unpack),u_terrain_exaggeration:new l.b8(Ge,He.u_terrain_exaggeration)}))(e,et),this.projectionUniforms=((Ge,He)=>({u_projection_matrix:new l.bJ(Ge,He.u_projection_matrix),u_projection_tile_mercator_coords:new l.bK(Ge,He.u_projection_tile_mercator_coords),u_projection_clipping_plane:new l.bK(Ge,He.u_projection_clipping_plane),u_projection_transition:new l.b8(Ge,He.u_projection_transition),u_projection_fallback_matrix:new l.bJ(Ge,He.u_projection_fallback_matrix)}))(e,et),this.binderUniforms=u?u.getUniforms(e,et):[]}draw(e,i,u,f,_,S,A,j,R,N,F,U,W,Y,ue,ce,de,pe,xe){const ve=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(u),e.setStencilMode(f),e.setColorMode(_),e.setCullFace(S),j){e.activeTexture.set(ve.TEXTURE2),ve.bindTexture(ve.TEXTURE_2D,j.depthTexture),e.activeTexture.set(ve.TEXTURE3),ve.bindTexture(ve.TEXTURE_2D,j.texture);for(const ke in this.terrainUniforms)this.terrainUniforms[ke].set(j[ke])}if(R)for(const ke in R)this.projectionUniforms[Uu[ke]].set(R[ke]);if(A)for(const ke in this.fixedUniforms)this.fixedUniforms[ke].set(A[ke]);ce&&ce.setUniforms(e,this.binderUniforms,Y,{zoom:ue});let we=0;switch(i){case ve.LINES:we=2;break;case ve.TRIANGLES:we=3;break;case ve.LINE_STRIP:we=1}for(const ke of W.get()){const Te=ke.vaos||(ke.vaos={});(Te[N]||(Te[N]=new Zp)).bind(e,this,F,ce?ce.getPaintVertexBuffers():[],U,ke.vertexOffset,de,pe,xe),ve.drawElements(i,ke.primitiveLength*we,ve.UNSIGNED_SHORT,ke.primitiveOffset*we*2)}}}function qu(g,e,i){const u=1/l.az(i,1,e.transform.tileZoom),f=Math.pow(2,i.tileID.overscaledZ),_=i.tileSize*Math.pow(2,e.transform.tileZoom)/f,S=_*(i.tileID.canonical.x+i.tileID.wrap*f),A=_*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[u,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[S>>16,A>>16],u_pixel_coord_lower:[65535&S,65535&A]}}const Zu=(g,e,i,u)=>{const f=g.style.light,_=f.properties.get("position"),S=[_.x,_.y,_.z],A=l.bN();f.properties.get("anchor")==="viewport"&&l.bO(A,g.transform.bearingInRadians),l.bP(S,S,A);const j=g.transform.transformLightDirection(S),R=f.properties.get("color");return{u_lightpos:S,u_lightpos_globe:j,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[R.r,R.g,R.b],u_vertical_gradient:+e,u_opacity:i,u_fill_translate:u}},mn=(g,e,i,u,f,_,S)=>l.e(Zu(g,e,i,u),qu(_,g,S),{u_height_factor:-Math.pow(2,f.overscaledZ)/S.tileSize/8}),Ul=(g,e,i,u)=>l.e(qu(e,g,i),{u_fill_translate:u}),Wh=(g,e)=>({u_world:g,u_fill_translate:e}),Vl=(g,e,i,u,f)=>l.e(Ul(g,e,i,f),{u_world:u}),ql=(g,e,i,u,f)=>{const _=g.transform;let S,A,j=0;if(i.paint.get("circle-pitch-alignment")==="map"){const R=l.az(e,1,_.zoom);S=!0,A=[R,R],j=R/(l.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*f}else S=!1,A=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(i.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+S,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:A,u_globe_extrude_scale:j,u_translate:u}},mf=g=>({u_pixel_extrude_scale:[1/g.width,1/g.height]}),Bc=g=>({u_viewport_size:[g.width,g.height]}),Xh=(g,e=1)=>({u_color:g,u_overlay:0,u_overlay_scale:e}),gn=(g,e,i,u)=>{const f=l.az(g,1,e)/(l.Z*Math.pow(2,g.tileID.overscaledZ))*2*Math.PI*u;return{u_extrude_scale:l.az(g,1,e),u_intensity:i,u_globe_extrude_scale:f}},gf=(g,e,i,u)=>{const f=l.K();l.bQ(f,0,g.width,g.height,0,0,1);const _=g.context.gl;return{u_matrix:f,u_world:[_.drawingBufferWidth,_.drawingBufferHeight],u_image:i,u_color_ramp:u,u_opacity:e.paint.get("heatmap-opacity")}},yf=(g,e,i)=>{const u=i.paint.get("hillshade-accent-color");let f;switch(i.paint.get("hillshade-method")){case"basic":f=4;break;case"combined":f=1;break;case"igor":f=2;break;case"multidirectional":f=3;break;default:f=0}const _=i.getIlluminationProperties();for(let S=0;S<_.directionRadians.length;S++)i.paint.get("hillshade-illumination-anchor")==="viewport"&&(_.directionRadians[S]+=g.transform.bearingInRadians);return{u_image:0,u_latrange:Yh(0,e.tileID),u_exaggeration:i.paint.get("hillshade-exaggeration"),u_altitudes:_.altitudeRadians,u_azimuths:_.directionRadians,u_accent:u,u_method:f,u_highlights:_.highlightColor,u_shadows:_.shadowColor}},Gp=(g,e)=>{const i=e.stride,u=l.K();return l.bQ(u,0,l.Z,-8192,0,0,1),l.L(u,u,[0,-8192,0]),{u_matrix:u,u_image:1,u_dimension:[i,i],u_zoom:g.overscaledZ,u_unpack:e.getUnpackVector()}};function Yh(g,e){const i=Math.pow(2,e.canonical.z),u=e.canonical.y;return[new l.$(0,u/i).toLngLat().lat,new l.$(0,(u+1)/i).toLngLat().lat]}const Zl=(g,e,i,u)=>{const f=g.transform;return{u_translation:As(g,e,i),u_ratio:u/l.az(e,1,f.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},$l=(g,e,i,u,f)=>l.e(Zl(g,e,i,u),{u_image:0,u_image_height:f}),Gl=(g,e,i,u,f)=>{const _=g.transform,S=Hl(e,_);return{u_translation:As(g,e,i),u_texsize:e.imageAtlasTexture.size,u_ratio:u/l.az(e,1,_.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[S,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},_f=(g,e,i,u,f,_)=>{const S=g.lineAtlas,A=Hl(e,g.transform),j=i.layout.get("line-cap")==="round",R=S.getDash(f.from,j),N=S.getDash(f.to,j),F=R.width*_.fromScale,U=N.width*_.toScale;return l.e(Zl(g,e,i,u),{u_patternscale_a:[A/F,-R.height/2],u_patternscale_b:[A/U,-N.height/2],u_sdfgamma:S.width/(256*Math.min(F,U)*g.pixelRatio)/2,u_image:0,u_tex_y_a:R.y,u_tex_y_b:N.y,u_mix:_.t})};function Hl(g,e){return 1/l.az(g,1,e.tileZoom)}function As(g,e,i){return l.aA(g.transform,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Kh=(g,e,i,u,f)=>{return{u_tl_parent:g,u_scale_parent:e,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*u.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:u.paint.get("raster-brightness-min"),u_brightness_high:u.paint.get("raster-brightness-max"),u_saturation_factor:(S=u.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(_=u.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:$u(u.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var _,S};function $u(g){g*=Math.PI/180;const e=Math.sin(g),i=Math.cos(g);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}const Ks=(g,e,i,u,f,_,S,A,j,R,N,F,U)=>{const W=S.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:W.cameraToCenterDistance,u_pitch:W.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:W.width/W.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:A,u_coord_matrix:j,u_is_text:+N,u_pitch_with_map:+u,u_is_along_line:f,u_is_variable_anchor:_,u_texsize:F,u_texture:0,u_translation:R,u_pitched_scale:U}},Qh=(g,e,i,u,f,_,S,A,j,R,N,F,U,W)=>{const Y=S.transform;return l.e(Ks(g,e,i,u,f,_,S,A,j,R,N,F,W),{u_gamma_scale:u?Math.cos(Y.pitch*Math.PI/180)*Y.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},Fc=(g,e,i,u,f,_,S,A,j,R,N,F,U)=>l.e(Qh(g,e,i,u,f,_,S,A,j,R,!0,N,0,U),{u_texsize_icon:F,u_texture_icon:1}),vf=(g,e)=>({u_opacity:g,u_color:e}),Hp=(g,e,i,u,f)=>l.e(function(_,S,A,j){const R=A.imageManager.getPattern(_.from.toString()),N=A.imageManager.getPattern(_.to.toString()),{width:F,height:U}=A.imageManager.getPixelSize(),W=Math.pow(2,j.tileID.overscaledZ),Y=j.tileSize*Math.pow(2,A.transform.tileZoom)/W,ue=Y*(j.tileID.canonical.x+j.tileID.wrap*W),ce=Y*j.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:R.tl,u_pattern_br_a:R.br,u_pattern_tl_b:N.tl,u_pattern_br_b:N.br,u_texsize:[F,U],u_mix:S.t,u_pattern_size_a:R.displaySize,u_pattern_size_b:N.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/l.az(j,1,A.transform.tileZoom),u_pixel_coord_upper:[ue>>16,ce>>16],u_pixel_coord_lower:[65535&ue,65535&ce]}}(i,f,e,u),{u_opacity:g}),Jh=(g,e)=>{},xf={fillExtrusion:(g,e)=>({u_lightpos:new l.bL(g,e.u_lightpos),u_lightpos_globe:new l.bL(g,e.u_lightpos_globe),u_lightintensity:new l.b8(g,e.u_lightintensity),u_lightcolor:new l.bL(g,e.u_lightcolor),u_vertical_gradient:new l.b8(g,e.u_vertical_gradient),u_opacity:new l.b8(g,e.u_opacity),u_fill_translate:new l.bM(g,e.u_fill_translate)}),fillExtrusionPattern:(g,e)=>({u_lightpos:new l.bL(g,e.u_lightpos),u_lightpos_globe:new l.bL(g,e.u_lightpos_globe),u_lightintensity:new l.b8(g,e.u_lightintensity),u_lightcolor:new l.bL(g,e.u_lightcolor),u_vertical_gradient:new l.b8(g,e.u_vertical_gradient),u_height_factor:new l.b8(g,e.u_height_factor),u_opacity:new l.b8(g,e.u_opacity),u_fill_translate:new l.bM(g,e.u_fill_translate),u_image:new l.bH(g,e.u_image),u_texsize:new l.bM(g,e.u_texsize),u_pixel_coord_upper:new l.bM(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bM(g,e.u_pixel_coord_lower),u_scale:new l.bL(g,e.u_scale),u_fade:new l.b8(g,e.u_fade)}),fill:(g,e)=>({u_fill_translate:new l.bM(g,e.u_fill_translate)}),fillPattern:(g,e)=>({u_image:new l.bH(g,e.u_image),u_texsize:new l.bM(g,e.u_texsize),u_pixel_coord_upper:new l.bM(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bM(g,e.u_pixel_coord_lower),u_scale:new l.bL(g,e.u_scale),u_fade:new l.b8(g,e.u_fade),u_fill_translate:new l.bM(g,e.u_fill_translate)}),fillOutline:(g,e)=>({u_world:new l.bM(g,e.u_world),u_fill_translate:new l.bM(g,e.u_fill_translate)}),fillOutlinePattern:(g,e)=>({u_world:new l.bM(g,e.u_world),u_image:new l.bH(g,e.u_image),u_texsize:new l.bM(g,e.u_texsize),u_pixel_coord_upper:new l.bM(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bM(g,e.u_pixel_coord_lower),u_scale:new l.bL(g,e.u_scale),u_fade:new l.b8(g,e.u_fade),u_fill_translate:new l.bM(g,e.u_fill_translate)}),circle:(g,e)=>({u_camera_to_center_distance:new l.b8(g,e.u_camera_to_center_distance),u_scale_with_map:new l.bH(g,e.u_scale_with_map),u_pitch_with_map:new l.bH(g,e.u_pitch_with_map),u_extrude_scale:new l.bM(g,e.u_extrude_scale),u_device_pixel_ratio:new l.b8(g,e.u_device_pixel_ratio),u_globe_extrude_scale:new l.b8(g,e.u_globe_extrude_scale),u_translate:new l.bM(g,e.u_translate)}),collisionBox:(g,e)=>({u_pixel_extrude_scale:new l.bM(g,e.u_pixel_extrude_scale)}),collisionCircle:(g,e)=>({u_viewport_size:new l.bM(g,e.u_viewport_size)}),debug:(g,e)=>({u_color:new l.bI(g,e.u_color),u_overlay:new l.bH(g,e.u_overlay),u_overlay_scale:new l.b8(g,e.u_overlay_scale)}),depth:Jh,clippingMask:Jh,heatmap:(g,e)=>({u_extrude_scale:new l.b8(g,e.u_extrude_scale),u_intensity:new l.b8(g,e.u_intensity),u_globe_extrude_scale:new l.b8(g,e.u_globe_extrude_scale)}),heatmapTexture:(g,e)=>({u_matrix:new l.bJ(g,e.u_matrix),u_world:new l.bM(g,e.u_world),u_image:new l.bH(g,e.u_image),u_color_ramp:new l.bH(g,e.u_color_ramp),u_opacity:new l.b8(g,e.u_opacity)}),hillshade:(g,e)=>({u_image:new l.bH(g,e.u_image),u_latrange:new l.bM(g,e.u_latrange),u_exaggeration:new l.b8(g,e.u_exaggeration),u_altitudes:new l.bS(g,e.u_altitudes),u_azimuths:new l.bS(g,e.u_azimuths),u_accent:new l.bI(g,e.u_accent),u_method:new l.bH(g,e.u_method),u_shadows:new l.bR(g,e.u_shadows),u_highlights:new l.bR(g,e.u_highlights)}),hillshadePrepare:(g,e)=>({u_matrix:new l.bJ(g,e.u_matrix),u_image:new l.bH(g,e.u_image),u_dimension:new l.bM(g,e.u_dimension),u_zoom:new l.b8(g,e.u_zoom),u_unpack:new l.bK(g,e.u_unpack)}),line:(g,e)=>({u_translation:new l.bM(g,e.u_translation),u_ratio:new l.b8(g,e.u_ratio),u_device_pixel_ratio:new l.b8(g,e.u_device_pixel_ratio),u_units_to_pixels:new l.bM(g,e.u_units_to_pixels)}),lineGradient:(g,e)=>({u_translation:new l.bM(g,e.u_translation),u_ratio:new l.b8(g,e.u_ratio),u_device_pixel_ratio:new l.b8(g,e.u_device_pixel_ratio),u_units_to_pixels:new l.bM(g,e.u_units_to_pixels),u_image:new l.bH(g,e.u_image),u_image_height:new l.b8(g,e.u_image_height)}),linePattern:(g,e)=>({u_translation:new l.bM(g,e.u_translation),u_texsize:new l.bM(g,e.u_texsize),u_ratio:new l.b8(g,e.u_ratio),u_device_pixel_ratio:new l.b8(g,e.u_device_pixel_ratio),u_image:new l.bH(g,e.u_image),u_units_to_pixels:new l.bM(g,e.u_units_to_pixels),u_scale:new l.bL(g,e.u_scale),u_fade:new l.b8(g,e.u_fade)}),lineSDF:(g,e)=>({u_translation:new l.bM(g,e.u_translation),u_ratio:new l.b8(g,e.u_ratio),u_device_pixel_ratio:new l.b8(g,e.u_device_pixel_ratio),u_units_to_pixels:new l.bM(g,e.u_units_to_pixels),u_patternscale_a:new l.bM(g,e.u_patternscale_a),u_patternscale_b:new l.bM(g,e.u_patternscale_b),u_sdfgamma:new l.b8(g,e.u_sdfgamma),u_image:new l.bH(g,e.u_image),u_tex_y_a:new l.b8(g,e.u_tex_y_a),u_tex_y_b:new l.b8(g,e.u_tex_y_b),u_mix:new l.b8(g,e.u_mix)}),raster:(g,e)=>({u_tl_parent:new l.bM(g,e.u_tl_parent),u_scale_parent:new l.b8(g,e.u_scale_parent),u_buffer_scale:new l.b8(g,e.u_buffer_scale),u_fade_t:new l.b8(g,e.u_fade_t),u_opacity:new l.b8(g,e.u_opacity),u_image0:new l.bH(g,e.u_image0),u_image1:new l.bH(g,e.u_image1),u_brightness_low:new l.b8(g,e.u_brightness_low),u_brightness_high:new l.b8(g,e.u_brightness_high),u_saturation_factor:new l.b8(g,e.u_saturation_factor),u_contrast_factor:new l.b8(g,e.u_contrast_factor),u_spin_weights:new l.bL(g,e.u_spin_weights),u_coords_top:new l.bK(g,e.u_coords_top),u_coords_bottom:new l.bK(g,e.u_coords_bottom)}),symbolIcon:(g,e)=>({u_is_size_zoom_constant:new l.bH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bH(g,e.u_is_size_feature_constant),u_size_t:new l.b8(g,e.u_size_t),u_size:new l.b8(g,e.u_size),u_camera_to_center_distance:new l.b8(g,e.u_camera_to_center_distance),u_pitch:new l.b8(g,e.u_pitch),u_rotate_symbol:new l.bH(g,e.u_rotate_symbol),u_aspect_ratio:new l.b8(g,e.u_aspect_ratio),u_fade_change:new l.b8(g,e.u_fade_change),u_label_plane_matrix:new l.bJ(g,e.u_label_plane_matrix),u_coord_matrix:new l.bJ(g,e.u_coord_matrix),u_is_text:new l.bH(g,e.u_is_text),u_pitch_with_map:new l.bH(g,e.u_pitch_with_map),u_is_along_line:new l.bH(g,e.u_is_along_line),u_is_variable_anchor:new l.bH(g,e.u_is_variable_anchor),u_texsize:new l.bM(g,e.u_texsize),u_texture:new l.bH(g,e.u_texture),u_translation:new l.bM(g,e.u_translation),u_pitched_scale:new l.b8(g,e.u_pitched_scale)}),symbolSDF:(g,e)=>({u_is_size_zoom_constant:new l.bH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bH(g,e.u_is_size_feature_constant),u_size_t:new l.b8(g,e.u_size_t),u_size:new l.b8(g,e.u_size),u_camera_to_center_distance:new l.b8(g,e.u_camera_to_center_distance),u_pitch:new l.b8(g,e.u_pitch),u_rotate_symbol:new l.bH(g,e.u_rotate_symbol),u_aspect_ratio:new l.b8(g,e.u_aspect_ratio),u_fade_change:new l.b8(g,e.u_fade_change),u_label_plane_matrix:new l.bJ(g,e.u_label_plane_matrix),u_coord_matrix:new l.bJ(g,e.u_coord_matrix),u_is_text:new l.bH(g,e.u_is_text),u_pitch_with_map:new l.bH(g,e.u_pitch_with_map),u_is_along_line:new l.bH(g,e.u_is_along_line),u_is_variable_anchor:new l.bH(g,e.u_is_variable_anchor),u_texsize:new l.bM(g,e.u_texsize),u_texture:new l.bH(g,e.u_texture),u_gamma_scale:new l.b8(g,e.u_gamma_scale),u_device_pixel_ratio:new l.b8(g,e.u_device_pixel_ratio),u_is_halo:new l.bH(g,e.u_is_halo),u_translation:new l.bM(g,e.u_translation),u_pitched_scale:new l.b8(g,e.u_pitched_scale)}),symbolTextAndIcon:(g,e)=>({u_is_size_zoom_constant:new l.bH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bH(g,e.u_is_size_feature_constant),u_size_t:new l.b8(g,e.u_size_t),u_size:new l.b8(g,e.u_size),u_camera_to_center_distance:new l.b8(g,e.u_camera_to_center_distance),u_pitch:new l.b8(g,e.u_pitch),u_rotate_symbol:new l.bH(g,e.u_rotate_symbol),u_aspect_ratio:new l.b8(g,e.u_aspect_ratio),u_fade_change:new l.b8(g,e.u_fade_change),u_label_plane_matrix:new l.bJ(g,e.u_label_plane_matrix),u_coord_matrix:new l.bJ(g,e.u_coord_matrix),u_is_text:new l.bH(g,e.u_is_text),u_pitch_with_map:new l.bH(g,e.u_pitch_with_map),u_is_along_line:new l.bH(g,e.u_is_along_line),u_is_variable_anchor:new l.bH(g,e.u_is_variable_anchor),u_texsize:new l.bM(g,e.u_texsize),u_texsize_icon:new l.bM(g,e.u_texsize_icon),u_texture:new l.bH(g,e.u_texture),u_texture_icon:new l.bH(g,e.u_texture_icon),u_gamma_scale:new l.b8(g,e.u_gamma_scale),u_device_pixel_ratio:new l.b8(g,e.u_device_pixel_ratio),u_is_halo:new l.bH(g,e.u_is_halo),u_translation:new l.bM(g,e.u_translation),u_pitched_scale:new l.b8(g,e.u_pitched_scale)}),background:(g,e)=>({u_opacity:new l.b8(g,e.u_opacity),u_color:new l.bI(g,e.u_color)}),backgroundPattern:(g,e)=>({u_opacity:new l.b8(g,e.u_opacity),u_image:new l.bH(g,e.u_image),u_pattern_tl_a:new l.bM(g,e.u_pattern_tl_a),u_pattern_br_a:new l.bM(g,e.u_pattern_br_a),u_pattern_tl_b:new l.bM(g,e.u_pattern_tl_b),u_pattern_br_b:new l.bM(g,e.u_pattern_br_b),u_texsize:new l.bM(g,e.u_texsize),u_mix:new l.b8(g,e.u_mix),u_pattern_size_a:new l.bM(g,e.u_pattern_size_a),u_pattern_size_b:new l.bM(g,e.u_pattern_size_b),u_scale_a:new l.b8(g,e.u_scale_a),u_scale_b:new l.b8(g,e.u_scale_b),u_pixel_coord_upper:new l.bM(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new l.bM(g,e.u_pixel_coord_lower),u_tile_units_to_pixels:new l.b8(g,e.u_tile_units_to_pixels)}),terrain:(g,e)=>({u_texture:new l.bH(g,e.u_texture),u_ele_delta:new l.b8(g,e.u_ele_delta),u_fog_matrix:new l.bJ(g,e.u_fog_matrix),u_fog_color:new l.bI(g,e.u_fog_color),u_fog_ground_blend:new l.b8(g,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new l.b8(g,e.u_fog_ground_blend_opacity),u_horizon_color:new l.bI(g,e.u_horizon_color),u_horizon_fog_blend:new l.b8(g,e.u_horizon_fog_blend),u_is_globe_mode:new l.b8(g,e.u_is_globe_mode)}),terrainDepth:(g,e)=>({u_ele_delta:new l.b8(g,e.u_ele_delta)}),terrainCoords:(g,e)=>({u_texture:new l.bH(g,e.u_texture),u_terrain_coords_id:new l.b8(g,e.u_terrain_coords_id),u_ele_delta:new l.b8(g,e.u_ele_delta)}),projectionErrorMeasurement:(g,e)=>({u_input:new l.b8(g,e.u_input),u_output_expected:new l.b8(g,e.u_output_expected)}),atmosphere:(g,e)=>({u_sun_pos:new l.bL(g,e.u_sun_pos),u_atmosphere_blend:new l.b8(g,e.u_atmosphere_blend),u_globe_position:new l.bL(g,e.u_globe_position),u_globe_radius:new l.b8(g,e.u_globe_radius),u_inv_proj_matrix:new l.bJ(g,e.u_inv_proj_matrix)}),sky:(g,e)=>({u_sky_color:new l.bI(g,e.u_sky_color),u_horizon_color:new l.bI(g,e.u_horizon_color),u_horizon:new l.bM(g,e.u_horizon),u_horizon_normal:new l.bM(g,e.u_horizon_normal),u_sky_horizon_blend:new l.b8(g,e.u_sky_horizon_blend),u_sky_blend:new l.b8(g,e.u_sky_blend)})};class bf{constructor(e,i,u){this.context=e;const f=e.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const i=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ed={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Da{constructor(e,i,u,f){this.length=i.length,this.attributes=u,this.itemSize=i.bytesPerElement,this.dynamicDraw=f,this.context=e;const _=e.gl;this.buffer=_.createBuffer(),e.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,i){for(let u=0;u<this.attributes.length;u++){const f=i.attributes[this.attributes[u].name];f!==void 0&&e.enableVertexAttribArray(f)}}setVertexAttribPointers(e,i,u){for(let f=0;f<this.attributes.length;f++){const _=this.attributes[f],S=i.attributes[_.name];S!==void 0&&e.vertexAttribPointer(S,_.components,e[ed[_.type]],!1,this.itemSize,_.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class mr{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class rs extends mr{getDefault(){return l.b7.transparent}set(e){const i=this.current;(e.r!==i.r||e.g!==i.g||e.b!==i.b||e.a!==i.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Gu extends mr{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Hu extends mr{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Wu extends mr{getDefault(){return[!0,!0,!0,!0]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Xu extends mr{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class td extends mr{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class $o extends mr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const i=this.current;(e.func!==i.func||e.ref!==i.ref||e.mask!==i.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Qs extends mr{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class rd extends mr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.STENCIL_TEST):i.disable(i.STENCIL_TEST),this.current=e,this.dirty=!1}}class Uc extends mr{getDefault(){return[0,1]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class id extends mr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST),this.current=e,this.dirty=!1}}class wf extends mr{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Js extends mr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.BLEND):i.disable(i.BLEND),this.current=e,this.dirty=!1}}class Wl extends mr{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Yu extends mr{getDefault(){return l.b7.transparent}set(e){const i=this.current;(e.r!==i.r||e.g!==i.g||e.b!==i.b||e.a!==i.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Vc extends mr{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class is extends mr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),this.current=e,this.dirty=!1}}class qc extends mr{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Ku extends mr{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class eo extends mr{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Qu extends mr{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Xl extends mr{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class yn extends mr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class ad extends mr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindRenderbuffer(i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class nd extends mr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindTexture(i.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Ju extends mr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class la extends mr{getDefault(){return null}set(e){const i=this.gl;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ma extends mr{getDefault(){return null}set(e){var i;if(e===this.current&&!this.dirty)return;const u=this.gl;Ci(u)?u.bindVertexArray(e):(i=u.getExtension("OES_vertex_array_object"))===null||i===void 0||i.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class ks extends mr{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Go extends mr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Ho extends mr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Wo extends mr{constructor(e,i){super(e),this.context=e,this.parent=i}getDefault(){return null}}class to extends Wo{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Ya extends Wo{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class sd extends Wo{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const Xo="Framebuffer is not complete";class or{constructor(e,i,u,f,_){this.context=e,this.width=i,this.height=u;const S=e.gl,A=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new to(e,A),f)this.depthAttachment=_?new sd(e,A):new Ya(e,A);else if(_)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(Xo)}destroy(){const e=this.context.gl,i=this.colorAttachment.get();if(i&&e.deleteTexture(i),this.depthAttachment){const u=this.depthAttachment.get();u&&e.deleteRenderbuffer(u)}e.deleteFramebuffer(this.framebuffer)}}class Zc{constructor(e){var i,u;if(this.gl=e,this.clearColor=new rs(this),this.clearDepth=new Gu(this),this.clearStencil=new Hu(this),this.colorMask=new Wu(this),this.depthMask=new Xu(this),this.stencilMask=new td(this),this.stencilFunc=new $o(this),this.stencilOp=new Qs(this),this.stencilTest=new rd(this),this.depthRange=new Uc(this),this.depthTest=new id(this),this.depthFunc=new wf(this),this.blend=new Js(this),this.blendFunc=new Wl(this),this.blendColor=new Yu(this),this.blendEquation=new Vc(this),this.cullFace=new is(this),this.cullFaceSide=new qc(this),this.frontFace=new Ku(this),this.program=new eo(this),this.activeTexture=new Qu(this),this.viewport=new Xl(this),this.bindFramebuffer=new yn(this),this.bindRenderbuffer=new ad(this),this.bindTexture=new nd(this),this.bindVertexBuffer=new Ju(this),this.bindElementBuffer=new la(this),this.bindVertexArray=new Ma(this),this.pixelStoreUnpack=new ks(this),this.pixelStoreUnpackPremultiplyAlpha=new Go(this),this.pixelStoreUnpackFlipY=new Ho(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Ci(e)){this.HALF_FLOAT=e.HALF_FLOAT;const f=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(i=e.RGBA16F)!==null&&i!==void 0?i:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(u=e.RGB16F)!==null&&u!==void 0?u:f==null?void 0:f.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const f=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,i){return new bf(this,e,i)}createVertexBuffer(e,i,u){return new Da(this,e,i,u)}createRenderbuffer(e,i,u){const f=this.gl,_=f.createRenderbuffer();return this.bindRenderbuffer.set(_),f.renderbufferStorage(f.RENDERBUFFER,e,i,u),this.bindRenderbuffer.set(null),_}createFramebuffer(e,i,u,f){return new or(this,e,i,u,f)}clear({color:e,depth:i,stencil:u}){const f=this.gl;let _=0;e&&(_|=f.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(_|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),u!==void 0&&(_|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),f.clear(_)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){l.bE(e.blendFunction,Dr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Ci(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var i;return Ci(this.gl)?this.gl.deleteVertexArray(e):(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Ea;function ro(g,e,i,u,f){const _=g.context,S=g.transform,A=_.gl,j=g.useProgram("collisionBox"),R=[];let N=0,F=0;for(let de=0;de<u.length;de++){const pe=u[de],xe=e.getTile(pe).getBucket(i);if(!xe)continue;const ve=f?xe.textCollisionBox:xe.iconCollisionBox,we=xe.collisionCircleArray;we.length>0&&(R.push({circleArray:we,circleOffset:F,coord:pe}),N+=we.length/4,F=N),ve&&j.draw(_,A.LINES,Jt.disabled,sr.disabled,g.colorModeForRenderPass(),pr.disabled,mf(g.transform),g.style.map.terrain&&g.style.map.terrain.getTerrainData(pe),S.getProjectionData({overscaledTileID:pe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),i.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,null,g.transform.zoom,null,null,ve.collisionVertexBuffer)}if(!f||!R.length)return;const U=g.useProgram("collisionCircle"),W=new l.bT;W.resize(4*N),W._trim();let Y=0;for(const de of R)for(let pe=0;pe<de.circleArray.length/4;pe++){const xe=4*pe,ve=de.circleArray[xe+0],we=de.circleArray[xe+1],ke=de.circleArray[xe+2],Te=de.circleArray[xe+3];W.emplace(Y++,ve,we,ke,Te,0),W.emplace(Y++,ve,we,ke,Te,1),W.emplace(Y++,ve,we,ke,Te,2),W.emplace(Y++,ve,we,ke,Te,3)}(!Ea||Ea.length<2*N)&&(Ea=function(de){const pe=2*de,xe=new l.bV;xe.resize(pe),xe._trim();for(let ve=0;ve<pe;ve++){const we=6*ve;xe.uint16[we+0]=4*ve+0,xe.uint16[we+1]=4*ve+1,xe.uint16[we+2]=4*ve+2,xe.uint16[we+3]=4*ve+2,xe.uint16[we+4]=4*ve+3,xe.uint16[we+5]=4*ve+0}return xe}(N));const ue=_.createIndexBuffer(Ea,!0),ce=_.createVertexBuffer(W,l.bU.members,!0);for(const de of R){const pe=Bc(g.transform);U.draw(_,A.TRIANGLES,Jt.disabled,sr.disabled,g.colorModeForRenderPass(),pr.disabled,pe,g.style.map.terrain&&g.style.map.terrain.getTerrainData(de.coord),null,i.id,ce,ue,l.aJ.simpleSegment(0,2*de.circleOffset,de.circleArray.length,de.circleArray.length/2),null,g.transform.zoom,null,null,null)}ce.destroy(),ue.destroy()}const as=l.ad(new Float32Array(16));function eh(g,e,i,u,f,_){const{horizontalAlign:S,verticalAlign:A}=l.aE(g);return new l.P((-(S-.5)*e/f+u[0])*_,(-(A-.5)*i/f+u[1])*_)}function th(g,e,i,u,f,_){const S=e.tileAnchorPoint.add(new l.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let A=u.mult(_);i||(A=A.rotate(-f));const j=S.add(A);return Qe(j.x,j.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(i){const A=xi(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(g),j=Math.atan(A.y/A.x)+(A.x<0?Math.PI:0);return g.add(u.rotate(j))}return g.add(u)}function Ka(g,e,i,u,f,_,S,A,j,R,N,F){const U=g.text.placedSymbolArray,W=g.text.dynamicLayoutVertexArray,Y=g.icon.dynamicLayoutVertexArray,ue={};W.clear();for(let ce=0;ce<U.length;ce++){const de=U.get(ce),pe=de.hidden||!de.crossTileID||g.allowVerticalPlacement&&!de.placedOrientation?null:u[de.crossTileID];if(pe){const xe=new l.P(de.anchorX,de.anchorY),ve={getElevation:F,width:f.width,height:f.height,pitchedLabelPlaneMatrix:_,pitchWithMap:i,transform:f,tileAnchorPoint:xe,translation:R,unwrappedTileID:N},we=i?nr(xe.x,xe.y,ve):xi(xe.x,xe.y,ve),ke=jr(f.cameraToCenterDistance,we.signedDistanceFromCamera);let Te=l.am(g.textSizeData,A,de)*ke/l.ay;i&&(Te*=g.tilePixelRatio/S);const{width:Ve,height:et,anchor:Ge,textOffset:He,textBoxScale:Ke}=pe,St=eh(Ge,Ve,et,He,Ke,Te),wt=f.getPitchedTextCorrection(xe.x+R[0],xe.y+R[1],N),ft=th(we.point,ve,e,St,-f.bearingInRadians,wt),Lt=g.allowVerticalPlacement&&de.placedOrientation===l.al.vertical?Math.PI/2:0;for(let lr=0;lr<de.numGlyphs;lr++)l.as(W,ft,Lt);j&&de.associatedIconIndex>=0&&(ue[de.associatedIconIndex]={shiftedAnchor:ft,angle:Lt})}else Wa(de.numGlyphs,W)}if(j){Y.clear();const ce=g.icon.placedSymbolArray;for(let de=0;de<ce.length;de++){const pe=ce.get(de);if(pe.hidden)Wa(pe.numGlyphs,Y);else{const xe=ue[de];if(xe)for(let ve=0;ve<pe.numGlyphs;ve++)l.as(Y,xe.shiftedAnchor,xe.angle);else Wa(pe.numGlyphs,Y)}}g.icon.dynamicLayoutVertexBuffer.updateData(Y)}g.text.dynamicLayoutVertexBuffer.updateData(W)}function _n(g,e,i){return i.iconsInText&&e?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function ns(g,e,i,u,f,_,S,A,j,R,N,F,U){const W=g.context,Y=W.gl,ue=g.transform,ce=A==="map",de=j==="map",pe=A!=="viewport"&&i.layout.get("symbol-placement")!=="point",xe=ce&&!de&&!pe,ve=!i.layout.get("symbol-sort-key").isConstant();let we=!1;const ke=g.getDepthModeForSublayer(0,Jt.ReadOnly),Te=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ve=[],et=ue.getCircleRadiusCorrection();for(const Ge of u){const He=e.getTile(Ge),Ke=He.getBucket(i);if(!Ke)continue;const St=f?Ke.text:Ke.icon;if(!St||!St.segments.get().length||!St.hasVisibleVertices)continue;const wt=St.programConfigurations.get(i.id),ft=f||Ke.sdfIcons,Lt=f?Ke.textSizeData:Ke.iconSizeData,lr=de||ue.pitch!==0,ur=g.useProgram(_n(ft,f,Ke),wt),ei=l.ak(Lt,ue.zoom),Nr=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Ge);let ni,si,Tr,yr,ti=[0,0],mi=null;if(f)si=He.glyphAtlasTexture,Tr=Y.LINEAR,ni=He.glyphAtlasTexture.size,Ke.iconsInText&&(ti=He.imageAtlasTexture.size,mi=He.imageAtlasTexture,yr=lr||g.options.rotating||g.options.zooming||Lt.kind==="composite"||Lt.kind==="camera"?Y.LINEAR:Y.NEAREST);else{const Oi=i.layout.get("icon-size").constantOr(0)!==1||Ke.iconsNeedLinear;si=He.imageAtlasTexture,Tr=ft||g.options.rotating||g.options.zooming||Oi||lr?Y.LINEAR:Y.NEAREST,ni=He.imageAtlasTexture.size}const Yi=l.az(He,1,g.transform.zoom),Er=Bt(ce,g.transform,Yi),Ds=l.K();l.an(Ds,Er);const Ln=ar(de,ce,g.transform,Yi),Oa=l.aA(ue,He,_,S),cs=ue.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!U,applyTerrainMatrix:!0}),ac=Te&&Ke.hasTextData(),Ns=i.layout.get("icon-text-fit")!=="none"&&ac&&Ke.hasIconData();if(pe){const Oi=g.style.map.terrain?(_a,cr)=>g.style.map.terrain.getElevation(Ge,_a,cr):null,Vi=i.layout.get("text-rotation-alignment")==="map";Ar(Ke,g,f,Er,Ds,de,R,Vi,Ge.toUnwrapped(),ue.width,ue.height,Oa,Oi)}const fo=f&&Te||Ns,ya=pe||fo?as:de?Er:g.transform.clipSpaceToPixelsMatrix,Ls=ft&&i.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let On;On=ft?Ke.iconsInText?Fc(Lt.kind,ei,xe,de,pe,fo,g,ya,Ln,Oa,ni,ti,et):Qh(Lt.kind,ei,xe,de,pe,fo,g,ya,Ln,Oa,f,ni,0,et):Ks(Lt.kind,ei,xe,de,pe,fo,g,ya,Ln,Oa,f,ni,et);const Os={program:ur,buffers:St,uniformValues:On,projectionData:cs,atlasTexture:si,atlasTextureIcon:mi,atlasInterpolation:Tr,atlasInterpolationIcon:yr,isSDF:ft,hasHalo:Ls};if(ve&&Ke.canOverlap){we=!0;const Oi=St.segments.get();for(const Vi of Oi)Ve.push({segments:new l.aJ([Vi]),sortKey:Vi.sortKey,state:Os,terrainData:Nr})}else Ve.push({segments:St.segments,sortKey:0,state:Os,terrainData:Nr})}we&&Ve.sort((Ge,He)=>Ge.sortKey-He.sortKey);for(const Ge of Ve){const He=Ge.state;if(W.activeTexture.set(Y.TEXTURE0),He.atlasTexture.bind(He.atlasInterpolation,Y.CLAMP_TO_EDGE),He.atlasTextureIcon&&(W.activeTexture.set(Y.TEXTURE1),He.atlasTextureIcon&&He.atlasTextureIcon.bind(He.atlasInterpolationIcon,Y.CLAMP_TO_EDGE)),He.isSDF){const Ke=He.uniformValues;He.hasHalo&&(Ke.u_is_halo=1,Qa(He.buffers,Ge.segments,i,g,He.program,ke,N,F,Ke,He.projectionData,Ge.terrainData)),Ke.u_is_halo=0}Qa(He.buffers,Ge.segments,i,g,He.program,ke,N,F,He.uniformValues,He.projectionData,Ge.terrainData)}}function Qa(g,e,i,u,f,_,S,A,j,R,N){const F=u.context;f.draw(F,F.gl.TRIANGLES,_,S,A,pr.backCCW,j,N,R,i.id,g.layoutVertexBuffer,g.indexBuffer,e,i.paint,u.transform.zoom,g.programConfigurations.get(i.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function vn(g,e,i,u,f){const _=g.context,S=_.gl,A=sr.disabled,j=new Dr([S.ONE,S.ONE],l.b7.transparent,[!0,!0,!0,!0]),R=e.getBucket(i);if(!R)return;const N=u.key;let F=i.heatmapFbos.get(N);F||(F=$c(_,e.tileSize,e.tileSize),i.heatmapFbos.set(N,F)),_.bindFramebuffer.set(F.framebuffer),_.viewport.set([0,0,e.tileSize,e.tileSize]),_.clear({color:l.b7.transparent});const U=R.programConfigurations.get(i.id),W=g.useProgram("heatmap",U,!f),Y=g.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ue=g.style.map.terrain.getTerrainData(u);W.draw(_,S.TRIANGLES,Jt.disabled,A,j,pr.disabled,gn(e,g.transform.zoom,i.paint.get("heatmap-intensity"),1),ue,Y,i.id,R.layoutVertexBuffer,R.indexBuffer,R.segments,i.paint,g.transform.zoom,U)}function Ps(g,e,i,u,f){const _=g.context,S=_.gl,A=g.transform;_.setColorMode(g.colorModeForRenderPass());const j=Gc(_,e),R=i.key,N=e.heatmapFbos.get(R);if(!N)return;_.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,N.colorAttachment.get()),_.activeTexture.set(S.TEXTURE1),j.bind(S.LINEAR,S.CLAMP_TO_EDGE);const F=A.getProjectionData({overscaledTileID:i,applyTerrainMatrix:f,applyGlobeMatrix:!u});g.useProgram("heatmapTexture").draw(_,S.TRIANGLES,Jt.disabled,sr.disabled,g.colorModeForRenderPass(),pr.disabled,gf(g,e,0,1),null,F,e.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,e.paint,A.zoom),N.destroy(),e.heatmapFbos.delete(R)}function $c(g,e,i){var u,f;const _=g.gl,S=_.createTexture();_.bindTexture(_.TEXTURE_2D,S),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR);const A=(u=g.HALF_FLOAT)!==null&&u!==void 0?u:_.UNSIGNED_BYTE,j=(f=g.RGBA16F)!==null&&f!==void 0?f:_.RGBA;_.texImage2D(_.TEXTURE_2D,0,j,e,i,0,_.RGBA,A,null);const R=g.createFramebuffer(e,i,!1,!1);return R.colorAttachment.set(S),R}function Gc(g,e){return e.colorRampTexture||(e.colorRampTexture=new ot(g,e.colorRamp,g.gl.RGBA)),e.colorRampTexture}function Yo(g,e,i,u,f){if(!i||!u||!u.imageAtlas)return;const _=u.imageAtlas.patternPositions;let S=_[i.to.toString()],A=_[i.from.toString()];if(!S&&A&&(S=A),!A&&S&&(A=S),!S||!A){const j=f.getPaintProperty(e);S=_[j],A=_[j]}S&&A&&g.setConstantPatternPositions(S,A)}function Xi(g,e,i,u,f,_,S,A){const j=g.context.gl,R="fill-pattern",N=i.paint.get(R),F=N&&N.constantOr(1),U=i.getCrossfadeParameters();let W,Y,ue,ce,de;const pe=g.transform,xe=i.paint.get("fill-translate"),ve=i.paint.get("fill-translate-anchor");S?(Y=F&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=j.LINES):(Y=F?"fillPattern":"fill",W=j.TRIANGLES);const we=N.constantOr(null);for(const ke of u){const Te=e.getTile(ke);if(F&&!Te.patternsLoaded())continue;const Ve=Te.getBucket(i);if(!Ve)continue;const et=Ve.programConfigurations.get(i.id),Ge=g.useProgram(Y,et),He=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ke);F&&(g.context.activeTexture.set(j.TEXTURE0),Te.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),et.updatePaintBuffers(U)),Yo(et,R,we,Te,i);const Ke=pe.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!A,applyTerrainMatrix:!0}),St=l.aA(pe,Te,xe,ve);if(S){ce=Ve.indexBuffer2,de=Ve.segments2;const ft=[j.drawingBufferWidth,j.drawingBufferHeight];ue=Y==="fillOutlinePattern"&&F?Vl(g,U,Te,ft,St):Wh(ft,St)}else ce=Ve.indexBuffer,de=Ve.segments,ue=F?Ul(g,U,Te,St):{u_fill_translate:St};const wt=g.stencilModeForClipping(ke);Ge.draw(g.context,W,f,wt,_,pr.backCCW,ue,He,Ke,i.id,Ve.layoutVertexBuffer,ce,de,i.paint,g.transform.zoom,et)}}function Di(g,e,i,u,f,_,S,A){const j=g.context,R=j.gl,N="fill-extrusion-pattern",F=i.paint.get(N),U=F.constantOr(1),W=i.getCrossfadeParameters(),Y=i.paint.get("fill-extrusion-opacity"),ue=F.constantOr(null),ce=g.transform;for(const de of u){const pe=e.getTile(de),xe=pe.getBucket(i);if(!xe)continue;const ve=g.style.map.terrain&&g.style.map.terrain.getTerrainData(de),we=xe.programConfigurations.get(i.id),ke=g.useProgram(U?"fillExtrusionPattern":"fillExtrusion",we);U&&(g.context.activeTexture.set(R.TEXTURE0),pe.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),we.updatePaintBuffers(W));const Te=ce.getProjectionData({overscaledTileID:de,applyGlobeMatrix:!A,applyTerrainMatrix:!0});Yo(we,N,ue,pe,i);const Ve=l.aA(ce,pe,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),et=i.paint.get("fill-extrusion-vertical-gradient"),Ge=U?mn(g,et,Y,Ve,de,W,pe):Zu(g,et,Y,Ve);ke.draw(j,j.gl.TRIANGLES,f,_,S,pr.backCCW,Ge,ve,Te,i.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,i.paint,g.transform.zoom,we,g.style.map.terrain&&xe.centroidVertexBuffer)}}function kr(g,e,i,u,f,_,S,A,j){var R;const N=g.style.projection,F=g.context,U=g.transform,W=F.gl,Y=[`#define NUM_ILLUMINATION_SOURCES ${i.paint.get("hillshade-highlight-color").values.length}`],ue=g.useProgram("hillshade",null,!1,Y),ce=!g.options.moving;for(const de of u){const pe=e.getTile(de),xe=pe.fbo;if(!xe)continue;const ve=N.getMeshFromTileID(F,de.canonical,A,!0,"raster"),we=(R=g.style.map.terrain)===null||R===void 0?void 0:R.getTerrainData(de);F.activeTexture.set(W.TEXTURE0),W.bindTexture(W.TEXTURE_2D,xe.colorAttachment.get());const ke=U.getProjectionData({overscaledTileID:de,aligned:ce,applyGlobeMatrix:!j,applyTerrainMatrix:!0});ue.draw(F,W.TRIANGLES,_,f[de.overscaledZ],S,pr.backCCW,yf(g,pe,i),we,ke,i.id,ve.vertexBuffer,ve.indexBuffer,ve.segments)}}const Ca=[new l.P(0,0),new l.P(l.Z,0),new l.P(l.Z,l.Z),new l.P(0,l.Z)];function Ja(g,e,i,u,f,_,S,A,j=!1,R=!1){const N=u[u.length-1].overscaledZ,F=g.context,U=F.gl,W=g.useProgram("raster"),Y=g.transform,ue=g.style.projection,ce=g.colorModeForRenderPass(),de=!g.options.moving;for(const pe of u){const xe=g.getDepthModeForSublayer(pe.overscaledZ-N,i.paint.get("raster-opacity")===1?Jt.ReadWrite:Jt.ReadOnly,U.LESS),ve=e.getTile(pe);ve.registerFadeDuration(i.paint.get("raster-fade-duration"));const we=e.findLoadedParent(pe,0),ke=e.findLoadedSibling(pe),Te=rh(ve,we||ke||null,e,i,g.transform,g.style.map.terrain);let Ve,et;const Ge=i.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;F.activeTexture.set(U.TEXTURE0),ve.texture.bind(Ge,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),F.activeTexture.set(U.TEXTURE1),we?(we.texture.bind(Ge,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),Ve=Math.pow(2,we.tileID.overscaledZ-ve.tileID.overscaledZ),et=[ve.tileID.canonical.x*Ve%1,ve.tileID.canonical.y*Ve%1]):ve.texture.bind(Ge,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),ve.texture.useMipmap&&F.extTextureFilterAnisotropic&&g.transform.pitch>20&&U.texParameterf(U.TEXTURE_2D,F.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,F.extTextureFilterAnisotropicMax);const He=g.style.map.terrain&&g.style.map.terrain.getTerrainData(pe),Ke=Y.getProjectionData({overscaledTileID:pe,aligned:de,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),St=Kh(et||[0,0],Ve||1,Te,i,A),wt=ue.getMeshFromTileID(F,pe.canonical,_,S,"raster");W.draw(F,U.TRIANGLES,xe,f?f[pe.overscaledZ]:sr.disabled,ce,j?pr.frontCCW:pr.backCCW,St,He,Ke,i.id,wt.vertexBuffer,wt.indexBuffer,wt.segments)}}function rh(g,e,i,u,f,_){const S=u.paint.get("raster-fade-duration");if(!_&&S>0){const A=re.now(),j=(A-g.timeAdded)/S,R=e?(A-e.timeAdded)/S:-1,N=i.getSource(),F=Ue(f,{tileSize:N.tileSize,roundZoom:N.roundZoom}),U=!e||Math.abs(e.tileID.overscaledZ-F)>Math.abs(g.tileID.overscaledZ-F),W=U&&g.refreshedUponExpiration?1:l.ae(U?j:1-R,0,1);return g.refreshedUponExpiration&&j>=1&&(g.refreshedUponExpiration=!1),e?{opacity:1,mix:1-W}:{opacity:W,mix:0}}return{opacity:1,mix:0}}const ss=new l.b7(1,0,0,1),ih=new l.b7(0,1,0,1),od=new l.b7(0,0,1,1),Yl=new l.b7(1,0,1,1),io=new l.b7(0,1,1,1);function ao(g,e,i,u){Ql(g,0,e+i/2,g.transform.width,i,u)}function Kl(g,e,i,u){Ql(g,e-i/2,0,i,g.transform.height,u)}function Ql(g,e,i,u,f,_){const S=g.context,A=S.gl;A.enable(A.SCISSOR_TEST),A.scissor(e*g.pixelRatio,i*g.pixelRatio,u*g.pixelRatio,f*g.pixelRatio),S.clear({color:_}),A.disable(A.SCISSOR_TEST)}function di(g,e,i){const u=g.context,f=u.gl,_=g.useProgram("debug"),S=Jt.disabled,A=sr.disabled,j=g.colorModeForRenderPass(),R="$debug",N=g.style.map.terrain&&g.style.map.terrain.getTerrainData(i);u.activeTexture.set(f.TEXTURE0);const F=e.getTileByID(i.key).latestRawTileData,U=Math.floor((F&&F.byteLength||0)/1024),W=e.getTile(i).tileSize,Y=512/Math.min(W,512)*(i.overscaledZ/g.transform.zoom)*.5;let ue=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(ue+=` => ${i.overscaledZ}`),function(de,pe){de.initDebugOverlayCanvas();const xe=de.debugOverlayCanvas,ve=de.context.gl,we=de.debugOverlayCanvas.getContext("2d");we.clearRect(0,0,xe.width,xe.height),we.shadowColor="white",we.shadowBlur=2,we.lineWidth=1.5,we.strokeStyle="white",we.textBaseline="top",we.font="bold 36px Open Sans, sans-serif",we.fillText(pe,5,5),we.strokeText(pe,5,5),de.debugOverlayTexture.update(xe),de.debugOverlayTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE)}(g,`${ue} ${U}kB`);const ce=g.transform.getProjectionData({overscaledTileID:i,applyGlobeMatrix:!0,applyTerrainMatrix:!0});_.draw(u,f.TRIANGLES,S,A,Dr.alphaBlended,pr.disabled,Xh(l.b7.transparent,Y),null,ce,R,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),_.draw(u,f.LINE_STRIP,S,A,j,pr.disabled,Xh(l.b7.red),N,ce,R,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function js(g,e,i,u){const{isRenderingGlobe:f}=u,_=g.context,S=_.gl,A=g.transform,j=g.colorModeForRenderPass(),R=g.getDepthModeFor3D(),N=g.useProgram("terrain");_.bindFramebuffer.set(null),_.viewport.set([0,0,g.width,g.height]);for(const F of i){const U=e.getTerrainMesh(F.tileID),W=g.renderToTexture.getTexture(F),Y=e.getTerrainData(F.tileID);_.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,W.texture);const ue=e.getMeshFrameDelta(A.zoom),ce=A.calculateFogMatrix(F.tileID.toUnwrapped()),de=$p(ue,ce,g.style.sky,A.pitch,f),pe=A.getProjectionData({overscaledTileID:F.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});N.draw(_,S.TRIANGLES,R,sr.disabled,j,pr.backCCW,de,Y,pe,"terrain",U.vertexBuffer,U.indexBuffer,U.segments)}}function ga(g,e){if(!e.mesh){const i=new l.aI;i.emplaceBack(-1,-1),i.emplaceBack(1,-1),i.emplaceBack(1,1),i.emplaceBack(-1,1);const u=new l.aK;u.emplaceBack(0,1,2),u.emplaceBack(0,2,3),e.mesh=new Io(g.createVertexBuffer(i,fa.members),g.createIndexBuffer(u),l.aJ.simpleSegment(0,0,i.length,u.length))}return e.mesh}class ah{constructor(e,i){this.context=new Zc(e),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.ad(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Le.maxUnderzooming+Le.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ll}resize(e,i,u){if(this.width=Math.floor(e*u),this.height=Math.floor(i*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const e=this.context,i=new l.aI;i.emplaceBack(0,0),i.emplaceBack(l.Z,0),i.emplaceBack(0,l.Z),i.emplaceBack(l.Z,l.Z),this.tileExtentBuffer=e.createVertexBuffer(i,fa.members),this.tileExtentSegments=l.aJ.simpleSegment(0,0,4,2);const u=new l.aI;u.emplaceBack(0,0),u.emplaceBack(l.Z,0),u.emplaceBack(0,l.Z),u.emplaceBack(l.Z,l.Z),this.debugBuffer=e.createVertexBuffer(u,fa.members),this.debugSegments=l.aJ.simpleSegment(0,0,4,5);const f=new l.b_;f.emplaceBack(0,0,0,0),f.emplaceBack(l.Z,0,l.Z,0),f.emplaceBack(0,l.Z,0,l.Z),f.emplaceBack(l.Z,l.Z,l.Z,l.Z),this.rasterBoundsBuffer=e.createVertexBuffer(f,qp.members),this.rasterBoundsSegments=l.aJ.simpleSegment(0,0,4,2);const _=new l.aI;_.emplaceBack(0,0),_.emplaceBack(l.Z,0),_.emplaceBack(0,l.Z),_.emplaceBack(l.Z,l.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(_,fa.members),this.rasterBoundsSegmentsPosOnly=l.aJ.simpleSegment(0,0,4,5);const S=new l.aI;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(S,fa.members),this.viewportSegments=l.aJ.simpleSegment(0,0,4,2);const A=new l.b$;A.emplaceBack(0),A.emplaceBack(1),A.emplaceBack(3),A.emplaceBack(2),A.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(A);const j=new l.aK;j.emplaceBack(1,0,2),j.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(j);const R=this.context.gl;this.stencilClearMode=new sr({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO),this.tileExtentMesh=new Io(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,i=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=l.K();l.bQ(u,0,this.width,this.height,0,0,1),l.M(u,u,[i.drawingBufferWidth,i.drawingBufferHeight,0]);const f={mainMatrix:u,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:u};this.useProgram("clippingMask",null,!0).draw(e,i.TRIANGLES,Jt.disabled,this.stencilClearMode,Dr.disabled,pr.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,i,u){if(this.currentStencilSource===e.source||!e.isTileClipped()||!i||!i.length)return;this.currentStencilSource=e.source,this.nextStencilID+i.length>256&&this.clearStencil();const f=this.context;f.setColorMode(Dr.disabled),f.setDepthMode(Jt.disabled);const _={};for(const S of i)_[S.key]=this.nextStencilID++;this._renderTileMasks(_,i,u,!0),this._renderTileMasks(_,i,u,!1),this._tileClippingMaskIDs=_}_renderTileMasks(e,i,u,f){const _=this.context,S=_.gl,A=this.style.projection,j=this.transform,R=this.useProgram("clippingMask");for(const N of i){const F=e[N.key],U=this.style.map.terrain&&this.style.map.terrain.getTerrainData(N),W=A.getMeshFromTileID(this.context,N.canonical,f,!0,"stencil"),Y=j.getProjectionData({overscaledTileID:N,applyGlobeMatrix:!u,applyTerrainMatrix:!0});R.draw(_,S.TRIANGLES,Jt.disabled,new sr({func:S.ALWAYS,mask:0},F,255,S.KEEP,S.KEEP,S.REPLACE),Dr.disabled,u?pr.disabled:pr.backCCW,null,U,Y,"$clipping",W.vertexBuffer,W.indexBuffer,W.segments)}}_renderTilesDepthBuffer(){const e=this.context,i=e.gl,u=this.style.projection,f=this.transform,_=this.useProgram("depth"),S=this.getDepthModeFor3D(),A=Pe(f,{tileSize:f.tileSize});for(const j of A){const R=this.style.map.terrain&&this.style.map.terrain.getTerrainData(j),N=u.getMeshFromTileID(this.context,j.canonical,!0,!0,"raster"),F=f.getProjectionData({overscaledTileID:j,applyGlobeMatrix:!0,applyTerrainMatrix:!0});_.draw(e,i.TRIANGLES,S,sr.disabled,Dr.disabled,pr.backCCW,null,R,F,"$clipping",N.vertexBuffer,N.indexBuffer,N.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,i=this.context.gl;return new sr({func:i.NOTEQUAL,mask:255},e,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(e){const i=this.context.gl;return new sr({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,i.KEEP,i.KEEP,i.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const i=this.context.gl,u=e.sort((S,A)=>A.overscaledZ-S.overscaledZ),f=u[u.length-1].overscaledZ,_=u[0].overscaledZ-f+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const S={};for(let A=0;A<_;A++)S[A+f]=new sr({func:i.GEQUAL,mask:255},A+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=_,[S,u]}return[{[f]:sr.disabled},u]}stencilConfigForOverlapTwoPass(e){const i=this.context.gl,u=e.sort((S,A)=>A.overscaledZ-S.overscaledZ),f=u[u.length-1].overscaledZ,_=u[0].overscaledZ-f+1;if(this.clearStencil(),_>1){const S={},A={};for(let j=0;j<_;j++)S[j+f]=new sr({func:i.GREATER,mask:255},_+1+j,255,i.KEEP,i.KEEP,i.REPLACE),A[j+f]=new sr({func:i.GREATER,mask:255},1+j,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID=2*_+1,[S,A,u]}return this.nextStencilID=3,[{[f]:new sr({func:i.GREATER,mask:255},2,255,i.KEEP,i.KEEP,i.REPLACE)},{[f]:new sr({func:i.GREATER,mask:255},1,255,i.KEEP,i.KEEP,i.REPLACE)},u]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Dr([e.CONSTANT_COLOR,e.ONE],new l.b7(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Dr.unblended:Dr.alphaBlended}getDepthModeForSublayer(e,i,u){if(!this.opaquePassEnabledForLayer())return Jt.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Jt(u||this.context.gl.LEQUAL,i,[f,f])}getDepthModeFor3D(){return new Jt(this.context.gl.LEQUAL,Jt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,i){var u,f;this.style=e,this.options=i,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(re.now()),this.imageManager.beginFrame();const _=this.style._order,S=this.style.sourceCaches,A={},j={},R={},N={isRenderingToTexture:!1,isRenderingGlobe:((u=e.projection)===null||u===void 0?void 0:u.transitionState)>0};for(const U in S){const W=S[U];W.used&&W.prepare(this.context),A[U]=W.getVisibleCoordinates(!1),j[U]=A[U].slice().reverse(),R[U]=W.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let U=0;U<_.length;U++)if(this.style._layers[_[U]].is3D()){this.opaquePassCutoff=U;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const U of _){const W=this.style._layers[U];if(!W.hasOffscreenPass()||W.isHidden(this.transform.zoom))continue;const Y=j[W.source];(W.type==="custom"||Y.length)&&this.renderLayer(this,S[W.source],W,Y,N)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:U=>this.useProgram(U)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?l.b7.black:l.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(U,W){const Y=U.context,ue=Y.gl,ce=((ke,Te,Ve)=>{const et=Math.cos(Te.rollInRadians),Ge=Math.sin(Te.rollInRadians),He=Re(Te),Ke=Te.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ke.properties.get("sky-color"),u_horizon_color:ke.properties.get("horizon-color"),u_horizon:[(Te.width/2-He*Ge)*Ve,(Te.height/2+He*et)*Ve],u_horizon_normal:[-Ge,et],u_sky_horizon_blend:ke.properties.get("sky-horizon-blend")*Te.height/2*Ve,u_sky_blend:Ke}})(W,U.style.map.transform,U.pixelRatio),de=new Jt(ue.LEQUAL,Jt.ReadWrite,[0,1]),pe=sr.disabled,xe=U.colorModeForRenderPass(),ve=U.useProgram("sky"),we=ga(Y,W);ve.draw(Y,ue.TRIANGLES,de,pe,xe,pr.disabled,ce,null,void 0,"sky",we.vertexBuffer,we.indexBuffer,we.segments)}(this,this.style.sky),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const U=this.style._layers[_[this.currentLayer]],W=S[U.source],Y=A[U.source];this._renderTileClippingMasks(U,Y,!1),this.renderLayer(this,W,U,Y,N)}this.renderPass="translucent";let F=!1;for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const U=this.style._layers[_[this.currentLayer]],W=S[U.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(U,N))continue;this.opaquePassEnabledForLayer()||F||(F=!0,N.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Y=(U.type==="symbol"?R:j)[U.source];this._renderTileClippingMasks(U,A[U.source],!!this.renderToTexture),this.renderLayer(this,W,U,Y,N)}if(N.isRenderingGlobe&&function(U,W,Y){const ue=U.context,ce=ue.gl,de=U.useProgram("atmosphere"),pe=new Jt(ce.LEQUAL,Jt.ReadOnly,[0,1]),xe=U.transform,ve=function(Ke,St){const wt=Ke.properties.get("position"),ft=[-wt.x,-wt.y,-wt.z],Lt=l.ad(new Float64Array(16));return Ke.properties.get("anchor")==="map"&&(l.a_(Lt,Lt,St.rollInRadians),l.a$(Lt,Lt,-St.pitchInRadians),l.a_(Lt,Lt,St.bearingInRadians),l.a$(Lt,Lt,St.center.lat*Math.PI/180),l.bp(Lt,Lt,-St.center.lng*Math.PI/180)),l.bZ(ft,ft,Lt),ft}(Y,U.transform),we=xe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ke=W.properties.get("atmosphere-blend")*we.projectionTransition;if(ke===0)return;const Te=Fo(xe.worldSize,xe.center.lat),Ve=xe.inverseProjectionMatrix,et=new Float64Array(4);et[3]=1,l.at(et,et,xe.modelViewProjectionMatrix),et[0]/=et[3],et[1]/=et[3],et[2]/=et[3],et[3]=1,l.at(et,et,Ve),et[0]/=et[3],et[1]/=et[3],et[2]/=et[3],et[3]=1;const Ge=((Ke,St,wt,ft,Lt)=>({u_sun_pos:Ke,u_atmosphere_blend:St,u_globe_position:wt,u_globe_radius:ft,u_inv_proj_matrix:Lt}))(ve,ke,[et[0],et[1],et[2]],Te,Ve),He=ga(ue,W);de.draw(ue,ce.TRIANGLES,pe,sr.disabled,Dr.alphaBlended,pr.disabled,Ge,null,null,"atmosphere",He.vertexBuffer,He.indexBuffer,He.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const U=function(W,Y){let ue=null;const ce=Object.values(W._layers).flatMap(ve=>ve.source&&!ve.isHidden(Y)?[W.sourceCaches[ve.source]]:[]),de=ce.filter(ve=>ve.getSource().type==="vector"),pe=ce.filter(ve=>ve.getSource().type!=="vector"),xe=ve=>{(!ue||ue.getSource().maxzoom<ve.getSource().maxzoom)&&(ue=ve)};return de.forEach(ve=>xe(ve)),ue||pe.forEach(ve=>xe(ve)),ue}(this.style,this.transform.zoom);U&&function(W,Y,ue){for(let ce=0;ce<ue.length;ce++)di(W,Y,ue[ce])}(this,U,U.getVisibleCoordinates())}this.options.showPadding&&function(U){const W=U.transform.padding;ao(U,U.transform.height-(W.top||0),3,ss),ao(U,W.bottom||0,3,ih),Kl(U,W.left||0,3,od),Kl(U,U.transform.width-(W.right||0),3,Yl);const Y=U.transform.centerPoint;(function(ue,ce,de,pe){Ql(ue,ce-1,de-10,2,20,pe),Ql(ue,ce-10,de-1,20,2,pe)})(U,Y.x,U.transform.height-Y.y,io)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const i=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=e?!l.c0(i,u):!l.c1(i,u)),f||(f=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(l.c2(i,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(_,S){const A=_.context,j=A.gl,R=_.transform,N=Dr.unblended,F=new Jt(j.LEQUAL,Jt.ReadWrite,[0,1]),U=S.sourceCache.getRenderableTiles(),W=_.useProgram("terrainDepth");A.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),A.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),A.clear({color:l.b7.transparent,depth:1});for(const Y of U){const ue=S.getTerrainMesh(Y.tileID),ce=S.getTerrainData(Y.tileID),de=R.getProjectionData({overscaledTileID:Y.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),pe={u_ele_delta:S.getMeshFrameDelta(R.zoom)};W.draw(A,j.TRIANGLES,F,sr.disabled,N,pr.backCCW,pe,ce,de,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments)}A.bindFramebuffer.set(null),A.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain),function(_,S){const A=_.context,j=A.gl,R=_.transform,N=Dr.unblended,F=new Jt(j.LEQUAL,Jt.ReadWrite,[0,1]),U=S.getCoordsTexture(),W=S.sourceCache.getRenderableTiles(),Y=_.useProgram("terrainCoords");A.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),A.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),A.clear({color:l.b7.transparent,depth:1}),S.coordsIndex=[];for(const ue of W){const ce=S.getTerrainMesh(ue.tileID),de=S.getTerrainData(ue.tileID);A.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,U.texture);const pe={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(R.zoom)},xe=R.getProjectionData({overscaledTileID:ue.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Y.draw(A,j.TRIANGLES,F,sr.disabled,N,pr.backCCW,pe,de,xe,"terrain",ce.vertexBuffer,ce.indexBuffer,ce.segments),S.coordsIndex.push(ue.tileID.key)}A.bindFramebuffer.set(null),A.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain))}renderLayer(e,i,u,f,_){u.isHidden(this.transform.zoom)||(u.type==="background"||u.type==="custom"||(f||[]).length)&&(this.id=u.id,l.c3(u)?function(S,A,j,R,N,F){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:U}=F,W=sr.disabled,Y=S.colorModeForRenderPass();(j._unevaluatedLayout.hasValue("text-variable-anchor")||j._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ue,ce,de,pe,xe,ve,we,ke,Te){const Ve=ce.transform,et=ce.style.map.terrain,Ge=xe==="map",He=ve==="map";for(const Ke of ue){const St=pe.getTile(Ke),wt=St.getBucket(de);if(!wt||!wt.text||!wt.text.segments.get().length)continue;const ft=l.ak(wt.textSizeData,Ve.zoom),Lt=l.az(St,1,ce.transform.zoom),lr=Bt(Ge,ce.transform,Lt),ur=de.layout.get("icon-text-fit")!=="none"&&wt.hasIconData();if(ft){const ei=Math.pow(2,Ve.zoom-St.tileID.overscaledZ),Nr=et?(ni,si)=>et.getElevation(Ke,ni,si):null;Ka(wt,Ge,He,Te,Ve,lr,ei,ft,ur,l.aA(Ve,St,we,ke),Ke.toUnwrapped(),Nr)}}}(R,S,j,A,j.layout.get("text-rotation-alignment"),j.layout.get("text-pitch-alignment"),j.paint.get("text-translate"),j.paint.get("text-translate-anchor"),N),j.paint.get("icon-opacity").constantOr(1)!==0&&ns(S,A,j,R,!1,j.paint.get("icon-translate"),j.paint.get("icon-translate-anchor"),j.layout.get("icon-rotation-alignment"),j.layout.get("icon-pitch-alignment"),j.layout.get("icon-keep-upright"),W,Y,U),j.paint.get("text-opacity").constantOr(1)!==0&&ns(S,A,j,R,!0,j.paint.get("text-translate"),j.paint.get("text-translate-anchor"),j.layout.get("text-rotation-alignment"),j.layout.get("text-pitch-alignment"),j.layout.get("text-keep-upright"),W,Y,U),A.map.showCollisionBoxes&&(ro(S,A,j,R,!0),ro(S,A,j,R,!1))}(e,i,u,f,this.style.placement.variableOffsets,_):l.c4(u)?function(S,A,j,R,N){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:F}=N,U=j.paint.get("circle-opacity"),W=j.paint.get("circle-stroke-width"),Y=j.paint.get("circle-stroke-opacity"),ue=!j.layout.get("circle-sort-key").isConstant();if(U.constantOr(1)===0&&(W.constantOr(1)===0||Y.constantOr(1)===0))return;const ce=S.context,de=ce.gl,pe=S.transform,xe=S.getDepthModeForSublayer(0,Jt.ReadOnly),ve=sr.disabled,we=S.colorModeForRenderPass(),ke=[],Te=pe.getCircleRadiusCorrection();for(let Ve=0;Ve<R.length;Ve++){const et=R[Ve],Ge=A.getTile(et),He=Ge.getBucket(j);if(!He)continue;const Ke=j.paint.get("circle-translate"),St=j.paint.get("circle-translate-anchor"),wt=l.aA(pe,Ge,Ke,St),ft=He.programConfigurations.get(j.id),Lt=S.useProgram("circle",ft),lr=He.layoutVertexBuffer,ur=He.indexBuffer,ei=S.style.map.terrain&&S.style.map.terrain.getTerrainData(et),Nr={programConfiguration:ft,program:Lt,layoutVertexBuffer:lr,indexBuffer:ur,uniformValues:ql(S,Ge,j,wt,Te),terrainData:ei,projectionData:pe.getProjectionData({overscaledTileID:et,applyGlobeMatrix:!F,applyTerrainMatrix:!0})};if(ue){const ni=He.segments.get();for(const si of ni)ke.push({segments:new l.aJ([si]),sortKey:si.sortKey,state:Nr})}else ke.push({segments:He.segments,sortKey:0,state:Nr})}ue&&ke.sort((Ve,et)=>Ve.sortKey-et.sortKey);for(const Ve of ke){const{programConfiguration:et,program:Ge,layoutVertexBuffer:He,indexBuffer:Ke,uniformValues:St,terrainData:wt,projectionData:ft}=Ve.state;Ge.draw(ce,de.TRIANGLES,xe,ve,we,pr.backCCW,St,wt,ft,j.id,He,Ke,Ve.segments,j.paint,S.transform.zoom,et)}}(e,i,u,f,_):l.c5(u)?function(S,A,j,R,N){if(j.paint.get("heatmap-opacity")===0)return;const F=S.context,{isRenderingToTexture:U,isRenderingGlobe:W}=N;if(S.style.map.terrain){for(const Y of R){const ue=A.getTile(Y);A.hasRenderableParent(Y)||(S.renderPass==="offscreen"?vn(S,ue,j,Y,W):S.renderPass==="translucent"&&Ps(S,j,Y,U,W))}F.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?function(Y,ue,ce,de){const pe=Y.context,xe=pe.gl,ve=Y.transform,we=sr.disabled,ke=new Dr([xe.ONE,xe.ONE],l.b7.transparent,[!0,!0,!0,!0]);(function(Te,Ve,et){const Ge=Te.gl;Te.activeTexture.set(Ge.TEXTURE1),Te.viewport.set([0,0,Ve.width/4,Ve.height/4]);let He=et.heatmapFbos.get(l.bW);He?(Ge.bindTexture(Ge.TEXTURE_2D,He.colorAttachment.get()),Te.bindFramebuffer.set(He.framebuffer)):(He=$c(Te,Ve.width/4,Ve.height/4),et.heatmapFbos.set(l.bW,He))})(pe,Y,ce),pe.clear({color:l.b7.transparent});for(let Te=0;Te<de.length;Te++){const Ve=de[Te];if(ue.hasRenderableParent(Ve))continue;const et=ue.getTile(Ve),Ge=et.getBucket(ce);if(!Ge)continue;const He=Ge.programConfigurations.get(ce.id),Ke=Y.useProgram("heatmap",He),St=ve.getProjectionData({overscaledTileID:Ve,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),wt=ve.getCircleRadiusCorrection();Ke.draw(pe,xe.TRIANGLES,Jt.disabled,we,ke,pr.backCCW,gn(et,ve.zoom,ce.paint.get("heatmap-intensity"),wt),null,St,ce.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,ce.paint,ve.zoom,He)}pe.viewport.set([0,0,Y.width,Y.height])}(S,A,j,R):S.renderPass==="translucent"&&function(Y,ue){const ce=Y.context,de=ce.gl;ce.setColorMode(Y.colorModeForRenderPass());const pe=ue.heatmapFbos.get(l.bW);pe&&(ce.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,pe.colorAttachment.get()),ce.activeTexture.set(de.TEXTURE1),Gc(ce,ue).bind(de.LINEAR,de.CLAMP_TO_EDGE),Y.useProgram("heatmapTexture").draw(ce,de.TRIANGLES,Jt.disabled,sr.disabled,Y.colorModeForRenderPass(),pr.disabled,gf(Y,ue,0,1),null,null,ue.id,Y.viewportBuffer,Y.quadTriangleIndexBuffer,Y.viewportSegments,ue.paint,Y.transform.zoom))}(S,j)}(e,i,u,f,_):l.c6(u)?function(S,A,j,R,N){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:F}=N,U=j.paint.get("line-opacity"),W=j.paint.get("line-width");if(U.constantOr(1)===0||W.constantOr(1)===0)return;const Y=S.getDepthModeForSublayer(0,Jt.ReadOnly),ue=S.colorModeForRenderPass(),ce=j.paint.get("line-dasharray"),de=j.paint.get("line-pattern"),pe=de.constantOr(1),xe=j.paint.get("line-gradient"),ve=j.getCrossfadeParameters(),we=pe?"linePattern":ce?"lineSDF":xe?"lineGradient":"line",ke=S.context,Te=ke.gl,Ve=S.transform;let et=!0;for(const Ge of R){const He=A.getTile(Ge);if(pe&&!He.patternsLoaded())continue;const Ke=He.getBucket(j);if(!Ke)continue;const St=Ke.programConfigurations.get(j.id),wt=S.context.program.get(),ft=S.useProgram(we,St),Lt=et||ft.program!==wt,lr=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ge),ur=de.constantOr(null);if(ur&&He.imageAtlas){const Tr=He.imageAtlas,yr=Tr.patternPositions[ur.to.toString()],ti=Tr.patternPositions[ur.from.toString()];yr&&ti&&St.setConstantPatternPositions(yr,ti)}const ei=Ve.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),Nr=Ve.getPixelScale(),ni=pe?Gl(S,He,j,Nr,ve):ce?_f(S,He,j,Nr,ce,ve):xe?$l(S,He,j,Nr,Ke.lineClipsArray.length):Zl(S,He,j,Nr);if(pe)ke.activeTexture.set(Te.TEXTURE0),He.imageAtlasTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),St.updatePaintBuffers(ve);else if(ce&&(Lt||S.lineAtlas.dirty))ke.activeTexture.set(Te.TEXTURE0),S.lineAtlas.bind(ke);else if(xe){const Tr=Ke.gradients[j.id];let yr=Tr.texture;if(j.gradientVersion!==Tr.version){let ti=256;if(j.stepInterpolant){const mi=A.getSource().maxzoom,Yi=Ge.canonical.z===mi?Math.ceil(1<<S.transform.maxZoom-Ge.canonical.z):1;ti=l.ae(l.bX(Ke.maxLineLength/l.Z*1024*Yi),256,ke.maxTextureSize)}Tr.gradient=l.bY({expression:j.gradientExpression(),evaluationKey:"lineProgress",resolution:ti,image:Tr.gradient||void 0,clips:Ke.lineClipsArray}),Tr.texture?Tr.texture.update(Tr.gradient):Tr.texture=new ot(ke,Tr.gradient,Te.RGBA),Tr.version=j.gradientVersion,yr=Tr.texture}ke.activeTexture.set(Te.TEXTURE0),yr.bind(j.stepInterpolant?Te.NEAREST:Te.LINEAR,Te.CLAMP_TO_EDGE)}const si=S.stencilModeForClipping(Ge);ft.draw(ke,Te.TRIANGLES,Y,si,ue,pr.disabled,ni,lr,ei,j.id,Ke.layoutVertexBuffer,Ke.indexBuffer,Ke.segments,j.paint,S.transform.zoom,St,Ke.layoutVertexBuffer2),et=!1}}(e,i,u,f,_):l.c7(u)?function(S,A,j,R,N){const F=j.paint.get("fill-color"),U=j.paint.get("fill-opacity");if(U.constantOr(1)===0)return;const{isRenderingToTexture:W}=N,Y=S.colorModeForRenderPass(),ue=j.paint.get("fill-pattern"),ce=S.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&F.constantOr(l.b7.transparent).a===1&&U.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===ce){const de=S.getDepthModeForSublayer(1,S.renderPass==="opaque"?Jt.ReadWrite:Jt.ReadOnly);Xi(S,A,j,R,de,Y,!1,W)}if(S.renderPass==="translucent"&&j.paint.get("fill-antialias")){const de=S.getDepthModeForSublayer(j.getPaintProperty("fill-outline-color")?2:0,Jt.ReadOnly);Xi(S,A,j,R,de,Y,!0,W)}}(e,i,u,f,_):l.c8(u)?function(S,A,j,R,N){const F=j.paint.get("fill-extrusion-opacity");if(F===0)return;const{isRenderingToTexture:U}=N;if(S.renderPass==="translucent"){const W=new Jt(S.context.gl.LEQUAL,Jt.ReadWrite,S.depthRangeFor3D);if(F!==1||j.paint.get("fill-extrusion-pattern").constantOr(1))Di(S,A,j,R,W,sr.disabled,Dr.disabled,U),Di(S,A,j,R,W,S.stencilModeFor3D(),S.colorModeForRenderPass(),U);else{const Y=S.colorModeForRenderPass();Di(S,A,j,R,W,sr.disabled,Y,U)}}}(e,i,u,f,_):l.c9(u)?function(S,A,j,R,N){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const{isRenderingToTexture:F}=N,U=S.context,W=S.style.projection.useSubdivision,Y=S.getDepthModeForSublayer(0,Jt.ReadOnly),ue=S.colorModeForRenderPass();if(S.renderPass==="offscreen")(function(ce,de,pe,xe,ve,we,ke){const Te=ce.context,Ve=Te.gl;for(const et of pe){const Ge=de.getTile(et),He=Ge.dem;if(!He||!He.data||!Ge.needsHillshadePrepare)continue;const Ke=He.dim,St=He.stride,wt=He.getPixels();if(Te.activeTexture.set(Ve.TEXTURE1),Te.pixelStoreUnpackPremultiplyAlpha.set(!1),Ge.demTexture=Ge.demTexture||ce.getTileTexture(St),Ge.demTexture){const Lt=Ge.demTexture;Lt.update(wt,{premultiply:!1}),Lt.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE)}else Ge.demTexture=new ot(Te,wt,Ve.RGBA,{premultiply:!1}),Ge.demTexture.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE);Te.activeTexture.set(Ve.TEXTURE0);let ft=Ge.fbo;if(!ft){const Lt=new ot(Te,{width:Ke,height:Ke,data:null},Ve.RGBA);Lt.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE),ft=Ge.fbo=Te.createFramebuffer(Ke,Ke,!0,!1),ft.colorAttachment.set(Lt.texture)}Te.bindFramebuffer.set(ft.framebuffer),Te.viewport.set([0,0,Ke,Ke]),ce.useProgram("hillshadePrepare").draw(Te,Ve.TRIANGLES,ve,we,ke,pr.disabled,Gp(Ge.tileID,He),null,null,xe.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments),Ge.needsHillshadePrepare=!1}})(S,A,R,j,Y,sr.disabled,ue),U.viewport.set([0,0,S.width,S.height]);else if(S.renderPass==="translucent")if(W){const[ce,de,pe]=S.stencilConfigForOverlapTwoPass(R);kr(S,A,j,pe,ce,Y,ue,!1,F),kr(S,A,j,pe,de,Y,ue,!0,F)}else{const[ce,de]=S.getStencilConfigForOverlapAndUpdateStencilID(R);kr(S,A,j,de,ce,Y,ue,!1,F)}}(e,i,u,f,_):l.ca(u)?function(S,A,j,R,N){if(S.renderPass!=="translucent"||j.paint.get("raster-opacity")===0||!R.length)return;const{isRenderingToTexture:F}=N,U=A.getSource(),W=S.style.projection.useSubdivision;if(U instanceof Sa)Ja(S,A,j,R,null,!1,!1,U.tileCoords,U.flippedWindingOrder,F);else if(W){const[Y,ue,ce]=S.stencilConfigForOverlapTwoPass(R);Ja(S,A,j,ce,Y,!1,!0,Ca,!1,F),Ja(S,A,j,ce,ue,!0,!0,Ca,!1,F)}else{const[Y,ue]=S.getStencilConfigForOverlapAndUpdateStencilID(R);Ja(S,A,j,ue,Y,!1,!0,Ca,!1,F)}}(e,i,u,f,_):l.cb(u)?function(S,A,j,R,N){const F=j.paint.get("background-color"),U=j.paint.get("background-opacity");if(U===0)return;const{isRenderingToTexture:W}=N,Y=S.context,ue=Y.gl,ce=S.style.projection,de=S.transform,pe=de.tileSize,xe=j.paint.get("background-pattern");if(S.isPatternMissing(xe))return;const ve=!xe&&F.a===1&&U===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==ve)return;const we=sr.disabled,ke=S.getDepthModeForSublayer(0,ve==="opaque"?Jt.ReadWrite:Jt.ReadOnly),Te=S.colorModeForRenderPass(),Ve=S.useProgram(xe?"backgroundPattern":"background"),et=R||Pe(de,{tileSize:pe,terrain:S.style.map.terrain});xe&&(Y.activeTexture.set(ue.TEXTURE0),S.imageManager.bind(S.context));const Ge=j.getCrossfadeParameters();for(const He of et){const Ke=de.getProjectionData({overscaledTileID:He,applyGlobeMatrix:!W,applyTerrainMatrix:!0}),St=xe?Hp(U,S,xe,{tileID:He,tileSize:pe},Ge):vf(U,F),wt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(He),ft=ce.getMeshFromTileID(Y,He.canonical,!1,!0,"raster");Ve.draw(Y,ue.TRIANGLES,ke,we,Te,pr.backCCW,St,wt,Ke,j.id,ft.vertexBuffer,ft.indexBuffer,ft.segments)}}(e,0,u,f,_):l.cc(u)&&function(S,A,j,R){const{isRenderingGlobe:N}=R,F=S.context,U=j.implementation,W=S.style.projection,Y=S.transform,ue=Y.getProjectionDataForCustomLayer(N),ce={farZ:Y.farZ,nearZ:Y.nearZ,fov:Y.fov*Math.PI/180,modelViewProjectionMatrix:Y.modelViewProjectionMatrix,projectionMatrix:Y.projectionMatrix,shaderData:{variantName:W.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${W.shaderPreludeCode.vertexSource}`,define:W.shaderDefine},defaultProjectionData:ue},de=U.renderingMode?U.renderingMode:"2d";if(S.renderPass==="offscreen"){const pe=U.prerender;pe&&(S.setCustomLayerDefaults(),F.setColorMode(S.colorModeForRenderPass()),pe.call(U,F.gl,ce),F.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),F.setColorMode(S.colorModeForRenderPass()),F.setStencilMode(sr.disabled);const pe=de==="3d"?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,Jt.ReadOnly);F.setDepthMode(pe),U.render(F.gl,ce),F.setDirty(),S.setBaseState(),F.bindFramebuffer.set(null)}}(e,0,u,_))}saveTileTexture(e){const i=this._tileTextures[e.size[0]];i?i.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const i=this._tileTextures[e];return i&&i.length>0?i.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const i=this.imageManager.getPattern(e.from.toString()),u=this.imageManager.getPattern(e.to.toString());return!i||!u}useProgram(e,i,u=!1,f=[]){this.cache=this.cache||{};const _=!!this.style.map.terrain,S=this.style.projection,A=u?Ui.projectionMercator:S.shaderPreludeCode,j=u?Es:S.shaderDefine,R=e+(i?i.cacheKey:"")+`/${u?vr:S.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(_?"/terrain":"")+(f?`/${f.join("/")}`:"");return this.cache[R]||(this.cache[R]=new Vu(this.context,Ui[e],i,xf[e],this._showOverdrawInspector,_,A,j,f)),this.cache[R]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ot(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:i}=this.context.gl;return this.width!==e||this.height!==i}}function zs(g,e){let i,u=!1,f=null,_=null;const S=()=>{f=null,u&&(g.apply(_,i),f=setTimeout(S,e),u=!1)};return(...A)=>(u=!0,_=this,i=A,f||S(),f)}class nh{constructor(e){this._getCurrentHash=()=>{const i=window.location.hash.replace("#","");if(this._hashName){let u;return i.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(u=f)}),(u&&u[1]||"").split("/")}return i.split("/")},this._onHashChange=()=>{const i=this._getCurrentHash();if(!this._isValidHash(i))return!1;const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:u,pitch:+(i[4]||0)}),!0},this._updateHashUnthrottled=()=>{const i=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,i)},this._removeHash=()=>{const i=this._getCurrentHash();if(i.length===0)return;const u=i.join("/");let f=u;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${u}`);let _=window.location.hash.replace(f,"");_.startsWith("#&")?_=_.slice(0,1)+_.slice(2):_==="#"&&(_="");let S=window.location.href.replace(/(#.+)?$/,_);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=zs(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const i=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,f=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,f),S=Math.round(i.lng*_)/_,A=Math.round(i.lat*_)/_,j=this._map.getBearing(),R=this._map.getPitch();let N="";if(N+=e?`/${S}/${A}/${u}`:`${u}/${A}/${S}`,(j||R)&&(N+="/"+Math.round(10*j)/10),R&&(N+=`/${Math.round(R)}`),this._hashName){const F=this._hashName;let U=!1;const W=window.location.hash.slice(1).split("&").map(Y=>{const ue=Y.split("=")[0];return ue===F?(U=!0,`${ue}=${N}`):Y}).filter(Y=>Y);return U||W.push(`${F}=${N}`),`#${W.join("&")}`}return`#${N}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new l.Q(+e[2],+e[1])}catch{return!1}const i=+e[0],u=+(e[3]||0),f=+(e[4]||0);return i>=this._map.getMinZoom()&&i<=this._map.getMaxZoom()&&u>=-180&&u<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const Aa={linearity:.3,easing:l.cd(0,0,.3,1)},Ko=l.e({deceleration:2500,maxSpeed:1400},Aa),no=l.e({deceleration:20,maxSpeed:1400},Aa),Qo=l.e({deceleration:1e3,maxSpeed:360},Aa),Hc=l.e({deceleration:1e3,maxSpeed:90},Aa),ld=l.e({deceleration:1e3,maxSpeed:360},Aa);class cd{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:re.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,i=re.now();for(;e.length>0&&i-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,roll:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)i.zoom+=_.zoomDelta||0,i.bearing+=_.bearingDelta||0,i.pitch+=_.pitchDelta||0,i.roll+=_.rollDelta||0,_.panDelta&&i.pan._add(_.panDelta),_.around&&(i.around=_.around),_.pinchAround&&(i.pinchAround=_.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(i.pan.mag()){const _=Jo(i.pan.mag(),u,l.e({},Ko,e||{})),S=i.pan.mult(_.amount/i.pan.mag()),A=this._map.cameraHelper.handlePanInertia(S,this._map.transform);f.center=A.easingCenter,f.offset=A.easingOffset,xn(f,_)}if(i.zoom){const _=Jo(i.zoom,u,no);f.zoom=this._map.transform.zoom+_.amount,xn(f,_)}if(i.bearing){const _=Jo(i.bearing,u,Qo);f.bearing=this._map.transform.bearing+l.ae(_.amount,-179,179),xn(f,_)}if(i.pitch){const _=Jo(i.pitch,u,Hc);f.pitch=this._map.transform.pitch+_.amount,xn(f,_)}if(i.roll){const _=Jo(i.roll,u,ld);f.roll=this._map.transform.roll+l.ae(_.amount,-179,179),xn(f,_)}if(f.zoom||f.bearing){const _=i.pinchAround===void 0?i.around:i.pinchAround;f.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),l.e(f,{noMoveStart:!0})}}function xn(g,e){(!g.duration||g.duration<e.duration)&&(g.duration=e.duration,g.easing=e.easing)}function Jo(g,e,i){const{maxSpeed:u,linearity:f,deceleration:_}=i,S=l.ae(g*f/(e/1e3),-u,u),A=Math.abs(S)/(_*f);return{easing:i.easing,duration:1e3*A,amount:S*(A/2)}}class fi extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,u,f={}){u=u instanceof MouseEvent?u:new MouseEvent(e,u);const _=ee.mousePos(i.getCanvas(),u),S=i.unproject(_);super(e,l.e({point:_,lngLat:S,originalEvent:u},f)),this._defaultPrevented=!1,this.target=i}}class Is extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,u){const f=e==="touchend"?u.changedTouches:u.touches,_=ee.touchPos(i.getCanvasContainer(),f),S=_.map(j=>i.unproject(j)),A=_.reduce((j,R,N,F)=>j.add(R.div(F.length)),new l.P(0,0));super(e,{points:_,point:A,lngLats:S,lngLat:i.unproject(A),originalEvent:u}),this._defaultPrevented=!1}}class sh extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,u){super(e,{originalEvent:u}),this._defaultPrevented=!1}}class oh{constructor(e,i){this._map=e,this._clickTolerance=i.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new sh(e.type,this._map,e))}mousedown(e,i){return this._mousedownPos=i,this._firePreventable(new fi(e.type,this._map,e))}mouseup(e){this._map.fire(new fi(e.type,this._map,e))}click(e,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new fi(e.type,this._map,e))}dblclick(e){return this._firePreventable(new fi(e.type,this._map,e))}mouseover(e){this._map.fire(new fi(e.type,this._map,e))}mouseout(e){this._map.fire(new fi(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Is(e.type,this._map,e))}touchmove(e){this._map.fire(new Is(e.type,this._map,e))}touchend(e){this._map.fire(new Is(e.type,this._map,e))}touchcancel(e){this._map.fire(new Is(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class lh{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new fi(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new fi(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ca{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(l.P.convert(e),this._map.terrain)}}class bn{constructor(e,i){this._map=e,this._tr=new ca(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=i.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,i){this.isEnabled()&&e.shiftKey&&e.button===0&&(ee.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)}mousemoveWindow(e,i){if(!this._active)return;const u=i;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=u,this._box||(this._box=ee.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const _=Math.min(f.x,u.x),S=Math.max(f.x,u.x),A=Math.min(f.y,u.y),j=Math.max(f.y,u.y);ee.setTransform(this._box,`translate(${_}px,${A}px)`),this._box.style.width=S-_+"px",this._box.style.height=j-A+"px"}mouseupWindow(e,i){if(!this._active||e.button!==0)return;const u=this._startPos,f=i;if(this.reset(),ee.suppressClick(),u.x!==f.x||u.y!==f.y)return this._map.fire(new l.l("boxzoomend",{originalEvent:e})),{cameraAnimation:_=>_.fitScreenCoordinates(u,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ee.remove(this._box),this._box=null),ee.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,i){return this._map.fire(new l.l(e,{originalEvent:i}))}}function jn(g,e){if(g.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${e.length}`);const i={};for(let u=0;u<g.length;u++)i[g[u].identifier]=e[u];return i}class ud{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,i,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),u.length===this.numTouches&&(this.centroid=function(f){const _=new l.P(0,0);for(const S of f)_._add(S);return _.div(f.length)}(i),this.touches=jn(u,i)))}touchmove(e,i,u){if(this.aborted||!this.centroid)return;const f=jn(u,i);for(const _ in this.touches){const S=f[_];(!S||S.dist(this.touches[_])>30)&&(this.aborted=!0)}}touchend(e,i,u){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class en{constructor(e){this.singleTap=new ud(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,i,u){this.singleTap.touchstart(e,i,u)}touchmove(e,i,u){this.singleTap.touchmove(e,i,u)}touchend(e,i,u){const f=this.singleTap.touchend(e,i,u);if(f){const _=e.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(f)<30;if(_&&S||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class os{constructor(e){this._tr=new ca(e),this._zoomIn=new en({numTouches:1,numTaps:2}),this._zoomOut=new en({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,i,u){this._zoomIn.touchstart(e,i,u),this._zoomOut.touchstart(e,i,u)}touchmove(e,i,u){this._zoomIn.touchmove(e,i,u),this._zoomOut.touchmove(e,i,u)}touchend(e,i,u){const f=this._zoomIn.touchend(e,i,u),_=this._zoomOut.touchend(e,i,u),S=this._tr;return f?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(f)},{originalEvent:e})}):_?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(_)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pr{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const i=this._moveFunction(...e);if(i.bearingDelta||i.pitchDelta||i.rollDelta||i.around||i.panDelta)return this._active=!0,i}dragStart(e,i){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(i)?i[0]:i,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,i){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const f=Array.isArray(i)?i[0]:i;return!this._moved&&f.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(u,f))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&ee.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Na={0:1,2:2};class Jl{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const i=ee.mouseButton(e);this._eventButton=i}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(i,u){const f=Na[u];return i.buttons===void 0||(i.buttons&f)!==f}(e,this._eventButton)}isValidEndEvent(e){return ee.mouseButton(e)===this._eventButton}}class zn{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class ec{constructor(e=new Jl({checkCorrectEvent:()=>!0}),i=new zn){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=i}_executeRelevantHandler(e,i,u){return e instanceof MouseEvent?i(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?u(e):void 0}startMove(e){this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.startMove(i),i=>this.oneFingerTouchMoveStateManager.startMove(i))}endMove(e){this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.endMove(i),i=>this.oneFingerTouchMoveStateManager.endMove(i))}isValidStartEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidStartEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidStartEvent(i))}isValidMoveEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidMoveEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(i))}isValidEndEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidEndEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidEndEvent(i))}}const Ai=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=e=>{e.preventDefault()}};class hd{constructor(e,i){this._clickTolerance=e.clickTolerance||1,this._map=i,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,i,u){return this._calculateTransform(e,i,u)}touchmove(e,i,u){if(this._active){if(!this._shouldBePrevented(u.length))return e.preventDefault(),this._calculateTransform(e,i,u);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,i,u){this._calculateTransform(e,i,u),this._active&&this._shouldBePrevented(u.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,i,u){u.length>0&&(this._active=!0);const f=jn(u,i),_=new l.P(0,0),S=new l.P(0,0);let A=0;for(const R in f){const N=f[R],F=this._touches[R];F&&(_._add(N),S._add(N.sub(F)),A++,f[R]=N)}if(this._touches=f,this._shouldBePrevented(A)||!S.mag())return;const j=S.div(A);return this._sum._add(j),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(A),panDelta:j}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class el{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,i,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([i[0],i[1]]))}touchmove(e,i,u){if(!this._firstTwoTouches)return;e.preventDefault();const[f,_]=this._firstTwoTouches,S=so(u,i,f),A=so(u,i,_);if(!S||!A)return;const j=this._aroundCenter?null:S.add(A).div(2);return this._move([S,A],j,e)}touchend(e,i,u){if(!this._firstTwoTouches)return;const[f,_]=this._firstTwoTouches,S=so(u,i,f),A=so(u,i,_);S&&A||(this._active&&ee.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function so(g,e,i){for(let u=0;u<g.length;u++)if(g[u].identifier===i)return e[u]}function Wc(g,e){return Math.log(g/e)/Math.LN2}class In extends el{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,i){const u=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Wc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Wc(this._distance,u),pinchAround:i}}}function ka(g,e){return 180*g.angleWith(e)/Math.PI}class kt extends el{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,i,u){const f=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ka(this._vector,f),pinchAround:i}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const i=25/(Math.PI*this._minDiameter)*360,u=ka(e,this._startVector);return Math.abs(u)<i}}function Xc(g){return Math.abs(g.y)>Math.abs(g.x)}class ch extends el{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,i,u){super.touchstart(e,i,u),this._currentTouchCount=u.length}_start(e){this._lastPoints=e,Xc(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,i,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=e[0].sub(this._lastPoints[0]),_=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,_,u.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(f.y+_.y)/2*-.5}):void 0}gestureBeginsVertically(e,i,u){if(this._valid!==void 0)return this._valid;const f=e.mag()>=2,_=i.mag()>=2;if(!f&&!_)return;if(!f||!_)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const S=e.y>0==i.y>0;return Xc(e)&&Xc(i)&&S}}const dd={panStep:100,bearingStep:15,pitchStep:10};class wn{constructor(e){this._tr=new ca(e);const i=dd;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let i=0,u=0,f=0,_=0,S=0;switch(e.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:e.shiftKey?u=-1:(e.preventDefault(),_=-1);break;case 39:e.shiftKey?u=1:(e.preventDefault(),_=1);break;case 38:e.shiftKey?f=1:(e.preventDefault(),S=-1);break;case 40:e.shiftKey?f=-1:(e.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(u=0,f=0),{cameraAnimation:A=>{const j=this._tr;A.easeTo({duration:300,easeId:"keyboardHandler",easing:tl,zoom:i?Math.round(j.zoom)+i*(e.shiftKey?2:1):j.zoom,bearing:j.bearing+u*this._bearingStep,pitch:j.pitch+f*this._pitchStep,offset:[-_*this._panStep,-S*this._panStep],center:j.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function tl(g){return g*(2-g)}const tc=4.000244140625;class dr{constructor(e,i){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=e,this._tr=new ca(e),this._triggerRenderFrame=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let i=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const u=re.now(),f=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,i!==0&&i%tc==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(f*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),e.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=e,this._delta-=i,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=ee.mousePos(this._map.getCanvas(),e),u=this._tr;this._aroundPoint=this._aroundCenter?u.transform.locationToScreenPoint(l.Q.convert(u.center)):i,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const A=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=A),typeof this._targetZoom=="number"&&(this._targetZoom+=A)}if(this._delta!==0){const A=this._type==="wheel"&&Math.abs(this._delta)>tc?this._wheelZoomRate:this._defaultZoomRate;let j=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&j!==0&&(j=1/j);const R=typeof this._targetZoom!="number"?e.scale:l.ac(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),l.ah(R*j)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,u=this._startZoom,f=this._easing;let _,S=!1;if(this._type==="wheel"&&u&&f){const A=re.now()-this._lastWheelEventTime,j=Math.min((A+5)/200,1),R=f(j);_=l.B.number(u,i,R),j<1?this._frameId||(this._frameId=!0):S=!0}else _=i,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=_,{noInertia:!0,needsRenderFrame:!S,zoomDelta:_-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let i=l.cf;if(this._prevEase){const u=this._prevEase,f=(re.now()-u.start)/u.duration,_=u.easing(f+.01)-u.easing(f),S=.27/Math.sqrt(_*_+1e-4)*.01,A=Math.sqrt(.0729-S*S);i=l.cd(S,A,.25,1)}return this._prevEase={start:re.now(),duration:e,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Rn{constructor(e,i){this._clickZoom=e,this._tapZoom=i}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class gr{constructor(e){this._tr=new ca(e),this.reset()}reset(){this._active=!1}dblclick(e,i){return e.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(i)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ur{constructor(){this._tap=new en({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,i,u){if(!this._swipePoint)if(this._tapTime){const f=i[0],_=e.timeStamp-this._tapTime<500,S=this._tapPoint.dist(f)<30;_&&S?u.length>0&&(this._swipePoint=f,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(e,i,u)}touchmove(e,i,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const f=i[0],_=f.y-this._swipePoint.y;return this._swipePoint=f,e.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(e,i,u)}touchend(e,i,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const f=this._tap.touchend(e,i,u);f&&(this._tapTime=e.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ni{constructor(e,i,u){this._el=e,this._mousePan=i,this._touchPan=u}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Yc{constructor(e,i,u,f){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=i,this._mousePitch=u,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class oo{constructor(e,i,u,f){this._el=e,this._touchZoom=i,this._touchRotate=u,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ls{constructor(e,i){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=i,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=ee.create("div","maplibregl-cooperative-gesture-screen",e);let i=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(i=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=i,this._container.appendChild(f);const _=document.createElement("div");_.className="maplibregl-mobile-message",_.textContent=u,this._container.appendChild(_),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(ee.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,i){this._enabled&&(this._map.fire(new l.l("cooperativegestureprevented",{gestureType:e,originalEvent:i})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const lo=g=>g.zoom||g.drag||g.roll||g.pitch||g.rotate;class Kc extends l.l{}function Rs(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta||g.rollDelta}class Wp{constructor(e,i){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,_)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=f.type==="renderFrame"?void 0:f,A={needsRenderFrame:!1},j={},R={};for(const{handlerName:U,handler:W,allowed:Y}of this._handlers){if(!W.isEnabled())continue;let ue;if(this._blockedByActive(R,Y,U))W.reset();else if(W[_||f.type]){if(l.cg(f,_||f.type)){const ce=ee.mousePos(this._map.getCanvas(),f);ue=W[_||f.type](f,ce)}else if(l.ch(f,_||f.type)){const ce=this._getMapTouches(f.touches),de=ee.touchPos(this._map.getCanvas(),ce);ue=W[_||f.type](f,de,ce)}else l.ci(_||f.type)||(ue=W[_||f.type](f));this.mergeHandlerResult(A,j,ue,U,S),ue&&ue.needsRenderFrame&&this._triggerRenderFrame()}(ue||W.isActive())&&(R[U]=W)}const N={};for(const U in this._previousActiveHandlers)R[U]||(N[U]=S);this._previousActiveHandlers=R,(Object.keys(N).length||Rs(A))&&(this._changes.push([A,j,N]),this._triggerRenderFrame()),(Object.keys(R).length||Rs(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:F}=A;F&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],F(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new cd(e),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,_,S]of this._listeners)ee.addEventListener(f,_,f===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[e,i,u]of this._listeners)ee.removeEventListener(e,i,e===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(e){const i=this._map,u=i.getCanvasContainer();this._add("mapEvent",new oh(i,e));const f=i.boxZoom=new bn(i,e);this._add("boxZoom",f),e.interactive&&e.boxZoom&&f.enable();const _=i.cooperativeGestures=new ls(i,e.cooperativeGestures);this._add("cooperativeGestures",_),e.cooperativeGestures&&_.enable();const S=new os(i),A=new gr(i);i.doubleClickZoom=new Rn(A,S),this._add("tapZoom",S),this._add("clickZoom",A),e.interactive&&e.doubleClickZoom&&i.doubleClickZoom.enable();const j=new Ur;this._add("tapDragZoom",j);const R=i.touchPitch=new ch(i);this._add("touchPitch",R),e.interactive&&e.touchPitch&&i.touchPitch.enable(e.touchPitch);const N=()=>i.project(i.getCenter()),F=function({enable:ve,clickTolerance:we,aroundCenter:ke=!0,minPixelCenterThreshold:Te=100,rotateDegreesPerPixelMoved:Ve=.8},et){const Ge=new Jl({checkCorrectEvent:He=>ee.mouseButton(He)===0&&He.ctrlKey||ee.mouseButton(He)===2&&!He.ctrlKey});return new Pr({clickTolerance:we,move:(He,Ke)=>{const St=et();if(ke&&Math.abs(St.y-He.y)>Te)return{bearingDelta:l.ce(new l.P(He.x,Ke.y),Ke,St)};let wt=(Ke.x-He.x)*Ve;return ke&&Ke.y<St.y&&(wt=-wt),{bearingDelta:wt}},moveStateManager:Ge,enable:ve,assignEvents:Ai})}(e,N),U=function({enable:ve,clickTolerance:we,pitchDegreesPerPixelMoved:ke=-.5}){const Te=new Jl({checkCorrectEvent:Ve=>ee.mouseButton(Ve)===0&&Ve.ctrlKey||ee.mouseButton(Ve)===2});return new Pr({clickTolerance:we,move:(Ve,et)=>({pitchDelta:(et.y-Ve.y)*ke}),moveStateManager:Te,enable:ve,assignEvents:Ai})}(e),W=function({enable:ve,clickTolerance:we,rollDegreesPerPixelMoved:ke=.3},Te){const Ve=new Jl({checkCorrectEvent:et=>ee.mouseButton(et)===2&&et.ctrlKey});return new Pr({clickTolerance:we,move:(et,Ge)=>{const He=Te();let Ke=(Ge.x-et.x)*ke;return Ge.y<He.y&&(Ke=-Ke),{rollDelta:Ke}},moveStateManager:Ve,enable:ve,assignEvents:Ai})}(e,N);i.dragRotate=new Yc(e,F,U,W),this._add("mouseRotate",F,["mousePitch"]),this._add("mousePitch",U,["mouseRotate","mouseRoll"]),this._add("mouseRoll",W,["mousePitch"]),e.interactive&&e.dragRotate&&i.dragRotate.enable();const Y=function({enable:ve,clickTolerance:we}){const ke=new Jl({checkCorrectEvent:Te=>ee.mouseButton(Te)===0&&!Te.ctrlKey});return new Pr({clickTolerance:we,move:(Te,Ve)=>({around:Ve,panDelta:Ve.sub(Te)}),activateOnStart:!0,moveStateManager:ke,enable:ve,assignEvents:Ai})}(e),ue=new hd(e,i);i.dragPan=new Ni(u,Y,ue),this._add("mousePan",Y),this._add("touchPan",ue,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&i.dragPan.enable(e.dragPan);const ce=new kt,de=new In;i.touchZoomRotate=new oo(u,de,ce,j),this._add("touchRotate",ce,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&i.touchZoomRotate.enable(e.touchZoomRotate);const pe=i.scrollZoom=new dr(i,()=>this._triggerRenderFrame());this._add("scrollZoom",pe,["mousePan"]),e.interactive&&e.scrollZoom&&i.scrollZoom.enable(e.scrollZoom);const xe=i.keyboard=new wn(i);this._add("keyboard",xe),e.interactive&&e.keyboard&&i.keyboard.enable(),this._add("blockableMapEvent",new lh(i))}_add(e,i,u){this._handlers.push({handlerName:e,handler:i,allowed:u}),this._handlersById[e]=i}stop(e){if(!this._updatingCamera){for(const{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!lo(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,i,u){for(const f in e)if(f!==u&&(!i||i.indexOf(f)<0))return!0;return!1}_getMapTouches(e){const i=[];for(const u of e)this._el.contains(u.target)&&i.push(u);return i}mergeHandlerResult(e,i,u,f,_){if(!u)return;l.e(e,u);const S={handlerName:f,originalEvent:u.originalEvent||_};u.zoomDelta!==void 0&&(i.zoom=S),u.panDelta!==void 0&&(i.drag=S),u.rollDelta!==void 0&&(i.roll=S),u.pitchDelta!==void 0&&(i.pitch=S),u.bearingDelta!==void 0&&(i.rotate=S)}_applyChanges(){const e={},i={},u={};for(const[f,_,S]of this._changes)f.panDelta&&(e.panDelta=(e.panDelta||new l.P(0,0))._add(f.panDelta)),f.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(e.rollDelta=(e.rollDelta||0)+f.rollDelta),f.around!==void 0&&(e.around=f.around),f.pinchAround!==void 0&&(e.pinchAround=f.pinchAround),f.noInertia&&(e.noInertia=f.noInertia),l.e(i,_),l.e(u,S);this._updateMapTransform(e,i,u),this._changes=[]}_updateMapTransform(e,i,u){const f=this._map,_=f._getTransformForUpdate(),S=f.terrain;if(!(Rs(e)||S&&this._terrainMovement))return this._fireEvents(i,u,!0);f._stop(!0);let{panDelta:A,zoomDelta:j,bearingDelta:R,pitchDelta:N,rollDelta:F,around:U,pinchAround:W}=e;W!==void 0&&(U=W),U=U||f.transform.centerPoint,S&&!_.isPointOnMapSurface(U)&&(U=_.centerPoint);const Y={panDelta:A,zoomDelta:j,rollDelta:F,pitchDelta:N,bearingDelta:R,around:U};this._map.cameraHelper.useGlobeControls&&!_.isPointOnMapSurface(U)&&(U=_.centerPoint);const ue=U.distSqr(_.centerPoint)<.01?_.center:_.screenPointToLocation(A?U.sub(A):U);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Y,_),this._terrainMovement||!i.drag&&!i.zoom?i.drag&&this._terrainMovement?_.setCenter(_.screenPointToLocation(_.centerPoint.sub(A))):this._map.cameraHelper.handleMapControlsPan(Y,_,ue):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Y,_,ue))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Y,_),this._map.cameraHelper.handleMapControlsPan(Y,_,ue)),f._applyUpdatedTransform(_),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(i,u,!0)}_fireEvents(e,i,u){const f=lo(this._eventsInProgress),_=lo(e),S={};for(const F in e){const{originalEvent:U}=e[F];this._eventsInProgress[F]||(S[`${F}start`]=U),this._eventsInProgress[F]=e[F]}!f&&_&&this._fireEvent("movestart",_.originalEvent);for(const F in S)this._fireEvent(F,S[F]);_&&this._fireEvent("move",_.originalEvent);for(const F in e){const{originalEvent:U}=e[F];this._fireEvent(F,U)}const A={};let j;for(const F in this._eventsInProgress){const{handlerName:U,originalEvent:W}=this._eventsInProgress[F];this._handlersById[U].isActive()||(delete this._eventsInProgress[F],j=i[U]||W,A[`${F}end`]=j)}for(const F in A)this._fireEvent(F,A[F]);const R=lo(this._eventsInProgress),N=(f||_)&&!R;if(N&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const F=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&F.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(F)}if(u&&N){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;!F||!F.essential&&re.prefersReducedMotion?(this._map.fire(new l.l("moveend",{originalEvent:j})),U(this._map.getBearing())&&this._map.resetNorth()):(U(F.bearing||this._map.getBearing())&&(F.bearing=0),F.freezeElevation=!0,this._map.easeTo(F,{originalEvent:j})),this._updatingCamera=!1}}_fireEvent(e,i){this._map.fire(new l.l(e,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Kc("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Li extends l.E{constructor(e,i,u){super(),this._renderFrameCallback=()=>{const f=Math.min((re.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=u.bearingSnap,this.cameraHelper=i,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,i){e.apply(this.transform),this.transform=e,this.cameraHelper=i}getCenter(){return new l.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,i){return this.jumpTo({center:e},i)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,i){return this.jumpTo({elevation:e},i),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,i,u){return e=l.P.convert(e).mult(-1),this.panTo(this.transform.center,l.e({offset:e},i),u)}panTo(e,i,u){return this.easeTo(l.e({center:e},i),u)}getZoom(){return this.transform.zoom}setZoom(e,i){return this.jumpTo({zoom:e},i),this}zoomTo(e,i,u){return this.easeTo(l.e({zoom:e},i),u)}zoomIn(e,i){return this.zoomTo(this.getZoom()+1,e,i),this}zoomOut(e,i){return this.zoomTo(this.getZoom()-1,e,i),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,i){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new l.l("movestart",i)).fire(new l.l("move",i)).fire(new l.l("moveend",i))),this}getBearing(){return this.transform.bearing}setBearing(e,i){return this.jumpTo({bearing:e},i),this}getPadding(){return this.transform.padding}setPadding(e,i){return this.jumpTo({padding:e},i),this}rotateTo(e,i,u){return this.easeTo(l.e({bearing:e},i),u)}resetNorth(e,i){return this.rotateTo(0,l.e({duration:1e3},e),i),this}resetNorthPitch(e,i){return this.easeTo(l.e({bearing:0,pitch:0,roll:0,duration:1e3},e),i),this}snapToNorth(e,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,i):this}getPitch(){return this.transform.pitch}setPitch(e,i){return this.jumpTo({pitch:e},i),this}getRoll(){return this.transform.roll}setRoll(e,i){return this.jumpTo({roll:e},i),this}cameraForBounds(e,i){e=Fr.convert(e).adjustAntiMeridian();const u=i&&i.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),u,i)}_cameraForBoxAndBearing(e,i,u,f){const _={top:0,bottom:0,right:0,left:0};if(typeof(f=l.e({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const R=f.padding;f.padding={top:R,bottom:R,right:R,left:R}}const S=l.e(_,f.padding);f.padding=S;const A=this.transform,j=new Fr(e,i);return this.cameraHelper.cameraForBoxAndBearing(f,S,j,u,A)}fitBounds(e,i,u){return this._fitInternal(this.cameraForBounds(e,i),i,u)}fitScreenCoordinates(e,i,u,f,_){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(l.P.convert(e)),this.transform.screenPointToLocation(l.P.convert(i)),u,f),f,_)}_fitInternal(e,i,u){return e?(delete(i=l.e(e,i)).padding,i.linear?this.easeTo(i,u):this.flyTo(i,u)):this}jumpTo(e,i){this.stop();const u=this._getTransformForUpdate();let f=!1,_=!1,S=!1;const A=u.zoom;this.cameraHelper.handleJumpToCenterZoom(u,e);const j=u.zoom!==A;return"elevation"in e&&u.elevation!==+e.elevation&&u.setElevation(+e.elevation),"bearing"in e&&u.bearing!==+e.bearing&&(f=!0,u.setBearing(+e.bearing)),"pitch"in e&&u.pitch!==+e.pitch&&(_=!0,u.setPitch(+e.pitch)),"roll"in e&&u.roll!==+e.roll&&(S=!0,u.setRoll(+e.roll)),e.padding==null||u.isPaddingEqual(e.padding)||u.setPadding(e.padding),this._applyUpdatedTransform(u),this.fire(new l.l("movestart",i)).fire(new l.l("move",i)),j&&this.fire(new l.l("zoomstart",i)).fire(new l.l("zoom",i)).fire(new l.l("zoomend",i)),f&&this.fire(new l.l("rotatestart",i)).fire(new l.l("rotate",i)).fire(new l.l("rotateend",i)),_&&this.fire(new l.l("pitchstart",i)).fire(new l.l("pitch",i)).fire(new l.l("pitchend",i)),S&&this.fire(new l.l("rollstart",i)).fire(new l.l("roll",i)).fire(new l.l("rollend",i)),this.fire(new l.l("moveend",i))}calculateCameraOptionsFromTo(e,i,u,f=0){const _=l.$.fromLngLat(e,i),S=l.$.fromLngLat(u,f),A=S.x-_.x,j=S.y-_.y,R=S.z-_.z,N=Math.hypot(A,j,R);if(N===0)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(A,j),U=l.ah(this.transform.cameraToCenterDistance/N/this.transform.tileSize),W=180*Math.atan2(A,-j)/Math.PI;let Y=180*Math.acos(F/N)/Math.PI;return Y=R<0?90-Y:90+Y,{center:S.toLngLat(),elevation:f,zoom:U,pitch:Y,bearing:W}}calculateCameraOptionsFromCameraLngLatAltRotation(e,i,u,f,_){const S=this.transform.calculateCenterFromCameraLngLatAlt(e,i,u,f);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:u,pitch:f,roll:_}}easeTo(e,i){this._stop(!1,e.easeId),((e=l.e({offset:[0,0],duration:500,easing:l.cf},e)).animate===!1||!e.essential&&re.prefersReducedMotion)&&(e.duration=0);const u=this._getTransformForUpdate(),f=this.getBearing(),_=u.pitch,S=u.roll,A="bearing"in e?this._normalizeBearing(e.bearing,f):f,j="pitch"in e?+e.pitch:_,R="roll"in e?this._normalizeBearing(e.roll,S):S,N="padding"in e?e.padding:u.padding,F=l.P.convert(e.offset);let U,W;e.around&&(U=l.Q.convert(e.around),W=u.locationToScreenPoint(U));const Y={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ue=this.cameraHelper.handleEaseTo(u,{bearing:A,pitch:j,roll:R,padding:N,around:U,aroundPoint:W,offsetAsPoint:F,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||f!==A,this._pitching=this._pitching||j!==_,this._rolling=this._rolling||R!==S,this._padding=!u.isPaddingEqual(N),this._zooming=this._zooming||ue.isZooming,this._easeId=e.easeId,this._prepareEase(i,e.noMoveStart,Y),this.terrain&&this._prepareElevation(ue.elevationCenter),this._ease(ce=>{ue.easeFunc(ce),this.terrain&&!e.freezeElevation&&this._updateElevation(ce),this._applyUpdatedTransform(u),this._fireMoveEvents(i)},ce=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(i,ce)},e),this}_prepareEase(e,i,u={}){this._moving=!0,i||u.moving||this.fire(new l.l("movestart",e)),this._zooming&&!u.zooming&&this.fire(new l.l("zoomstart",e)),this._rotating&&!u.rotating&&this.fire(new l.l("rotatestart",e)),this._pitching&&!u.pitching&&this.fire(new l.l("pitchstart",e)),this._rolling&&!u.rolling&&this.fire(new l.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&i!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(u-(i-(u*e+this._elevationStart))/(1-e)),this._elevationTarget=i}this.transform.setElevation(l.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const i=e.getCameraLngLat(),u=e.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(i,e.zoom):0;if(u<f){const _=this.calculateCameraOptionsFromTo(i,f,e.center,e.elevation);return{pitch:_.pitch,zoom:_.zoom}}return{}}_applyUpdatedTransform(e){const i=[];if(i.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&i.push(f=>this.transformCameraUpdate(f)),!i.length)return;const u=e.clone();for(const f of i){const _=u.clone(),{center:S,zoom:A,roll:j,pitch:R,bearing:N,elevation:F}=f(_);S&&_.setCenter(S),F!==void 0&&_.setElevation(F),A!==void 0&&_.setZoom(A),j!==void 0&&_.setRoll(j),R!==void 0&&_.setPitch(R),N!==void 0&&_.setBearing(N),u.apply(_)}this.transform.apply(u)}_fireMoveEvents(e){this.fire(new l.l("move",e)),this._zooming&&this.fire(new l.l("zoom",e)),this._rotating&&this.fire(new l.l("rotate",e)),this._pitching&&this.fire(new l.l("pitch",e)),this._rolling&&this.fire(new l.l("roll",e))}_afterEase(e,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const u=this._zooming,f=this._rotating,_=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,u&&this.fire(new l.l("zoomend",e)),f&&this.fire(new l.l("rotateend",e)),_&&this.fire(new l.l("pitchend",e)),S&&this.fire(new l.l("rollend",e)),this.fire(new l.l("moveend",e))}flyTo(e,i){if(!e.essential&&re.prefersReducedMotion){const Ke=l.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ke,i)}this.stop(),e=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.cf},e);const u=this._getTransformForUpdate(),f=u.bearing,_=u.pitch,S=u.roll,A=u.padding,j="bearing"in e?this._normalizeBearing(e.bearing,f):f,R="pitch"in e?+e.pitch:_,N="roll"in e?this._normalizeBearing(e.roll,S):S,F="padding"in e?e.padding:u.padding,U=l.P.convert(e.offset);let W=u.centerPoint.add(U);const Y=u.screenPointToLocation(W),ue=this.cameraHelper.handleFlyTo(u,{bearing:j,pitch:R,roll:N,padding:F,locationAtOffset:Y,offsetAsPoint:U,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ce=e.curve;const de=Math.max(u.width,u.height),pe=de/ue.scaleOfZoom,xe=ue.pixelPathLength;typeof ue.scaleOfMinZoom=="number"&&(ce=Math.sqrt(de/ue.scaleOfMinZoom/xe*2));const ve=ce*ce;function we(Ke){const St=(pe*pe-de*de+(Ke?-1:1)*ve*ve*xe*xe)/(2*(Ke?pe:de)*ve*xe);return Math.log(Math.sqrt(St*St+1)-St)}function ke(Ke){return(Math.exp(Ke)-Math.exp(-Ke))/2}function Te(Ke){return(Math.exp(Ke)+Math.exp(-Ke))/2}const Ve=we(!1);let et=function(Ke){return Te(Ve)/Te(Ve+ce*Ke)},Ge=function(Ke){return de*((Te(Ve)*(ke(St=Ve+ce*Ke)/Te(St))-ke(Ve))/ve)/xe;var St},He=(we(!0)-Ve)/ce;if(Math.abs(xe)<2e-6||!isFinite(He)){if(Math.abs(de-pe)<1e-6)return this.easeTo(e,i);const Ke=pe<de?-1:1;He=Math.abs(Math.log(pe/de))/ce,Ge=()=>0,et=St=>Math.exp(Ke*ce*St)}return e.duration="duration"in e?+e.duration:1e3*He/("screenSpeed"in e?+e.screenSpeed/ce:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=f!==j,this._pitching=R!==_,this._rolling=N!==S,this._padding=!u.isPaddingEqual(F),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(ue.targetCenter),this._ease(Ke=>{const St=Ke*He,wt=1/et(St),ft=Ge(St);this._rotating&&u.setBearing(l.B.number(f,j,Ke)),this._pitching&&u.setPitch(l.B.number(_,R,Ke)),this._rolling&&u.setRoll(l.B.number(S,N,Ke)),this._padding&&(u.interpolatePadding(A,F,Ke),W=u.centerPoint.add(U)),ue.easeFunc(Ke,wt,ft,W),this.terrain&&!e.freezeElevation&&this._updateElevation(Ke),this._applyUpdatedTransform(u),this._fireMoveEvents(i)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(i)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,i){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,i)}return e||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(e,i,u){u.animate===!1||u.duration===0?(e(1),i()):(this._easeStart=re.now(),this._easeOptions=u,this._onEaseFrame=e,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,i){e=l.aL(e,-180,180);const u=Math.abs(e-i);return Math.abs(e-360-i)<u&&(e-=360),Math.abs(e+360-i)<u&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(l.Q.convert(e),this.transform.tileZoom):null}}const Dn={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Hr{constructor(e=Dn){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=i=>{!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"&&i.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=ee.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ee.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ee.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ee.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,i){const u=this._map._getUIString(`AttributionControl.${i}`);e.title=u,e.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const i=this._map.style.sourceCaches;for(const f in i){const _=i[f];if(_.used||_.usedForTerrain){const S=_.getSource();S.attribution&&e.indexOf(S.attribution)<0&&e.push(S.attribution)}}e=e.filter(f=>String(f).trim()),e.sort((f,_)=>f.length-_.length),e=e.filter((f,_)=>{for(let S=_+1;S<e.length;S++)if(e[S].indexOf(f)>=0)return!1;return!0});const u=e.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,e.length?(this._innerContainer.innerHTML=ee.sanitize(u),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class rc{constructor(e={}){this._updateCompact=()=>{const i=this._container.children;if(i.length){const u=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=ee.create("div","maplibregl-ctrl");const i=ee.create("a","maplibregl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://maplibre.org/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ee.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class uh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const i=++this._id;return this._queue.push({callback:e,id:i,cancelled:!1}),i}remove(e){const i=this._currentlyRunning,u=i?this._queue.concat(i):this._queue;for(const f of u)if(f.id===e)return void(f.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const i=this._currentlyRunning=this._queue;this._queue=[];for(const u of i)if(!u.cancelled&&(u.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Sf=l.aG([{name:"a_pos3d",type:"Int16",components:3}]);class hh extends l.E{constructor(e){super(),this._lastTilesetChange=re.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,i){this.sourceCache.update(e,i),this._renderableTilesKeys=[];const u={};for(const f of Pe(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))u[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),l.bQ(f.terrainRttPosMatrix32f,0,l.Z,l.Z,0,0,1),this._tiles[f.key]=new ws(f,this.tileSize),this._lastTilesetChange=re.now());for(const f in this._tiles)u[f]||delete this._tiles[f]}freeRtt(e){for(const i in this._tiles){const u=this._tiles[i];(!e||u.tileID.equals(e)||u.tileID.isChildOf(e)||e.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,i){return i?this._getTerrainCoordsForTileRanges(e,i):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const i={};for(const u of this._renderableTilesKeys){const f=this._tiles[u].tileID,_=e.clone(),S=l.b2();if(f.canonical.equals(e.canonical))l.bQ(S,0,l.Z,l.Z,0,0,1);else if(f.canonical.isChildOf(e.canonical)){const A=f.canonical.z-e.canonical.z,j=f.canonical.x-(f.canonical.x>>A<<A),R=f.canonical.y-(f.canonical.y>>A<<A),N=l.Z>>A;l.bQ(S,0,N,N,0,0,1),l.L(S,S,[-j*N,-R*N,0])}else{if(!e.canonical.isChildOf(f.canonical))continue;{const A=e.canonical.z-f.canonical.z,j=e.canonical.x-(e.canonical.x>>A<<A),R=e.canonical.y-(e.canonical.y>>A<<A),N=l.Z>>A;l.bQ(S,0,l.Z,l.Z,0,0,1),l.L(S,S,[j*N,R*N,0]),l.M(S,S,[1/2**A,1/2**A,0])}}_.terrainRttPosMatrix32f=new Float32Array(S),i[u]=_}return i}_getTerrainCoordsForTileRanges(e,i){const u={};for(const f of this._renderableTilesKeys){const _=this._tiles[f].tileID;if(!this._isWithinTileRanges(_,i))continue;const S=e.clone(),A=l.b2();if(_.canonical.z===e.canonical.z){const j=e.canonical.x-_.canonical.x,R=e.canonical.y-_.canonical.y;l.bQ(A,0,l.Z,l.Z,0,0,1),l.L(A,A,[j*l.Z,R*l.Z,0])}else if(_.canonical.z>e.canonical.z){const j=_.canonical.z-e.canonical.z,R=_.canonical.x-(_.canonical.x>>j<<j),N=_.canonical.y-(_.canonical.y>>j<<j),F=e.canonical.x-(_.canonical.x>>j),U=e.canonical.y-(_.canonical.y>>j),W=l.Z>>j;l.bQ(A,0,W,W,0,0,1),l.L(A,A,[-R*W+F*l.Z,-N*W+U*l.Z,0])}else{const j=e.canonical.z-_.canonical.z,R=e.canonical.x-(e.canonical.x>>j<<j),N=e.canonical.y-(e.canonical.y>>j<<j),F=(e.canonical.x>>j)-_.canonical.x,U=(e.canonical.y>>j)-_.canonical.y,W=l.Z<<j;l.bQ(A,0,W,W,0,0,1),l.L(A,A,[R*l.Z+F*W,N*l.Z+U*W,0])}S.terrainRttPosMatrix32f=new Float32Array(A),u[f]=S}return u}getSourceTile(e,i){const u=this.sourceCache._source;let f=e.overscaledZ-this.deltaZoom;if(f>u.maxzoom&&(f=u.maxzoom),f<u.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(f).key);let _=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!_||!_.dem)&&i)for(;f>=u.minzoom&&(!_||!_.dem);)_=this.sourceCache.getTileByID(e.scaledTo(f--).key);return _}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,i){return i[e.canonical.z]&&e.canonical.x>=i[e.canonical.z].minTileX&&e.canonical.x<=i[e.canonical.z].maxTileX&&e.canonical.y>=i[e.canonical.z].minTileY&&e.canonical.y<=i[e.canonical.z].maxTileY}}class dh{constructor(e,i,u){this._meshCache={},this.painter=e,this.sourceCache=new hh(i),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,i,u,f=l.Z){var _;if(!(i>=0&&i<f&&u>=0&&u<f))return 0;const S=this.getTerrainData(e),A=(_=S.tile)===null||_===void 0?void 0:_.dem;if(!A)return 0;const j=l.cj([],[i/f*l.Z,u/f*l.Z],S.u_terrain_matrix),R=[j[0]*A.dim,j[1]*A.dim],N=Math.floor(R[0]),F=Math.floor(R[1]),U=R[0]-N,W=R[1]-F;return A.get(N,F)*(1-U)*(1-W)+A.get(N+1,F)*U*(1-W)+A.get(N,F+1)*(1-U)*W+A.get(N+1,F+1)*U*W}getElevationForLngLatZoom(e,i){if(!l.ck(i,e.wrap()))return 0;const{tileID:u,mercatorX:f,mercatorY:_}=this._getOverscaledTileIDFromLngLatZoom(e,i);return this.getElevation(u,f%l.Z,_%l.Z,l.Z)}getElevation(e,i,u,f=l.Z){return this.getDEMElevation(e,i,u,f)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const f=this.painter.context,_=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ot(f,_,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ot(f,new l.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ad([])}const i=this.sourceCache.getSourceTile(e,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const f=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new ot(f,i.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),i.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const u=i&&i+i.tileID.key+e.key;if(u&&!this._demMatrixCache[u]){const f=this.sourceCache.sourceCache._source.maxzoom;let _=e.canonical.z-i.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=f?_=e.canonical.z-f:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=e.canonical.x-(e.canonical.x>>_<<_),A=e.canonical.y-(e.canonical.y>>_<<_),j=l.cl(new Float64Array(16),[1/(l.Z<<_),1/(l.Z<<_),0]);l.L(j,j,[S*l.Z,A*l.Z,0]),this._demMatrixCache[e.key]={matrix:j,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(e){const i=this.painter,u=i.width/devicePixelRatio,f=i.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ot(i.context,{width:u,height:f,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ot(i.context,{width:u,height:f,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=i.context.createFramebuffer(u,f,!0,!1),this._fbo.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,u,f))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let _=0,S=0;_<this._coordsTextureSize;_++)for(let A=0;A<this._coordsTextureSize;A++,S+=4)i[S+0]=255&A,i[S+1]=255&_,i[S+2]=A>>8<<4|_>>8,i[S+3]=0;const u=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),f=new ot(e,u,e.gl.RGBA,{premultiply:!1});return f.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const i=new Uint8Array(4),u=this.painter.context,f=u.gl,_=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),A=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(_,A-S-1,1,1,f.RGBA,f.UNSIGNED_BYTE,i),u.bindFramebuffer.set(null);const j=i[0]+(i[2]>>4<<8),R=i[1]+((15&i[2])<<8),N=this.coordsIndex[255-i[3]],F=N&&this.sourceCache.getTileByID(N);if(!F)return null;const U=this._coordsTextureSize,W=(1<<F.tileID.canonical.z)*U;return new l.$((F.tileID.canonical.x*U+j)/W+F.tileID.wrap,(F.tileID.canonical.y*U+R)/W,this.getElevation(F.tileID,j,R,U))}depthAtPoint(e){const i=new Uint8Array(4),u=this.painter.context,f=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,i),u.bindFramebuffer.set(null),(i[0]/16777216+i[1]/65536+i[2]/256+i[3])/256}getTerrainMesh(e){var i;const u=((i=this.painter.style.projection)===null||i===void 0?void 0:i.transitionState)>0,f=u&&e.canonical.y===0,_=u&&e.canonical.y===(1<<e.canonical.z)-1,S=`m_${f?"n":""}_${_?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const A=this.painter.context,j=new l.cm,R=new l.aK,N=this.meshSize,F=l.Z/N,U=N*N;for(let Te=0;Te<=N;Te++)for(let Ve=0;Ve<=N;Ve++)j.emplaceBack(Ve*F,Te*F,0);for(let Te=0;Te<U;Te+=N+1)for(let Ve=0;Ve<N;Ve++)R.emplaceBack(Ve+Te,N+Ve+Te+1,N+Ve+Te+2),R.emplaceBack(Ve+Te,N+Ve+Te+2,Ve+Te+1);const W=j.length,Y=W+(N+1),ue=(N+1)*N,ce=f?l.b9:0,de=f?0:1,pe=_?l.ba:l.Z,xe=_?0:1;for(let Te=0;Te<=N;Te++)j.emplaceBack(Te*F,ce,de);for(let Te=0;Te<=N;Te++)j.emplaceBack(Te*F,pe,xe);for(let Te=0;Te<N;Te++)R.emplaceBack(ue+Te,Y+Te,Y+Te+1),R.emplaceBack(ue+Te,Y+Te+1,ue+Te+1),R.emplaceBack(0+Te,W+Te+1,W+Te),R.emplaceBack(0+Te,0+Te+1,W+Te+1);const ve=j.length,we=ve+2*(N+1);for(const Te of[0,1])for(let Ve=0;Ve<=N;Ve++)for(const et of[0,1])j.emplaceBack(Te*l.Z,Ve*F,et);for(let Te=0;Te<2*N;Te+=2)R.emplaceBack(ve+Te,ve+Te+1,ve+Te+3),R.emplaceBack(ve+Te,ve+Te+3,ve+Te+2),R.emplaceBack(we+Te,we+Te+3,we+Te+1),R.emplaceBack(we+Te,we+Te+2,we+Te+3);const ke=new Io(A.createVertexBuffer(j,Sf.members),A.createIndexBuffer(R),l.aJ.simpleSegment(0,0,j.length,R.length));return this._meshCache[S]=ke,ke}getMeshFrameDelta(e){return 2*Math.PI*l.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,i){var u;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(e,i);return(u=this.getMinMaxElevation(f).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(e){const i=this.getTerrainData(e).tile,u={minElevation:null,maxElevation:null};return i&&i.dem&&(u.minElevation=i.dem.min*this.exaggeration,u.maxElevation=i.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(e,i){const u=l.$.fromLngLat(e.wrap()),f=(1<<i)*l.Z,_=u.x*f,S=u.y*f,A=Math.floor(_/l.Z),j=Math.floor(S/l.Z);return{tileID:new l.Y(i,0,i,A,j),mercatorX:_,mercatorY:S}}}class fd{constructor(e,i,u){this._context=e,this._size=i,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const i=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new ot(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),i.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),i.colorAttachment.set(u.texture),{id:e,fbo:i,texture:u,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(i=>e.id!==i),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const i of this._recentlyUsed)if(!this._objects[i].inUse)return this._objects[i];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const Wr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class bi{constructor(e,i){this.painter=e,this.terrain=i,this.pool=new fd(e.context,30,i.sourceCache.tileSize*i.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,i){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(u=>!e._layers[u].isHidden(i)),this._coordsAscending={};for(const u in e.sourceCaches){this._coordsAscending[u]={};const f=e.sourceCaches[u].getVisibleCoordinates(),_=e.sourceCaches[u].getSource(),S=_ instanceof Sa?_.terrainTileRanges:null;for(const A of f){const j=this.terrain.sourceCache.getTerrainCoords(A,S);for(const R in j)this._coordsAscending[u][R]||(this._coordsAscending[u][R]=[]),this._coordsAscending[u][R].push(j[R])}}this._coordsAscendingStr={};for(const u of e._order){const f=e._layers[u],_=f.source;if(Wr[f.type]&&!this._coordsAscendingStr[_]){this._coordsAscendingStr[_]={};for(const S in this._coordsAscending[_])this._coordsAscendingStr[_][S]=this._coordsAscending[_][S].map(A=>A.key).sort().join()}}for(const u of this._renderableTiles)for(const f in this._coordsAscendingStr){const _=this._coordsAscendingStr[f][u.tileID.key];_&&_!==u.rttCoords[f]&&(u.rtt=[])}}renderLayer(e,i){if(e.isHidden(this.painter.transform.zoom))return!1;const u=Object.assign(Object.assign({},i),{isRenderingToTexture:!0}),f=e.type,_=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Wr[f]&&(this._prevType&&Wr[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(e.id),!S))return!0;if(Wr[this._prevType]||Wr[f]&&S){this._prevType=f;const A=this._stacks.length-1,j=this._stacks[A]||[];for(const R of this._renderableTiles){if(this.pool.isFull()&&(js(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(R),R.rtt[A]){const F=this.pool.getObjectForId(R.rtt[A].id);if(F.stamp===R.rtt[A].stamp){this.pool.useObject(F);continue}}const N=this.pool.getOrCreateFreeObject();this.pool.useObject(N),this.pool.stampObject(N),R.rtt[A]={id:N.id,stamp:N.stamp},_.context.bindFramebuffer.set(N.fbo.framebuffer),_.context.clear({color:l.b7.transparent,stencil:0}),_.currentStencilSource=void 0;for(let F=0;F<j.length;F++){const U=_.style._layers[j[F]],W=U.source?this._coordsAscending[U.source][R.tileID.key]:[R.tileID];_.context.viewport.set([0,0,N.fbo.width,N.fbo.height]),_._renderTileClippingMasks(U,W,!0),_.renderLayer(_,_.style.sourceCaches[U.source],U,W,u),U.source&&(R.rttCoords[U.source]=this._coordsAscendingStr[U.source][R.tileID.key])}}return js(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects(),Wr[f]}return!1}}const Dt={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},$t=B,co={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Dn,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Qc={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Nn{constructor(e,i,u=!1){this.mousedown=_=>{this.startMove(_,ee.mousePos(this.element,_)),ee.addEventListener(window,"mousemove",this.mousemove),ee.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=_=>{this.move(_,ee.mousePos(this.element,_))},this.mouseup=_=>{this._rotatePitchHanlder.dragEnd(_),this.offTemp()},this.touchstart=_=>{_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ee.touchPos(this.element,_.targetTouches)[0],this.startMove(_,this._startPos),ee.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ee.addEventListener(window,"touchend",this.touchend))},this.touchmove=_=>{_.targetTouches.length!==1?this.reset():(this._lastPos=ee.touchPos(this.element,_.targetTouches)[0],this.move(_,this._lastPos))},this.touchend=_=>{_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=i;const f=new ec;this._rotatePitchHanlder=new Pr({clickTolerance:3,move:(_,S)=>{const A=i.getBoundingClientRect(),j=new l.P((A.bottom-A.top)/2,(A.right-A.left)/2);return{bearingDelta:l.ce(new l.P(_.x,S.y),S,j),pitchDelta:u?-.5*(S.y-_.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=e,ee.addEventListener(i,"mousedown",this.mousedown),ee.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),ee.addEventListener(i,"touchcancel",this.reset)}startMove(e,i){this._rotatePitchHanlder.dragStart(e,i),ee.disableDrag()}move(e,i){const u=this.map,{bearingDelta:f,pitchDelta:_}=this._rotatePitchHanlder.dragMove(e,i)||{};f&&u.setBearing(u.getBearing()+f),_&&u.setPitch(u.getPitch()+_)}off(){const e=this.element;ee.removeEventListener(e,"mousedown",this.mousedown),ee.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),ee.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ee.removeEventListener(window,"touchend",this.touchend),ee.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){ee.enableDrag(),ee.removeEventListener(window,"mousemove",this.mousemove),ee.removeEventListener(window,"mouseup",this.mouseup),ee.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ee.removeEventListener(window,"touchend",this.touchend)}}let wi;function Jc(g,e,i,u=!1){if(u||!i.getCoveringTilesDetailsProvider().allowWorldCopies())return g==null?void 0:g.wrap();const f=new l.Q(g.lng,g.lat);if(g=new l.Q(g.lng,g.lat),e){const _=new l.Q(g.lng-360,g.lat),S=new l.Q(g.lng+360,g.lat),A=i.locationToScreenPoint(g).distSqr(e);i.locationToScreenPoint(_).distSqr(e)<A?g=_:i.locationToScreenPoint(S).distSqr(e)<A&&(g=S)}for(;Math.abs(g.lng-i.center.lng)>180;){const _=i.locationToScreenPoint(g);if(_.x>=0&&_.y>=0&&_.x<=i.width&&_.y<=i.height)break;g.lng>i.center.lng?g.lng-=360:g.lng+=360}return g.lng!==f.lng&&i.isPointOnMapSurface(i.locationToScreenPoint(g))?g:f}const La={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function pd(g,e,i){const u=g.classList;for(const f in La)u.remove(`maplibregl-${i}-anchor-${f}`);u.add(`maplibregl-${i}-anchor-${e}`)}class uo extends l.E{constructor(e){if(super(),this._onKeyPress=i=>{const u=i.code,f=i.charCode||i.keyCode;u!=="Space"&&u!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=i=>{const u=i.originalEvent.target,f=this._element;this._popup&&(u===f||f.contains(u))&&this.togglePopup()},this._update=i=>{if(!this._map)return;const u=this._map.loaded()&&!this._map.isMoving();((i==null?void 0:i.type)==="terrain"||(i==null?void 0:i.type)==="render"&&!u)&&this._map.once("render",this._update),this._lngLat=Jc(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||i&&i.type!=="moveend"||(this._pos=this._pos.round()),ee.setTransform(this._element,`${La[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${f}`),re.frameAsync(new AbortController).then(()=>{this._updateOpacity(i&&i.type==="moveend")}).catch(()=>{})},this._onMove=i=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.l("dragstart"))),this.fire(new l.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.l("dragend")),this._state="inactive"},this._addDragHandler=i=>{this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=l.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=ee.create("div");const i=ee.createNS("http://www.w3.org/2000/svg","svg"),u=41,f=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${u}px`),i.setAttributeNS(null,"width",`${f}px`),i.setAttributeNS(null,"viewBox",`0 0 ${f} ${u}`);const _=ee.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");const S=ee.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const A=ee.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"transform","translate(3.0, 29.0)"),A.setAttributeNS(null,"fill","#000000");const j=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const de of j){const pe=ee.createNS("http://www.w3.org/2000/svg","ellipse");pe.setAttributeNS(null,"opacity","0.04"),pe.setAttributeNS(null,"cx","10.5"),pe.setAttributeNS(null,"cy","5.80029008"),pe.setAttributeNS(null,"rx",de.rx),pe.setAttributeNS(null,"ry",de.ry),A.appendChild(pe)}const R=ee.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill",this._color);const N=ee.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),R.appendChild(N);const F=ee.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"opacity","0.25"),F.setAttributeNS(null,"fill","#000000");const U=ee.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),F.appendChild(U);const W=ee.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"transform","translate(6.0, 7.0)"),W.setAttributeNS(null,"fill","#FFFFFF");const Y=ee.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ue=ee.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#000000"),ue.setAttributeNS(null,"opacity","0.25"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962");const ce=ee.createNS("http://www.w3.org/2000/svg","circle");ce.setAttributeNS(null,"fill","#FFFFFF"),ce.setAttributeNS(null,"cx","5.5"),ce.setAttributeNS(null,"cy","5.5"),ce.setAttributeNS(null,"r","5.4999962"),Y.appendChild(ue),Y.appendChild(ce),S.appendChild(A),S.appendChild(R),S.appendChild(F),S.appendChild(W),S.appendChild(Y),i.appendChild(S),i.setAttributeNS(null,"height",u*this._scale+"px"),i.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(i),this._offset=l.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",i=>{i.preventDefault()}),this._element.addEventListener("mousedown",i=>{i.preventDefault()}),pd(this._element,this._anchor,"marker"),e&&e.className)for(const i of e.className.split(" "))this._element.classList.add(i);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ee.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=l.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const f=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var i,u;const f=(i=this._map)===null||i===void 0?void 0:i.terrain,_=this._map.transform.isLocationOccluded(this._lngLat);if(!f||_){const W=_?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==W&&(this._element.style.opacity=W))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const S=this._map,A=S.terrain.depthAtPoint(this._pos),j=S.terrain.getElevationForLngLatZoom(this._lngLat,S.transform.tileZoom);if(S.transform.lngLatToCameraDepth(this._lngLat,j)-A<.006)return void(this._element.style.opacity=this._opacity);const R=-this._offset.y/S.transform.pixelsPerMeter,N=Math.sin(S.getPitch()*Math.PI/180)*R,F=S.terrain.depthAtPoint(new l.P(this._pos.x,this._pos.y-this._offset.y)),U=S.transform.lngLatToCameraDepth(this._lngLat,j+N)-F>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&U&&this._popup.remove(),this._element.style.opacity=U?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=l.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,i){return(this._opacity===void 0||e===void 0&&i===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),i!==void 0&&(this._opacityWhenCovered=i),this._map&&this._updateOpacity(!0),this}}const pi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ai=0,rl=!1;const ic={maxWidth:100,unit:"metric"};function il(g,e,i){const u=i&&i.maxWidth||100,f=g._container.clientHeight/2,_=g._container.clientWidth/2,S=g.unproject([_-u/2,f]),A=g.unproject([_+u/2,f]),j=Math.round(g.project(A).x-g.project(S).x),R=Math.min(u,j,g._container.clientWidth),N=S.distanceTo(A);if(i&&i.unit==="imperial"){const F=3.2808*N;F>5280?ho(e,R,F/5280,g._getUIString("ScaleControl.Miles")):ho(e,R,F,g._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?ho(e,R,N/1852,g._getUIString("ScaleControl.NauticalMiles")):N>=1e3?ho(e,R,N/1e3,g._getUIString("ScaleControl.Kilometers")):ho(e,R,N,g._getUIString("ScaleControl.Meters"))}function ho(g,e,i,u){const f=function(_){const S=Math.pow(10,`${Math.floor(_)}`.length-1);let A=_/S;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:function(j){const R=Math.pow(10,Math.ceil(-Math.log(j)/Math.LN10));return Math.round(j*R)/R}(A),S*A}(i);g.style.width=e*(f/i)+"px",g.innerHTML=`${f}&nbsp;${u}`}const md={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},fh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function al(g){if(g){if(typeof g=="number"){const e=Math.round(Math.abs(g)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,g),"top-left":new l.P(e,e),"top-right":new l.P(-e,e),bottom:new l.P(0,-g),"bottom-left":new l.P(e,-e),"bottom-right":new l.P(-e,-e),left:new l.P(g,0),right:new l.P(-g,0)}}if(g instanceof l.P||Array.isArray(g)){const e=l.P.convert(g);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:l.P.convert(g.center||[0,0]),top:l.P.convert(g.top||[0,0]),"top-left":l.P.convert(g["top-left"]||[0,0]),"top-right":l.P.convert(g["top-right"]||[0,0]),bottom:l.P.convert(g.bottom||[0,0]),"bottom-left":l.P.convert(g["bottom-left"]||[0,0]),"bottom-right":l.P.convert(g["bottom-right"]||[0,0]),left:l.P.convert(g.left||[0,0]),right:l.P.convert(g.right||[0,0])}}return al(new l.P(0,0))}const ph=B;E.AJAXError=l.cq,E.Event=l.l,E.Evented=l.E,E.LngLat=l.Q,E.MercatorCoordinate=l.$,E.Point=l.P,E.addProtocol=l.cr,E.config=l.a,E.removeProtocol=l.cs,E.AttributionControl=Hr,E.BoxZoomHandler=bn,E.CanvasSource=Co,E.CooperativeGesturesHandler=ls,E.DoubleClickZoomHandler=Rn,E.DragPanHandler=Ni,E.DragRotateHandler=Yc,E.EdgeInsets=Hs,E.FullscreenControl=class extends l.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var e;let i=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=i==null?void 0:i.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)i=i.shadowRoot.fullscreenElement;i===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=ee.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ee.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=ee.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ee.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new l.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},E.GeoJSONSource=Eo,E.GeolocateControl=class extends l.E{constructor(g){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new l.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const i=new l.Q(e.coords.longitude,e.coords.latitude),u=e.coords.accuracy,f=this._map.getBearing(),_=l.e({bearing:f},this.options.fitBoundsOptions),S=Fr.fromLngLat(i,u);this._map.fitBounds(S,_,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const i=new l.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&rl)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=ee.create("button","maplibregl-ctrl-geolocate",this._container),ee.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ee.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new uo({element:this._dotElement}),this._circleElement=ee.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new uo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.l("trackuserlocationend")),this.fire(new l.l("userlocationlostfocus")))})}},this.options=l.e({},pi,g)}onAdd(g){return this._map=g,this._container=ee.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return l._(this,arguments,void 0,function*(e=!1){if(wi!==void 0&&!e)return wi;if(window.navigator.permissions===void 0)return wi=!!window.navigator.geolocation,wi;try{wi=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{wi=!!window.navigator.geolocation}return wi})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ee.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ai=0,rl=!1}_isOutOfMapMaxBounds(g){const e=this._map.getMaxBounds(),i=g.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),e=g.getSouthEast(),i=g.getNorthEast(),u=e.distanceTo(i),f=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ai--,rl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.l("trackuserlocationstart")),this.fire(new l.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ai++,ai>1?(g={maximumAge:6e5,timeout:0},rl=!0):(g=this.options.positionOptions,rl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},E.GlobeControl=class{constructor(){this._toggleProjection=()=>{var g;const e=(g=this._map.getProjection())===null||g===void 0?void 0:g.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var g;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((g=this._map.getProjection())===null||g===void 0?void 0:g.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(g){return this._map=g,this._container=ee.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=ee.create("button","maplibregl-ctrl-globe",this._container),ee.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){ee.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},E.Hash=nh,E.ImageSource=Sa,E.KeyboardHandler=wn,E.LngLatBounds=Fr,E.LogoControl=rc,E.Map=class extends Li{constructor(g){var e,i;l.cn.mark(l.co.create);const u=Object.assign(Object.assign(Object.assign({},co),g),{canvasContextAttributes:Object.assign(Object.assign({},co.canvasContextAttributes),g.canvasContextAttributes)});if(u.minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new Ro,_=new fn;if(u.minZoom!==void 0&&f.setMinZoom(u.minZoom),u.maxZoom!==void 0&&f.setMaxZoom(u.maxZoom),u.minPitch!==void 0&&f.setMinPitch(u.minPitch),u.maxPitch!==void 0&&f.setMaxPitch(u.maxPitch),u.renderWorldCopies!==void 0&&f.setRenderWorldCopies(u.renderWorldCopies),super(f,_,{bearingSnap:u.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new uh,this._controls=[],this._mapId=l.a4(),this._contextLost=A=>{A.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new l.l("webglcontextlost",{originalEvent:A}))},this._contextRestored=A=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.l("webglcontextrestored",{originalEvent:A}))},this._onMapScroll=A=>{if(A.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._maxTileCacheZoomLevels=u.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},u.canvasContextAttributes),this._trackResize=u.trackResize===!0,this._bearingSnap=u.bearingSnap,this._centerClampedToGround=u.centerClampedToGround,this._refreshExpiredTiles=u.refreshExpiredTiles===!0,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions===!0,this._collectResourceTiming=u.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Dt),u.locale),this._clickTolerance=u.clickTolerance,this._overridePixelRatio=u.pixelRatio,this._maxCanvasSize=u.maxCanvasSize,this.transformCameraUpdate=u.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=u.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=vt.addThrottleControl(()=>this.isMoving()),this._requestManager=new nt(u.transformRequest),typeof u.container=="string"){if(this._container=document.getElementById(u.container),!this._container)throw new Error(`Container '${u.container}' not found.`)}else{if(!(u.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let A=!1;const j=zs(R=>{this._trackResize&&!this._removed&&(this.resize(R),this.redraw())},50);this._resizeObserver=new ResizeObserver(R=>{A?j(R):A=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Wp(this,u),this._hash=u.hash&&new nh(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,elevation:u.elevation,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,roll:u.roll}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,l.e({},u.fitBoundsOptions,{duration:0}))));const S=typeof u.style=="string"||((i=(e=u.style)===null||e===void 0?void 0:e.projection)===null||i===void 0?void 0:i.type)!=="globe";this.resize(null,S),this._localIdeographFontFamily=u.localIdeographFontFamily,this._validateStyle=u.validateStyle,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new Hr(typeof u.attributionControl=="boolean"?void 0:u.attributionControl)),u.maplibreLogo&&this.addControl(new rc,u.logoPosition),this.on("style.load",()=>{if(S||this._resizeTransform(),this.transform.unmodified){const A=l.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(A)}}),this.on("data",A=>{this._update(A.dataType==="style"),this.fire(new l.l(`${A.dataType}data`,A))}),this.on("dataloading",A=>{this.fire(new l.l(`${A.dataType}dataloading`,A))}),this.on("dataabort",A=>{this.fire(new l.l("sourcedataabort",A))})}_getMapId(){return this._mapId}addControl(g,e){if(e===void 0&&(e=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new l.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=g.onAdd(this);this._controls.push(g);const u=this._controlPositions[e];return e.indexOf("bottom")!==-1?u.insertBefore(i,u.firstChild):u.appendChild(i),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new l.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(g);return e>-1&&this._controls.splice(e,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,e,i,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,e,i,u)}resize(g,e=!0){const[i,u]=this._containerDimensions(),f=this._getClampedPixelRatio(i,u);if(this._resizeCanvas(i,u,f),this.painter.resize(i,u,f),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const A=this._getClampedPixelRatio(i,u);this._resizeCanvas(i,u,A),this.painter.resize(i,u,A)}this._resizeTransform(e);const _=!this._moving;return _&&(this.stop(),this.fire(new l.l("movestart",g)).fire(new l.l("move",g))),this.fire(new l.l("resize",g)),_&&this.fire(new l.l("moveend",g)),this}_resizeTransform(g=!0){var e;const[i,u]=this._containerDimensions();this.transform.resize(i,u,g),(e=this._requestedCameraState)===null||e===void 0||e.resize(i,u,g)}_getClampedPixelRatio(g,e){const{0:i,1:u}=this._maxCanvasSize,f=this.getPixelRatio(),_=g*f,S=e*f;return Math.min(_>i?i/_:1,S>u?u/S:1)*f}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(Fr.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.setMinZoom(g),this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.setMaxZoom(g),this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.setMinPitch(g),this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(g>=this.transform.minPitch)return this.transform.setMaxPitch(g),this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.setRenderWorldCopies(g),this._update()}project(g){return this.transform.locationToScreenPoint(l.Q.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.screenPointToLocation(l.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,e,i){if(g==="mouseenter"||g==="mouseover"){let u=!1;return{layers:e,listener:i,delegates:{mousemove:_=>{const S=e.filter(j=>this.getLayer(j)),A=S.length!==0?this.queryRenderedFeatures(_.point,{layers:S}):[];A.length?u||(u=!0,i.call(this,new fi(g,this,_.originalEvent,{features:A}))):u=!1},mouseout:()=>{u=!1}}}}if(g==="mouseleave"||g==="mouseout"){let u=!1;return{layers:e,listener:i,delegates:{mousemove:S=>{const A=e.filter(j=>this.getLayer(j));(A.length!==0?this.queryRenderedFeatures(S.point,{layers:A}):[]).length?u=!0:u&&(u=!1,i.call(this,new fi(g,this,S.originalEvent)))},mouseout:S=>{u&&(u=!1,i.call(this,new fi(g,this,S.originalEvent)))}}}}{const u=f=>{const _=e.filter(A=>this.getLayer(A)),S=_.length!==0?this.queryRenderedFeatures(f.point,{layers:_}):[];S.length&&(f.features=S,i.call(this,f),delete f.features)};return{layers:e,listener:i,delegates:{[g]:u}}}}_saveDelegatedListener(g,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(e)}_removeDelegatedListener(g,e,i){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const u=this._delegatedListeners[g];for(let f=0;f<u.length;f++){const _=u[f];if(_.listener===i&&_.layers.length===e.length&&_.layers.every(S=>e.includes(S))){for(const S in _.delegates)this.off(S,_.delegates[S]);return void u.splice(f,1)}}}on(g,e,i){if(i===void 0)return super.on(g,e);const u=typeof e=="string"?[e]:e,f=this._createDelegatedListener(g,u,i);this._saveDelegatedListener(g,f);for(const _ in f.delegates)this.on(_,f.delegates[_]);return{unsubscribe:()=>{this._removeDelegatedListener(g,u,i)}}}once(g,e,i){if(i===void 0)return super.once(g,e);const u=typeof e=="string"?[e]:e,f=this._createDelegatedListener(g,u,i);for(const _ in f.delegates){const S=f.delegates[_];f.delegates[_]=(...A)=>{this._removeDelegatedListener(g,u,i),S(...A)}}this._saveDelegatedListener(g,f);for(const _ in f.delegates)this.once(_,f.delegates[_]);return this}off(g,e,i){return i===void 0?super.off(g,e):(this._removeDelegatedListener(g,typeof e=="string"?[e]:e,i),this)}queryRenderedFeatures(g,e){if(!this.style)return[];let i;const u=g instanceof l.P||Array.isArray(g),f=u?g:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(u?{}:g)||{},f instanceof l.P||typeof f[0]=="number")i=[l.P.convert(f)];else{const _=l.P.convert(f[0]),S=l.P.convert(f[1]);i=[_,new l.P(S.x,_.y),S,new l.P(_.x,S.y),_]}return this.style.queryRenderedFeatures(i,e,this.transform)}querySourceFeatures(g,e){return this.style.querySourceFeatures(g,e)}setStyle(g,e){return(e=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(g,e))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const e=this._locale[g];if(e==null)throw new Error(`Missing UI string '${g}'`);return e}_updateStyle(g,e){var i,u;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,e));const f=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new Hh(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,e,f):this.style.loadJSON(g,e,f),this):((u=(i=this.style)===null||i===void 0?void 0:i.projection)===null||u===void 0||u.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Hh(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,e){if(typeof g=="string"){const i=this._requestManager.transformRequest(g,"Style");l.j(i,new AbortController).then(u=>{this._updateDiff(u.data,e)}).catch(u=>{u&&this.fire(new l.k(u))})}else typeof g=="object"&&this._updateDiff(g,e)}_updateDiff(g,e){try{this.style.setState(g,e)&&this._update(!0)}catch(i){l.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(g,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(g,e){return this._lazyInitEmptyStyle(),this.style.addSource(g,e),this._update(!0)}isSourceLoaded(g){const e=this.style&&this.style.sourceCaches[g];if(e!==void 0)return e.loaded();this.fire(new l.k(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const e=this.style.sourceCaches[g.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&e.reload();for(const i in this.style._layers){const u=this.style._layers[i];u.type==="hillshade"&&u.source===g.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new dh(this.painter,e,g),this.painter.renderToTexture=new bi(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=i=>{var u;i.dataType==="style"?this.terrain.sourceCache.freeRtt():i.dataType==="source"&&i.tile&&(i.sourceId!==g.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((u=i.source)===null||u===void 0?void 0:u.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(i.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new l.l("terrain",{terrain:g})),this}getTerrain(){var g,e;return(e=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const e in g){const i=g[e]._tiles;for(const u in i){const f=i[u];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}setSourceTileLodParams(g,e,i){if(i){const u=this.getSource(i);if(!u)throw new Error(`There is no source with ID "${i}", cannot set LOD parameters`);u.calculateTileZoom=Ce(Math.max(1,g),Math.max(1,e))}else for(const u in this.style.sourceCaches)this.style.sourceCaches[u].getSource().calculateTileZoom=Ce(Math.max(1,g),Math.max(1,e));return this._update(!0),this}refreshTiles(g,e){const i=this.style.sourceCaches[g];if(!i)throw new Error(`There is no source cache with ID "${g}", cannot refresh tile`);e===void 0?i.reload():i.refreshTiles(e.map(u=>new l.a1(u.z,u.x,u.y)))}addImage(g,e,i={}){const{pixelRatio:u=1,sdf:f=!1,stretchX:_,stretchY:S,content:A,textFitWidth:j,textFitHeight:R}=i;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||l.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:N,height:F,data:U}=e,W=e;return this.style.addImage(g,{data:new l.R({width:N,height:F},new Uint8Array(U)),pixelRatio:u,stretchX:_,stretchY:S,content:A,textFitWidth:j,textFitHeight:R,sdf:f,version:0,userImage:W}),W.onAdd&&W.onAdd(this,g),this}}{const{width:N,height:F,data:U}=re.getImageData(e);this.style.addImage(g,{data:new l.R({width:N,height:F},U),pixelRatio:u,stretchX:_,stretchY:S,content:A,textFitWidth:j,textFitHeight:R,sdf:f,version:0})}}updateImage(g,e){const i=this.style.getImage(g);if(!i)return this.fire(new l.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=e instanceof HTMLImageElement||l.b(e)?re.getImageData(e):e,{width:f,height:_,data:S}=u;if(f===void 0||_===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==i.data.width||_!==i.data.height)return this.fire(new l.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const A=!(e instanceof HTMLImageElement||l.b(e));return i.data.replace(S,A),this.style.updateImage(g,i),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new l.k(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return vt.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,e){return this._lazyInitEmptyStyle(),this.style.addLayer(g,e),this._update(!0)}moveLayer(g,e){return this.style.moveLayer(g,e),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,e,i){return this.style.setLayerZoomRange(g,e,i),this._update(!0)}setFilter(g,e,i={}){return this.style.setFilter(g,e,i),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,e,i,u={}){return this.style.setPaintProperty(g,e,i,u),this._update(!0)}getPaintProperty(g,e){return this.style.getPaintProperty(g,e)}setLayoutProperty(g,e,i,u={}){return this.style.setLayoutProperty(g,e,i,u),this._update(!0)}getLayoutProperty(g,e){return this.style.getLayoutProperty(g,e)}setGlyphs(g,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,e,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,e,i,u=>{u||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,e,i=>{i||this._update(!0)}),this}setLight(g,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(g,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(g,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,e){return this.style.setFeatureState(g,e),this._update()}removeFeatureState(g,e){return this.style.removeFeatureState(g,e),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,e=0;return this._container&&(g=this._container.clientWidth||400,e=this._container.clientHeight||300),[g,e]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const e=this._canvasContainer=ee.create("div","maplibregl-canvas-container",g);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=ee.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const i=this._containerDimensions(),u=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],u);const f=this._controlContainer=ee.create("div","maplibregl-control-container",g),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{_[S]=ee.create("div",`maplibregl-ctrl-${S} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,e,i){this._canvas.width=Math.floor(i*g),this._canvas.height=Math.floor(i*e),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const g=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{e={requestedAttributes:g},u&&(e.statusMessage=u.statusMessage,e.type=u.type)},{once:!0});let i=null;if(i=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,g):this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g),!i){const u="Failed to initialize WebGL";throw e?(e.message=u,new Error(JSON.stringify(e))):new Error(u)}this.painter=new ah(i,this.transform),te.testSupport(i)}migrateProjection(g,e){super.migrateProjection(g,e),this.painter.transform=g,this.fire(new l.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){var e,i,u,f,_;const S=this._idleTriggered?this._fadeDuration:0,A=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let j=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const F=this.transform.zoom,U=re.now();this.style.zoomHistory.update(F,U);const W=new l.C(F,{now:U,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Y=W.crossFadingFactor();Y===1&&Y===this._crossFadingFactor||(j=!0,this._crossFadingFactor=Y),this.style.update(W)}const R=((i=this.style.projection)===null||i===void 0?void 0:i.transitionState)>0!==A;(u=this.style.projection)===null||u===void 0||u.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(_=this.style.projection)===null||_===void 0?void 0:_.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||R)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,R),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new l.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.cn.mark(l.co.load),this.fire(new l.l("load"))),this.style&&(this.style.hasTransitions()||j)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const N=this._sourcesDirty||this._styleDirty||this._placementDirty;return N||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.l("idle")),!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,l.cn.mark(l.co.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),vt.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ee.remove(this._canvasContainer),ee.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),l.cn.clearMetrics(),this._removed=!0,this.fire(new l.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,re.frame(this._frameRequest,g=>{l.cn.frame(g),this._frameRequest=null;try{this._render(g)}catch(e){if(!l.cp(e)&&!function(i){return i.message===Xo}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return $t}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(g){return this._lazyInitEmptyStyle(),this.style.setProjection(g),this._update(!0)}},E.MapMouseEvent=fi,E.MapTouchEvent=Is,E.MapWheelEvent=sh,E.Marker=uo,E.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const e=this._map.getZoom(),i=e===this._map.getMaxZoom(),u=e===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,i)=>{const u=this._map._getUIString(`NavigationControl.${i}`);e.title=u,e.setAttribute("aria-label",u)},this.options=l.e({},Qc,g),this._container=ee.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),ee.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),ee.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=ee.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Nn(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ee.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,e){const i=ee.create("button",g,this._container);return i.type="button",i.addEventListener("click",e),i}},E.Popup=class extends l.E{constructor(g){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&ee.remove(this._content),this._container&&(ee.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new l.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ee.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ee.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Jc(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const i=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let u=this.options.anchor;const f=al(this.options.offset);if(!u){const S=this._container.offsetWidth,A=this._container.offsetHeight;let j;j=i.y+f.bottom.y<A?["top"]:i.y>this._map.transform.height-A?["bottom"]:[],i.x<S/2?j.push("left"):i.x>this._map.transform.width-S/2&&j.push("right"),u=j.length===0?"bottom":j.join("-")}let _=i.add(f[u]);this.options.subpixelPositioning||(_=_.round()),ee.setTransform(this._container,`${La[u]} translate(${_.x}px,${_.y}px)`),pd(this._container,u,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(md),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=l.Q.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const e=document.createDocumentFragment(),i=document.createElement("body");let u;for(i.innerHTML=g;u=i.firstChild,u;)e.appendChild(u);return this.setDOMContent(e)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ee.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=ee.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(fh);g&&g.focus()}},E.RasterDEMTileSource=Gs,E.RasterTileSource=za,E.ScaleControl=class{constructor(g){this._onMove=()=>{il(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,il(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ic),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=ee.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ee.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},E.ScrollZoomHandler=dr,E.Style=Hh,E.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=ee.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ee.create("button","maplibregl-ctrl-terrain",this._container),ee.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ee.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},E.TwoFingersTouchPitchHandler=ch,E.TwoFingersTouchRotateHandler=kt,E.TwoFingersTouchZoomHandler=In,E.TwoFingersTouchZoomRotateHandler=oo,E.VectorTileSource=Ga,E.VideoSource=ln,E.addSourceType=(g,e)=>l._(void 0,void 0,void 0,function*(){if(Ji(g))throw new Error(`A source type called "${g}" already exists.`);((i,u)=>{Ao[i]=u})(g,e)}),E.clearPrewarmedResources=function(){const g=Et;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(_t),Et=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},E.createTileMesh=Lc,E.getMaxParallelImageRequests=function(){return l.a.MAX_PARALLEL_IMAGE_REQUESTS},E.getRTLTextPluginStatus=function(){return cn().getRTLTextPluginStatus()},E.getVersion=function(){return ph},E.getWorkerCount=function(){return Ot.workerCount},E.getWorkerUrl=function(){return l.a.WORKER_URL},E.importScriptInWorkers=function(g){return wr().broadcast("IS",g)},E.prewarm=function(){rr().acquire(_t)},E.setMaxParallelImageRequests=function(g){l.a.MAX_PARALLEL_IMAGE_REQUESTS=g},E.setRTLTextPlugin=function(g,e){return cn().setRTLTextPlugin(g,e)},E.setWorkerCount=function(g){Ot.workerCount=g},E.setWorkerUrl=function(g){l.a.WORKER_URL=g}});var k=m;return k})}(Ly)),Ly.exports}var y4=g4();const $m=lf(y4),_4=()=>{const{auth:o}=Ri(),[d,m]=he.useState([]),x=he.useRef(null),C=he.useRef(null),k=zl();he.useEffect(()=>{o.location&&E()},[o.location]);const E=async()=>{try{const B=await(await fetch(Wt.url+`users/location/search?lat=${o.location.coordinates[0]}&lng=${o.location.coordinates[1]}`,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();B.status==="success"&&m(B.users)}catch(l){console.log("Error obteniendo usuarios:",l)}};return he.useEffect(()=>{if(!x.current||(o.location||navigator.geolocation.getCurrentPosition(B=>{const{latitude:V,longitude:X}=B.coords;o.location={coordinates:[X,V]},E()},B=>{console.warn("No se pudo obtener la ubicación del navegador:",B),o.location={coordinates:[-6.5918,42.5464]},E()}),!o.location||!o.location.coordinates))return;const l=new $m.Map({container:x.current,style:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",center:[o.location.coordinates[0],o.location.coordinates[1]],zoom:15,pitch:60,bearing:-15,antialias:!0});return C.current=l,new $m.Marker({color:"red"}).setLngLat([o.location.coordinates[0],o.location.coordinates[1]]).setPopup(new $m.Popup().setHTML(`
          <p><strong>Tu estas aquí </strong> ${o.username}</p>
        `)).addTo(l),()=>l.remove()},[o.location]),he.useEffect(()=>{!C.current||d.length===0||d.forEach(l=>{if(l.location&&l.location.coordinates){const B=document.createElement("div"),V=document.createElement("span");V.innerText=`${l.username}`,V.style.color="#d97706",V.style.cursor="pointer",V.onclick=()=>k("/private/profile/",{state:{user:l._id}}),B.appendChild(V),new $m.Marker({color:"blue"}).setLngLat([l.location.coordinates[0],l.location.coordinates[1]]).setPopup(new $m.Popup().setDOMContent(B)).addTo(C.current)}})},[d,k]),w.jsx("div",{className:"w-full h-screen overflow-hidden",children:w.jsx("div",{ref:x,className:"w-[100vw] h-[100vh] mt-[2%]"})})},v4=()=>{const{auth:o}=Ri(),d=zl(),[m,x]=he.useState(null),[C,k]=he.useState({}),[E,l]=he.useState([]),B=async()=>{try{const ee=await(await fetch(Wt.url+`users/search?q=${m}`,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();ee.status==="success"&&k(ee.users)}catch(re){console.log(re)}},V=async re=>{const ee=re._id;try{const be=await(await fetch(Wt.url+"follow",{method:"POST",body:JSON.stringify({followed:ee}),headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}})).json();be.follow.followed.length>0&&l(be.follow.followed),l(Ee=>[...Ee,be.follow.followed])}catch(te){console.log(te)}},X=async re=>{let ee=re._id;try{const be=await(await fetch(Wt.url+"/unfollow/"+ee,{method:"DELETE",headers:{Authorization:localStorage.getItem("token")}})).json();if(be.status!=="success")return;if(E.includes(be.followed)){const Ee=E.indexOf(be.followed);if(Ee===-1)return;const Ae=[...E];Ae.splice(Ee,1),l(Ae)}}catch(te){console.log(te)}},ne=async()=>{const re=o._id;try{const te=await(await fetch(Wt.url+"followings/"+re,{method:"GET",headers:{Authorization:localStorage.getItem("token")}})).json();if(te.status!=="success")return;l(te.users_folowing)}catch(ee){console.log(ee)}};return w.jsx("div",{className:"w-full max-w-4xl sm:max-w-lg md:max-w-2xl lg:max-w-3xl xl:max-w-4xl mx-auto bg-white shadow-md rounded-lg overflow-hidden mt-[20%] sm:mt-[20%] md:mt-[10%] lg:mt-[7%] xl:mt-[7%] 2xl:mt-[5%] p-6",children:w.jsxs("div",{className:"relative items-center mb-6",children:[w.jsx("label",{htmlFor:"user",className:"block text-sm font-medium text-gray-900",children:"Usuario"}),w.jsxs("div",{className:"flex gap-2 items-center mt-2",children:[w.jsx("input",{type:"text",name:"user",onChange:re=>x(re.target.value),className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"}),w.jsx(Q_,{onClick:()=>{B(),ne()},size:20,className:"hover:text-lime-700"})]}),C.length>0&&w.jsxs("div",{className:"mt-4 space-y-4",children:[w.jsx("h4",{className:"font-semibold text-gray-800",children:"Usuarios Encontrados:"}),C.map(re=>w.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-300 rounded-lg",children:[w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsx("img",{src:re.avatar?re.avatar:Uh,alt:`Avatar de ${re.username}`,className:"w-10 h-10 rounded-full object-cover"}),w.jsxs("div",{className:"cursor-pointer",onClick:()=>d("/private/profile/",{state:{user:re._id}}),children:[w.jsx("p",{className:"font-semibold text-gray-800",children:re.username}),w.jsx("p",{className:"text-sm text-gray-500",children:re.bio})]})]}),E&&E.includes(re._id)?w.jsx("button",{onClick:()=>X(re),className:"px-4 py-2 rounded-full bg-gray-400 text-white text-sm font-semibold",children:"Siguiendo"}):w.jsx("button",{onClick:()=>V(re),className:"px-4 py-2 rounded-full bg-amber-700 border border-transparent text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800",children:"Seguir"})]},re._id))]}),C.length===0&&m!==""&&w.jsx("p",{className:"mt-4 text-gray-500",children:"No se encontraron usuarios."})]})})},x4=()=>{const{changed:o,form:d}=Il(),[m,x]=he.useState(null),[C,k]=he.useState(null),[E,l]=he.useState("not-sended"),B=async V=>{V.preventDefault();try{const ne=await(await fetch(Wt.url+"user/forgot-password",{method:"POST",body:JSON.stringify(d),headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("token")}})).json();ne.status==="success"?(x(ne.message),l(!0)):(x(ne.message),k(ne.error),l(!1))}catch(X){console.log(X)}};return w.jsx("div",{className:"min-h-screen flex items-center justify-center",children:w.jsxs("div",{className:"p-8 rounded-md bg-white shadow-md max-w-xs w-full",children:[w.jsx("h1",{className:"text-3xl text-center",children:"Restablecer contraseña"}),w.jsxs("form",{className:"space-y-6 mt-8",onSubmit:B,children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Email"}),w.jsx("div",{className:"mt-2",children:w.jsx("input",{type:"email",name:"email",placeholder:"Email de recuperación",onChange:o,required:!0,className:"block w-full rounded-md bg-gray-200 border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-400 hover:border-amber-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})})]}),w.jsx("div",{children:w.jsx("button",{type:"submit",className:"flex w-full justify-center rounded-full bg-amber-700 border border-transparent px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-amber-800 hover:border-lime-500 focus:outline-none focus:ring-2 focus:ring-lime-800",children:"Enviar"})}),E===!0?w.jsxs("div",{className:" mt-4 bg-lime-100 border border-lime-400 text-lime-700 px-4 py-3 rounded relative",role:"alert-success",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",m," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):"",E===!1?w.jsxs("div",{className:" mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert-danger",children:[w.jsx("strong",{className:"",children:w.jsxs("p",{className:"block sm:inline ml-2",children:[" ",m," "]})}),w.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3"})]}):""]})]})})},b4="/assets/policy-uYLj_d6r.png",w4="/assets/terms-c3y9llcQ.jpg",S4=()=>w.jsxs("div",{className:"bg-gray-100",children:[w.jsxs("div",{className:"relative",children:[w.jsx("img",{src:b4,alt:"Café de especialidad",className:"w-full h-[400px] object-cover"}),w.jsx("div",{className:"absolute inset-0 flex justify-center items-center",children:w.jsx("h2",{className:"text-4xl font-semibold text-white text-center px-6",children:"Política de Privacidad"})})]}),w.jsx("div",{className:"flex justify-center",children:w.jsxs("div",{className:"w-full md:max-w-6xl",children:[w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"1. Información que Recopilamos"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"Recopilamos la siguiente información personal cuando interactúas con nuestro sitio web o plataforma:"}),w.jsxs("ul",{className:"list-inside list-disc pl-5 mt-4",children:[w.jsxs("li",{children:[w.jsx("strong",{className:"text-gray-700",children:"Información proporcionada directamente por el usuario:"})," ","Nombre, correo electrónico, mensaje de contacto, etc."]}),w.jsxs("li",{children:[w.jsx("strong",{className:"text-gray-700",children:"Información recopilada automáticamente:"})," ","Dirección IP, tipo de navegador, dispositivo, información de navegación."]})]})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"2. Cómo Usamos tu Información"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"Utilizamos los datos personales recopilados para los siguientes fines:"}),w.jsxs("ul",{className:"list-inside list-disc pl-5 mt-4",children:[w.jsx("li",{children:"Proveer nuestros servicios de manera eficiente y personalizada."}),w.jsx("li",{children:"Responder a tus consultas, solicitudes o comentarios."}),w.jsx("li",{children:"Mejorar la experiencia del usuario en nuestra plataforma."}),w.jsx("li",{children:"Enviar correos electrónicos relacionados con el servicio."}),w.jsx("li",{children:"Cumplir con nuestras obligaciones legales y reguladoras."})]})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"3. Cómo Compartimos tu Información"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"En BeanLink, no vendemos ni compartimos tu información personal con terceros para fines comerciales. Sin embargo, podemos compartir tu información con:"}),w.jsxs("ul",{className:"list-inside list-disc pl-5 mt-4",children:[w.jsxs("li",{children:[w.jsx("strong",{className:"text-gray-700",children:"Proveedores de servicios:"})," ","Empresas que nos ayudan a operar la plataforma."]}),w.jsxs("li",{children:[w.jsx("strong",{className:"text-gray-700",children:"Razones legales:"})," Si es requerido por la ley, como en el caso de una orden judicial."]})]})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"4. Tus Derechos sobre tus Datos"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"De acuerdo con la legislación aplicable, tienes derecho a:"}),w.jsxs("ul",{className:"list-inside list-disc pl-5 mt-4",children:[w.jsx("li",{children:"Acceder, corregir, actualizar o eliminar tu información personal."}),w.jsx("li",{children:"Solicitar la restricción del uso de tus datos."}),w.jsx("li",{children:"Oponerte al procesamiento de tus datos para fines de marketing."})]}),w.jsxs("p",{className:"mt-4",children:["Para ejercer tus derechos, contáctanos"," ",w.jsx(zc,{to:"/",className:"font-bold text-amber-700",children:"Aqui"}),"."]})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"5. Seguridad de la Información"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"Tomamos medidas de seguridad razonables para proteger tus datos personales contra accesos no autorizados."})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"6. Cambios en la Política de Privacidad"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"Podemos modificar esta política de privacidad de vez en cuando. Cualquier cambio será publicado en esta página y será efectivo tan pronto como se haga disponible."})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"7. Contacto"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"Si tienes alguna pregunta o inquietud sobre nuestra política de privacidad, por favor contáctanos en:"}),w.jsx("p",{className:"mt-4",children:w.jsx(zc,{to:"/",className:"font-bold text-amber-700",children:"Aqui"})}),w.jsx("p",{children:"Equipo BeanLink"})]})]})}),w.jsxs("div",{className:"bg-gray-100",children:[w.jsxs("div",{className:"relative mt-8",children:[w.jsx("img",{src:w4,alt:"Café de especialidad",className:"w-full h-[400px] object-cover"}),w.jsx("div",{className:"absolute inset-0 flex justify-center items-center",children:w.jsx("h2",{className:"text-4xl font-semibold text-white text-center px-6",children:"Términos de Uso"})})]}),w.jsx("div",{className:"flex justify-center",children:w.jsxs("div",{className:"w-full md:max-w-6xl",children:[w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"1. Aceptación de los Términos"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"Al acceder y utilizar BeanLink, aceptas estar sujeto a estos Términos, así como a nuestra Política de Privacidad. Si no aceptas alguna de las condiciones, no debes utilizar la plataforma."})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"2. Uso de la Plataforma"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"Te comprometes a utilizar la plataforma de manera legal, ética y conforme a los principios de buena fe. No podrás usar los servicios para:"}),w.jsxs("ul",{className:"list-inside list-disc pl-5 mt-4",children:[w.jsx("li",{children:"Realizar actividades ilegales o fraudulentas."}),w.jsx("li",{children:"Interrumpir el funcionamiento del sitio o los servicios."}),w.jsx("li",{children:"Violar derechos de propiedad intelectual."})]})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"3. Propiedad Intelectual"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"El contenido de BeanLink, incluyendo textos, imágenes, logotipos, diseños y código fuente, es propiedad de BeanLink o de nuestros licenciantes. No se permite el uso sin autorización expresa."})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"4. Limitación de Responsabilidad"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"En BeanLink no nos hacemos responsables de los daños que puedan surgir del uso de la plataforma, incluyendo la pérdida de datos o ingresos."})]}),w.jsxs("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden p-6 mt-8",children:[w.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"5. Modificaciones en el Servicio"}),w.jsx("p",{className:"text-lg leading-relaxed mt-4",children:"Nos reservamos el derecho de modificar o suspender el servicio en cualquier momento y sin previo aviso."})]})]})})]}),w.jsx(V1,{})]}),T4=()=>w.jsx(rT,{children:w.jsx(fT,{children:w.jsxs(zS,{children:[w.jsxs(sn,{path:"/",element:w.jsx(pT,{}),children:[w.jsx(sn,{index:!0,element:w.jsx(_T,{})}),w.jsx(sn,{path:"/login",element:w.jsx(mT,{})}),w.jsx(sn,{path:"/register",element:w.jsx(gT,{})}),w.jsx(sn,{path:"/forgot-password",element:w.jsx(x4,{})}),w.jsx(sn,{path:"/reset-password/:token",element:w.jsx(vT,{})}),w.jsx(sn,{path:"/privacity-policy",element:w.jsx(S4,{})})]}),w.jsxs(sn,{path:"/private",element:w.jsx(CT,{}),children:[w.jsx(sn,{index:!0,element:w.jsx(Gb,{})}),w.jsx(sn,{path:"feed",element:w.jsx(Gb,{})}),w.jsx(sn,{path:"profile",element:w.jsx(f4,{})}),w.jsx(sn,{path:"coffeelog",element:w.jsx(u2,{})}),w.jsx(sn,{path:"logout",element:w.jsx(p4,{})}),w.jsx(sn,{path:"search",element:w.jsx(v4,{})}),w.jsx(sn,{path:"map",element:w.jsx(_4,{})})]}),w.jsx(sn,{path:"*",element:w.jsxs(w.Fragment,{children:[w.jsx("h1",{children:"Error 404"}),w.jsx(zc,{to:"/",children:"Volver al Inicio"})]})})]})})});function M4(){return w.jsx("div",{className:"layout",children:w.jsx(T4,{})})}const f2={locale:"es",long:{year:{previous:"el año pasado",current:"este año",next:"el próximo año",past:{one:"hace {0} año",other:"hace {0} años"},future:{one:"dentro de {0} año",other:"dentro de {0} años"}},quarter:{previous:"el trimestre pasado",current:"este trimestre",next:"el próximo trimestre",past:{one:"hace {0} trimestre",other:"hace {0} trimestres"},future:{one:"dentro de {0} trimestre",other:"dentro de {0} trimestres"}},month:{previous:"el mes pasado",current:"este mes",next:"el próximo mes",past:{one:"hace {0} mes",other:"hace {0} meses"},future:{one:"dentro de {0} mes",other:"dentro de {0} meses"}},week:{previous:"la semana pasada",current:"esta semana",next:"la próxima semana",past:{one:"hace {0} semana",other:"hace {0} semanas"},future:{one:"dentro de {0} semana",other:"dentro de {0} semanas"}},day:{previous:"ayer","previous-2":"anteayer",current:"hoy",next:"mañana","next-2":"pasado mañana",past:{one:"hace {0} día",other:"hace {0} días"},future:{one:"dentro de {0} día",other:"dentro de {0} días"}},hour:{current:"esta hora",past:{one:"hace {0} hora",other:"hace {0} horas"},future:{one:"dentro de {0} hora",other:"dentro de {0} horas"}},minute:{current:"este minuto",past:{one:"hace {0} minuto",other:"hace {0} minutos"},future:{one:"dentro de {0} minuto",other:"dentro de {0} minutos"}},second:{current:"ahora",past:{one:"hace {0} segundo",other:"hace {0} segundos"},future:{one:"dentro de {0} segundo",other:"dentro de {0} segundos"}}},short:{year:{previous:"el año pasado",current:"este año",next:"el próximo año",past:"hace {0} a",future:"dentro de {0} a"},quarter:{previous:"el trimestre pasado",current:"este trimestre",next:"el próximo trimestre",past:"hace {0} trim.",future:"dentro de {0} trim."},month:{previous:"el mes pasado",current:"este mes",next:"el próximo mes",past:"hace {0} m",future:"dentro de {0} m"},week:{previous:"sem. ant.",current:"esta sem.",next:"próx. sem.",past:"hace {0} sem.",future:"dentro de {0} sem."},day:{previous:"ayer","previous-2":"anteayer",current:"hoy",next:"mañana","next-2":"pasado mañana",past:"hace {0} d",future:"dentro de {0} d"},hour:{current:"esta hora",past:"hace {0} h",future:"dentro de {0} h"},minute:{current:"este minuto",past:"hace {0} min",future:"dentro de {0} min"},second:{current:"ahora",past:"hace {0} s",future:"dentro de {0} s"}},narrow:{year:{previous:"el año pasado",current:"este año",next:"el próximo año",past:"hace {0} a",future:"dentro de {0} a"},quarter:{previous:"el trimestre pasado",current:"este trimestre",next:"el próximo trimestre",past:"hace {0} trim.",future:"dentro de {0} trim."},month:{previous:"el mes pasado",current:"este mes",next:"el próximo mes",past:"hace {0} m",future:"dentro de {0} m"},week:{previous:"sem. ant.",current:"esta sem.",next:"próx. sem.",past:"hace {0} sem.",future:"dentro de {0} sem."},day:{previous:"ayer","previous-2":"anteayer",current:"hoy",next:"mañana","next-2":"pasado mañana",past:"hace {0} d",future:"dentro de {0} d"},hour:{current:"esta hora",past:"hace {0} h",future:"dentro de {0} h"},minute:{current:"este minuto",past:"hace {0} min",future:"dentro de {0} min"},second:{current:"ahora",past:"hace {0} s",future:"dentro de {0} s"}},now:{now:{current:"ahora",future:"enseguida",past:"ahora mismo"}},mini:{year:{one:"{0} año",other:"{0} años"},month:{one:"{0} mes",other:"{0} meses"},week:"{0} sem.",day:{one:"{0} día",other:"{0} días"},hour:{one:"{0} hora",other:"{0} horas"},minute:"{0} min.",second:"{0} seg.",now:"ahora"},"long-time":{year:{one:"{0} año",other:"{0} años"},month:{one:"{0} mes",other:"{0} meses"},week:{one:"{0} semana",other:"{0} semanas"},day:{one:"{0} día",other:"{0} días"},hour:{one:"{0} hora",other:"{0} horas"},minute:{one:"{0} minuto",other:"{0} minutos"},second:{one:"{0} segundo",other:"{0} segundos"}}};qs.addDefaultLocale(f2);qs.addLocale(f2);z2.createRoot(document.getElementById("root")).render(w.jsx(he.StrictMode,{children:w.jsx(M4,{})}));
